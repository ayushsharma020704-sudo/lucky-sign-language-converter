function IM(n,e){for(var t=0;t<e.length;t++){const s=e[t];if(typeof s!="string"&&!Array.isArray(s)){for(const r in s)if(r!=="default"&&!(r in n)){const o=Object.getOwnPropertyDescriptor(s,r);o&&Object.defineProperty(n,r,o.get?o:{enumerable:!0,get:()=>s[r]})}}}return Object.freeze(Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))s(r);new MutationObserver(r=>{for(const o of r)if(o.type==="childList")for(const i of o.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&s(i)}).observe(document,{childList:!0,subtree:!0});function t(r){const o={};return r.integrity&&(o.integrity=r.integrity),r.referrerPolicy&&(o.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?o.credentials="include":r.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function s(r){if(r.ep)return;r.ep=!0;const o=t(r);fetch(r.href,o)}})();function am(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}function $M(n){if(Object.prototype.hasOwnProperty.call(n,"__esModule"))return n;var e=n.default;if(typeof e=="function"){var t=function s(){return this instanceof s?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};t.prototype=e.prototype}else t={};return Object.defineProperty(t,"__esModule",{value:!0}),Object.keys(n).forEach(function(s){var r=Object.getOwnPropertyDescriptor(n,s);Object.defineProperty(t,s,r.get?r:{enumerable:!0,get:function(){return n[s]}})}),t}var Q0={exports:{}},hc={},Z0={exports:{}},ut={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var jT;function EM(){if(jT)return ut;jT=1;var n=Symbol.for("react.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),s=Symbol.for("react.strict_mode"),r=Symbol.for("react.profiler"),o=Symbol.for("react.provider"),i=Symbol.for("react.context"),a=Symbol.for("react.forward_ref"),l=Symbol.for("react.suspense"),u=Symbol.for("react.memo"),h=Symbol.for("react.lazy"),p=Symbol.iterator;function f(F){return F===null||typeof F!="object"?null:(F=p&&F[p]||F["@@iterator"],typeof F=="function"?F:null)}var m={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},y=Object.assign,x={};function v(F,z,q){this.props=F,this.context=z,this.refs=x,this.updater=q||m}v.prototype.isReactComponent={},v.prototype.setState=function(F,z){if(typeof F!="object"&&typeof F!="function"&&F!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,F,z,"setState")},v.prototype.forceUpdate=function(F){this.updater.enqueueForceUpdate(this,F,"forceUpdate")};function w(){}w.prototype=v.prototype;function S(F,z,q){this.props=F,this.context=z,this.refs=x,this.updater=q||m}var k=S.prototype=new w;k.constructor=S,y(k,v.prototype),k.isPureReactComponent=!0;var T=Array.isArray,I=Object.prototype.hasOwnProperty,E={current:null},D={key:!0,ref:!0,__self:!0,__source:!0};function O(F,z,q){var re,ue={},pe=null,he=null;if(z!=null)for(re in z.ref!==void 0&&(he=z.ref),z.key!==void 0&&(pe=""+z.key),z)I.call(z,re)&&!D.hasOwnProperty(re)&&(ue[re]=z[re]);var xe=arguments.length-2;if(xe===1)ue.children=q;else if(1<xe){for(var ge=Array(xe),Ie=0;Ie<xe;Ie++)ge[Ie]=arguments[Ie+2];ue.children=ge}if(F&&F.defaultProps)for(re in xe=F.defaultProps,xe)ue[re]===void 0&&(ue[re]=xe[re]);return{$$typeof:n,type:F,key:pe,ref:he,props:ue,_owner:E.current}}function _(F,z){return{$$typeof:n,type:F.type,key:z,ref:F.ref,props:F.props,_owner:F._owner}}function P(F){return typeof F=="object"&&F!==null&&F.$$typeof===n}function R(F){var z={"=":"=0",":":"=2"};return"$"+F.replace(/[=:]/g,function(q){return z[q]})}var W=/\/+/g;function Q(F,z){return typeof F=="object"&&F!==null&&F.key!=null?R(""+F.key):z.toString(36)}function ee(F,z,q,re,ue){var pe=typeof F;(pe==="undefined"||pe==="boolean")&&(F=null);var he=!1;if(F===null)he=!0;else switch(pe){case"string":case"number":he=!0;break;case"object":switch(F.$$typeof){case n:case e:he=!0}}if(he)return he=F,ue=ue(he),F=re===""?"."+Q(he,0):re,T(ue)?(q="",F!=null&&(q=F.replace(W,"$&/")+"/"),ee(ue,z,q,"",function(Ie){return Ie})):ue!=null&&(P(ue)&&(ue=_(ue,q+(!ue.key||he&&he.key===ue.key?"":(""+ue.key).replace(W,"$&/")+"/")+F)),z.push(ue)),1;if(he=0,re=re===""?".":re+":",T(F))for(var xe=0;xe<F.length;xe++){pe=F[xe];var ge=re+Q(pe,xe);he+=ee(pe,z,q,ge,ue)}else if(ge=f(F),typeof ge=="function")for(F=ge.call(F),xe=0;!(pe=F.next()).done;)pe=pe.value,ge=re+Q(pe,xe++),he+=ee(pe,z,q,ge,ue);else if(pe==="object")throw z=String(F),Error("Objects are not valid as a React child (found: "+(z==="[object Object]"?"object with keys {"+Object.keys(F).join(", ")+"}":z)+"). If you meant to render a collection of children, use an array instead.");return he}function te(F,z,q){if(F==null)return F;var re=[],ue=0;return ee(F,re,"","",function(pe){return z.call(q,pe,ue++)}),re}function oe(F){if(F._status===-1){var z=F._result;z=z(),z.then(function(q){(F._status===0||F._status===-1)&&(F._status=1,F._result=q)},function(q){(F._status===0||F._status===-1)&&(F._status=2,F._result=q)}),F._status===-1&&(F._status=0,F._result=z)}if(F._status===1)return F._result.default;throw F._result}var se={current:null},G={transition:null},V={ReactCurrentDispatcher:se,ReactCurrentBatchConfig:G,ReactCurrentOwner:E};function B(){throw Error("act(...) is not supported in production builds of React.")}return ut.Children={map:te,forEach:function(F,z,q){te(F,function(){z.apply(this,arguments)},q)},count:function(F){var z=0;return te(F,function(){z++}),z},toArray:function(F){return te(F,function(z){return z})||[]},only:function(F){if(!P(F))throw Error("React.Children.only expected to receive a single React element child.");return F}},ut.Component=v,ut.Fragment=t,ut.Profiler=r,ut.PureComponent=S,ut.StrictMode=s,ut.Suspense=l,ut.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=V,ut.act=B,ut.cloneElement=function(F,z,q){if(F==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+F+".");var re=y({},F.props),ue=F.key,pe=F.ref,he=F._owner;if(z!=null){if(z.ref!==void 0&&(pe=z.ref,he=E.current),z.key!==void 0&&(ue=""+z.key),F.type&&F.type.defaultProps)var xe=F.type.defaultProps;for(ge in z)I.call(z,ge)&&!D.hasOwnProperty(ge)&&(re[ge]=z[ge]===void 0&&xe!==void 0?xe[ge]:z[ge])}var ge=arguments.length-2;if(ge===1)re.children=q;else if(1<ge){xe=Array(ge);for(var Ie=0;Ie<ge;Ie++)xe[Ie]=arguments[Ie+2];re.children=xe}return{$$typeof:n,type:F.type,key:ue,ref:pe,props:re,_owner:he}},ut.createContext=function(F){return F={$$typeof:i,_currentValue:F,_currentValue2:F,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},F.Provider={$$typeof:o,_context:F},F.Consumer=F},ut.createElement=O,ut.createFactory=function(F){var z=O.bind(null,F);return z.type=F,z},ut.createRef=function(){return{current:null}},ut.forwardRef=function(F){return{$$typeof:a,render:F}},ut.isValidElement=P,ut.lazy=function(F){return{$$typeof:h,_payload:{_status:-1,_result:F},_init:oe}},ut.memo=function(F,z){return{$$typeof:u,type:F,compare:z===void 0?null:z}},ut.startTransition=function(F){var z=G.transition;G.transition={};try{F()}finally{G.transition=z}},ut.unstable_act=B,ut.useCallback=function(F,z){return se.current.useCallback(F,z)},ut.useContext=function(F){return se.current.useContext(F)},ut.useDebugValue=function(){},ut.useDeferredValue=function(F){return se.current.useDeferredValue(F)},ut.useEffect=function(F,z){return se.current.useEffect(F,z)},ut.useId=function(){return se.current.useId()},ut.useImperativeHandle=function(F,z,q){return se.current.useImperativeHandle(F,z,q)},ut.useInsertionEffect=function(F,z){return se.current.useInsertionEffect(F,z)},ut.useLayoutEffect=function(F,z){return se.current.useLayoutEffect(F,z)},ut.useMemo=function(F,z){return se.current.useMemo(F,z)},ut.useReducer=function(F,z,q){return se.current.useReducer(F,z,q)},ut.useRef=function(F){return se.current.useRef(F)},ut.useState=function(F){return se.current.useState(F)},ut.useSyncExternalStore=function(F,z,q){return se.current.useSyncExternalStore(F,z,q)},ut.useTransition=function(){return se.current.useTransition()},ut.version="18.3.1",ut}var HT;function lm(){return HT||(HT=1,Z0.exports=EM()),Z0.exports}/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var KT;function RM(){if(KT)return hc;KT=1;var n=lm(),e=Symbol.for("react.element"),t=Symbol.for("react.fragment"),s=Object.prototype.hasOwnProperty,r=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,o={key:!0,ref:!0,__self:!0,__source:!0};function i(a,l,u){var h,p={},f=null,m=null;u!==void 0&&(f=""+u),l.key!==void 0&&(f=""+l.key),l.ref!==void 0&&(m=l.ref);for(h in l)s.call(l,h)&&!o.hasOwnProperty(h)&&(p[h]=l[h]);if(a&&a.defaultProps)for(h in l=a.defaultProps,l)p[h]===void 0&&(p[h]=l[h]);return{$$typeof:e,type:a,key:f,ref:m,props:p,_owner:r.current}}return hc.Fragment=t,hc.jsx=i,hc.jsxs=i,hc}var qT;function DM(){return qT||(qT=1,Q0.exports=RM()),Q0.exports}var ke=DM(),J=lm();const AM=am(J);var Op={},J0={exports:{}},Cs={},ex={exports:{}},tx={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var XT;function OM(){return XT||(XT=1,(function(n){function e(G,V){var B=G.length;G.push(V);e:for(;0<B;){var F=B-1>>>1,z=G[F];if(0<r(z,V))G[F]=V,G[B]=z,B=F;else break e}}function t(G){return G.length===0?null:G[0]}function s(G){if(G.length===0)return null;var V=G[0],B=G.pop();if(B!==V){G[0]=B;e:for(var F=0,z=G.length,q=z>>>1;F<q;){var re=2*(F+1)-1,ue=G[re],pe=re+1,he=G[pe];if(0>r(ue,B))pe<z&&0>r(he,ue)?(G[F]=he,G[pe]=B,F=pe):(G[F]=ue,G[re]=B,F=re);else if(pe<z&&0>r(he,B))G[F]=he,G[pe]=B,F=pe;else break e}}return V}function r(G,V){var B=G.sortIndex-V.sortIndex;return B!==0?B:G.id-V.id}if(typeof performance=="object"&&typeof performance.now=="function"){var o=performance;n.unstable_now=function(){return o.now()}}else{var i=Date,a=i.now();n.unstable_now=function(){return i.now()-a}}var l=[],u=[],h=1,p=null,f=3,m=!1,y=!1,x=!1,v=typeof setTimeout=="function"?setTimeout:null,w=typeof clearTimeout=="function"?clearTimeout:null,S=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function k(G){for(var V=t(u);V!==null;){if(V.callback===null)s(u);else if(V.startTime<=G)s(u),V.sortIndex=V.expirationTime,e(l,V);else break;V=t(u)}}function T(G){if(x=!1,k(G),!y)if(t(l)!==null)y=!0,oe(I);else{var V=t(u);V!==null&&se(T,V.startTime-G)}}function I(G,V){y=!1,x&&(x=!1,w(O),O=-1),m=!0;var B=f;try{for(k(V),p=t(l);p!==null&&(!(p.expirationTime>V)||G&&!R());){var F=p.callback;if(typeof F=="function"){p.callback=null,f=p.priorityLevel;var z=F(p.expirationTime<=V);V=n.unstable_now(),typeof z=="function"?p.callback=z:p===t(l)&&s(l),k(V)}else s(l);p=t(l)}if(p!==null)var q=!0;else{var re=t(u);re!==null&&se(T,re.startTime-V),q=!1}return q}finally{p=null,f=B,m=!1}}var E=!1,D=null,O=-1,_=5,P=-1;function R(){return!(n.unstable_now()-P<_)}function W(){if(D!==null){var G=n.unstable_now();P=G;var V=!0;try{V=D(!0,G)}finally{V?Q():(E=!1,D=null)}}else E=!1}var Q;if(typeof S=="function")Q=function(){S(W)};else if(typeof MessageChannel<"u"){var ee=new MessageChannel,te=ee.port2;ee.port1.onmessage=W,Q=function(){te.postMessage(null)}}else Q=function(){v(W,0)};function oe(G){D=G,E||(E=!0,Q())}function se(G,V){O=v(function(){G(n.unstable_now())},V)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(G){G.callback=null},n.unstable_continueExecution=function(){y||m||(y=!0,oe(I))},n.unstable_forceFrameRate=function(G){0>G||125<G?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):_=0<G?Math.floor(1e3/G):5},n.unstable_getCurrentPriorityLevel=function(){return f},n.unstable_getFirstCallbackNode=function(){return t(l)},n.unstable_next=function(G){switch(f){case 1:case 2:case 3:var V=3;break;default:V=f}var B=f;f=V;try{return G()}finally{f=B}},n.unstable_pauseExecution=function(){},n.unstable_requestPaint=function(){},n.unstable_runWithPriority=function(G,V){switch(G){case 1:case 2:case 3:case 4:case 5:break;default:G=3}var B=f;f=G;try{return V()}finally{f=B}},n.unstable_scheduleCallback=function(G,V,B){var F=n.unstable_now();switch(typeof B=="object"&&B!==null?(B=B.delay,B=typeof B=="number"&&0<B?F+B:F):B=F,G){case 1:var z=-1;break;case 2:z=250;break;case 5:z=1073741823;break;case 4:z=1e4;break;default:z=5e3}return z=B+z,G={id:h++,callback:V,priorityLevel:G,startTime:B,expirationTime:z,sortIndex:-1},B>F?(G.sortIndex=B,e(u,G),t(l)===null&&G===t(u)&&(x?(w(O),O=-1):x=!0,se(T,B-F))):(G.sortIndex=z,e(l,G),y||m||(y=!0,oe(I))),G},n.unstable_shouldYield=R,n.unstable_wrapCallback=function(G){var V=f;return function(){var B=f;f=V;try{return G.apply(this,arguments)}finally{f=B}}}})(tx)),tx}var YT;function _M(){return YT||(YT=1,ex.exports=OM()),ex.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var QT;function FM(){if(QT)return Cs;QT=1;var n=lm(),e=_M();function t(c){for(var d="https://reactjs.org/docs/error-decoder.html?invariant="+c,g=1;g<arguments.length;g++)d+="&args[]="+encodeURIComponent(arguments[g]);return"Minified React error #"+c+"; visit "+d+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var s=new Set,r={};function o(c,d){i(c,d),i(c+"Capture",d)}function i(c,d){for(r[c]=d,c=0;c<d.length;c++)s.add(d[c])}var a=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),l=Object.prototype.hasOwnProperty,u=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,h={},p={};function f(c){return l.call(p,c)?!0:l.call(h,c)?!1:u.test(c)?p[c]=!0:(h[c]=!0,!1)}function m(c,d,g,b){if(g!==null&&g.type===0)return!1;switch(typeof d){case"function":case"symbol":return!0;case"boolean":return b?!1:g!==null?!g.acceptsBooleans:(c=c.toLowerCase().slice(0,5),c!=="data-"&&c!=="aria-");default:return!1}}function y(c,d,g,b){if(d===null||typeof d>"u"||m(c,d,g,b))return!0;if(b)return!1;if(g!==null)switch(g.type){case 3:return!d;case 4:return d===!1;case 5:return isNaN(d);case 6:return isNaN(d)||1>d}return!1}function x(c,d,g,b,C,N,A){this.acceptsBooleans=d===2||d===3||d===4,this.attributeName=b,this.attributeNamespace=C,this.mustUseProperty=g,this.propertyName=c,this.type=d,this.sanitizeURL=N,this.removeEmptyString=A}var v={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(c){v[c]=new x(c,0,!1,c,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(c){var d=c[0];v[d]=new x(d,1,!1,c[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(c){v[c]=new x(c,2,!1,c.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(c){v[c]=new x(c,2,!1,c,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(c){v[c]=new x(c,3,!1,c.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(c){v[c]=new x(c,3,!0,c,null,!1,!1)}),["capture","download"].forEach(function(c){v[c]=new x(c,4,!1,c,null,!1,!1)}),["cols","rows","size","span"].forEach(function(c){v[c]=new x(c,6,!1,c,null,!1,!1)}),["rowSpan","start"].forEach(function(c){v[c]=new x(c,5,!1,c.toLowerCase(),null,!1,!1)});var w=/[\-:]([a-z])/g;function S(c){return c[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(c){var d=c.replace(w,S);v[d]=new x(d,1,!1,c,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(c){var d=c.replace(w,S);v[d]=new x(d,1,!1,c,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(c){var d=c.replace(w,S);v[d]=new x(d,1,!1,c,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(c){v[c]=new x(c,1,!1,c.toLowerCase(),null,!1,!1)}),v.xlinkHref=new x("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(c){v[c]=new x(c,1,!1,c.toLowerCase(),null,!0,!0)});function k(c,d,g,b){var C=v.hasOwnProperty(d)?v[d]:null;(C!==null?C.type!==0:b||!(2<d.length)||d[0]!=="o"&&d[0]!=="O"||d[1]!=="n"&&d[1]!=="N")&&(y(d,g,C,b)&&(g=null),b||C===null?f(d)&&(g===null?c.removeAttribute(d):c.setAttribute(d,""+g)):C.mustUseProperty?c[C.propertyName]=g===null?C.type===3?!1:"":g:(d=C.attributeName,b=C.attributeNamespace,g===null?c.removeAttribute(d):(C=C.type,g=C===3||C===4&&g===!0?"":""+g,b?c.setAttributeNS(b,d,g):c.setAttribute(d,g))))}var T=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,I=Symbol.for("react.element"),E=Symbol.for("react.portal"),D=Symbol.for("react.fragment"),O=Symbol.for("react.strict_mode"),_=Symbol.for("react.profiler"),P=Symbol.for("react.provider"),R=Symbol.for("react.context"),W=Symbol.for("react.forward_ref"),Q=Symbol.for("react.suspense"),ee=Symbol.for("react.suspense_list"),te=Symbol.for("react.memo"),oe=Symbol.for("react.lazy"),se=Symbol.for("react.offscreen"),G=Symbol.iterator;function V(c){return c===null||typeof c!="object"?null:(c=G&&c[G]||c["@@iterator"],typeof c=="function"?c:null)}var B=Object.assign,F;function z(c){if(F===void 0)try{throw Error()}catch(g){var d=g.stack.trim().match(/\n( *(at )?)/);F=d&&d[1]||""}return`
`+F+c}var q=!1;function re(c,d){if(!c||q)return"";q=!0;var g=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(d)if(d=function(){throw Error()},Object.defineProperty(d.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(d,[])}catch(de){var b=de}Reflect.construct(c,[],d)}else{try{d.call()}catch(de){b=de}c.call(d.prototype)}else{try{throw Error()}catch(de){b=de}c()}}catch(de){if(de&&b&&typeof de.stack=="string"){for(var C=de.stack.split(`
`),N=b.stack.split(`
`),A=C.length-1,U=N.length-1;1<=A&&0<=U&&C[A]!==N[U];)U--;for(;1<=A&&0<=U;A--,U--)if(C[A]!==N[U]){if(A!==1||U!==1)do if(A--,U--,0>U||C[A]!==N[U]){var Y=`
`+C[A].replace(" at new "," at ");return c.displayName&&Y.includes("<anonymous>")&&(Y=Y.replace("<anonymous>",c.displayName)),Y}while(1<=A&&0<=U);break}}}finally{q=!1,Error.prepareStackTrace=g}return(c=c?c.displayName||c.name:"")?z(c):""}function ue(c){switch(c.tag){case 5:return z(c.type);case 16:return z("Lazy");case 13:return z("Suspense");case 19:return z("SuspenseList");case 0:case 2:case 15:return c=re(c.type,!1),c;case 11:return c=re(c.type.render,!1),c;case 1:return c=re(c.type,!0),c;default:return""}}function pe(c){if(c==null)return null;if(typeof c=="function")return c.displayName||c.name||null;if(typeof c=="string")return c;switch(c){case D:return"Fragment";case E:return"Portal";case _:return"Profiler";case O:return"StrictMode";case Q:return"Suspense";case ee:return"SuspenseList"}if(typeof c=="object")switch(c.$$typeof){case R:return(c.displayName||"Context")+".Consumer";case P:return(c._context.displayName||"Context")+".Provider";case W:var d=c.render;return c=c.displayName,c||(c=d.displayName||d.name||"",c=c!==""?"ForwardRef("+c+")":"ForwardRef"),c;case te:return d=c.displayName||null,d!==null?d:pe(c.type)||"Memo";case oe:d=c._payload,c=c._init;try{return pe(c(d))}catch{}}return null}function he(c){var d=c.type;switch(c.tag){case 24:return"Cache";case 9:return(d.displayName||"Context")+".Consumer";case 10:return(d._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return c=d.render,c=c.displayName||c.name||"",d.displayName||(c!==""?"ForwardRef("+c+")":"ForwardRef");case 7:return"Fragment";case 5:return d;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return pe(d);case 8:return d===O?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof d=="function")return d.displayName||d.name||null;if(typeof d=="string")return d}return null}function xe(c){switch(typeof c){case"boolean":case"number":case"string":case"undefined":return c;case"object":return c;default:return""}}function ge(c){var d=c.type;return(c=c.nodeName)&&c.toLowerCase()==="input"&&(d==="checkbox"||d==="radio")}function Ie(c){var d=ge(c)?"checked":"value",g=Object.getOwnPropertyDescriptor(c.constructor.prototype,d),b=""+c[d];if(!c.hasOwnProperty(d)&&typeof g<"u"&&typeof g.get=="function"&&typeof g.set=="function"){var C=g.get,N=g.set;return Object.defineProperty(c,d,{configurable:!0,get:function(){return C.call(this)},set:function(A){b=""+A,N.call(this,A)}}),Object.defineProperty(c,d,{enumerable:g.enumerable}),{getValue:function(){return b},setValue:function(A){b=""+A},stopTracking:function(){c._valueTracker=null,delete c[d]}}}}function Re(c){c._valueTracker||(c._valueTracker=Ie(c))}function Ue(c){if(!c)return!1;var d=c._valueTracker;if(!d)return!0;var g=d.getValue(),b="";return c&&(b=ge(c)?c.checked?"true":"false":c.value),c=b,c!==g?(d.setValue(c),!0):!1}function qe(c){if(c=c||(typeof document<"u"?document:void 0),typeof c>"u")return null;try{return c.activeElement||c.body}catch{return c.body}}function Qe(c,d){var g=d.checked;return B({},d,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:g??c._wrapperState.initialChecked})}function Je(c,d){var g=d.defaultValue==null?"":d.defaultValue,b=d.checked!=null?d.checked:d.defaultChecked;g=xe(d.value!=null?d.value:g),c._wrapperState={initialChecked:b,initialValue:g,controlled:d.type==="checkbox"||d.type==="radio"?d.checked!=null:d.value!=null}}function Ke(c,d){d=d.checked,d!=null&&k(c,"checked",d,!1)}function st(c,d){Ke(c,d);var g=xe(d.value),b=d.type;if(g!=null)b==="number"?(g===0&&c.value===""||c.value!=g)&&(c.value=""+g):c.value!==""+g&&(c.value=""+g);else if(b==="submit"||b==="reset"){c.removeAttribute("value");return}d.hasOwnProperty("value")?nn(c,d.type,g):d.hasOwnProperty("defaultValue")&&nn(c,d.type,xe(d.defaultValue)),d.checked==null&&d.defaultChecked!=null&&(c.defaultChecked=!!d.defaultChecked)}function rt(c,d,g){if(d.hasOwnProperty("value")||d.hasOwnProperty("defaultValue")){var b=d.type;if(!(b!=="submit"&&b!=="reset"||d.value!==void 0&&d.value!==null))return;d=""+c._wrapperState.initialValue,g||d===c.value||(c.value=d),c.defaultValue=d}g=c.name,g!==""&&(c.name=""),c.defaultChecked=!!c._wrapperState.initialChecked,g!==""&&(c.name=g)}function nn(c,d,g){(d!=="number"||qe(c.ownerDocument)!==c)&&(g==null?c.defaultValue=""+c._wrapperState.initialValue:c.defaultValue!==""+g&&(c.defaultValue=""+g))}var mt=Array.isArray;function Dt(c,d,g,b){if(c=c.options,d){d={};for(var C=0;C<g.length;C++)d["$"+g[C]]=!0;for(g=0;g<c.length;g++)C=d.hasOwnProperty("$"+c[g].value),c[g].selected!==C&&(c[g].selected=C),C&&b&&(c[g].defaultSelected=!0)}else{for(g=""+xe(g),d=null,C=0;C<c.length;C++){if(c[C].value===g){c[C].selected=!0,b&&(c[C].defaultSelected=!0);return}d!==null||c[C].disabled||(d=c[C])}d!==null&&(d.selected=!0)}}function xt(c,d){if(d.dangerouslySetInnerHTML!=null)throw Error(t(91));return B({},d,{value:void 0,defaultValue:void 0,children:""+c._wrapperState.initialValue})}function Kt(c,d){var g=d.value;if(g==null){if(g=d.children,d=d.defaultValue,g!=null){if(d!=null)throw Error(t(92));if(mt(g)){if(1<g.length)throw Error(t(93));g=g[0]}d=g}d==null&&(d=""),g=d}c._wrapperState={initialValue:xe(g)}}function Vt(c,d){var g=xe(d.value),b=xe(d.defaultValue);g!=null&&(g=""+g,g!==c.value&&(c.value=g),d.defaultValue==null&&c.defaultValue!==g&&(c.defaultValue=g)),b!=null&&(c.defaultValue=""+b)}function qt(c){var d=c.textContent;d===c._wrapperState.initialValue&&d!==""&&d!==null&&(c.value=d)}function an(c){switch(c){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Bn(c,d){return c==null||c==="http://www.w3.org/1999/xhtml"?an(d):c==="http://www.w3.org/2000/svg"&&d==="foreignObject"?"http://www.w3.org/1999/xhtml":c}var $n,gs=(function(c){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(d,g,b,C){MSApp.execUnsafeLocalFunction(function(){return c(d,g,b,C)})}:c})(function(c,d){if(c.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in c)c.innerHTML=d;else{for($n=$n||document.createElement("div"),$n.innerHTML="<svg>"+d.valueOf().toString()+"</svg>",d=$n.firstChild;c.firstChild;)c.removeChild(c.firstChild);for(;d.firstChild;)c.appendChild(d.firstChild)}});function ys(c,d){if(d){var g=c.firstChild;if(g&&g===c.lastChild&&g.nodeType===3){g.nodeValue=d;return}}c.textContent=d}var ln={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},$u=["Webkit","ms","Moz","O"];Object.keys(ln).forEach(function(c){$u.forEach(function(d){d=d+c.charAt(0).toUpperCase()+c.substring(1),ln[d]=ln[c]})});function wr(c,d,g){return d==null||typeof d=="boolean"||d===""?"":g||typeof d!="number"||d===0||ln.hasOwnProperty(c)&&ln[c]?(""+d).trim():d+"px"}function Ya(c,d){c=c.style;for(var g in d)if(d.hasOwnProperty(g)){var b=g.indexOf("--")===0,C=wr(g,d[g],b);g==="float"&&(g="cssFloat"),b?c.setProperty(g,C):c[g]=C}}var ly=B({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function uy(c,d){if(d){if(ly[c]&&(d.children!=null||d.dangerouslySetInnerHTML!=null))throw Error(t(137,c));if(d.dangerouslySetInnerHTML!=null){if(d.children!=null)throw Error(t(60));if(typeof d.dangerouslySetInnerHTML!="object"||!("__html"in d.dangerouslySetInnerHTML))throw Error(t(61))}if(d.style!=null&&typeof d.style!="object")throw Error(t(62))}}function cy(c,d){if(c.indexOf("-")===-1)return typeof d.is=="string";switch(c){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var hy=null;function dy(c){return c=c.target||c.srcElement||window,c.correspondingUseElement&&(c=c.correspondingUseElement),c.nodeType===3?c.parentNode:c}var py=null,Qa=null,Za=null;function lC(c){if(c=Yu(c)){if(typeof py!="function")throw Error(t(280));var d=c.stateNode;d&&(d=qd(d),py(c.stateNode,c.type,d))}}function uC(c){Qa?Za?Za.push(c):Za=[c]:Qa=c}function cC(){if(Qa){var c=Qa,d=Za;if(Za=Qa=null,lC(c),d)for(c=0;c<d.length;c++)lC(d[c])}}function hC(c,d){return c(d)}function dC(){}var fy=!1;function pC(c,d,g){if(fy)return c(d,g);fy=!0;try{return hC(c,d,g)}finally{fy=!1,(Qa!==null||Za!==null)&&(dC(),cC())}}function Eu(c,d){var g=c.stateNode;if(g===null)return null;var b=qd(g);if(b===null)return null;g=b[d];e:switch(d){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(b=!b.disabled)||(c=c.type,b=!(c==="button"||c==="input"||c==="select"||c==="textarea")),c=!b;break e;default:c=!1}if(c)return null;if(g&&typeof g!="function")throw Error(t(231,d,typeof g));return g}var my=!1;if(a)try{var Ru={};Object.defineProperty(Ru,"passive",{get:function(){my=!0}}),window.addEventListener("test",Ru,Ru),window.removeEventListener("test",Ru,Ru)}catch{my=!1}function OL(c,d,g,b,C,N,A,U,Y){var de=Array.prototype.slice.call(arguments,3);try{d.apply(g,de)}catch(be){this.onError(be)}}var Du=!1,Nd=null,Id=!1,gy=null,_L={onError:function(c){Du=!0,Nd=c}};function FL(c,d,g,b,C,N,A,U,Y){Du=!1,Nd=null,OL.apply(_L,arguments)}function PL(c,d,g,b,C,N,A,U,Y){if(FL.apply(this,arguments),Du){if(Du){var de=Nd;Du=!1,Nd=null}else throw Error(t(198));Id||(Id=!0,gy=de)}}function Hi(c){var d=c,g=c;if(c.alternate)for(;d.return;)d=d.return;else{c=d;do d=c,(d.flags&4098)!==0&&(g=d.return),c=d.return;while(c)}return d.tag===3?g:null}function fC(c){if(c.tag===13){var d=c.memoizedState;if(d===null&&(c=c.alternate,c!==null&&(d=c.memoizedState)),d!==null)return d.dehydrated}return null}function mC(c){if(Hi(c)!==c)throw Error(t(188))}function LL(c){var d=c.alternate;if(!d){if(d=Hi(c),d===null)throw Error(t(188));return d!==c?null:c}for(var g=c,b=d;;){var C=g.return;if(C===null)break;var N=C.alternate;if(N===null){if(b=C.return,b!==null){g=b;continue}break}if(C.child===N.child){for(N=C.child;N;){if(N===g)return mC(C),c;if(N===b)return mC(C),d;N=N.sibling}throw Error(t(188))}if(g.return!==b.return)g=C,b=N;else{for(var A=!1,U=C.child;U;){if(U===g){A=!0,g=C,b=N;break}if(U===b){A=!0,b=C,g=N;break}U=U.sibling}if(!A){for(U=N.child;U;){if(U===g){A=!0,g=N,b=C;break}if(U===b){A=!0,b=N,g=C;break}U=U.sibling}if(!A)throw Error(t(189))}}if(g.alternate!==b)throw Error(t(190))}if(g.tag!==3)throw Error(t(188));return g.stateNode.current===g?c:d}function gC(c){return c=LL(c),c!==null?yC(c):null}function yC(c){if(c.tag===5||c.tag===6)return c;for(c=c.child;c!==null;){var d=yC(c);if(d!==null)return d;c=c.sibling}return null}var xC=e.unstable_scheduleCallback,vC=e.unstable_cancelCallback,ML=e.unstable_shouldYield,zL=e.unstable_requestPaint,sn=e.unstable_now,VL=e.unstable_getCurrentPriorityLevel,yy=e.unstable_ImmediatePriority,wC=e.unstable_UserBlockingPriority,$d=e.unstable_NormalPriority,BL=e.unstable_LowPriority,bC=e.unstable_IdlePriority,Ed=null,Ur=null;function WL(c){if(Ur&&typeof Ur.onCommitFiberRoot=="function")try{Ur.onCommitFiberRoot(Ed,c,void 0,(c.current.flags&128)===128)}catch{}}var br=Math.clz32?Math.clz32:jL,UL=Math.log,GL=Math.LN2;function jL(c){return c>>>=0,c===0?32:31-(UL(c)/GL|0)|0}var Rd=64,Dd=4194304;function Au(c){switch(c&-c){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return c&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return c&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return c}}function Ad(c,d){var g=c.pendingLanes;if(g===0)return 0;var b=0,C=c.suspendedLanes,N=c.pingedLanes,A=g&268435455;if(A!==0){var U=A&~C;U!==0?b=Au(U):(N&=A,N!==0&&(b=Au(N)))}else A=g&~C,A!==0?b=Au(A):N!==0&&(b=Au(N));if(b===0)return 0;if(d!==0&&d!==b&&(d&C)===0&&(C=b&-b,N=d&-d,C>=N||C===16&&(N&4194240)!==0))return d;if((b&4)!==0&&(b|=g&16),d=c.entangledLanes,d!==0)for(c=c.entanglements,d&=b;0<d;)g=31-br(d),C=1<<g,b|=c[g],d&=~C;return b}function HL(c,d){switch(c){case 1:case 2:case 4:return d+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return d+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function KL(c,d){for(var g=c.suspendedLanes,b=c.pingedLanes,C=c.expirationTimes,N=c.pendingLanes;0<N;){var A=31-br(N),U=1<<A,Y=C[A];Y===-1?((U&g)===0||(U&b)!==0)&&(C[A]=HL(U,d)):Y<=d&&(c.expiredLanes|=U),N&=~U}}function xy(c){return c=c.pendingLanes&-1073741825,c!==0?c:c&1073741824?1073741824:0}function SC(){var c=Rd;return Rd<<=1,(Rd&4194240)===0&&(Rd=64),c}function vy(c){for(var d=[],g=0;31>g;g++)d.push(c);return d}function Ou(c,d,g){c.pendingLanes|=d,d!==536870912&&(c.suspendedLanes=0,c.pingedLanes=0),c=c.eventTimes,d=31-br(d),c[d]=g}function qL(c,d){var g=c.pendingLanes&~d;c.pendingLanes=d,c.suspendedLanes=0,c.pingedLanes=0,c.expiredLanes&=d,c.mutableReadLanes&=d,c.entangledLanes&=d,d=c.entanglements;var b=c.eventTimes;for(c=c.expirationTimes;0<g;){var C=31-br(g),N=1<<C;d[C]=0,b[C]=-1,c[C]=-1,g&=~N}}function wy(c,d){var g=c.entangledLanes|=d;for(c=c.entanglements;g;){var b=31-br(g),C=1<<b;C&d|c[b]&d&&(c[b]|=d),g&=~C}}var bt=0;function CC(c){return c&=-c,1<c?4<c?(c&268435455)!==0?16:536870912:4:1}var kC,by,TC,NC,IC,Sy=!1,Od=[],Wo=null,Uo=null,Go=null,_u=new Map,Fu=new Map,jo=[],XL="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function $C(c,d){switch(c){case"focusin":case"focusout":Wo=null;break;case"dragenter":case"dragleave":Uo=null;break;case"mouseover":case"mouseout":Go=null;break;case"pointerover":case"pointerout":_u.delete(d.pointerId);break;case"gotpointercapture":case"lostpointercapture":Fu.delete(d.pointerId)}}function Pu(c,d,g,b,C,N){return c===null||c.nativeEvent!==N?(c={blockedOn:d,domEventName:g,eventSystemFlags:b,nativeEvent:N,targetContainers:[C]},d!==null&&(d=Yu(d),d!==null&&by(d)),c):(c.eventSystemFlags|=b,d=c.targetContainers,C!==null&&d.indexOf(C)===-1&&d.push(C),c)}function YL(c,d,g,b,C){switch(d){case"focusin":return Wo=Pu(Wo,c,d,g,b,C),!0;case"dragenter":return Uo=Pu(Uo,c,d,g,b,C),!0;case"mouseover":return Go=Pu(Go,c,d,g,b,C),!0;case"pointerover":var N=C.pointerId;return _u.set(N,Pu(_u.get(N)||null,c,d,g,b,C)),!0;case"gotpointercapture":return N=C.pointerId,Fu.set(N,Pu(Fu.get(N)||null,c,d,g,b,C)),!0}return!1}function EC(c){var d=Ki(c.target);if(d!==null){var g=Hi(d);if(g!==null){if(d=g.tag,d===13){if(d=fC(g),d!==null){c.blockedOn=d,IC(c.priority,function(){TC(g)});return}}else if(d===3&&g.stateNode.current.memoizedState.isDehydrated){c.blockedOn=g.tag===3?g.stateNode.containerInfo:null;return}}}c.blockedOn=null}function _d(c){if(c.blockedOn!==null)return!1;for(var d=c.targetContainers;0<d.length;){var g=ky(c.domEventName,c.eventSystemFlags,d[0],c.nativeEvent);if(g===null){g=c.nativeEvent;var b=new g.constructor(g.type,g);hy=b,g.target.dispatchEvent(b),hy=null}else return d=Yu(g),d!==null&&by(d),c.blockedOn=g,!1;d.shift()}return!0}function RC(c,d,g){_d(c)&&g.delete(d)}function QL(){Sy=!1,Wo!==null&&_d(Wo)&&(Wo=null),Uo!==null&&_d(Uo)&&(Uo=null),Go!==null&&_d(Go)&&(Go=null),_u.forEach(RC),Fu.forEach(RC)}function Lu(c,d){c.blockedOn===d&&(c.blockedOn=null,Sy||(Sy=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,QL)))}function Mu(c){function d(C){return Lu(C,c)}if(0<Od.length){Lu(Od[0],c);for(var g=1;g<Od.length;g++){var b=Od[g];b.blockedOn===c&&(b.blockedOn=null)}}for(Wo!==null&&Lu(Wo,c),Uo!==null&&Lu(Uo,c),Go!==null&&Lu(Go,c),_u.forEach(d),Fu.forEach(d),g=0;g<jo.length;g++)b=jo[g],b.blockedOn===c&&(b.blockedOn=null);for(;0<jo.length&&(g=jo[0],g.blockedOn===null);)EC(g),g.blockedOn===null&&jo.shift()}var Ja=T.ReactCurrentBatchConfig,Fd=!0;function ZL(c,d,g,b){var C=bt,N=Ja.transition;Ja.transition=null;try{bt=1,Cy(c,d,g,b)}finally{bt=C,Ja.transition=N}}function JL(c,d,g,b){var C=bt,N=Ja.transition;Ja.transition=null;try{bt=4,Cy(c,d,g,b)}finally{bt=C,Ja.transition=N}}function Cy(c,d,g,b){if(Fd){var C=ky(c,d,g,b);if(C===null)By(c,d,b,Pd,g),$C(c,b);else if(YL(C,c,d,g,b))b.stopPropagation();else if($C(c,b),d&4&&-1<XL.indexOf(c)){for(;C!==null;){var N=Yu(C);if(N!==null&&kC(N),N=ky(c,d,g,b),N===null&&By(c,d,b,Pd,g),N===C)break;C=N}C!==null&&b.stopPropagation()}else By(c,d,b,null,g)}}var Pd=null;function ky(c,d,g,b){if(Pd=null,c=dy(b),c=Ki(c),c!==null)if(d=Hi(c),d===null)c=null;else if(g=d.tag,g===13){if(c=fC(d),c!==null)return c;c=null}else if(g===3){if(d.stateNode.current.memoizedState.isDehydrated)return d.tag===3?d.stateNode.containerInfo:null;c=null}else d!==c&&(c=null);return Pd=c,null}function DC(c){switch(c){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(VL()){case yy:return 1;case wC:return 4;case $d:case BL:return 16;case bC:return 536870912;default:return 16}default:return 16}}var Ho=null,Ty=null,Ld=null;function AC(){if(Ld)return Ld;var c,d=Ty,g=d.length,b,C="value"in Ho?Ho.value:Ho.textContent,N=C.length;for(c=0;c<g&&d[c]===C[c];c++);var A=g-c;for(b=1;b<=A&&d[g-b]===C[N-b];b++);return Ld=C.slice(c,1<b?1-b:void 0)}function Md(c){var d=c.keyCode;return"charCode"in c?(c=c.charCode,c===0&&d===13&&(c=13)):c=d,c===10&&(c=13),32<=c||c===13?c:0}function zd(){return!0}function OC(){return!1}function zs(c){function d(g,b,C,N,A){this._reactName=g,this._targetInst=C,this.type=b,this.nativeEvent=N,this.target=A,this.currentTarget=null;for(var U in c)c.hasOwnProperty(U)&&(g=c[U],this[U]=g?g(N):N[U]);return this.isDefaultPrevented=(N.defaultPrevented!=null?N.defaultPrevented:N.returnValue===!1)?zd:OC,this.isPropagationStopped=OC,this}return B(d.prototype,{preventDefault:function(){this.defaultPrevented=!0;var g=this.nativeEvent;g&&(g.preventDefault?g.preventDefault():typeof g.returnValue!="unknown"&&(g.returnValue=!1),this.isDefaultPrevented=zd)},stopPropagation:function(){var g=this.nativeEvent;g&&(g.stopPropagation?g.stopPropagation():typeof g.cancelBubble!="unknown"&&(g.cancelBubble=!0),this.isPropagationStopped=zd)},persist:function(){},isPersistent:zd}),d}var el={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(c){return c.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Ny=zs(el),zu=B({},el,{view:0,detail:0}),e3=zs(zu),Iy,$y,Vu,Vd=B({},zu,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Ry,button:0,buttons:0,relatedTarget:function(c){return c.relatedTarget===void 0?c.fromElement===c.srcElement?c.toElement:c.fromElement:c.relatedTarget},movementX:function(c){return"movementX"in c?c.movementX:(c!==Vu&&(Vu&&c.type==="mousemove"?(Iy=c.screenX-Vu.screenX,$y=c.screenY-Vu.screenY):$y=Iy=0,Vu=c),Iy)},movementY:function(c){return"movementY"in c?c.movementY:$y}}),_C=zs(Vd),t3=B({},Vd,{dataTransfer:0}),n3=zs(t3),s3=B({},zu,{relatedTarget:0}),Ey=zs(s3),r3=B({},el,{animationName:0,elapsedTime:0,pseudoElement:0}),o3=zs(r3),i3=B({},el,{clipboardData:function(c){return"clipboardData"in c?c.clipboardData:window.clipboardData}}),a3=zs(i3),l3=B({},el,{data:0}),FC=zs(l3),u3={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},c3={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},h3={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function d3(c){var d=this.nativeEvent;return d.getModifierState?d.getModifierState(c):(c=h3[c])?!!d[c]:!1}function Ry(){return d3}var p3=B({},zu,{key:function(c){if(c.key){var d=u3[c.key]||c.key;if(d!=="Unidentified")return d}return c.type==="keypress"?(c=Md(c),c===13?"Enter":String.fromCharCode(c)):c.type==="keydown"||c.type==="keyup"?c3[c.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Ry,charCode:function(c){return c.type==="keypress"?Md(c):0},keyCode:function(c){return c.type==="keydown"||c.type==="keyup"?c.keyCode:0},which:function(c){return c.type==="keypress"?Md(c):c.type==="keydown"||c.type==="keyup"?c.keyCode:0}}),f3=zs(p3),m3=B({},Vd,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),PC=zs(m3),g3=B({},zu,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Ry}),y3=zs(g3),x3=B({},el,{propertyName:0,elapsedTime:0,pseudoElement:0}),v3=zs(x3),w3=B({},Vd,{deltaX:function(c){return"deltaX"in c?c.deltaX:"wheelDeltaX"in c?-c.wheelDeltaX:0},deltaY:function(c){return"deltaY"in c?c.deltaY:"wheelDeltaY"in c?-c.wheelDeltaY:"wheelDelta"in c?-c.wheelDelta:0},deltaZ:0,deltaMode:0}),b3=zs(w3),S3=[9,13,27,32],Dy=a&&"CompositionEvent"in window,Bu=null;a&&"documentMode"in document&&(Bu=document.documentMode);var C3=a&&"TextEvent"in window&&!Bu,LC=a&&(!Dy||Bu&&8<Bu&&11>=Bu),MC=" ",zC=!1;function VC(c,d){switch(c){case"keyup":return S3.indexOf(d.keyCode)!==-1;case"keydown":return d.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function BC(c){return c=c.detail,typeof c=="object"&&"data"in c?c.data:null}var tl=!1;function k3(c,d){switch(c){case"compositionend":return BC(d);case"keypress":return d.which!==32?null:(zC=!0,MC);case"textInput":return c=d.data,c===MC&&zC?null:c;default:return null}}function T3(c,d){if(tl)return c==="compositionend"||!Dy&&VC(c,d)?(c=AC(),Ld=Ty=Ho=null,tl=!1,c):null;switch(c){case"paste":return null;case"keypress":if(!(d.ctrlKey||d.altKey||d.metaKey)||d.ctrlKey&&d.altKey){if(d.char&&1<d.char.length)return d.char;if(d.which)return String.fromCharCode(d.which)}return null;case"compositionend":return LC&&d.locale!=="ko"?null:d.data;default:return null}}var N3={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function WC(c){var d=c&&c.nodeName&&c.nodeName.toLowerCase();return d==="input"?!!N3[c.type]:d==="textarea"}function UC(c,d,g,b){uC(b),d=jd(d,"onChange"),0<d.length&&(g=new Ny("onChange","change",null,g,b),c.push({event:g,listeners:d}))}var Wu=null,Uu=null;function I3(c){ak(c,0)}function Bd(c){var d=il(c);if(Ue(d))return c}function $3(c,d){if(c==="change")return d}var GC=!1;if(a){var Ay;if(a){var Oy="oninput"in document;if(!Oy){var jC=document.createElement("div");jC.setAttribute("oninput","return;"),Oy=typeof jC.oninput=="function"}Ay=Oy}else Ay=!1;GC=Ay&&(!document.documentMode||9<document.documentMode)}function HC(){Wu&&(Wu.detachEvent("onpropertychange",KC),Uu=Wu=null)}function KC(c){if(c.propertyName==="value"&&Bd(Uu)){var d=[];UC(d,Uu,c,dy(c)),pC(I3,d)}}function E3(c,d,g){c==="focusin"?(HC(),Wu=d,Uu=g,Wu.attachEvent("onpropertychange",KC)):c==="focusout"&&HC()}function R3(c){if(c==="selectionchange"||c==="keyup"||c==="keydown")return Bd(Uu)}function D3(c,d){if(c==="click")return Bd(d)}function A3(c,d){if(c==="input"||c==="change")return Bd(d)}function O3(c,d){return c===d&&(c!==0||1/c===1/d)||c!==c&&d!==d}var Sr=typeof Object.is=="function"?Object.is:O3;function Gu(c,d){if(Sr(c,d))return!0;if(typeof c!="object"||c===null||typeof d!="object"||d===null)return!1;var g=Object.keys(c),b=Object.keys(d);if(g.length!==b.length)return!1;for(b=0;b<g.length;b++){var C=g[b];if(!l.call(d,C)||!Sr(c[C],d[C]))return!1}return!0}function qC(c){for(;c&&c.firstChild;)c=c.firstChild;return c}function XC(c,d){var g=qC(c);c=0;for(var b;g;){if(g.nodeType===3){if(b=c+g.textContent.length,c<=d&&b>=d)return{node:g,offset:d-c};c=b}e:{for(;g;){if(g.nextSibling){g=g.nextSibling;break e}g=g.parentNode}g=void 0}g=qC(g)}}function YC(c,d){return c&&d?c===d?!0:c&&c.nodeType===3?!1:d&&d.nodeType===3?YC(c,d.parentNode):"contains"in c?c.contains(d):c.compareDocumentPosition?!!(c.compareDocumentPosition(d)&16):!1:!1}function QC(){for(var c=window,d=qe();d instanceof c.HTMLIFrameElement;){try{var g=typeof d.contentWindow.location.href=="string"}catch{g=!1}if(g)c=d.contentWindow;else break;d=qe(c.document)}return d}function _y(c){var d=c&&c.nodeName&&c.nodeName.toLowerCase();return d&&(d==="input"&&(c.type==="text"||c.type==="search"||c.type==="tel"||c.type==="url"||c.type==="password")||d==="textarea"||c.contentEditable==="true")}function _3(c){var d=QC(),g=c.focusedElem,b=c.selectionRange;if(d!==g&&g&&g.ownerDocument&&YC(g.ownerDocument.documentElement,g)){if(b!==null&&_y(g)){if(d=b.start,c=b.end,c===void 0&&(c=d),"selectionStart"in g)g.selectionStart=d,g.selectionEnd=Math.min(c,g.value.length);else if(c=(d=g.ownerDocument||document)&&d.defaultView||window,c.getSelection){c=c.getSelection();var C=g.textContent.length,N=Math.min(b.start,C);b=b.end===void 0?N:Math.min(b.end,C),!c.extend&&N>b&&(C=b,b=N,N=C),C=XC(g,N);var A=XC(g,b);C&&A&&(c.rangeCount!==1||c.anchorNode!==C.node||c.anchorOffset!==C.offset||c.focusNode!==A.node||c.focusOffset!==A.offset)&&(d=d.createRange(),d.setStart(C.node,C.offset),c.removeAllRanges(),N>b?(c.addRange(d),c.extend(A.node,A.offset)):(d.setEnd(A.node,A.offset),c.addRange(d)))}}for(d=[],c=g;c=c.parentNode;)c.nodeType===1&&d.push({element:c,left:c.scrollLeft,top:c.scrollTop});for(typeof g.focus=="function"&&g.focus(),g=0;g<d.length;g++)c=d[g],c.element.scrollLeft=c.left,c.element.scrollTop=c.top}}var F3=a&&"documentMode"in document&&11>=document.documentMode,nl=null,Fy=null,ju=null,Py=!1;function ZC(c,d,g){var b=g.window===g?g.document:g.nodeType===9?g:g.ownerDocument;Py||nl==null||nl!==qe(b)||(b=nl,"selectionStart"in b&&_y(b)?b={start:b.selectionStart,end:b.selectionEnd}:(b=(b.ownerDocument&&b.ownerDocument.defaultView||window).getSelection(),b={anchorNode:b.anchorNode,anchorOffset:b.anchorOffset,focusNode:b.focusNode,focusOffset:b.focusOffset}),ju&&Gu(ju,b)||(ju=b,b=jd(Fy,"onSelect"),0<b.length&&(d=new Ny("onSelect","select",null,d,g),c.push({event:d,listeners:b}),d.target=nl)))}function Wd(c,d){var g={};return g[c.toLowerCase()]=d.toLowerCase(),g["Webkit"+c]="webkit"+d,g["Moz"+c]="moz"+d,g}var sl={animationend:Wd("Animation","AnimationEnd"),animationiteration:Wd("Animation","AnimationIteration"),animationstart:Wd("Animation","AnimationStart"),transitionend:Wd("Transition","TransitionEnd")},Ly={},JC={};a&&(JC=document.createElement("div").style,"AnimationEvent"in window||(delete sl.animationend.animation,delete sl.animationiteration.animation,delete sl.animationstart.animation),"TransitionEvent"in window||delete sl.transitionend.transition);function Ud(c){if(Ly[c])return Ly[c];if(!sl[c])return c;var d=sl[c],g;for(g in d)if(d.hasOwnProperty(g)&&g in JC)return Ly[c]=d[g];return c}var ek=Ud("animationend"),tk=Ud("animationiteration"),nk=Ud("animationstart"),sk=Ud("transitionend"),rk=new Map,ok="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Ko(c,d){rk.set(c,d),o(d,[c])}for(var My=0;My<ok.length;My++){var zy=ok[My],P3=zy.toLowerCase(),L3=zy[0].toUpperCase()+zy.slice(1);Ko(P3,"on"+L3)}Ko(ek,"onAnimationEnd"),Ko(tk,"onAnimationIteration"),Ko(nk,"onAnimationStart"),Ko("dblclick","onDoubleClick"),Ko("focusin","onFocus"),Ko("focusout","onBlur"),Ko(sk,"onTransitionEnd"),i("onMouseEnter",["mouseout","mouseover"]),i("onMouseLeave",["mouseout","mouseover"]),i("onPointerEnter",["pointerout","pointerover"]),i("onPointerLeave",["pointerout","pointerover"]),o("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),o("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),o("onBeforeInput",["compositionend","keypress","textInput","paste"]),o("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),o("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),o("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Hu="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),M3=new Set("cancel close invalid load scroll toggle".split(" ").concat(Hu));function ik(c,d,g){var b=c.type||"unknown-event";c.currentTarget=g,PL(b,d,void 0,c),c.currentTarget=null}function ak(c,d){d=(d&4)!==0;for(var g=0;g<c.length;g++){var b=c[g],C=b.event;b=b.listeners;e:{var N=void 0;if(d)for(var A=b.length-1;0<=A;A--){var U=b[A],Y=U.instance,de=U.currentTarget;if(U=U.listener,Y!==N&&C.isPropagationStopped())break e;ik(C,U,de),N=Y}else for(A=0;A<b.length;A++){if(U=b[A],Y=U.instance,de=U.currentTarget,U=U.listener,Y!==N&&C.isPropagationStopped())break e;ik(C,U,de),N=Y}}}if(Id)throw c=gy,Id=!1,gy=null,c}function At(c,d){var g=d[Ky];g===void 0&&(g=d[Ky]=new Set);var b=c+"__bubble";g.has(b)||(lk(d,c,2,!1),g.add(b))}function Vy(c,d,g){var b=0;d&&(b|=4),lk(g,c,b,d)}var Gd="_reactListening"+Math.random().toString(36).slice(2);function Ku(c){if(!c[Gd]){c[Gd]=!0,s.forEach(function(g){g!=="selectionchange"&&(M3.has(g)||Vy(g,!1,c),Vy(g,!0,c))});var d=c.nodeType===9?c:c.ownerDocument;d===null||d[Gd]||(d[Gd]=!0,Vy("selectionchange",!1,d))}}function lk(c,d,g,b){switch(DC(d)){case 1:var C=ZL;break;case 4:C=JL;break;default:C=Cy}g=C.bind(null,d,g,c),C=void 0,!my||d!=="touchstart"&&d!=="touchmove"&&d!=="wheel"||(C=!0),b?C!==void 0?c.addEventListener(d,g,{capture:!0,passive:C}):c.addEventListener(d,g,!0):C!==void 0?c.addEventListener(d,g,{passive:C}):c.addEventListener(d,g,!1)}function By(c,d,g,b,C){var N=b;if((d&1)===0&&(d&2)===0&&b!==null)e:for(;;){if(b===null)return;var A=b.tag;if(A===3||A===4){var U=b.stateNode.containerInfo;if(U===C||U.nodeType===8&&U.parentNode===C)break;if(A===4)for(A=b.return;A!==null;){var Y=A.tag;if((Y===3||Y===4)&&(Y=A.stateNode.containerInfo,Y===C||Y.nodeType===8&&Y.parentNode===C))return;A=A.return}for(;U!==null;){if(A=Ki(U),A===null)return;if(Y=A.tag,Y===5||Y===6){b=N=A;continue e}U=U.parentNode}}b=b.return}pC(function(){var de=N,be=dy(g),Se=[];e:{var we=rk.get(c);if(we!==void 0){var De=Ny,Pe=c;switch(c){case"keypress":if(Md(g)===0)break e;case"keydown":case"keyup":De=f3;break;case"focusin":Pe="focus",De=Ey;break;case"focusout":Pe="blur",De=Ey;break;case"beforeblur":case"afterblur":De=Ey;break;case"click":if(g.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":De=_C;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":De=n3;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":De=y3;break;case ek:case tk:case nk:De=o3;break;case sk:De=v3;break;case"scroll":De=e3;break;case"wheel":De=b3;break;case"copy":case"cut":case"paste":De=a3;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":De=PC}var ze=(d&4)!==0,rn=!ze&&c==="scroll",le=ze?we!==null?we+"Capture":null:we;ze=[];for(var ne=de,ce;ne!==null;){ce=ne;var Ce=ce.stateNode;if(ce.tag===5&&Ce!==null&&(ce=Ce,le!==null&&(Ce=Eu(ne,le),Ce!=null&&ze.push(qu(ne,Ce,ce)))),rn)break;ne=ne.return}0<ze.length&&(we=new De(we,Pe,null,g,be),Se.push({event:we,listeners:ze}))}}if((d&7)===0){e:{if(we=c==="mouseover"||c==="pointerover",De=c==="mouseout"||c==="pointerout",we&&g!==hy&&(Pe=g.relatedTarget||g.fromElement)&&(Ki(Pe)||Pe[fo]))break e;if((De||we)&&(we=be.window===be?be:(we=be.ownerDocument)?we.defaultView||we.parentWindow:window,De?(Pe=g.relatedTarget||g.toElement,De=de,Pe=Pe?Ki(Pe):null,Pe!==null&&(rn=Hi(Pe),Pe!==rn||Pe.tag!==5&&Pe.tag!==6)&&(Pe=null)):(De=null,Pe=de),De!==Pe)){if(ze=_C,Ce="onMouseLeave",le="onMouseEnter",ne="mouse",(c==="pointerout"||c==="pointerover")&&(ze=PC,Ce="onPointerLeave",le="onPointerEnter",ne="pointer"),rn=De==null?we:il(De),ce=Pe==null?we:il(Pe),we=new ze(Ce,ne+"leave",De,g,be),we.target=rn,we.relatedTarget=ce,Ce=null,Ki(be)===de&&(ze=new ze(le,ne+"enter",Pe,g,be),ze.target=ce,ze.relatedTarget=rn,Ce=ze),rn=Ce,De&&Pe)t:{for(ze=De,le=Pe,ne=0,ce=ze;ce;ce=rl(ce))ne++;for(ce=0,Ce=le;Ce;Ce=rl(Ce))ce++;for(;0<ne-ce;)ze=rl(ze),ne--;for(;0<ce-ne;)le=rl(le),ce--;for(;ne--;){if(ze===le||le!==null&&ze===le.alternate)break t;ze=rl(ze),le=rl(le)}ze=null}else ze=null;De!==null&&uk(Se,we,De,ze,!1),Pe!==null&&rn!==null&&uk(Se,rn,Pe,ze,!0)}}e:{if(we=de?il(de):window,De=we.nodeName&&we.nodeName.toLowerCase(),De==="select"||De==="input"&&we.type==="file")var Ve=$3;else if(WC(we))if(GC)Ve=A3;else{Ve=R3;var Ge=E3}else(De=we.nodeName)&&De.toLowerCase()==="input"&&(we.type==="checkbox"||we.type==="radio")&&(Ve=D3);if(Ve&&(Ve=Ve(c,de))){UC(Se,Ve,g,be);break e}Ge&&Ge(c,we,de),c==="focusout"&&(Ge=we._wrapperState)&&Ge.controlled&&we.type==="number"&&nn(we,"number",we.value)}switch(Ge=de?il(de):window,c){case"focusin":(WC(Ge)||Ge.contentEditable==="true")&&(nl=Ge,Fy=de,ju=null);break;case"focusout":ju=Fy=nl=null;break;case"mousedown":Py=!0;break;case"contextmenu":case"mouseup":case"dragend":Py=!1,ZC(Se,g,be);break;case"selectionchange":if(F3)break;case"keydown":case"keyup":ZC(Se,g,be)}var je;if(Dy)e:{switch(c){case"compositionstart":var Ye="onCompositionStart";break e;case"compositionend":Ye="onCompositionEnd";break e;case"compositionupdate":Ye="onCompositionUpdate";break e}Ye=void 0}else tl?VC(c,g)&&(Ye="onCompositionEnd"):c==="keydown"&&g.keyCode===229&&(Ye="onCompositionStart");Ye&&(LC&&g.locale!=="ko"&&(tl||Ye!=="onCompositionStart"?Ye==="onCompositionEnd"&&tl&&(je=AC()):(Ho=be,Ty="value"in Ho?Ho.value:Ho.textContent,tl=!0)),Ge=jd(de,Ye),0<Ge.length&&(Ye=new FC(Ye,c,null,g,be),Se.push({event:Ye,listeners:Ge}),je?Ye.data=je:(je=BC(g),je!==null&&(Ye.data=je)))),(je=C3?k3(c,g):T3(c,g))&&(de=jd(de,"onBeforeInput"),0<de.length&&(be=new FC("onBeforeInput","beforeinput",null,g,be),Se.push({event:be,listeners:de}),be.data=je))}ak(Se,d)})}function qu(c,d,g){return{instance:c,listener:d,currentTarget:g}}function jd(c,d){for(var g=d+"Capture",b=[];c!==null;){var C=c,N=C.stateNode;C.tag===5&&N!==null&&(C=N,N=Eu(c,g),N!=null&&b.unshift(qu(c,N,C)),N=Eu(c,d),N!=null&&b.push(qu(c,N,C))),c=c.return}return b}function rl(c){if(c===null)return null;do c=c.return;while(c&&c.tag!==5);return c||null}function uk(c,d,g,b,C){for(var N=d._reactName,A=[];g!==null&&g!==b;){var U=g,Y=U.alternate,de=U.stateNode;if(Y!==null&&Y===b)break;U.tag===5&&de!==null&&(U=de,C?(Y=Eu(g,N),Y!=null&&A.unshift(qu(g,Y,U))):C||(Y=Eu(g,N),Y!=null&&A.push(qu(g,Y,U)))),g=g.return}A.length!==0&&c.push({event:d,listeners:A})}var z3=/\r\n?/g,V3=/\u0000|\uFFFD/g;function ck(c){return(typeof c=="string"?c:""+c).replace(z3,`
`).replace(V3,"")}function Hd(c,d,g){if(d=ck(d),ck(c)!==d&&g)throw Error(t(425))}function Kd(){}var Wy=null,Uy=null;function Gy(c,d){return c==="textarea"||c==="noscript"||typeof d.children=="string"||typeof d.children=="number"||typeof d.dangerouslySetInnerHTML=="object"&&d.dangerouslySetInnerHTML!==null&&d.dangerouslySetInnerHTML.__html!=null}var jy=typeof setTimeout=="function"?setTimeout:void 0,B3=typeof clearTimeout=="function"?clearTimeout:void 0,hk=typeof Promise=="function"?Promise:void 0,W3=typeof queueMicrotask=="function"?queueMicrotask:typeof hk<"u"?function(c){return hk.resolve(null).then(c).catch(U3)}:jy;function U3(c){setTimeout(function(){throw c})}function Hy(c,d){var g=d,b=0;do{var C=g.nextSibling;if(c.removeChild(g),C&&C.nodeType===8)if(g=C.data,g==="/$"){if(b===0){c.removeChild(C),Mu(d);return}b--}else g!=="$"&&g!=="$?"&&g!=="$!"||b++;g=C}while(g);Mu(d)}function qo(c){for(;c!=null;c=c.nextSibling){var d=c.nodeType;if(d===1||d===3)break;if(d===8){if(d=c.data,d==="$"||d==="$!"||d==="$?")break;if(d==="/$")return null}}return c}function dk(c){c=c.previousSibling;for(var d=0;c;){if(c.nodeType===8){var g=c.data;if(g==="$"||g==="$!"||g==="$?"){if(d===0)return c;d--}else g==="/$"&&d++}c=c.previousSibling}return null}var ol=Math.random().toString(36).slice(2),Gr="__reactFiber$"+ol,Xu="__reactProps$"+ol,fo="__reactContainer$"+ol,Ky="__reactEvents$"+ol,G3="__reactListeners$"+ol,j3="__reactHandles$"+ol;function Ki(c){var d=c[Gr];if(d)return d;for(var g=c.parentNode;g;){if(d=g[fo]||g[Gr]){if(g=d.alternate,d.child!==null||g!==null&&g.child!==null)for(c=dk(c);c!==null;){if(g=c[Gr])return g;c=dk(c)}return d}c=g,g=c.parentNode}return null}function Yu(c){return c=c[Gr]||c[fo],!c||c.tag!==5&&c.tag!==6&&c.tag!==13&&c.tag!==3?null:c}function il(c){if(c.tag===5||c.tag===6)return c.stateNode;throw Error(t(33))}function qd(c){return c[Xu]||null}var qy=[],al=-1;function Xo(c){return{current:c}}function Ot(c){0>al||(c.current=qy[al],qy[al]=null,al--)}function It(c,d){al++,qy[al]=c.current,c.current=d}var Yo={},Yn=Xo(Yo),xs=Xo(!1),qi=Yo;function ll(c,d){var g=c.type.contextTypes;if(!g)return Yo;var b=c.stateNode;if(b&&b.__reactInternalMemoizedUnmaskedChildContext===d)return b.__reactInternalMemoizedMaskedChildContext;var C={},N;for(N in g)C[N]=d[N];return b&&(c=c.stateNode,c.__reactInternalMemoizedUnmaskedChildContext=d,c.__reactInternalMemoizedMaskedChildContext=C),C}function vs(c){return c=c.childContextTypes,c!=null}function Xd(){Ot(xs),Ot(Yn)}function pk(c,d,g){if(Yn.current!==Yo)throw Error(t(168));It(Yn,d),It(xs,g)}function fk(c,d,g){var b=c.stateNode;if(d=d.childContextTypes,typeof b.getChildContext!="function")return g;b=b.getChildContext();for(var C in b)if(!(C in d))throw Error(t(108,he(c)||"Unknown",C));return B({},g,b)}function Yd(c){return c=(c=c.stateNode)&&c.__reactInternalMemoizedMergedChildContext||Yo,qi=Yn.current,It(Yn,c),It(xs,xs.current),!0}function mk(c,d,g){var b=c.stateNode;if(!b)throw Error(t(169));g?(c=fk(c,d,qi),b.__reactInternalMemoizedMergedChildContext=c,Ot(xs),Ot(Yn),It(Yn,c)):Ot(xs),It(xs,g)}var mo=null,Qd=!1,Xy=!1;function gk(c){mo===null?mo=[c]:mo.push(c)}function H3(c){Qd=!0,gk(c)}function Qo(){if(!Xy&&mo!==null){Xy=!0;var c=0,d=bt;try{var g=mo;for(bt=1;c<g.length;c++){var b=g[c];do b=b(!0);while(b!==null)}mo=null,Qd=!1}catch(C){throw mo!==null&&(mo=mo.slice(c+1)),xC(yy,Qo),C}finally{bt=d,Xy=!1}}return null}var ul=[],cl=0,Zd=null,Jd=0,Xs=[],Ys=0,Xi=null,go=1,yo="";function Yi(c,d){ul[cl++]=Jd,ul[cl++]=Zd,Zd=c,Jd=d}function yk(c,d,g){Xs[Ys++]=go,Xs[Ys++]=yo,Xs[Ys++]=Xi,Xi=c;var b=go;c=yo;var C=32-br(b)-1;b&=~(1<<C),g+=1;var N=32-br(d)+C;if(30<N){var A=C-C%5;N=(b&(1<<A)-1).toString(32),b>>=A,C-=A,go=1<<32-br(d)+C|g<<C|b,yo=N+c}else go=1<<N|g<<C|b,yo=c}function Yy(c){c.return!==null&&(Yi(c,1),yk(c,1,0))}function Qy(c){for(;c===Zd;)Zd=ul[--cl],ul[cl]=null,Jd=ul[--cl],ul[cl]=null;for(;c===Xi;)Xi=Xs[--Ys],Xs[Ys]=null,yo=Xs[--Ys],Xs[Ys]=null,go=Xs[--Ys],Xs[Ys]=null}var Vs=null,Bs=null,Pt=!1,Cr=null;function xk(c,d){var g=er(5,null,null,0);g.elementType="DELETED",g.stateNode=d,g.return=c,d=c.deletions,d===null?(c.deletions=[g],c.flags|=16):d.push(g)}function vk(c,d){switch(c.tag){case 5:var g=c.type;return d=d.nodeType!==1||g.toLowerCase()!==d.nodeName.toLowerCase()?null:d,d!==null?(c.stateNode=d,Vs=c,Bs=qo(d.firstChild),!0):!1;case 6:return d=c.pendingProps===""||d.nodeType!==3?null:d,d!==null?(c.stateNode=d,Vs=c,Bs=null,!0):!1;case 13:return d=d.nodeType!==8?null:d,d!==null?(g=Xi!==null?{id:go,overflow:yo}:null,c.memoizedState={dehydrated:d,treeContext:g,retryLane:1073741824},g=er(18,null,null,0),g.stateNode=d,g.return=c,c.child=g,Vs=c,Bs=null,!0):!1;default:return!1}}function Zy(c){return(c.mode&1)!==0&&(c.flags&128)===0}function Jy(c){if(Pt){var d=Bs;if(d){var g=d;if(!vk(c,d)){if(Zy(c))throw Error(t(418));d=qo(g.nextSibling);var b=Vs;d&&vk(c,d)?xk(b,g):(c.flags=c.flags&-4097|2,Pt=!1,Vs=c)}}else{if(Zy(c))throw Error(t(418));c.flags=c.flags&-4097|2,Pt=!1,Vs=c}}}function wk(c){for(c=c.return;c!==null&&c.tag!==5&&c.tag!==3&&c.tag!==13;)c=c.return;Vs=c}function ep(c){if(c!==Vs)return!1;if(!Pt)return wk(c),Pt=!0,!1;var d;if((d=c.tag!==3)&&!(d=c.tag!==5)&&(d=c.type,d=d!=="head"&&d!=="body"&&!Gy(c.type,c.memoizedProps)),d&&(d=Bs)){if(Zy(c))throw bk(),Error(t(418));for(;d;)xk(c,d),d=qo(d.nextSibling)}if(wk(c),c.tag===13){if(c=c.memoizedState,c=c!==null?c.dehydrated:null,!c)throw Error(t(317));e:{for(c=c.nextSibling,d=0;c;){if(c.nodeType===8){var g=c.data;if(g==="/$"){if(d===0){Bs=qo(c.nextSibling);break e}d--}else g!=="$"&&g!=="$!"&&g!=="$?"||d++}c=c.nextSibling}Bs=null}}else Bs=Vs?qo(c.stateNode.nextSibling):null;return!0}function bk(){for(var c=Bs;c;)c=qo(c.nextSibling)}function hl(){Bs=Vs=null,Pt=!1}function e0(c){Cr===null?Cr=[c]:Cr.push(c)}var K3=T.ReactCurrentBatchConfig;function Qu(c,d,g){if(c=g.ref,c!==null&&typeof c!="function"&&typeof c!="object"){if(g._owner){if(g=g._owner,g){if(g.tag!==1)throw Error(t(309));var b=g.stateNode}if(!b)throw Error(t(147,c));var C=b,N=""+c;return d!==null&&d.ref!==null&&typeof d.ref=="function"&&d.ref._stringRef===N?d.ref:(d=function(A){var U=C.refs;A===null?delete U[N]:U[N]=A},d._stringRef=N,d)}if(typeof c!="string")throw Error(t(284));if(!g._owner)throw Error(t(290,c))}return c}function tp(c,d){throw c=Object.prototype.toString.call(d),Error(t(31,c==="[object Object]"?"object with keys {"+Object.keys(d).join(", ")+"}":c))}function Sk(c){var d=c._init;return d(c._payload)}function Ck(c){function d(le,ne){if(c){var ce=le.deletions;ce===null?(le.deletions=[ne],le.flags|=16):ce.push(ne)}}function g(le,ne){if(!c)return null;for(;ne!==null;)d(le,ne),ne=ne.sibling;return null}function b(le,ne){for(le=new Map;ne!==null;)ne.key!==null?le.set(ne.key,ne):le.set(ne.index,ne),ne=ne.sibling;return le}function C(le,ne){return le=oi(le,ne),le.index=0,le.sibling=null,le}function N(le,ne,ce){return le.index=ce,c?(ce=le.alternate,ce!==null?(ce=ce.index,ce<ne?(le.flags|=2,ne):ce):(le.flags|=2,ne)):(le.flags|=1048576,ne)}function A(le){return c&&le.alternate===null&&(le.flags|=2),le}function U(le,ne,ce,Ce){return ne===null||ne.tag!==6?(ne=j0(ce,le.mode,Ce),ne.return=le,ne):(ne=C(ne,ce),ne.return=le,ne)}function Y(le,ne,ce,Ce){var Ve=ce.type;return Ve===D?be(le,ne,ce.props.children,Ce,ce.key):ne!==null&&(ne.elementType===Ve||typeof Ve=="object"&&Ve!==null&&Ve.$$typeof===oe&&Sk(Ve)===ne.type)?(Ce=C(ne,ce.props),Ce.ref=Qu(le,ne,ce),Ce.return=le,Ce):(Ce=Tp(ce.type,ce.key,ce.props,null,le.mode,Ce),Ce.ref=Qu(le,ne,ce),Ce.return=le,Ce)}function de(le,ne,ce,Ce){return ne===null||ne.tag!==4||ne.stateNode.containerInfo!==ce.containerInfo||ne.stateNode.implementation!==ce.implementation?(ne=H0(ce,le.mode,Ce),ne.return=le,ne):(ne=C(ne,ce.children||[]),ne.return=le,ne)}function be(le,ne,ce,Ce,Ve){return ne===null||ne.tag!==7?(ne=ra(ce,le.mode,Ce,Ve),ne.return=le,ne):(ne=C(ne,ce),ne.return=le,ne)}function Se(le,ne,ce){if(typeof ne=="string"&&ne!==""||typeof ne=="number")return ne=j0(""+ne,le.mode,ce),ne.return=le,ne;if(typeof ne=="object"&&ne!==null){switch(ne.$$typeof){case I:return ce=Tp(ne.type,ne.key,ne.props,null,le.mode,ce),ce.ref=Qu(le,null,ne),ce.return=le,ce;case E:return ne=H0(ne,le.mode,ce),ne.return=le,ne;case oe:var Ce=ne._init;return Se(le,Ce(ne._payload),ce)}if(mt(ne)||V(ne))return ne=ra(ne,le.mode,ce,null),ne.return=le,ne;tp(le,ne)}return null}function we(le,ne,ce,Ce){var Ve=ne!==null?ne.key:null;if(typeof ce=="string"&&ce!==""||typeof ce=="number")return Ve!==null?null:U(le,ne,""+ce,Ce);if(typeof ce=="object"&&ce!==null){switch(ce.$$typeof){case I:return ce.key===Ve?Y(le,ne,ce,Ce):null;case E:return ce.key===Ve?de(le,ne,ce,Ce):null;case oe:return Ve=ce._init,we(le,ne,Ve(ce._payload),Ce)}if(mt(ce)||V(ce))return Ve!==null?null:be(le,ne,ce,Ce,null);tp(le,ce)}return null}function De(le,ne,ce,Ce,Ve){if(typeof Ce=="string"&&Ce!==""||typeof Ce=="number")return le=le.get(ce)||null,U(ne,le,""+Ce,Ve);if(typeof Ce=="object"&&Ce!==null){switch(Ce.$$typeof){case I:return le=le.get(Ce.key===null?ce:Ce.key)||null,Y(ne,le,Ce,Ve);case E:return le=le.get(Ce.key===null?ce:Ce.key)||null,de(ne,le,Ce,Ve);case oe:var Ge=Ce._init;return De(le,ne,ce,Ge(Ce._payload),Ve)}if(mt(Ce)||V(Ce))return le=le.get(ce)||null,be(ne,le,Ce,Ve,null);tp(ne,Ce)}return null}function Pe(le,ne,ce,Ce){for(var Ve=null,Ge=null,je=ne,Ye=ne=0,Dn=null;je!==null&&Ye<ce.length;Ye++){je.index>Ye?(Dn=je,je=null):Dn=je.sibling;var yt=we(le,je,ce[Ye],Ce);if(yt===null){je===null&&(je=Dn);break}c&&je&&yt.alternate===null&&d(le,je),ne=N(yt,ne,Ye),Ge===null?Ve=yt:Ge.sibling=yt,Ge=yt,je=Dn}if(Ye===ce.length)return g(le,je),Pt&&Yi(le,Ye),Ve;if(je===null){for(;Ye<ce.length;Ye++)je=Se(le,ce[Ye],Ce),je!==null&&(ne=N(je,ne,Ye),Ge===null?Ve=je:Ge.sibling=je,Ge=je);return Pt&&Yi(le,Ye),Ve}for(je=b(le,je);Ye<ce.length;Ye++)Dn=De(je,le,Ye,ce[Ye],Ce),Dn!==null&&(c&&Dn.alternate!==null&&je.delete(Dn.key===null?Ye:Dn.key),ne=N(Dn,ne,Ye),Ge===null?Ve=Dn:Ge.sibling=Dn,Ge=Dn);return c&&je.forEach(function(ii){return d(le,ii)}),Pt&&Yi(le,Ye),Ve}function ze(le,ne,ce,Ce){var Ve=V(ce);if(typeof Ve!="function")throw Error(t(150));if(ce=Ve.call(ce),ce==null)throw Error(t(151));for(var Ge=Ve=null,je=ne,Ye=ne=0,Dn=null,yt=ce.next();je!==null&&!yt.done;Ye++,yt=ce.next()){je.index>Ye?(Dn=je,je=null):Dn=je.sibling;var ii=we(le,je,yt.value,Ce);if(ii===null){je===null&&(je=Dn);break}c&&je&&ii.alternate===null&&d(le,je),ne=N(ii,ne,Ye),Ge===null?Ve=ii:Ge.sibling=ii,Ge=ii,je=Dn}if(yt.done)return g(le,je),Pt&&Yi(le,Ye),Ve;if(je===null){for(;!yt.done;Ye++,yt=ce.next())yt=Se(le,yt.value,Ce),yt!==null&&(ne=N(yt,ne,Ye),Ge===null?Ve=yt:Ge.sibling=yt,Ge=yt);return Pt&&Yi(le,Ye),Ve}for(je=b(le,je);!yt.done;Ye++,yt=ce.next())yt=De(je,le,Ye,yt.value,Ce),yt!==null&&(c&&yt.alternate!==null&&je.delete(yt.key===null?Ye:yt.key),ne=N(yt,ne,Ye),Ge===null?Ve=yt:Ge.sibling=yt,Ge=yt);return c&&je.forEach(function(NM){return d(le,NM)}),Pt&&Yi(le,Ye),Ve}function rn(le,ne,ce,Ce){if(typeof ce=="object"&&ce!==null&&ce.type===D&&ce.key===null&&(ce=ce.props.children),typeof ce=="object"&&ce!==null){switch(ce.$$typeof){case I:e:{for(var Ve=ce.key,Ge=ne;Ge!==null;){if(Ge.key===Ve){if(Ve=ce.type,Ve===D){if(Ge.tag===7){g(le,Ge.sibling),ne=C(Ge,ce.props.children),ne.return=le,le=ne;break e}}else if(Ge.elementType===Ve||typeof Ve=="object"&&Ve!==null&&Ve.$$typeof===oe&&Sk(Ve)===Ge.type){g(le,Ge.sibling),ne=C(Ge,ce.props),ne.ref=Qu(le,Ge,ce),ne.return=le,le=ne;break e}g(le,Ge);break}else d(le,Ge);Ge=Ge.sibling}ce.type===D?(ne=ra(ce.props.children,le.mode,Ce,ce.key),ne.return=le,le=ne):(Ce=Tp(ce.type,ce.key,ce.props,null,le.mode,Ce),Ce.ref=Qu(le,ne,ce),Ce.return=le,le=Ce)}return A(le);case E:e:{for(Ge=ce.key;ne!==null;){if(ne.key===Ge)if(ne.tag===4&&ne.stateNode.containerInfo===ce.containerInfo&&ne.stateNode.implementation===ce.implementation){g(le,ne.sibling),ne=C(ne,ce.children||[]),ne.return=le,le=ne;break e}else{g(le,ne);break}else d(le,ne);ne=ne.sibling}ne=H0(ce,le.mode,Ce),ne.return=le,le=ne}return A(le);case oe:return Ge=ce._init,rn(le,ne,Ge(ce._payload),Ce)}if(mt(ce))return Pe(le,ne,ce,Ce);if(V(ce))return ze(le,ne,ce,Ce);tp(le,ce)}return typeof ce=="string"&&ce!==""||typeof ce=="number"?(ce=""+ce,ne!==null&&ne.tag===6?(g(le,ne.sibling),ne=C(ne,ce),ne.return=le,le=ne):(g(le,ne),ne=j0(ce,le.mode,Ce),ne.return=le,le=ne),A(le)):g(le,ne)}return rn}var dl=Ck(!0),kk=Ck(!1),np=Xo(null),sp=null,pl=null,t0=null;function n0(){t0=pl=sp=null}function s0(c){var d=np.current;Ot(np),c._currentValue=d}function r0(c,d,g){for(;c!==null;){var b=c.alternate;if((c.childLanes&d)!==d?(c.childLanes|=d,b!==null&&(b.childLanes|=d)):b!==null&&(b.childLanes&d)!==d&&(b.childLanes|=d),c===g)break;c=c.return}}function fl(c,d){sp=c,t0=pl=null,c=c.dependencies,c!==null&&c.firstContext!==null&&((c.lanes&d)!==0&&(ws=!0),c.firstContext=null)}function Qs(c){var d=c._currentValue;if(t0!==c)if(c={context:c,memoizedValue:d,next:null},pl===null){if(sp===null)throw Error(t(308));pl=c,sp.dependencies={lanes:0,firstContext:c}}else pl=pl.next=c;return d}var Qi=null;function o0(c){Qi===null?Qi=[c]:Qi.push(c)}function Tk(c,d,g,b){var C=d.interleaved;return C===null?(g.next=g,o0(d)):(g.next=C.next,C.next=g),d.interleaved=g,xo(c,b)}function xo(c,d){c.lanes|=d;var g=c.alternate;for(g!==null&&(g.lanes|=d),g=c,c=c.return;c!==null;)c.childLanes|=d,g=c.alternate,g!==null&&(g.childLanes|=d),g=c,c=c.return;return g.tag===3?g.stateNode:null}var Zo=!1;function i0(c){c.updateQueue={baseState:c.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Nk(c,d){c=c.updateQueue,d.updateQueue===c&&(d.updateQueue={baseState:c.baseState,firstBaseUpdate:c.firstBaseUpdate,lastBaseUpdate:c.lastBaseUpdate,shared:c.shared,effects:c.effects})}function vo(c,d){return{eventTime:c,lane:d,tag:0,payload:null,callback:null,next:null}}function Jo(c,d,g){var b=c.updateQueue;if(b===null)return null;if(b=b.shared,(gt&2)!==0){var C=b.pending;return C===null?d.next=d:(d.next=C.next,C.next=d),b.pending=d,xo(c,g)}return C=b.interleaved,C===null?(d.next=d,o0(b)):(d.next=C.next,C.next=d),b.interleaved=d,xo(c,g)}function rp(c,d,g){if(d=d.updateQueue,d!==null&&(d=d.shared,(g&4194240)!==0)){var b=d.lanes;b&=c.pendingLanes,g|=b,d.lanes=g,wy(c,g)}}function Ik(c,d){var g=c.updateQueue,b=c.alternate;if(b!==null&&(b=b.updateQueue,g===b)){var C=null,N=null;if(g=g.firstBaseUpdate,g!==null){do{var A={eventTime:g.eventTime,lane:g.lane,tag:g.tag,payload:g.payload,callback:g.callback,next:null};N===null?C=N=A:N=N.next=A,g=g.next}while(g!==null);N===null?C=N=d:N=N.next=d}else C=N=d;g={baseState:b.baseState,firstBaseUpdate:C,lastBaseUpdate:N,shared:b.shared,effects:b.effects},c.updateQueue=g;return}c=g.lastBaseUpdate,c===null?g.firstBaseUpdate=d:c.next=d,g.lastBaseUpdate=d}function op(c,d,g,b){var C=c.updateQueue;Zo=!1;var N=C.firstBaseUpdate,A=C.lastBaseUpdate,U=C.shared.pending;if(U!==null){C.shared.pending=null;var Y=U,de=Y.next;Y.next=null,A===null?N=de:A.next=de,A=Y;var be=c.alternate;be!==null&&(be=be.updateQueue,U=be.lastBaseUpdate,U!==A&&(U===null?be.firstBaseUpdate=de:U.next=de,be.lastBaseUpdate=Y))}if(N!==null){var Se=C.baseState;A=0,be=de=Y=null,U=N;do{var we=U.lane,De=U.eventTime;if((b&we)===we){be!==null&&(be=be.next={eventTime:De,lane:0,tag:U.tag,payload:U.payload,callback:U.callback,next:null});e:{var Pe=c,ze=U;switch(we=d,De=g,ze.tag){case 1:if(Pe=ze.payload,typeof Pe=="function"){Se=Pe.call(De,Se,we);break e}Se=Pe;break e;case 3:Pe.flags=Pe.flags&-65537|128;case 0:if(Pe=ze.payload,we=typeof Pe=="function"?Pe.call(De,Se,we):Pe,we==null)break e;Se=B({},Se,we);break e;case 2:Zo=!0}}U.callback!==null&&U.lane!==0&&(c.flags|=64,we=C.effects,we===null?C.effects=[U]:we.push(U))}else De={eventTime:De,lane:we,tag:U.tag,payload:U.payload,callback:U.callback,next:null},be===null?(de=be=De,Y=Se):be=be.next=De,A|=we;if(U=U.next,U===null){if(U=C.shared.pending,U===null)break;we=U,U=we.next,we.next=null,C.lastBaseUpdate=we,C.shared.pending=null}}while(!0);if(be===null&&(Y=Se),C.baseState=Y,C.firstBaseUpdate=de,C.lastBaseUpdate=be,d=C.shared.interleaved,d!==null){C=d;do A|=C.lane,C=C.next;while(C!==d)}else N===null&&(C.shared.lanes=0);ea|=A,c.lanes=A,c.memoizedState=Se}}function $k(c,d,g){if(c=d.effects,d.effects=null,c!==null)for(d=0;d<c.length;d++){var b=c[d],C=b.callback;if(C!==null){if(b.callback=null,b=g,typeof C!="function")throw Error(t(191,C));C.call(b)}}}var Zu={},jr=Xo(Zu),Ju=Xo(Zu),ec=Xo(Zu);function Zi(c){if(c===Zu)throw Error(t(174));return c}function a0(c,d){switch(It(ec,d),It(Ju,c),It(jr,Zu),c=d.nodeType,c){case 9:case 11:d=(d=d.documentElement)?d.namespaceURI:Bn(null,"");break;default:c=c===8?d.parentNode:d,d=c.namespaceURI||null,c=c.tagName,d=Bn(d,c)}Ot(jr),It(jr,d)}function ml(){Ot(jr),Ot(Ju),Ot(ec)}function Ek(c){Zi(ec.current);var d=Zi(jr.current),g=Bn(d,c.type);d!==g&&(It(Ju,c),It(jr,g))}function l0(c){Ju.current===c&&(Ot(jr),Ot(Ju))}var Bt=Xo(0);function ip(c){for(var d=c;d!==null;){if(d.tag===13){var g=d.memoizedState;if(g!==null&&(g=g.dehydrated,g===null||g.data==="$?"||g.data==="$!"))return d}else if(d.tag===19&&d.memoizedProps.revealOrder!==void 0){if((d.flags&128)!==0)return d}else if(d.child!==null){d.child.return=d,d=d.child;continue}if(d===c)break;for(;d.sibling===null;){if(d.return===null||d.return===c)return null;d=d.return}d.sibling.return=d.return,d=d.sibling}return null}var u0=[];function c0(){for(var c=0;c<u0.length;c++)u0[c]._workInProgressVersionPrimary=null;u0.length=0}var ap=T.ReactCurrentDispatcher,h0=T.ReactCurrentBatchConfig,Ji=0,Wt=null,wn=null,En=null,lp=!1,tc=!1,nc=0,q3=0;function Qn(){throw Error(t(321))}function d0(c,d){if(d===null)return!1;for(var g=0;g<d.length&&g<c.length;g++)if(!Sr(c[g],d[g]))return!1;return!0}function p0(c,d,g,b,C,N){if(Ji=N,Wt=d,d.memoizedState=null,d.updateQueue=null,d.lanes=0,ap.current=c===null||c.memoizedState===null?Z3:J3,c=g(b,C),tc){N=0;do{if(tc=!1,nc=0,25<=N)throw Error(t(301));N+=1,En=wn=null,d.updateQueue=null,ap.current=eM,c=g(b,C)}while(tc)}if(ap.current=hp,d=wn!==null&&wn.next!==null,Ji=0,En=wn=Wt=null,lp=!1,d)throw Error(t(300));return c}function f0(){var c=nc!==0;return nc=0,c}function Hr(){var c={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return En===null?Wt.memoizedState=En=c:En=En.next=c,En}function Zs(){if(wn===null){var c=Wt.alternate;c=c!==null?c.memoizedState:null}else c=wn.next;var d=En===null?Wt.memoizedState:En.next;if(d!==null)En=d,wn=c;else{if(c===null)throw Error(t(310));wn=c,c={memoizedState:wn.memoizedState,baseState:wn.baseState,baseQueue:wn.baseQueue,queue:wn.queue,next:null},En===null?Wt.memoizedState=En=c:En=En.next=c}return En}function sc(c,d){return typeof d=="function"?d(c):d}function m0(c){var d=Zs(),g=d.queue;if(g===null)throw Error(t(311));g.lastRenderedReducer=c;var b=wn,C=b.baseQueue,N=g.pending;if(N!==null){if(C!==null){var A=C.next;C.next=N.next,N.next=A}b.baseQueue=C=N,g.pending=null}if(C!==null){N=C.next,b=b.baseState;var U=A=null,Y=null,de=N;do{var be=de.lane;if((Ji&be)===be)Y!==null&&(Y=Y.next={lane:0,action:de.action,hasEagerState:de.hasEagerState,eagerState:de.eagerState,next:null}),b=de.hasEagerState?de.eagerState:c(b,de.action);else{var Se={lane:be,action:de.action,hasEagerState:de.hasEagerState,eagerState:de.eagerState,next:null};Y===null?(U=Y=Se,A=b):Y=Y.next=Se,Wt.lanes|=be,ea|=be}de=de.next}while(de!==null&&de!==N);Y===null?A=b:Y.next=U,Sr(b,d.memoizedState)||(ws=!0),d.memoizedState=b,d.baseState=A,d.baseQueue=Y,g.lastRenderedState=b}if(c=g.interleaved,c!==null){C=c;do N=C.lane,Wt.lanes|=N,ea|=N,C=C.next;while(C!==c)}else C===null&&(g.lanes=0);return[d.memoizedState,g.dispatch]}function g0(c){var d=Zs(),g=d.queue;if(g===null)throw Error(t(311));g.lastRenderedReducer=c;var b=g.dispatch,C=g.pending,N=d.memoizedState;if(C!==null){g.pending=null;var A=C=C.next;do N=c(N,A.action),A=A.next;while(A!==C);Sr(N,d.memoizedState)||(ws=!0),d.memoizedState=N,d.baseQueue===null&&(d.baseState=N),g.lastRenderedState=N}return[N,b]}function Rk(){}function Dk(c,d){var g=Wt,b=Zs(),C=d(),N=!Sr(b.memoizedState,C);if(N&&(b.memoizedState=C,ws=!0),b=b.queue,y0(_k.bind(null,g,b,c),[c]),b.getSnapshot!==d||N||En!==null&&En.memoizedState.tag&1){if(g.flags|=2048,rc(9,Ok.bind(null,g,b,C,d),void 0,null),Rn===null)throw Error(t(349));(Ji&30)!==0||Ak(g,d,C)}return C}function Ak(c,d,g){c.flags|=16384,c={getSnapshot:d,value:g},d=Wt.updateQueue,d===null?(d={lastEffect:null,stores:null},Wt.updateQueue=d,d.stores=[c]):(g=d.stores,g===null?d.stores=[c]:g.push(c))}function Ok(c,d,g,b){d.value=g,d.getSnapshot=b,Fk(d)&&Pk(c)}function _k(c,d,g){return g(function(){Fk(d)&&Pk(c)})}function Fk(c){var d=c.getSnapshot;c=c.value;try{var g=d();return!Sr(c,g)}catch{return!0}}function Pk(c){var d=xo(c,1);d!==null&&Ir(d,c,1,-1)}function Lk(c){var d=Hr();return typeof c=="function"&&(c=c()),d.memoizedState=d.baseState=c,c={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:sc,lastRenderedState:c},d.queue=c,c=c.dispatch=Q3.bind(null,Wt,c),[d.memoizedState,c]}function rc(c,d,g,b){return c={tag:c,create:d,destroy:g,deps:b,next:null},d=Wt.updateQueue,d===null?(d={lastEffect:null,stores:null},Wt.updateQueue=d,d.lastEffect=c.next=c):(g=d.lastEffect,g===null?d.lastEffect=c.next=c:(b=g.next,g.next=c,c.next=b,d.lastEffect=c)),c}function Mk(){return Zs().memoizedState}function up(c,d,g,b){var C=Hr();Wt.flags|=c,C.memoizedState=rc(1|d,g,void 0,b===void 0?null:b)}function cp(c,d,g,b){var C=Zs();b=b===void 0?null:b;var N=void 0;if(wn!==null){var A=wn.memoizedState;if(N=A.destroy,b!==null&&d0(b,A.deps)){C.memoizedState=rc(d,g,N,b);return}}Wt.flags|=c,C.memoizedState=rc(1|d,g,N,b)}function zk(c,d){return up(8390656,8,c,d)}function y0(c,d){return cp(2048,8,c,d)}function Vk(c,d){return cp(4,2,c,d)}function Bk(c,d){return cp(4,4,c,d)}function Wk(c,d){if(typeof d=="function")return c=c(),d(c),function(){d(null)};if(d!=null)return c=c(),d.current=c,function(){d.current=null}}function Uk(c,d,g){return g=g!=null?g.concat([c]):null,cp(4,4,Wk.bind(null,d,c),g)}function x0(){}function Gk(c,d){var g=Zs();d=d===void 0?null:d;var b=g.memoizedState;return b!==null&&d!==null&&d0(d,b[1])?b[0]:(g.memoizedState=[c,d],c)}function jk(c,d){var g=Zs();d=d===void 0?null:d;var b=g.memoizedState;return b!==null&&d!==null&&d0(d,b[1])?b[0]:(c=c(),g.memoizedState=[c,d],c)}function Hk(c,d,g){return(Ji&21)===0?(c.baseState&&(c.baseState=!1,ws=!0),c.memoizedState=g):(Sr(g,d)||(g=SC(),Wt.lanes|=g,ea|=g,c.baseState=!0),d)}function X3(c,d){var g=bt;bt=g!==0&&4>g?g:4,c(!0);var b=h0.transition;h0.transition={};try{c(!1),d()}finally{bt=g,h0.transition=b}}function Kk(){return Zs().memoizedState}function Y3(c,d,g){var b=si(c);if(g={lane:b,action:g,hasEagerState:!1,eagerState:null,next:null},qk(c))Xk(d,g);else if(g=Tk(c,d,g,b),g!==null){var C=ls();Ir(g,c,b,C),Yk(g,d,b)}}function Q3(c,d,g){var b=si(c),C={lane:b,action:g,hasEagerState:!1,eagerState:null,next:null};if(qk(c))Xk(d,C);else{var N=c.alternate;if(c.lanes===0&&(N===null||N.lanes===0)&&(N=d.lastRenderedReducer,N!==null))try{var A=d.lastRenderedState,U=N(A,g);if(C.hasEagerState=!0,C.eagerState=U,Sr(U,A)){var Y=d.interleaved;Y===null?(C.next=C,o0(d)):(C.next=Y.next,Y.next=C),d.interleaved=C;return}}catch{}finally{}g=Tk(c,d,C,b),g!==null&&(C=ls(),Ir(g,c,b,C),Yk(g,d,b))}}function qk(c){var d=c.alternate;return c===Wt||d!==null&&d===Wt}function Xk(c,d){tc=lp=!0;var g=c.pending;g===null?d.next=d:(d.next=g.next,g.next=d),c.pending=d}function Yk(c,d,g){if((g&4194240)!==0){var b=d.lanes;b&=c.pendingLanes,g|=b,d.lanes=g,wy(c,g)}}var hp={readContext:Qs,useCallback:Qn,useContext:Qn,useEffect:Qn,useImperativeHandle:Qn,useInsertionEffect:Qn,useLayoutEffect:Qn,useMemo:Qn,useReducer:Qn,useRef:Qn,useState:Qn,useDebugValue:Qn,useDeferredValue:Qn,useTransition:Qn,useMutableSource:Qn,useSyncExternalStore:Qn,useId:Qn,unstable_isNewReconciler:!1},Z3={readContext:Qs,useCallback:function(c,d){return Hr().memoizedState=[c,d===void 0?null:d],c},useContext:Qs,useEffect:zk,useImperativeHandle:function(c,d,g){return g=g!=null?g.concat([c]):null,up(4194308,4,Wk.bind(null,d,c),g)},useLayoutEffect:function(c,d){return up(4194308,4,c,d)},useInsertionEffect:function(c,d){return up(4,2,c,d)},useMemo:function(c,d){var g=Hr();return d=d===void 0?null:d,c=c(),g.memoizedState=[c,d],c},useReducer:function(c,d,g){var b=Hr();return d=g!==void 0?g(d):d,b.memoizedState=b.baseState=d,c={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:c,lastRenderedState:d},b.queue=c,c=c.dispatch=Y3.bind(null,Wt,c),[b.memoizedState,c]},useRef:function(c){var d=Hr();return c={current:c},d.memoizedState=c},useState:Lk,useDebugValue:x0,useDeferredValue:function(c){return Hr().memoizedState=c},useTransition:function(){var c=Lk(!1),d=c[0];return c=X3.bind(null,c[1]),Hr().memoizedState=c,[d,c]},useMutableSource:function(){},useSyncExternalStore:function(c,d,g){var b=Wt,C=Hr();if(Pt){if(g===void 0)throw Error(t(407));g=g()}else{if(g=d(),Rn===null)throw Error(t(349));(Ji&30)!==0||Ak(b,d,g)}C.memoizedState=g;var N={value:g,getSnapshot:d};return C.queue=N,zk(_k.bind(null,b,N,c),[c]),b.flags|=2048,rc(9,Ok.bind(null,b,N,g,d),void 0,null),g},useId:function(){var c=Hr(),d=Rn.identifierPrefix;if(Pt){var g=yo,b=go;g=(b&~(1<<32-br(b)-1)).toString(32)+g,d=":"+d+"R"+g,g=nc++,0<g&&(d+="H"+g.toString(32)),d+=":"}else g=q3++,d=":"+d+"r"+g.toString(32)+":";return c.memoizedState=d},unstable_isNewReconciler:!1},J3={readContext:Qs,useCallback:Gk,useContext:Qs,useEffect:y0,useImperativeHandle:Uk,useInsertionEffect:Vk,useLayoutEffect:Bk,useMemo:jk,useReducer:m0,useRef:Mk,useState:function(){return m0(sc)},useDebugValue:x0,useDeferredValue:function(c){var d=Zs();return Hk(d,wn.memoizedState,c)},useTransition:function(){var c=m0(sc)[0],d=Zs().memoizedState;return[c,d]},useMutableSource:Rk,useSyncExternalStore:Dk,useId:Kk,unstable_isNewReconciler:!1},eM={readContext:Qs,useCallback:Gk,useContext:Qs,useEffect:y0,useImperativeHandle:Uk,useInsertionEffect:Vk,useLayoutEffect:Bk,useMemo:jk,useReducer:g0,useRef:Mk,useState:function(){return g0(sc)},useDebugValue:x0,useDeferredValue:function(c){var d=Zs();return wn===null?d.memoizedState=c:Hk(d,wn.memoizedState,c)},useTransition:function(){var c=g0(sc)[0],d=Zs().memoizedState;return[c,d]},useMutableSource:Rk,useSyncExternalStore:Dk,useId:Kk,unstable_isNewReconciler:!1};function kr(c,d){if(c&&c.defaultProps){d=B({},d),c=c.defaultProps;for(var g in c)d[g]===void 0&&(d[g]=c[g]);return d}return d}function v0(c,d,g,b){d=c.memoizedState,g=g(b,d),g=g==null?d:B({},d,g),c.memoizedState=g,c.lanes===0&&(c.updateQueue.baseState=g)}var dp={isMounted:function(c){return(c=c._reactInternals)?Hi(c)===c:!1},enqueueSetState:function(c,d,g){c=c._reactInternals;var b=ls(),C=si(c),N=vo(b,C);N.payload=d,g!=null&&(N.callback=g),d=Jo(c,N,C),d!==null&&(Ir(d,c,C,b),rp(d,c,C))},enqueueReplaceState:function(c,d,g){c=c._reactInternals;var b=ls(),C=si(c),N=vo(b,C);N.tag=1,N.payload=d,g!=null&&(N.callback=g),d=Jo(c,N,C),d!==null&&(Ir(d,c,C,b),rp(d,c,C))},enqueueForceUpdate:function(c,d){c=c._reactInternals;var g=ls(),b=si(c),C=vo(g,b);C.tag=2,d!=null&&(C.callback=d),d=Jo(c,C,b),d!==null&&(Ir(d,c,b,g),rp(d,c,b))}};function Qk(c,d,g,b,C,N,A){return c=c.stateNode,typeof c.shouldComponentUpdate=="function"?c.shouldComponentUpdate(b,N,A):d.prototype&&d.prototype.isPureReactComponent?!Gu(g,b)||!Gu(C,N):!0}function Zk(c,d,g){var b=!1,C=Yo,N=d.contextType;return typeof N=="object"&&N!==null?N=Qs(N):(C=vs(d)?qi:Yn.current,b=d.contextTypes,N=(b=b!=null)?ll(c,C):Yo),d=new d(g,N),c.memoizedState=d.state!==null&&d.state!==void 0?d.state:null,d.updater=dp,c.stateNode=d,d._reactInternals=c,b&&(c=c.stateNode,c.__reactInternalMemoizedUnmaskedChildContext=C,c.__reactInternalMemoizedMaskedChildContext=N),d}function Jk(c,d,g,b){c=d.state,typeof d.componentWillReceiveProps=="function"&&d.componentWillReceiveProps(g,b),typeof d.UNSAFE_componentWillReceiveProps=="function"&&d.UNSAFE_componentWillReceiveProps(g,b),d.state!==c&&dp.enqueueReplaceState(d,d.state,null)}function w0(c,d,g,b){var C=c.stateNode;C.props=g,C.state=c.memoizedState,C.refs={},i0(c);var N=d.contextType;typeof N=="object"&&N!==null?C.context=Qs(N):(N=vs(d)?qi:Yn.current,C.context=ll(c,N)),C.state=c.memoizedState,N=d.getDerivedStateFromProps,typeof N=="function"&&(v0(c,d,N,g),C.state=c.memoizedState),typeof d.getDerivedStateFromProps=="function"||typeof C.getSnapshotBeforeUpdate=="function"||typeof C.UNSAFE_componentWillMount!="function"&&typeof C.componentWillMount!="function"||(d=C.state,typeof C.componentWillMount=="function"&&C.componentWillMount(),typeof C.UNSAFE_componentWillMount=="function"&&C.UNSAFE_componentWillMount(),d!==C.state&&dp.enqueueReplaceState(C,C.state,null),op(c,g,C,b),C.state=c.memoizedState),typeof C.componentDidMount=="function"&&(c.flags|=4194308)}function gl(c,d){try{var g="",b=d;do g+=ue(b),b=b.return;while(b);var C=g}catch(N){C=`
Error generating stack: `+N.message+`
`+N.stack}return{value:c,source:d,stack:C,digest:null}}function b0(c,d,g){return{value:c,source:null,stack:g??null,digest:d??null}}function S0(c,d){try{console.error(d.value)}catch(g){setTimeout(function(){throw g})}}var tM=typeof WeakMap=="function"?WeakMap:Map;function eT(c,d,g){g=vo(-1,g),g.tag=3,g.payload={element:null};var b=d.value;return g.callback=function(){vp||(vp=!0,L0=b),S0(c,d)},g}function tT(c,d,g){g=vo(-1,g),g.tag=3;var b=c.type.getDerivedStateFromError;if(typeof b=="function"){var C=d.value;g.payload=function(){return b(C)},g.callback=function(){S0(c,d)}}var N=c.stateNode;return N!==null&&typeof N.componentDidCatch=="function"&&(g.callback=function(){S0(c,d),typeof b!="function"&&(ti===null?ti=new Set([this]):ti.add(this));var A=d.stack;this.componentDidCatch(d.value,{componentStack:A!==null?A:""})}),g}function nT(c,d,g){var b=c.pingCache;if(b===null){b=c.pingCache=new tM;var C=new Set;b.set(d,C)}else C=b.get(d),C===void 0&&(C=new Set,b.set(d,C));C.has(g)||(C.add(g),c=mM.bind(null,c,d,g),d.then(c,c))}function sT(c){do{var d;if((d=c.tag===13)&&(d=c.memoizedState,d=d!==null?d.dehydrated!==null:!0),d)return c;c=c.return}while(c!==null);return null}function rT(c,d,g,b,C){return(c.mode&1)===0?(c===d?c.flags|=65536:(c.flags|=128,g.flags|=131072,g.flags&=-52805,g.tag===1&&(g.alternate===null?g.tag=17:(d=vo(-1,1),d.tag=2,Jo(g,d,1))),g.lanes|=1),c):(c.flags|=65536,c.lanes=C,c)}var nM=T.ReactCurrentOwner,ws=!1;function as(c,d,g,b){d.child=c===null?kk(d,null,g,b):dl(d,c.child,g,b)}function oT(c,d,g,b,C){g=g.render;var N=d.ref;return fl(d,C),b=p0(c,d,g,b,N,C),g=f0(),c!==null&&!ws?(d.updateQueue=c.updateQueue,d.flags&=-2053,c.lanes&=~C,wo(c,d,C)):(Pt&&g&&Yy(d),d.flags|=1,as(c,d,b,C),d.child)}function iT(c,d,g,b,C){if(c===null){var N=g.type;return typeof N=="function"&&!G0(N)&&N.defaultProps===void 0&&g.compare===null&&g.defaultProps===void 0?(d.tag=15,d.type=N,aT(c,d,N,b,C)):(c=Tp(g.type,null,b,d,d.mode,C),c.ref=d.ref,c.return=d,d.child=c)}if(N=c.child,(c.lanes&C)===0){var A=N.memoizedProps;if(g=g.compare,g=g!==null?g:Gu,g(A,b)&&c.ref===d.ref)return wo(c,d,C)}return d.flags|=1,c=oi(N,b),c.ref=d.ref,c.return=d,d.child=c}function aT(c,d,g,b,C){if(c!==null){var N=c.memoizedProps;if(Gu(N,b)&&c.ref===d.ref)if(ws=!1,d.pendingProps=b=N,(c.lanes&C)!==0)(c.flags&131072)!==0&&(ws=!0);else return d.lanes=c.lanes,wo(c,d,C)}return C0(c,d,g,b,C)}function lT(c,d,g){var b=d.pendingProps,C=b.children,N=c!==null?c.memoizedState:null;if(b.mode==="hidden")if((d.mode&1)===0)d.memoizedState={baseLanes:0,cachePool:null,transitions:null},It(xl,Ws),Ws|=g;else{if((g&1073741824)===0)return c=N!==null?N.baseLanes|g:g,d.lanes=d.childLanes=1073741824,d.memoizedState={baseLanes:c,cachePool:null,transitions:null},d.updateQueue=null,It(xl,Ws),Ws|=c,null;d.memoizedState={baseLanes:0,cachePool:null,transitions:null},b=N!==null?N.baseLanes:g,It(xl,Ws),Ws|=b}else N!==null?(b=N.baseLanes|g,d.memoizedState=null):b=g,It(xl,Ws),Ws|=b;return as(c,d,C,g),d.child}function uT(c,d){var g=d.ref;(c===null&&g!==null||c!==null&&c.ref!==g)&&(d.flags|=512,d.flags|=2097152)}function C0(c,d,g,b,C){var N=vs(g)?qi:Yn.current;return N=ll(d,N),fl(d,C),g=p0(c,d,g,b,N,C),b=f0(),c!==null&&!ws?(d.updateQueue=c.updateQueue,d.flags&=-2053,c.lanes&=~C,wo(c,d,C)):(Pt&&b&&Yy(d),d.flags|=1,as(c,d,g,C),d.child)}function cT(c,d,g,b,C){if(vs(g)){var N=!0;Yd(d)}else N=!1;if(fl(d,C),d.stateNode===null)fp(c,d),Zk(d,g,b),w0(d,g,b,C),b=!0;else if(c===null){var A=d.stateNode,U=d.memoizedProps;A.props=U;var Y=A.context,de=g.contextType;typeof de=="object"&&de!==null?de=Qs(de):(de=vs(g)?qi:Yn.current,de=ll(d,de));var be=g.getDerivedStateFromProps,Se=typeof be=="function"||typeof A.getSnapshotBeforeUpdate=="function";Se||typeof A.UNSAFE_componentWillReceiveProps!="function"&&typeof A.componentWillReceiveProps!="function"||(U!==b||Y!==de)&&Jk(d,A,b,de),Zo=!1;var we=d.memoizedState;A.state=we,op(d,b,A,C),Y=d.memoizedState,U!==b||we!==Y||xs.current||Zo?(typeof be=="function"&&(v0(d,g,be,b),Y=d.memoizedState),(U=Zo||Qk(d,g,U,b,we,Y,de))?(Se||typeof A.UNSAFE_componentWillMount!="function"&&typeof A.componentWillMount!="function"||(typeof A.componentWillMount=="function"&&A.componentWillMount(),typeof A.UNSAFE_componentWillMount=="function"&&A.UNSAFE_componentWillMount()),typeof A.componentDidMount=="function"&&(d.flags|=4194308)):(typeof A.componentDidMount=="function"&&(d.flags|=4194308),d.memoizedProps=b,d.memoizedState=Y),A.props=b,A.state=Y,A.context=de,b=U):(typeof A.componentDidMount=="function"&&(d.flags|=4194308),b=!1)}else{A=d.stateNode,Nk(c,d),U=d.memoizedProps,de=d.type===d.elementType?U:kr(d.type,U),A.props=de,Se=d.pendingProps,we=A.context,Y=g.contextType,typeof Y=="object"&&Y!==null?Y=Qs(Y):(Y=vs(g)?qi:Yn.current,Y=ll(d,Y));var De=g.getDerivedStateFromProps;(be=typeof De=="function"||typeof A.getSnapshotBeforeUpdate=="function")||typeof A.UNSAFE_componentWillReceiveProps!="function"&&typeof A.componentWillReceiveProps!="function"||(U!==Se||we!==Y)&&Jk(d,A,b,Y),Zo=!1,we=d.memoizedState,A.state=we,op(d,b,A,C);var Pe=d.memoizedState;U!==Se||we!==Pe||xs.current||Zo?(typeof De=="function"&&(v0(d,g,De,b),Pe=d.memoizedState),(de=Zo||Qk(d,g,de,b,we,Pe,Y)||!1)?(be||typeof A.UNSAFE_componentWillUpdate!="function"&&typeof A.componentWillUpdate!="function"||(typeof A.componentWillUpdate=="function"&&A.componentWillUpdate(b,Pe,Y),typeof A.UNSAFE_componentWillUpdate=="function"&&A.UNSAFE_componentWillUpdate(b,Pe,Y)),typeof A.componentDidUpdate=="function"&&(d.flags|=4),typeof A.getSnapshotBeforeUpdate=="function"&&(d.flags|=1024)):(typeof A.componentDidUpdate!="function"||U===c.memoizedProps&&we===c.memoizedState||(d.flags|=4),typeof A.getSnapshotBeforeUpdate!="function"||U===c.memoizedProps&&we===c.memoizedState||(d.flags|=1024),d.memoizedProps=b,d.memoizedState=Pe),A.props=b,A.state=Pe,A.context=Y,b=de):(typeof A.componentDidUpdate!="function"||U===c.memoizedProps&&we===c.memoizedState||(d.flags|=4),typeof A.getSnapshotBeforeUpdate!="function"||U===c.memoizedProps&&we===c.memoizedState||(d.flags|=1024),b=!1)}return k0(c,d,g,b,N,C)}function k0(c,d,g,b,C,N){uT(c,d);var A=(d.flags&128)!==0;if(!b&&!A)return C&&mk(d,g,!1),wo(c,d,N);b=d.stateNode,nM.current=d;var U=A&&typeof g.getDerivedStateFromError!="function"?null:b.render();return d.flags|=1,c!==null&&A?(d.child=dl(d,c.child,null,N),d.child=dl(d,null,U,N)):as(c,d,U,N),d.memoizedState=b.state,C&&mk(d,g,!0),d.child}function hT(c){var d=c.stateNode;d.pendingContext?pk(c,d.pendingContext,d.pendingContext!==d.context):d.context&&pk(c,d.context,!1),a0(c,d.containerInfo)}function dT(c,d,g,b,C){return hl(),e0(C),d.flags|=256,as(c,d,g,b),d.child}var T0={dehydrated:null,treeContext:null,retryLane:0};function N0(c){return{baseLanes:c,cachePool:null,transitions:null}}function pT(c,d,g){var b=d.pendingProps,C=Bt.current,N=!1,A=(d.flags&128)!==0,U;if((U=A)||(U=c!==null&&c.memoizedState===null?!1:(C&2)!==0),U?(N=!0,d.flags&=-129):(c===null||c.memoizedState!==null)&&(C|=1),It(Bt,C&1),c===null)return Jy(d),c=d.memoizedState,c!==null&&(c=c.dehydrated,c!==null)?((d.mode&1)===0?d.lanes=1:c.data==="$!"?d.lanes=8:d.lanes=1073741824,null):(A=b.children,c=b.fallback,N?(b=d.mode,N=d.child,A={mode:"hidden",children:A},(b&1)===0&&N!==null?(N.childLanes=0,N.pendingProps=A):N=Np(A,b,0,null),c=ra(c,b,g,null),N.return=d,c.return=d,N.sibling=c,d.child=N,d.child.memoizedState=N0(g),d.memoizedState=T0,c):I0(d,A));if(C=c.memoizedState,C!==null&&(U=C.dehydrated,U!==null))return sM(c,d,A,b,U,C,g);if(N){N=b.fallback,A=d.mode,C=c.child,U=C.sibling;var Y={mode:"hidden",children:b.children};return(A&1)===0&&d.child!==C?(b=d.child,b.childLanes=0,b.pendingProps=Y,d.deletions=null):(b=oi(C,Y),b.subtreeFlags=C.subtreeFlags&14680064),U!==null?N=oi(U,N):(N=ra(N,A,g,null),N.flags|=2),N.return=d,b.return=d,b.sibling=N,d.child=b,b=N,N=d.child,A=c.child.memoizedState,A=A===null?N0(g):{baseLanes:A.baseLanes|g,cachePool:null,transitions:A.transitions},N.memoizedState=A,N.childLanes=c.childLanes&~g,d.memoizedState=T0,b}return N=c.child,c=N.sibling,b=oi(N,{mode:"visible",children:b.children}),(d.mode&1)===0&&(b.lanes=g),b.return=d,b.sibling=null,c!==null&&(g=d.deletions,g===null?(d.deletions=[c],d.flags|=16):g.push(c)),d.child=b,d.memoizedState=null,b}function I0(c,d){return d=Np({mode:"visible",children:d},c.mode,0,null),d.return=c,c.child=d}function pp(c,d,g,b){return b!==null&&e0(b),dl(d,c.child,null,g),c=I0(d,d.pendingProps.children),c.flags|=2,d.memoizedState=null,c}function sM(c,d,g,b,C,N,A){if(g)return d.flags&256?(d.flags&=-257,b=b0(Error(t(422))),pp(c,d,A,b)):d.memoizedState!==null?(d.child=c.child,d.flags|=128,null):(N=b.fallback,C=d.mode,b=Np({mode:"visible",children:b.children},C,0,null),N=ra(N,C,A,null),N.flags|=2,b.return=d,N.return=d,b.sibling=N,d.child=b,(d.mode&1)!==0&&dl(d,c.child,null,A),d.child.memoizedState=N0(A),d.memoizedState=T0,N);if((d.mode&1)===0)return pp(c,d,A,null);if(C.data==="$!"){if(b=C.nextSibling&&C.nextSibling.dataset,b)var U=b.dgst;return b=U,N=Error(t(419)),b=b0(N,b,void 0),pp(c,d,A,b)}if(U=(A&c.childLanes)!==0,ws||U){if(b=Rn,b!==null){switch(A&-A){case 4:C=2;break;case 16:C=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:C=32;break;case 536870912:C=268435456;break;default:C=0}C=(C&(b.suspendedLanes|A))!==0?0:C,C!==0&&C!==N.retryLane&&(N.retryLane=C,xo(c,C),Ir(b,c,C,-1))}return U0(),b=b0(Error(t(421))),pp(c,d,A,b)}return C.data==="$?"?(d.flags|=128,d.child=c.child,d=gM.bind(null,c),C._reactRetry=d,null):(c=N.treeContext,Bs=qo(C.nextSibling),Vs=d,Pt=!0,Cr=null,c!==null&&(Xs[Ys++]=go,Xs[Ys++]=yo,Xs[Ys++]=Xi,go=c.id,yo=c.overflow,Xi=d),d=I0(d,b.children),d.flags|=4096,d)}function fT(c,d,g){c.lanes|=d;var b=c.alternate;b!==null&&(b.lanes|=d),r0(c.return,d,g)}function $0(c,d,g,b,C){var N=c.memoizedState;N===null?c.memoizedState={isBackwards:d,rendering:null,renderingStartTime:0,last:b,tail:g,tailMode:C}:(N.isBackwards=d,N.rendering=null,N.renderingStartTime=0,N.last=b,N.tail=g,N.tailMode=C)}function mT(c,d,g){var b=d.pendingProps,C=b.revealOrder,N=b.tail;if(as(c,d,b.children,g),b=Bt.current,(b&2)!==0)b=b&1|2,d.flags|=128;else{if(c!==null&&(c.flags&128)!==0)e:for(c=d.child;c!==null;){if(c.tag===13)c.memoizedState!==null&&fT(c,g,d);else if(c.tag===19)fT(c,g,d);else if(c.child!==null){c.child.return=c,c=c.child;continue}if(c===d)break e;for(;c.sibling===null;){if(c.return===null||c.return===d)break e;c=c.return}c.sibling.return=c.return,c=c.sibling}b&=1}if(It(Bt,b),(d.mode&1)===0)d.memoizedState=null;else switch(C){case"forwards":for(g=d.child,C=null;g!==null;)c=g.alternate,c!==null&&ip(c)===null&&(C=g),g=g.sibling;g=C,g===null?(C=d.child,d.child=null):(C=g.sibling,g.sibling=null),$0(d,!1,C,g,N);break;case"backwards":for(g=null,C=d.child,d.child=null;C!==null;){if(c=C.alternate,c!==null&&ip(c)===null){d.child=C;break}c=C.sibling,C.sibling=g,g=C,C=c}$0(d,!0,g,null,N);break;case"together":$0(d,!1,null,null,void 0);break;default:d.memoizedState=null}return d.child}function fp(c,d){(d.mode&1)===0&&c!==null&&(c.alternate=null,d.alternate=null,d.flags|=2)}function wo(c,d,g){if(c!==null&&(d.dependencies=c.dependencies),ea|=d.lanes,(g&d.childLanes)===0)return null;if(c!==null&&d.child!==c.child)throw Error(t(153));if(d.child!==null){for(c=d.child,g=oi(c,c.pendingProps),d.child=g,g.return=d;c.sibling!==null;)c=c.sibling,g=g.sibling=oi(c,c.pendingProps),g.return=d;g.sibling=null}return d.child}function rM(c,d,g){switch(d.tag){case 3:hT(d),hl();break;case 5:Ek(d);break;case 1:vs(d.type)&&Yd(d);break;case 4:a0(d,d.stateNode.containerInfo);break;case 10:var b=d.type._context,C=d.memoizedProps.value;It(np,b._currentValue),b._currentValue=C;break;case 13:if(b=d.memoizedState,b!==null)return b.dehydrated!==null?(It(Bt,Bt.current&1),d.flags|=128,null):(g&d.child.childLanes)!==0?pT(c,d,g):(It(Bt,Bt.current&1),c=wo(c,d,g),c!==null?c.sibling:null);It(Bt,Bt.current&1);break;case 19:if(b=(g&d.childLanes)!==0,(c.flags&128)!==0){if(b)return mT(c,d,g);d.flags|=128}if(C=d.memoizedState,C!==null&&(C.rendering=null,C.tail=null,C.lastEffect=null),It(Bt,Bt.current),b)break;return null;case 22:case 23:return d.lanes=0,lT(c,d,g)}return wo(c,d,g)}var gT,E0,yT,xT;gT=function(c,d){for(var g=d.child;g!==null;){if(g.tag===5||g.tag===6)c.appendChild(g.stateNode);else if(g.tag!==4&&g.child!==null){g.child.return=g,g=g.child;continue}if(g===d)break;for(;g.sibling===null;){if(g.return===null||g.return===d)return;g=g.return}g.sibling.return=g.return,g=g.sibling}},E0=function(){},yT=function(c,d,g,b){var C=c.memoizedProps;if(C!==b){c=d.stateNode,Zi(jr.current);var N=null;switch(g){case"input":C=Qe(c,C),b=Qe(c,b),N=[];break;case"select":C=B({},C,{value:void 0}),b=B({},b,{value:void 0}),N=[];break;case"textarea":C=xt(c,C),b=xt(c,b),N=[];break;default:typeof C.onClick!="function"&&typeof b.onClick=="function"&&(c.onclick=Kd)}uy(g,b);var A;g=null;for(de in C)if(!b.hasOwnProperty(de)&&C.hasOwnProperty(de)&&C[de]!=null)if(de==="style"){var U=C[de];for(A in U)U.hasOwnProperty(A)&&(g||(g={}),g[A]="")}else de!=="dangerouslySetInnerHTML"&&de!=="children"&&de!=="suppressContentEditableWarning"&&de!=="suppressHydrationWarning"&&de!=="autoFocus"&&(r.hasOwnProperty(de)?N||(N=[]):(N=N||[]).push(de,null));for(de in b){var Y=b[de];if(U=C!=null?C[de]:void 0,b.hasOwnProperty(de)&&Y!==U&&(Y!=null||U!=null))if(de==="style")if(U){for(A in U)!U.hasOwnProperty(A)||Y&&Y.hasOwnProperty(A)||(g||(g={}),g[A]="");for(A in Y)Y.hasOwnProperty(A)&&U[A]!==Y[A]&&(g||(g={}),g[A]=Y[A])}else g||(N||(N=[]),N.push(de,g)),g=Y;else de==="dangerouslySetInnerHTML"?(Y=Y?Y.__html:void 0,U=U?U.__html:void 0,Y!=null&&U!==Y&&(N=N||[]).push(de,Y)):de==="children"?typeof Y!="string"&&typeof Y!="number"||(N=N||[]).push(de,""+Y):de!=="suppressContentEditableWarning"&&de!=="suppressHydrationWarning"&&(r.hasOwnProperty(de)?(Y!=null&&de==="onScroll"&&At("scroll",c),N||U===Y||(N=[])):(N=N||[]).push(de,Y))}g&&(N=N||[]).push("style",g);var de=N;(d.updateQueue=de)&&(d.flags|=4)}},xT=function(c,d,g,b){g!==b&&(d.flags|=4)};function oc(c,d){if(!Pt)switch(c.tailMode){case"hidden":d=c.tail;for(var g=null;d!==null;)d.alternate!==null&&(g=d),d=d.sibling;g===null?c.tail=null:g.sibling=null;break;case"collapsed":g=c.tail;for(var b=null;g!==null;)g.alternate!==null&&(b=g),g=g.sibling;b===null?d||c.tail===null?c.tail=null:c.tail.sibling=null:b.sibling=null}}function Zn(c){var d=c.alternate!==null&&c.alternate.child===c.child,g=0,b=0;if(d)for(var C=c.child;C!==null;)g|=C.lanes|C.childLanes,b|=C.subtreeFlags&14680064,b|=C.flags&14680064,C.return=c,C=C.sibling;else for(C=c.child;C!==null;)g|=C.lanes|C.childLanes,b|=C.subtreeFlags,b|=C.flags,C.return=c,C=C.sibling;return c.subtreeFlags|=b,c.childLanes=g,d}function oM(c,d,g){var b=d.pendingProps;switch(Qy(d),d.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Zn(d),null;case 1:return vs(d.type)&&Xd(),Zn(d),null;case 3:return b=d.stateNode,ml(),Ot(xs),Ot(Yn),c0(),b.pendingContext&&(b.context=b.pendingContext,b.pendingContext=null),(c===null||c.child===null)&&(ep(d)?d.flags|=4:c===null||c.memoizedState.isDehydrated&&(d.flags&256)===0||(d.flags|=1024,Cr!==null&&(V0(Cr),Cr=null))),E0(c,d),Zn(d),null;case 5:l0(d);var C=Zi(ec.current);if(g=d.type,c!==null&&d.stateNode!=null)yT(c,d,g,b,C),c.ref!==d.ref&&(d.flags|=512,d.flags|=2097152);else{if(!b){if(d.stateNode===null)throw Error(t(166));return Zn(d),null}if(c=Zi(jr.current),ep(d)){b=d.stateNode,g=d.type;var N=d.memoizedProps;switch(b[Gr]=d,b[Xu]=N,c=(d.mode&1)!==0,g){case"dialog":At("cancel",b),At("close",b);break;case"iframe":case"object":case"embed":At("load",b);break;case"video":case"audio":for(C=0;C<Hu.length;C++)At(Hu[C],b);break;case"source":At("error",b);break;case"img":case"image":case"link":At("error",b),At("load",b);break;case"details":At("toggle",b);break;case"input":Je(b,N),At("invalid",b);break;case"select":b._wrapperState={wasMultiple:!!N.multiple},At("invalid",b);break;case"textarea":Kt(b,N),At("invalid",b)}uy(g,N),C=null;for(var A in N)if(N.hasOwnProperty(A)){var U=N[A];A==="children"?typeof U=="string"?b.textContent!==U&&(N.suppressHydrationWarning!==!0&&Hd(b.textContent,U,c),C=["children",U]):typeof U=="number"&&b.textContent!==""+U&&(N.suppressHydrationWarning!==!0&&Hd(b.textContent,U,c),C=["children",""+U]):r.hasOwnProperty(A)&&U!=null&&A==="onScroll"&&At("scroll",b)}switch(g){case"input":Re(b),rt(b,N,!0);break;case"textarea":Re(b),qt(b);break;case"select":case"option":break;default:typeof N.onClick=="function"&&(b.onclick=Kd)}b=C,d.updateQueue=b,b!==null&&(d.flags|=4)}else{A=C.nodeType===9?C:C.ownerDocument,c==="http://www.w3.org/1999/xhtml"&&(c=an(g)),c==="http://www.w3.org/1999/xhtml"?g==="script"?(c=A.createElement("div"),c.innerHTML="<script><\/script>",c=c.removeChild(c.firstChild)):typeof b.is=="string"?c=A.createElement(g,{is:b.is}):(c=A.createElement(g),g==="select"&&(A=c,b.multiple?A.multiple=!0:b.size&&(A.size=b.size))):c=A.createElementNS(c,g),c[Gr]=d,c[Xu]=b,gT(c,d,!1,!1),d.stateNode=c;e:{switch(A=cy(g,b),g){case"dialog":At("cancel",c),At("close",c),C=b;break;case"iframe":case"object":case"embed":At("load",c),C=b;break;case"video":case"audio":for(C=0;C<Hu.length;C++)At(Hu[C],c);C=b;break;case"source":At("error",c),C=b;break;case"img":case"image":case"link":At("error",c),At("load",c),C=b;break;case"details":At("toggle",c),C=b;break;case"input":Je(c,b),C=Qe(c,b),At("invalid",c);break;case"option":C=b;break;case"select":c._wrapperState={wasMultiple:!!b.multiple},C=B({},b,{value:void 0}),At("invalid",c);break;case"textarea":Kt(c,b),C=xt(c,b),At("invalid",c);break;default:C=b}uy(g,C),U=C;for(N in U)if(U.hasOwnProperty(N)){var Y=U[N];N==="style"?Ya(c,Y):N==="dangerouslySetInnerHTML"?(Y=Y?Y.__html:void 0,Y!=null&&gs(c,Y)):N==="children"?typeof Y=="string"?(g!=="textarea"||Y!=="")&&ys(c,Y):typeof Y=="number"&&ys(c,""+Y):N!=="suppressContentEditableWarning"&&N!=="suppressHydrationWarning"&&N!=="autoFocus"&&(r.hasOwnProperty(N)?Y!=null&&N==="onScroll"&&At("scroll",c):Y!=null&&k(c,N,Y,A))}switch(g){case"input":Re(c),rt(c,b,!1);break;case"textarea":Re(c),qt(c);break;case"option":b.value!=null&&c.setAttribute("value",""+xe(b.value));break;case"select":c.multiple=!!b.multiple,N=b.value,N!=null?Dt(c,!!b.multiple,N,!1):b.defaultValue!=null&&Dt(c,!!b.multiple,b.defaultValue,!0);break;default:typeof C.onClick=="function"&&(c.onclick=Kd)}switch(g){case"button":case"input":case"select":case"textarea":b=!!b.autoFocus;break e;case"img":b=!0;break e;default:b=!1}}b&&(d.flags|=4)}d.ref!==null&&(d.flags|=512,d.flags|=2097152)}return Zn(d),null;case 6:if(c&&d.stateNode!=null)xT(c,d,c.memoizedProps,b);else{if(typeof b!="string"&&d.stateNode===null)throw Error(t(166));if(g=Zi(ec.current),Zi(jr.current),ep(d)){if(b=d.stateNode,g=d.memoizedProps,b[Gr]=d,(N=b.nodeValue!==g)&&(c=Vs,c!==null))switch(c.tag){case 3:Hd(b.nodeValue,g,(c.mode&1)!==0);break;case 5:c.memoizedProps.suppressHydrationWarning!==!0&&Hd(b.nodeValue,g,(c.mode&1)!==0)}N&&(d.flags|=4)}else b=(g.nodeType===9?g:g.ownerDocument).createTextNode(b),b[Gr]=d,d.stateNode=b}return Zn(d),null;case 13:if(Ot(Bt),b=d.memoizedState,c===null||c.memoizedState!==null&&c.memoizedState.dehydrated!==null){if(Pt&&Bs!==null&&(d.mode&1)!==0&&(d.flags&128)===0)bk(),hl(),d.flags|=98560,N=!1;else if(N=ep(d),b!==null&&b.dehydrated!==null){if(c===null){if(!N)throw Error(t(318));if(N=d.memoizedState,N=N!==null?N.dehydrated:null,!N)throw Error(t(317));N[Gr]=d}else hl(),(d.flags&128)===0&&(d.memoizedState=null),d.flags|=4;Zn(d),N=!1}else Cr!==null&&(V0(Cr),Cr=null),N=!0;if(!N)return d.flags&65536?d:null}return(d.flags&128)!==0?(d.lanes=g,d):(b=b!==null,b!==(c!==null&&c.memoizedState!==null)&&b&&(d.child.flags|=8192,(d.mode&1)!==0&&(c===null||(Bt.current&1)!==0?bn===0&&(bn=3):U0())),d.updateQueue!==null&&(d.flags|=4),Zn(d),null);case 4:return ml(),E0(c,d),c===null&&Ku(d.stateNode.containerInfo),Zn(d),null;case 10:return s0(d.type._context),Zn(d),null;case 17:return vs(d.type)&&Xd(),Zn(d),null;case 19:if(Ot(Bt),N=d.memoizedState,N===null)return Zn(d),null;if(b=(d.flags&128)!==0,A=N.rendering,A===null)if(b)oc(N,!1);else{if(bn!==0||c!==null&&(c.flags&128)!==0)for(c=d.child;c!==null;){if(A=ip(c),A!==null){for(d.flags|=128,oc(N,!1),b=A.updateQueue,b!==null&&(d.updateQueue=b,d.flags|=4),d.subtreeFlags=0,b=g,g=d.child;g!==null;)N=g,c=b,N.flags&=14680066,A=N.alternate,A===null?(N.childLanes=0,N.lanes=c,N.child=null,N.subtreeFlags=0,N.memoizedProps=null,N.memoizedState=null,N.updateQueue=null,N.dependencies=null,N.stateNode=null):(N.childLanes=A.childLanes,N.lanes=A.lanes,N.child=A.child,N.subtreeFlags=0,N.deletions=null,N.memoizedProps=A.memoizedProps,N.memoizedState=A.memoizedState,N.updateQueue=A.updateQueue,N.type=A.type,c=A.dependencies,N.dependencies=c===null?null:{lanes:c.lanes,firstContext:c.firstContext}),g=g.sibling;return It(Bt,Bt.current&1|2),d.child}c=c.sibling}N.tail!==null&&sn()>vl&&(d.flags|=128,b=!0,oc(N,!1),d.lanes=4194304)}else{if(!b)if(c=ip(A),c!==null){if(d.flags|=128,b=!0,g=c.updateQueue,g!==null&&(d.updateQueue=g,d.flags|=4),oc(N,!0),N.tail===null&&N.tailMode==="hidden"&&!A.alternate&&!Pt)return Zn(d),null}else 2*sn()-N.renderingStartTime>vl&&g!==1073741824&&(d.flags|=128,b=!0,oc(N,!1),d.lanes=4194304);N.isBackwards?(A.sibling=d.child,d.child=A):(g=N.last,g!==null?g.sibling=A:d.child=A,N.last=A)}return N.tail!==null?(d=N.tail,N.rendering=d,N.tail=d.sibling,N.renderingStartTime=sn(),d.sibling=null,g=Bt.current,It(Bt,b?g&1|2:g&1),d):(Zn(d),null);case 22:case 23:return W0(),b=d.memoizedState!==null,c!==null&&c.memoizedState!==null!==b&&(d.flags|=8192),b&&(d.mode&1)!==0?(Ws&1073741824)!==0&&(Zn(d),d.subtreeFlags&6&&(d.flags|=8192)):Zn(d),null;case 24:return null;case 25:return null}throw Error(t(156,d.tag))}function iM(c,d){switch(Qy(d),d.tag){case 1:return vs(d.type)&&Xd(),c=d.flags,c&65536?(d.flags=c&-65537|128,d):null;case 3:return ml(),Ot(xs),Ot(Yn),c0(),c=d.flags,(c&65536)!==0&&(c&128)===0?(d.flags=c&-65537|128,d):null;case 5:return l0(d),null;case 13:if(Ot(Bt),c=d.memoizedState,c!==null&&c.dehydrated!==null){if(d.alternate===null)throw Error(t(340));hl()}return c=d.flags,c&65536?(d.flags=c&-65537|128,d):null;case 19:return Ot(Bt),null;case 4:return ml(),null;case 10:return s0(d.type._context),null;case 22:case 23:return W0(),null;case 24:return null;default:return null}}var mp=!1,Jn=!1,aM=typeof WeakSet=="function"?WeakSet:Set,Oe=null;function yl(c,d){var g=c.ref;if(g!==null)if(typeof g=="function")try{g(null)}catch(b){Xt(c,d,b)}else g.current=null}function R0(c,d,g){try{g()}catch(b){Xt(c,d,b)}}var vT=!1;function lM(c,d){if(Wy=Fd,c=QC(),_y(c)){if("selectionStart"in c)var g={start:c.selectionStart,end:c.selectionEnd};else e:{g=(g=c.ownerDocument)&&g.defaultView||window;var b=g.getSelection&&g.getSelection();if(b&&b.rangeCount!==0){g=b.anchorNode;var C=b.anchorOffset,N=b.focusNode;b=b.focusOffset;try{g.nodeType,N.nodeType}catch{g=null;break e}var A=0,U=-1,Y=-1,de=0,be=0,Se=c,we=null;t:for(;;){for(var De;Se!==g||C!==0&&Se.nodeType!==3||(U=A+C),Se!==N||b!==0&&Se.nodeType!==3||(Y=A+b),Se.nodeType===3&&(A+=Se.nodeValue.length),(De=Se.firstChild)!==null;)we=Se,Se=De;for(;;){if(Se===c)break t;if(we===g&&++de===C&&(U=A),we===N&&++be===b&&(Y=A),(De=Se.nextSibling)!==null)break;Se=we,we=Se.parentNode}Se=De}g=U===-1||Y===-1?null:{start:U,end:Y}}else g=null}g=g||{start:0,end:0}}else g=null;for(Uy={focusedElem:c,selectionRange:g},Fd=!1,Oe=d;Oe!==null;)if(d=Oe,c=d.child,(d.subtreeFlags&1028)!==0&&c!==null)c.return=d,Oe=c;else for(;Oe!==null;){d=Oe;try{var Pe=d.alternate;if((d.flags&1024)!==0)switch(d.tag){case 0:case 11:case 15:break;case 1:if(Pe!==null){var ze=Pe.memoizedProps,rn=Pe.memoizedState,le=d.stateNode,ne=le.getSnapshotBeforeUpdate(d.elementType===d.type?ze:kr(d.type,ze),rn);le.__reactInternalSnapshotBeforeUpdate=ne}break;case 3:var ce=d.stateNode.containerInfo;ce.nodeType===1?ce.textContent="":ce.nodeType===9&&ce.documentElement&&ce.removeChild(ce.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(t(163))}}catch(Ce){Xt(d,d.return,Ce)}if(c=d.sibling,c!==null){c.return=d.return,Oe=c;break}Oe=d.return}return Pe=vT,vT=!1,Pe}function ic(c,d,g){var b=d.updateQueue;if(b=b!==null?b.lastEffect:null,b!==null){var C=b=b.next;do{if((C.tag&c)===c){var N=C.destroy;C.destroy=void 0,N!==void 0&&R0(d,g,N)}C=C.next}while(C!==b)}}function gp(c,d){if(d=d.updateQueue,d=d!==null?d.lastEffect:null,d!==null){var g=d=d.next;do{if((g.tag&c)===c){var b=g.create;g.destroy=b()}g=g.next}while(g!==d)}}function D0(c){var d=c.ref;if(d!==null){var g=c.stateNode;switch(c.tag){case 5:c=g;break;default:c=g}typeof d=="function"?d(c):d.current=c}}function wT(c){var d=c.alternate;d!==null&&(c.alternate=null,wT(d)),c.child=null,c.deletions=null,c.sibling=null,c.tag===5&&(d=c.stateNode,d!==null&&(delete d[Gr],delete d[Xu],delete d[Ky],delete d[G3],delete d[j3])),c.stateNode=null,c.return=null,c.dependencies=null,c.memoizedProps=null,c.memoizedState=null,c.pendingProps=null,c.stateNode=null,c.updateQueue=null}function bT(c){return c.tag===5||c.tag===3||c.tag===4}function ST(c){e:for(;;){for(;c.sibling===null;){if(c.return===null||bT(c.return))return null;c=c.return}for(c.sibling.return=c.return,c=c.sibling;c.tag!==5&&c.tag!==6&&c.tag!==18;){if(c.flags&2||c.child===null||c.tag===4)continue e;c.child.return=c,c=c.child}if(!(c.flags&2))return c.stateNode}}function A0(c,d,g){var b=c.tag;if(b===5||b===6)c=c.stateNode,d?g.nodeType===8?g.parentNode.insertBefore(c,d):g.insertBefore(c,d):(g.nodeType===8?(d=g.parentNode,d.insertBefore(c,g)):(d=g,d.appendChild(c)),g=g._reactRootContainer,g!=null||d.onclick!==null||(d.onclick=Kd));else if(b!==4&&(c=c.child,c!==null))for(A0(c,d,g),c=c.sibling;c!==null;)A0(c,d,g),c=c.sibling}function O0(c,d,g){var b=c.tag;if(b===5||b===6)c=c.stateNode,d?g.insertBefore(c,d):g.appendChild(c);else if(b!==4&&(c=c.child,c!==null))for(O0(c,d,g),c=c.sibling;c!==null;)O0(c,d,g),c=c.sibling}var Wn=null,Tr=!1;function ei(c,d,g){for(g=g.child;g!==null;)CT(c,d,g),g=g.sibling}function CT(c,d,g){if(Ur&&typeof Ur.onCommitFiberUnmount=="function")try{Ur.onCommitFiberUnmount(Ed,g)}catch{}switch(g.tag){case 5:Jn||yl(g,d);case 6:var b=Wn,C=Tr;Wn=null,ei(c,d,g),Wn=b,Tr=C,Wn!==null&&(Tr?(c=Wn,g=g.stateNode,c.nodeType===8?c.parentNode.removeChild(g):c.removeChild(g)):Wn.removeChild(g.stateNode));break;case 18:Wn!==null&&(Tr?(c=Wn,g=g.stateNode,c.nodeType===8?Hy(c.parentNode,g):c.nodeType===1&&Hy(c,g),Mu(c)):Hy(Wn,g.stateNode));break;case 4:b=Wn,C=Tr,Wn=g.stateNode.containerInfo,Tr=!0,ei(c,d,g),Wn=b,Tr=C;break;case 0:case 11:case 14:case 15:if(!Jn&&(b=g.updateQueue,b!==null&&(b=b.lastEffect,b!==null))){C=b=b.next;do{var N=C,A=N.destroy;N=N.tag,A!==void 0&&((N&2)!==0||(N&4)!==0)&&R0(g,d,A),C=C.next}while(C!==b)}ei(c,d,g);break;case 1:if(!Jn&&(yl(g,d),b=g.stateNode,typeof b.componentWillUnmount=="function"))try{b.props=g.memoizedProps,b.state=g.memoizedState,b.componentWillUnmount()}catch(U){Xt(g,d,U)}ei(c,d,g);break;case 21:ei(c,d,g);break;case 22:g.mode&1?(Jn=(b=Jn)||g.memoizedState!==null,ei(c,d,g),Jn=b):ei(c,d,g);break;default:ei(c,d,g)}}function kT(c){var d=c.updateQueue;if(d!==null){c.updateQueue=null;var g=c.stateNode;g===null&&(g=c.stateNode=new aM),d.forEach(function(b){var C=yM.bind(null,c,b);g.has(b)||(g.add(b),b.then(C,C))})}}function Nr(c,d){var g=d.deletions;if(g!==null)for(var b=0;b<g.length;b++){var C=g[b];try{var N=c,A=d,U=A;e:for(;U!==null;){switch(U.tag){case 5:Wn=U.stateNode,Tr=!1;break e;case 3:Wn=U.stateNode.containerInfo,Tr=!0;break e;case 4:Wn=U.stateNode.containerInfo,Tr=!0;break e}U=U.return}if(Wn===null)throw Error(t(160));CT(N,A,C),Wn=null,Tr=!1;var Y=C.alternate;Y!==null&&(Y.return=null),C.return=null}catch(de){Xt(C,d,de)}}if(d.subtreeFlags&12854)for(d=d.child;d!==null;)TT(d,c),d=d.sibling}function TT(c,d){var g=c.alternate,b=c.flags;switch(c.tag){case 0:case 11:case 14:case 15:if(Nr(d,c),Kr(c),b&4){try{ic(3,c,c.return),gp(3,c)}catch(ze){Xt(c,c.return,ze)}try{ic(5,c,c.return)}catch(ze){Xt(c,c.return,ze)}}break;case 1:Nr(d,c),Kr(c),b&512&&g!==null&&yl(g,g.return);break;case 5:if(Nr(d,c),Kr(c),b&512&&g!==null&&yl(g,g.return),c.flags&32){var C=c.stateNode;try{ys(C,"")}catch(ze){Xt(c,c.return,ze)}}if(b&4&&(C=c.stateNode,C!=null)){var N=c.memoizedProps,A=g!==null?g.memoizedProps:N,U=c.type,Y=c.updateQueue;if(c.updateQueue=null,Y!==null)try{U==="input"&&N.type==="radio"&&N.name!=null&&Ke(C,N),cy(U,A);var de=cy(U,N);for(A=0;A<Y.length;A+=2){var be=Y[A],Se=Y[A+1];be==="style"?Ya(C,Se):be==="dangerouslySetInnerHTML"?gs(C,Se):be==="children"?ys(C,Se):k(C,be,Se,de)}switch(U){case"input":st(C,N);break;case"textarea":Vt(C,N);break;case"select":var we=C._wrapperState.wasMultiple;C._wrapperState.wasMultiple=!!N.multiple;var De=N.value;De!=null?Dt(C,!!N.multiple,De,!1):we!==!!N.multiple&&(N.defaultValue!=null?Dt(C,!!N.multiple,N.defaultValue,!0):Dt(C,!!N.multiple,N.multiple?[]:"",!1))}C[Xu]=N}catch(ze){Xt(c,c.return,ze)}}break;case 6:if(Nr(d,c),Kr(c),b&4){if(c.stateNode===null)throw Error(t(162));C=c.stateNode,N=c.memoizedProps;try{C.nodeValue=N}catch(ze){Xt(c,c.return,ze)}}break;case 3:if(Nr(d,c),Kr(c),b&4&&g!==null&&g.memoizedState.isDehydrated)try{Mu(d.containerInfo)}catch(ze){Xt(c,c.return,ze)}break;case 4:Nr(d,c),Kr(c);break;case 13:Nr(d,c),Kr(c),C=c.child,C.flags&8192&&(N=C.memoizedState!==null,C.stateNode.isHidden=N,!N||C.alternate!==null&&C.alternate.memoizedState!==null||(P0=sn())),b&4&&kT(c);break;case 22:if(be=g!==null&&g.memoizedState!==null,c.mode&1?(Jn=(de=Jn)||be,Nr(d,c),Jn=de):Nr(d,c),Kr(c),b&8192){if(de=c.memoizedState!==null,(c.stateNode.isHidden=de)&&!be&&(c.mode&1)!==0)for(Oe=c,be=c.child;be!==null;){for(Se=Oe=be;Oe!==null;){switch(we=Oe,De=we.child,we.tag){case 0:case 11:case 14:case 15:ic(4,we,we.return);break;case 1:yl(we,we.return);var Pe=we.stateNode;if(typeof Pe.componentWillUnmount=="function"){b=we,g=we.return;try{d=b,Pe.props=d.memoizedProps,Pe.state=d.memoizedState,Pe.componentWillUnmount()}catch(ze){Xt(b,g,ze)}}break;case 5:yl(we,we.return);break;case 22:if(we.memoizedState!==null){$T(Se);continue}}De!==null?(De.return=we,Oe=De):$T(Se)}be=be.sibling}e:for(be=null,Se=c;;){if(Se.tag===5){if(be===null){be=Se;try{C=Se.stateNode,de?(N=C.style,typeof N.setProperty=="function"?N.setProperty("display","none","important"):N.display="none"):(U=Se.stateNode,Y=Se.memoizedProps.style,A=Y!=null&&Y.hasOwnProperty("display")?Y.display:null,U.style.display=wr("display",A))}catch(ze){Xt(c,c.return,ze)}}}else if(Se.tag===6){if(be===null)try{Se.stateNode.nodeValue=de?"":Se.memoizedProps}catch(ze){Xt(c,c.return,ze)}}else if((Se.tag!==22&&Se.tag!==23||Se.memoizedState===null||Se===c)&&Se.child!==null){Se.child.return=Se,Se=Se.child;continue}if(Se===c)break e;for(;Se.sibling===null;){if(Se.return===null||Se.return===c)break e;be===Se&&(be=null),Se=Se.return}be===Se&&(be=null),Se.sibling.return=Se.return,Se=Se.sibling}}break;case 19:Nr(d,c),Kr(c),b&4&&kT(c);break;case 21:break;default:Nr(d,c),Kr(c)}}function Kr(c){var d=c.flags;if(d&2){try{e:{for(var g=c.return;g!==null;){if(bT(g)){var b=g;break e}g=g.return}throw Error(t(160))}switch(b.tag){case 5:var C=b.stateNode;b.flags&32&&(ys(C,""),b.flags&=-33);var N=ST(c);O0(c,N,C);break;case 3:case 4:var A=b.stateNode.containerInfo,U=ST(c);A0(c,U,A);break;default:throw Error(t(161))}}catch(Y){Xt(c,c.return,Y)}c.flags&=-3}d&4096&&(c.flags&=-4097)}function uM(c,d,g){Oe=c,NT(c)}function NT(c,d,g){for(var b=(c.mode&1)!==0;Oe!==null;){var C=Oe,N=C.child;if(C.tag===22&&b){var A=C.memoizedState!==null||mp;if(!A){var U=C.alternate,Y=U!==null&&U.memoizedState!==null||Jn;U=mp;var de=Jn;if(mp=A,(Jn=Y)&&!de)for(Oe=C;Oe!==null;)A=Oe,Y=A.child,A.tag===22&&A.memoizedState!==null?ET(C):Y!==null?(Y.return=A,Oe=Y):ET(C);for(;N!==null;)Oe=N,NT(N),N=N.sibling;Oe=C,mp=U,Jn=de}IT(c)}else(C.subtreeFlags&8772)!==0&&N!==null?(N.return=C,Oe=N):IT(c)}}function IT(c){for(;Oe!==null;){var d=Oe;if((d.flags&8772)!==0){var g=d.alternate;try{if((d.flags&8772)!==0)switch(d.tag){case 0:case 11:case 15:Jn||gp(5,d);break;case 1:var b=d.stateNode;if(d.flags&4&&!Jn)if(g===null)b.componentDidMount();else{var C=d.elementType===d.type?g.memoizedProps:kr(d.type,g.memoizedProps);b.componentDidUpdate(C,g.memoizedState,b.__reactInternalSnapshotBeforeUpdate)}var N=d.updateQueue;N!==null&&$k(d,N,b);break;case 3:var A=d.updateQueue;if(A!==null){if(g=null,d.child!==null)switch(d.child.tag){case 5:g=d.child.stateNode;break;case 1:g=d.child.stateNode}$k(d,A,g)}break;case 5:var U=d.stateNode;if(g===null&&d.flags&4){g=U;var Y=d.memoizedProps;switch(d.type){case"button":case"input":case"select":case"textarea":Y.autoFocus&&g.focus();break;case"img":Y.src&&(g.src=Y.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(d.memoizedState===null){var de=d.alternate;if(de!==null){var be=de.memoizedState;if(be!==null){var Se=be.dehydrated;Se!==null&&Mu(Se)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(t(163))}Jn||d.flags&512&&D0(d)}catch(we){Xt(d,d.return,we)}}if(d===c){Oe=null;break}if(g=d.sibling,g!==null){g.return=d.return,Oe=g;break}Oe=d.return}}function $T(c){for(;Oe!==null;){var d=Oe;if(d===c){Oe=null;break}var g=d.sibling;if(g!==null){g.return=d.return,Oe=g;break}Oe=d.return}}function ET(c){for(;Oe!==null;){var d=Oe;try{switch(d.tag){case 0:case 11:case 15:var g=d.return;try{gp(4,d)}catch(Y){Xt(d,g,Y)}break;case 1:var b=d.stateNode;if(typeof b.componentDidMount=="function"){var C=d.return;try{b.componentDidMount()}catch(Y){Xt(d,C,Y)}}var N=d.return;try{D0(d)}catch(Y){Xt(d,N,Y)}break;case 5:var A=d.return;try{D0(d)}catch(Y){Xt(d,A,Y)}}}catch(Y){Xt(d,d.return,Y)}if(d===c){Oe=null;break}var U=d.sibling;if(U!==null){U.return=d.return,Oe=U;break}Oe=d.return}}var cM=Math.ceil,yp=T.ReactCurrentDispatcher,_0=T.ReactCurrentOwner,Js=T.ReactCurrentBatchConfig,gt=0,Rn=null,un=null,Un=0,Ws=0,xl=Xo(0),bn=0,ac=null,ea=0,xp=0,F0=0,lc=null,bs=null,P0=0,vl=1/0,bo=null,vp=!1,L0=null,ti=null,wp=!1,ni=null,bp=0,uc=0,M0=null,Sp=-1,Cp=0;function ls(){return(gt&6)!==0?sn():Sp!==-1?Sp:Sp=sn()}function si(c){return(c.mode&1)===0?1:(gt&2)!==0&&Un!==0?Un&-Un:K3.transition!==null?(Cp===0&&(Cp=SC()),Cp):(c=bt,c!==0||(c=window.event,c=c===void 0?16:DC(c.type)),c)}function Ir(c,d,g,b){if(50<uc)throw uc=0,M0=null,Error(t(185));Ou(c,g,b),((gt&2)===0||c!==Rn)&&(c===Rn&&((gt&2)===0&&(xp|=g),bn===4&&ri(c,Un)),Ss(c,b),g===1&&gt===0&&(d.mode&1)===0&&(vl=sn()+500,Qd&&Qo()))}function Ss(c,d){var g=c.callbackNode;KL(c,d);var b=Ad(c,c===Rn?Un:0);if(b===0)g!==null&&vC(g),c.callbackNode=null,c.callbackPriority=0;else if(d=b&-b,c.callbackPriority!==d){if(g!=null&&vC(g),d===1)c.tag===0?H3(DT.bind(null,c)):gk(DT.bind(null,c)),W3(function(){(gt&6)===0&&Qo()}),g=null;else{switch(CC(b)){case 1:g=yy;break;case 4:g=wC;break;case 16:g=$d;break;case 536870912:g=bC;break;default:g=$d}g=zT(g,RT.bind(null,c))}c.callbackPriority=d,c.callbackNode=g}}function RT(c,d){if(Sp=-1,Cp=0,(gt&6)!==0)throw Error(t(327));var g=c.callbackNode;if(wl()&&c.callbackNode!==g)return null;var b=Ad(c,c===Rn?Un:0);if(b===0)return null;if((b&30)!==0||(b&c.expiredLanes)!==0||d)d=kp(c,b);else{d=b;var C=gt;gt|=2;var N=OT();(Rn!==c||Un!==d)&&(bo=null,vl=sn()+500,na(c,d));do try{pM();break}catch(U){AT(c,U)}while(!0);n0(),yp.current=N,gt=C,un!==null?d=0:(Rn=null,Un=0,d=bn)}if(d!==0){if(d===2&&(C=xy(c),C!==0&&(b=C,d=z0(c,C))),d===1)throw g=ac,na(c,0),ri(c,b),Ss(c,sn()),g;if(d===6)ri(c,b);else{if(C=c.current.alternate,(b&30)===0&&!hM(C)&&(d=kp(c,b),d===2&&(N=xy(c),N!==0&&(b=N,d=z0(c,N))),d===1))throw g=ac,na(c,0),ri(c,b),Ss(c,sn()),g;switch(c.finishedWork=C,c.finishedLanes=b,d){case 0:case 1:throw Error(t(345));case 2:sa(c,bs,bo);break;case 3:if(ri(c,b),(b&130023424)===b&&(d=P0+500-sn(),10<d)){if(Ad(c,0)!==0)break;if(C=c.suspendedLanes,(C&b)!==b){ls(),c.pingedLanes|=c.suspendedLanes&C;break}c.timeoutHandle=jy(sa.bind(null,c,bs,bo),d);break}sa(c,bs,bo);break;case 4:if(ri(c,b),(b&4194240)===b)break;for(d=c.eventTimes,C=-1;0<b;){var A=31-br(b);N=1<<A,A=d[A],A>C&&(C=A),b&=~N}if(b=C,b=sn()-b,b=(120>b?120:480>b?480:1080>b?1080:1920>b?1920:3e3>b?3e3:4320>b?4320:1960*cM(b/1960))-b,10<b){c.timeoutHandle=jy(sa.bind(null,c,bs,bo),b);break}sa(c,bs,bo);break;case 5:sa(c,bs,bo);break;default:throw Error(t(329))}}}return Ss(c,sn()),c.callbackNode===g?RT.bind(null,c):null}function z0(c,d){var g=lc;return c.current.memoizedState.isDehydrated&&(na(c,d).flags|=256),c=kp(c,d),c!==2&&(d=bs,bs=g,d!==null&&V0(d)),c}function V0(c){bs===null?bs=c:bs.push.apply(bs,c)}function hM(c){for(var d=c;;){if(d.flags&16384){var g=d.updateQueue;if(g!==null&&(g=g.stores,g!==null))for(var b=0;b<g.length;b++){var C=g[b],N=C.getSnapshot;C=C.value;try{if(!Sr(N(),C))return!1}catch{return!1}}}if(g=d.child,d.subtreeFlags&16384&&g!==null)g.return=d,d=g;else{if(d===c)break;for(;d.sibling===null;){if(d.return===null||d.return===c)return!0;d=d.return}d.sibling.return=d.return,d=d.sibling}}return!0}function ri(c,d){for(d&=~F0,d&=~xp,c.suspendedLanes|=d,c.pingedLanes&=~d,c=c.expirationTimes;0<d;){var g=31-br(d),b=1<<g;c[g]=-1,d&=~b}}function DT(c){if((gt&6)!==0)throw Error(t(327));wl();var d=Ad(c,0);if((d&1)===0)return Ss(c,sn()),null;var g=kp(c,d);if(c.tag!==0&&g===2){var b=xy(c);b!==0&&(d=b,g=z0(c,b))}if(g===1)throw g=ac,na(c,0),ri(c,d),Ss(c,sn()),g;if(g===6)throw Error(t(345));return c.finishedWork=c.current.alternate,c.finishedLanes=d,sa(c,bs,bo),Ss(c,sn()),null}function B0(c,d){var g=gt;gt|=1;try{return c(d)}finally{gt=g,gt===0&&(vl=sn()+500,Qd&&Qo())}}function ta(c){ni!==null&&ni.tag===0&&(gt&6)===0&&wl();var d=gt;gt|=1;var g=Js.transition,b=bt;try{if(Js.transition=null,bt=1,c)return c()}finally{bt=b,Js.transition=g,gt=d,(gt&6)===0&&Qo()}}function W0(){Ws=xl.current,Ot(xl)}function na(c,d){c.finishedWork=null,c.finishedLanes=0;var g=c.timeoutHandle;if(g!==-1&&(c.timeoutHandle=-1,B3(g)),un!==null)for(g=un.return;g!==null;){var b=g;switch(Qy(b),b.tag){case 1:b=b.type.childContextTypes,b!=null&&Xd();break;case 3:ml(),Ot(xs),Ot(Yn),c0();break;case 5:l0(b);break;case 4:ml();break;case 13:Ot(Bt);break;case 19:Ot(Bt);break;case 10:s0(b.type._context);break;case 22:case 23:W0()}g=g.return}if(Rn=c,un=c=oi(c.current,null),Un=Ws=d,bn=0,ac=null,F0=xp=ea=0,bs=lc=null,Qi!==null){for(d=0;d<Qi.length;d++)if(g=Qi[d],b=g.interleaved,b!==null){g.interleaved=null;var C=b.next,N=g.pending;if(N!==null){var A=N.next;N.next=C,b.next=A}g.pending=b}Qi=null}return c}function AT(c,d){do{var g=un;try{if(n0(),ap.current=hp,lp){for(var b=Wt.memoizedState;b!==null;){var C=b.queue;C!==null&&(C.pending=null),b=b.next}lp=!1}if(Ji=0,En=wn=Wt=null,tc=!1,nc=0,_0.current=null,g===null||g.return===null){bn=1,ac=d,un=null;break}e:{var N=c,A=g.return,U=g,Y=d;if(d=Un,U.flags|=32768,Y!==null&&typeof Y=="object"&&typeof Y.then=="function"){var de=Y,be=U,Se=be.tag;if((be.mode&1)===0&&(Se===0||Se===11||Se===15)){var we=be.alternate;we?(be.updateQueue=we.updateQueue,be.memoizedState=we.memoizedState,be.lanes=we.lanes):(be.updateQueue=null,be.memoizedState=null)}var De=sT(A);if(De!==null){De.flags&=-257,rT(De,A,U,N,d),De.mode&1&&nT(N,de,d),d=De,Y=de;var Pe=d.updateQueue;if(Pe===null){var ze=new Set;ze.add(Y),d.updateQueue=ze}else Pe.add(Y);break e}else{if((d&1)===0){nT(N,de,d),U0();break e}Y=Error(t(426))}}else if(Pt&&U.mode&1){var rn=sT(A);if(rn!==null){(rn.flags&65536)===0&&(rn.flags|=256),rT(rn,A,U,N,d),e0(gl(Y,U));break e}}N=Y=gl(Y,U),bn!==4&&(bn=2),lc===null?lc=[N]:lc.push(N),N=A;do{switch(N.tag){case 3:N.flags|=65536,d&=-d,N.lanes|=d;var le=eT(N,Y,d);Ik(N,le);break e;case 1:U=Y;var ne=N.type,ce=N.stateNode;if((N.flags&128)===0&&(typeof ne.getDerivedStateFromError=="function"||ce!==null&&typeof ce.componentDidCatch=="function"&&(ti===null||!ti.has(ce)))){N.flags|=65536,d&=-d,N.lanes|=d;var Ce=tT(N,U,d);Ik(N,Ce);break e}}N=N.return}while(N!==null)}FT(g)}catch(Ve){d=Ve,un===g&&g!==null&&(un=g=g.return);continue}break}while(!0)}function OT(){var c=yp.current;return yp.current=hp,c===null?hp:c}function U0(){(bn===0||bn===3||bn===2)&&(bn=4),Rn===null||(ea&268435455)===0&&(xp&268435455)===0||ri(Rn,Un)}function kp(c,d){var g=gt;gt|=2;var b=OT();(Rn!==c||Un!==d)&&(bo=null,na(c,d));do try{dM();break}catch(C){AT(c,C)}while(!0);if(n0(),gt=g,yp.current=b,un!==null)throw Error(t(261));return Rn=null,Un=0,bn}function dM(){for(;un!==null;)_T(un)}function pM(){for(;un!==null&&!ML();)_T(un)}function _T(c){var d=MT(c.alternate,c,Ws);c.memoizedProps=c.pendingProps,d===null?FT(c):un=d,_0.current=null}function FT(c){var d=c;do{var g=d.alternate;if(c=d.return,(d.flags&32768)===0){if(g=oM(g,d,Ws),g!==null){un=g;return}}else{if(g=iM(g,d),g!==null){g.flags&=32767,un=g;return}if(c!==null)c.flags|=32768,c.subtreeFlags=0,c.deletions=null;else{bn=6,un=null;return}}if(d=d.sibling,d!==null){un=d;return}un=d=c}while(d!==null);bn===0&&(bn=5)}function sa(c,d,g){var b=bt,C=Js.transition;try{Js.transition=null,bt=1,fM(c,d,g,b)}finally{Js.transition=C,bt=b}return null}function fM(c,d,g,b){do wl();while(ni!==null);if((gt&6)!==0)throw Error(t(327));g=c.finishedWork;var C=c.finishedLanes;if(g===null)return null;if(c.finishedWork=null,c.finishedLanes=0,g===c.current)throw Error(t(177));c.callbackNode=null,c.callbackPriority=0;var N=g.lanes|g.childLanes;if(qL(c,N),c===Rn&&(un=Rn=null,Un=0),(g.subtreeFlags&2064)===0&&(g.flags&2064)===0||wp||(wp=!0,zT($d,function(){return wl(),null})),N=(g.flags&15990)!==0,(g.subtreeFlags&15990)!==0||N){N=Js.transition,Js.transition=null;var A=bt;bt=1;var U=gt;gt|=4,_0.current=null,lM(c,g),TT(g,c),_3(Uy),Fd=!!Wy,Uy=Wy=null,c.current=g,uM(g),zL(),gt=U,bt=A,Js.transition=N}else c.current=g;if(wp&&(wp=!1,ni=c,bp=C),N=c.pendingLanes,N===0&&(ti=null),WL(g.stateNode),Ss(c,sn()),d!==null)for(b=c.onRecoverableError,g=0;g<d.length;g++)C=d[g],b(C.value,{componentStack:C.stack,digest:C.digest});if(vp)throw vp=!1,c=L0,L0=null,c;return(bp&1)!==0&&c.tag!==0&&wl(),N=c.pendingLanes,(N&1)!==0?c===M0?uc++:(uc=0,M0=c):uc=0,Qo(),null}function wl(){if(ni!==null){var c=CC(bp),d=Js.transition,g=bt;try{if(Js.transition=null,bt=16>c?16:c,ni===null)var b=!1;else{if(c=ni,ni=null,bp=0,(gt&6)!==0)throw Error(t(331));var C=gt;for(gt|=4,Oe=c.current;Oe!==null;){var N=Oe,A=N.child;if((Oe.flags&16)!==0){var U=N.deletions;if(U!==null){for(var Y=0;Y<U.length;Y++){var de=U[Y];for(Oe=de;Oe!==null;){var be=Oe;switch(be.tag){case 0:case 11:case 15:ic(8,be,N)}var Se=be.child;if(Se!==null)Se.return=be,Oe=Se;else for(;Oe!==null;){be=Oe;var we=be.sibling,De=be.return;if(wT(be),be===de){Oe=null;break}if(we!==null){we.return=De,Oe=we;break}Oe=De}}}var Pe=N.alternate;if(Pe!==null){var ze=Pe.child;if(ze!==null){Pe.child=null;do{var rn=ze.sibling;ze.sibling=null,ze=rn}while(ze!==null)}}Oe=N}}if((N.subtreeFlags&2064)!==0&&A!==null)A.return=N,Oe=A;else e:for(;Oe!==null;){if(N=Oe,(N.flags&2048)!==0)switch(N.tag){case 0:case 11:case 15:ic(9,N,N.return)}var le=N.sibling;if(le!==null){le.return=N.return,Oe=le;break e}Oe=N.return}}var ne=c.current;for(Oe=ne;Oe!==null;){A=Oe;var ce=A.child;if((A.subtreeFlags&2064)!==0&&ce!==null)ce.return=A,Oe=ce;else e:for(A=ne;Oe!==null;){if(U=Oe,(U.flags&2048)!==0)try{switch(U.tag){case 0:case 11:case 15:gp(9,U)}}catch(Ve){Xt(U,U.return,Ve)}if(U===A){Oe=null;break e}var Ce=U.sibling;if(Ce!==null){Ce.return=U.return,Oe=Ce;break e}Oe=U.return}}if(gt=C,Qo(),Ur&&typeof Ur.onPostCommitFiberRoot=="function")try{Ur.onPostCommitFiberRoot(Ed,c)}catch{}b=!0}return b}finally{bt=g,Js.transition=d}}return!1}function PT(c,d,g){d=gl(g,d),d=eT(c,d,1),c=Jo(c,d,1),d=ls(),c!==null&&(Ou(c,1,d),Ss(c,d))}function Xt(c,d,g){if(c.tag===3)PT(c,c,g);else for(;d!==null;){if(d.tag===3){PT(d,c,g);break}else if(d.tag===1){var b=d.stateNode;if(typeof d.type.getDerivedStateFromError=="function"||typeof b.componentDidCatch=="function"&&(ti===null||!ti.has(b))){c=gl(g,c),c=tT(d,c,1),d=Jo(d,c,1),c=ls(),d!==null&&(Ou(d,1,c),Ss(d,c));break}}d=d.return}}function mM(c,d,g){var b=c.pingCache;b!==null&&b.delete(d),d=ls(),c.pingedLanes|=c.suspendedLanes&g,Rn===c&&(Un&g)===g&&(bn===4||bn===3&&(Un&130023424)===Un&&500>sn()-P0?na(c,0):F0|=g),Ss(c,d)}function LT(c,d){d===0&&((c.mode&1)===0?d=1:(d=Dd,Dd<<=1,(Dd&130023424)===0&&(Dd=4194304)));var g=ls();c=xo(c,d),c!==null&&(Ou(c,d,g),Ss(c,g))}function gM(c){var d=c.memoizedState,g=0;d!==null&&(g=d.retryLane),LT(c,g)}function yM(c,d){var g=0;switch(c.tag){case 13:var b=c.stateNode,C=c.memoizedState;C!==null&&(g=C.retryLane);break;case 19:b=c.stateNode;break;default:throw Error(t(314))}b!==null&&b.delete(d),LT(c,g)}var MT;MT=function(c,d,g){if(c!==null)if(c.memoizedProps!==d.pendingProps||xs.current)ws=!0;else{if((c.lanes&g)===0&&(d.flags&128)===0)return ws=!1,rM(c,d,g);ws=(c.flags&131072)!==0}else ws=!1,Pt&&(d.flags&1048576)!==0&&yk(d,Jd,d.index);switch(d.lanes=0,d.tag){case 2:var b=d.type;fp(c,d),c=d.pendingProps;var C=ll(d,Yn.current);fl(d,g),C=p0(null,d,b,c,C,g);var N=f0();return d.flags|=1,typeof C=="object"&&C!==null&&typeof C.render=="function"&&C.$$typeof===void 0?(d.tag=1,d.memoizedState=null,d.updateQueue=null,vs(b)?(N=!0,Yd(d)):N=!1,d.memoizedState=C.state!==null&&C.state!==void 0?C.state:null,i0(d),C.updater=dp,d.stateNode=C,C._reactInternals=d,w0(d,b,c,g),d=k0(null,d,b,!0,N,g)):(d.tag=0,Pt&&N&&Yy(d),as(null,d,C,g),d=d.child),d;case 16:b=d.elementType;e:{switch(fp(c,d),c=d.pendingProps,C=b._init,b=C(b._payload),d.type=b,C=d.tag=vM(b),c=kr(b,c),C){case 0:d=C0(null,d,b,c,g);break e;case 1:d=cT(null,d,b,c,g);break e;case 11:d=oT(null,d,b,c,g);break e;case 14:d=iT(null,d,b,kr(b.type,c),g);break e}throw Error(t(306,b,""))}return d;case 0:return b=d.type,C=d.pendingProps,C=d.elementType===b?C:kr(b,C),C0(c,d,b,C,g);case 1:return b=d.type,C=d.pendingProps,C=d.elementType===b?C:kr(b,C),cT(c,d,b,C,g);case 3:e:{if(hT(d),c===null)throw Error(t(387));b=d.pendingProps,N=d.memoizedState,C=N.element,Nk(c,d),op(d,b,null,g);var A=d.memoizedState;if(b=A.element,N.isDehydrated)if(N={element:b,isDehydrated:!1,cache:A.cache,pendingSuspenseBoundaries:A.pendingSuspenseBoundaries,transitions:A.transitions},d.updateQueue.baseState=N,d.memoizedState=N,d.flags&256){C=gl(Error(t(423)),d),d=dT(c,d,b,g,C);break e}else if(b!==C){C=gl(Error(t(424)),d),d=dT(c,d,b,g,C);break e}else for(Bs=qo(d.stateNode.containerInfo.firstChild),Vs=d,Pt=!0,Cr=null,g=kk(d,null,b,g),d.child=g;g;)g.flags=g.flags&-3|4096,g=g.sibling;else{if(hl(),b===C){d=wo(c,d,g);break e}as(c,d,b,g)}d=d.child}return d;case 5:return Ek(d),c===null&&Jy(d),b=d.type,C=d.pendingProps,N=c!==null?c.memoizedProps:null,A=C.children,Gy(b,C)?A=null:N!==null&&Gy(b,N)&&(d.flags|=32),uT(c,d),as(c,d,A,g),d.child;case 6:return c===null&&Jy(d),null;case 13:return pT(c,d,g);case 4:return a0(d,d.stateNode.containerInfo),b=d.pendingProps,c===null?d.child=dl(d,null,b,g):as(c,d,b,g),d.child;case 11:return b=d.type,C=d.pendingProps,C=d.elementType===b?C:kr(b,C),oT(c,d,b,C,g);case 7:return as(c,d,d.pendingProps,g),d.child;case 8:return as(c,d,d.pendingProps.children,g),d.child;case 12:return as(c,d,d.pendingProps.children,g),d.child;case 10:e:{if(b=d.type._context,C=d.pendingProps,N=d.memoizedProps,A=C.value,It(np,b._currentValue),b._currentValue=A,N!==null)if(Sr(N.value,A)){if(N.children===C.children&&!xs.current){d=wo(c,d,g);break e}}else for(N=d.child,N!==null&&(N.return=d);N!==null;){var U=N.dependencies;if(U!==null){A=N.child;for(var Y=U.firstContext;Y!==null;){if(Y.context===b){if(N.tag===1){Y=vo(-1,g&-g),Y.tag=2;var de=N.updateQueue;if(de!==null){de=de.shared;var be=de.pending;be===null?Y.next=Y:(Y.next=be.next,be.next=Y),de.pending=Y}}N.lanes|=g,Y=N.alternate,Y!==null&&(Y.lanes|=g),r0(N.return,g,d),U.lanes|=g;break}Y=Y.next}}else if(N.tag===10)A=N.type===d.type?null:N.child;else if(N.tag===18){if(A=N.return,A===null)throw Error(t(341));A.lanes|=g,U=A.alternate,U!==null&&(U.lanes|=g),r0(A,g,d),A=N.sibling}else A=N.child;if(A!==null)A.return=N;else for(A=N;A!==null;){if(A===d){A=null;break}if(N=A.sibling,N!==null){N.return=A.return,A=N;break}A=A.return}N=A}as(c,d,C.children,g),d=d.child}return d;case 9:return C=d.type,b=d.pendingProps.children,fl(d,g),C=Qs(C),b=b(C),d.flags|=1,as(c,d,b,g),d.child;case 14:return b=d.type,C=kr(b,d.pendingProps),C=kr(b.type,C),iT(c,d,b,C,g);case 15:return aT(c,d,d.type,d.pendingProps,g);case 17:return b=d.type,C=d.pendingProps,C=d.elementType===b?C:kr(b,C),fp(c,d),d.tag=1,vs(b)?(c=!0,Yd(d)):c=!1,fl(d,g),Zk(d,b,C),w0(d,b,C,g),k0(null,d,b,!0,c,g);case 19:return mT(c,d,g);case 22:return lT(c,d,g)}throw Error(t(156,d.tag))};function zT(c,d){return xC(c,d)}function xM(c,d,g,b){this.tag=c,this.key=g,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=d,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=b,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function er(c,d,g,b){return new xM(c,d,g,b)}function G0(c){return c=c.prototype,!(!c||!c.isReactComponent)}function vM(c){if(typeof c=="function")return G0(c)?1:0;if(c!=null){if(c=c.$$typeof,c===W)return 11;if(c===te)return 14}return 2}function oi(c,d){var g=c.alternate;return g===null?(g=er(c.tag,d,c.key,c.mode),g.elementType=c.elementType,g.type=c.type,g.stateNode=c.stateNode,g.alternate=c,c.alternate=g):(g.pendingProps=d,g.type=c.type,g.flags=0,g.subtreeFlags=0,g.deletions=null),g.flags=c.flags&14680064,g.childLanes=c.childLanes,g.lanes=c.lanes,g.child=c.child,g.memoizedProps=c.memoizedProps,g.memoizedState=c.memoizedState,g.updateQueue=c.updateQueue,d=c.dependencies,g.dependencies=d===null?null:{lanes:d.lanes,firstContext:d.firstContext},g.sibling=c.sibling,g.index=c.index,g.ref=c.ref,g}function Tp(c,d,g,b,C,N){var A=2;if(b=c,typeof c=="function")G0(c)&&(A=1);else if(typeof c=="string")A=5;else e:switch(c){case D:return ra(g.children,C,N,d);case O:A=8,C|=8;break;case _:return c=er(12,g,d,C|2),c.elementType=_,c.lanes=N,c;case Q:return c=er(13,g,d,C),c.elementType=Q,c.lanes=N,c;case ee:return c=er(19,g,d,C),c.elementType=ee,c.lanes=N,c;case se:return Np(g,C,N,d);default:if(typeof c=="object"&&c!==null)switch(c.$$typeof){case P:A=10;break e;case R:A=9;break e;case W:A=11;break e;case te:A=14;break e;case oe:A=16,b=null;break e}throw Error(t(130,c==null?c:typeof c,""))}return d=er(A,g,d,C),d.elementType=c,d.type=b,d.lanes=N,d}function ra(c,d,g,b){return c=er(7,c,b,d),c.lanes=g,c}function Np(c,d,g,b){return c=er(22,c,b,d),c.elementType=se,c.lanes=g,c.stateNode={isHidden:!1},c}function j0(c,d,g){return c=er(6,c,null,d),c.lanes=g,c}function H0(c,d,g){return d=er(4,c.children!==null?c.children:[],c.key,d),d.lanes=g,d.stateNode={containerInfo:c.containerInfo,pendingChildren:null,implementation:c.implementation},d}function wM(c,d,g,b,C){this.tag=d,this.containerInfo=c,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=vy(0),this.expirationTimes=vy(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=vy(0),this.identifierPrefix=b,this.onRecoverableError=C,this.mutableSourceEagerHydrationData=null}function K0(c,d,g,b,C,N,A,U,Y){return c=new wM(c,d,g,U,Y),d===1?(d=1,N===!0&&(d|=8)):d=0,N=er(3,null,null,d),c.current=N,N.stateNode=c,N.memoizedState={element:b,isDehydrated:g,cache:null,transitions:null,pendingSuspenseBoundaries:null},i0(N),c}function bM(c,d,g){var b=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:E,key:b==null?null:""+b,children:c,containerInfo:d,implementation:g}}function VT(c){if(!c)return Yo;c=c._reactInternals;e:{if(Hi(c)!==c||c.tag!==1)throw Error(t(170));var d=c;do{switch(d.tag){case 3:d=d.stateNode.context;break e;case 1:if(vs(d.type)){d=d.stateNode.__reactInternalMemoizedMergedChildContext;break e}}d=d.return}while(d!==null);throw Error(t(171))}if(c.tag===1){var g=c.type;if(vs(g))return fk(c,g,d)}return d}function BT(c,d,g,b,C,N,A,U,Y){return c=K0(g,b,!0,c,C,N,A,U,Y),c.context=VT(null),g=c.current,b=ls(),C=si(g),N=vo(b,C),N.callback=d??null,Jo(g,N,C),c.current.lanes=C,Ou(c,C,b),Ss(c,b),c}function Ip(c,d,g,b){var C=d.current,N=ls(),A=si(C);return g=VT(g),d.context===null?d.context=g:d.pendingContext=g,d=vo(N,A),d.payload={element:c},b=b===void 0?null:b,b!==null&&(d.callback=b),c=Jo(C,d,A),c!==null&&(Ir(c,C,A,N),rp(c,C,A)),A}function $p(c){if(c=c.current,!c.child)return null;switch(c.child.tag){case 5:return c.child.stateNode;default:return c.child.stateNode}}function WT(c,d){if(c=c.memoizedState,c!==null&&c.dehydrated!==null){var g=c.retryLane;c.retryLane=g!==0&&g<d?g:d}}function q0(c,d){WT(c,d),(c=c.alternate)&&WT(c,d)}function SM(){return null}var UT=typeof reportError=="function"?reportError:function(c){console.error(c)};function X0(c){this._internalRoot=c}Ep.prototype.render=X0.prototype.render=function(c){var d=this._internalRoot;if(d===null)throw Error(t(409));Ip(c,d,null,null)},Ep.prototype.unmount=X0.prototype.unmount=function(){var c=this._internalRoot;if(c!==null){this._internalRoot=null;var d=c.containerInfo;ta(function(){Ip(null,c,null,null)}),d[fo]=null}};function Ep(c){this._internalRoot=c}Ep.prototype.unstable_scheduleHydration=function(c){if(c){var d=NC();c={blockedOn:null,target:c,priority:d};for(var g=0;g<jo.length&&d!==0&&d<jo[g].priority;g++);jo.splice(g,0,c),g===0&&EC(c)}};function Y0(c){return!(!c||c.nodeType!==1&&c.nodeType!==9&&c.nodeType!==11)}function Rp(c){return!(!c||c.nodeType!==1&&c.nodeType!==9&&c.nodeType!==11&&(c.nodeType!==8||c.nodeValue!==" react-mount-point-unstable "))}function GT(){}function CM(c,d,g,b,C){if(C){if(typeof b=="function"){var N=b;b=function(){var de=$p(A);N.call(de)}}var A=BT(d,b,c,0,null,!1,!1,"",GT);return c._reactRootContainer=A,c[fo]=A.current,Ku(c.nodeType===8?c.parentNode:c),ta(),A}for(;C=c.lastChild;)c.removeChild(C);if(typeof b=="function"){var U=b;b=function(){var de=$p(Y);U.call(de)}}var Y=K0(c,0,!1,null,null,!1,!1,"",GT);return c._reactRootContainer=Y,c[fo]=Y.current,Ku(c.nodeType===8?c.parentNode:c),ta(function(){Ip(d,Y,g,b)}),Y}function Dp(c,d,g,b,C){var N=g._reactRootContainer;if(N){var A=N;if(typeof C=="function"){var U=C;C=function(){var Y=$p(A);U.call(Y)}}Ip(d,A,c,C)}else A=CM(g,d,c,C,b);return $p(A)}kC=function(c){switch(c.tag){case 3:var d=c.stateNode;if(d.current.memoizedState.isDehydrated){var g=Au(d.pendingLanes);g!==0&&(wy(d,g|1),Ss(d,sn()),(gt&6)===0&&(vl=sn()+500,Qo()))}break;case 13:ta(function(){var b=xo(c,1);if(b!==null){var C=ls();Ir(b,c,1,C)}}),q0(c,1)}},by=function(c){if(c.tag===13){var d=xo(c,134217728);if(d!==null){var g=ls();Ir(d,c,134217728,g)}q0(c,134217728)}},TC=function(c){if(c.tag===13){var d=si(c),g=xo(c,d);if(g!==null){var b=ls();Ir(g,c,d,b)}q0(c,d)}},NC=function(){return bt},IC=function(c,d){var g=bt;try{return bt=c,d()}finally{bt=g}},py=function(c,d,g){switch(d){case"input":if(st(c,g),d=g.name,g.type==="radio"&&d!=null){for(g=c;g.parentNode;)g=g.parentNode;for(g=g.querySelectorAll("input[name="+JSON.stringify(""+d)+'][type="radio"]'),d=0;d<g.length;d++){var b=g[d];if(b!==c&&b.form===c.form){var C=qd(b);if(!C)throw Error(t(90));Ue(b),st(b,C)}}}break;case"textarea":Vt(c,g);break;case"select":d=g.value,d!=null&&Dt(c,!!g.multiple,d,!1)}},hC=B0,dC=ta;var kM={usingClientEntryPoint:!1,Events:[Yu,il,qd,uC,cC,B0]},cc={findFiberByHostInstance:Ki,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},TM={bundleType:cc.bundleType,version:cc.version,rendererPackageName:cc.rendererPackageName,rendererConfig:cc.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:T.ReactCurrentDispatcher,findHostInstanceByFiber:function(c){return c=gC(c),c===null?null:c.stateNode},findFiberByHostInstance:cc.findFiberByHostInstance||SM,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Ap=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Ap.isDisabled&&Ap.supportsFiber)try{Ed=Ap.inject(TM),Ur=Ap}catch{}}return Cs.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=kM,Cs.createPortal=function(c,d){var g=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Y0(d))throw Error(t(200));return bM(c,d,null,g)},Cs.createRoot=function(c,d){if(!Y0(c))throw Error(t(299));var g=!1,b="",C=UT;return d!=null&&(d.unstable_strictMode===!0&&(g=!0),d.identifierPrefix!==void 0&&(b=d.identifierPrefix),d.onRecoverableError!==void 0&&(C=d.onRecoverableError)),d=K0(c,1,!1,null,null,g,!1,b,C),c[fo]=d.current,Ku(c.nodeType===8?c.parentNode:c),new X0(d)},Cs.findDOMNode=function(c){if(c==null)return null;if(c.nodeType===1)return c;var d=c._reactInternals;if(d===void 0)throw typeof c.render=="function"?Error(t(188)):(c=Object.keys(c).join(","),Error(t(268,c)));return c=gC(d),c=c===null?null:c.stateNode,c},Cs.flushSync=function(c){return ta(c)},Cs.hydrate=function(c,d,g){if(!Rp(d))throw Error(t(200));return Dp(null,c,d,!0,g)},Cs.hydrateRoot=function(c,d,g){if(!Y0(c))throw Error(t(405));var b=g!=null&&g.hydratedSources||null,C=!1,N="",A=UT;if(g!=null&&(g.unstable_strictMode===!0&&(C=!0),g.identifierPrefix!==void 0&&(N=g.identifierPrefix),g.onRecoverableError!==void 0&&(A=g.onRecoverableError)),d=BT(d,null,c,1,g??null,C,!1,N,A),c[fo]=d.current,Ku(c),b)for(c=0;c<b.length;c++)g=b[c],C=g._getVersion,C=C(g._source),d.mutableSourceEagerHydrationData==null?d.mutableSourceEagerHydrationData=[g,C]:d.mutableSourceEagerHydrationData.push(g,C);return new Ep(d)},Cs.render=function(c,d,g){if(!Rp(d))throw Error(t(200));return Dp(null,c,d,!1,g)},Cs.unmountComponentAtNode=function(c){if(!Rp(c))throw Error(t(40));return c._reactRootContainer?(ta(function(){Dp(null,null,c,!1,function(){c._reactRootContainer=null,c[fo]=null})}),!0):!1},Cs.unstable_batchedUpdates=B0,Cs.unstable_renderSubtreeIntoContainer=function(c,d,g,b){if(!Rp(g))throw Error(t(200));if(c==null||c._reactInternals===void 0)throw Error(t(38));return Dp(c,d,g,!1,b)},Cs.version="18.3.1-next-f1338f8080-20240426",Cs}var ZT;function PM(){if(ZT)return J0.exports;ZT=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),J0.exports=FM(),J0.exports}var JT;function LM(){if(JT)return Op;JT=1;var n=PM();return Op.createRoot=n.createRoot,Op.hydrateRoot=n.hydrateRoot,Op}var MM=LM();const zM=am(MM);/**
 * react-router v7.13.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */var eN="popstate";function VM(n={}){function e(s,r){let{pathname:o,search:i,hash:a}=s.location;return jx("",{pathname:o,search:i,hash:a},r.state&&r.state.usr||null,r.state&&r.state.key||"default")}function t(s,r){return typeof r=="string"?r:Rc(r)}return WM(e,t,null,n)}function jt(n,e){if(n===!1||n===null||typeof n>"u")throw new Error(e)}function io(n,e){if(!n){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function BM(){return Math.random().toString(36).substring(2,10)}function tN(n,e){return{usr:n.state,key:n.key,idx:e}}function jx(n,e,t=null,s){return{pathname:typeof n=="string"?n:n.pathname,search:"",hash:"",...typeof e=="string"?ou(e):e,state:t,key:e&&e.key||s||BM()}}function Rc({pathname:n="/",search:e="",hash:t=""}){return e&&e!=="?"&&(n+=e.charAt(0)==="?"?e:"?"+e),t&&t!=="#"&&(n+=t.charAt(0)==="#"?t:"#"+t),n}function ou(n){let e={};if(n){let t=n.indexOf("#");t>=0&&(e.hash=n.substring(t),n=n.substring(0,t));let s=n.indexOf("?");s>=0&&(e.search=n.substring(s),n=n.substring(0,s)),n&&(e.pathname=n)}return e}function WM(n,e,t,s={}){let{window:r=document.defaultView,v5Compat:o=!1}=s,i=r.history,a="POP",l=null,u=h();u==null&&(u=0,i.replaceState({...i.state,idx:u},""));function h(){return(i.state||{idx:null}).idx}function p(){a="POP";let v=h(),w=v==null?null:v-u;u=v,l&&l({action:a,location:x.location,delta:w})}function f(v,w){a="PUSH";let S=jx(x.location,v,w);u=h()+1;let k=tN(S,u),T=x.createHref(S);try{i.pushState(k,"",T)}catch(I){if(I instanceof DOMException&&I.name==="DataCloneError")throw I;r.location.assign(T)}o&&l&&l({action:a,location:x.location,delta:1})}function m(v,w){a="REPLACE";let S=jx(x.location,v,w);u=h();let k=tN(S,u),T=x.createHref(S);i.replaceState(k,"",T),o&&l&&l({action:a,location:x.location,delta:0})}function y(v){return UM(v)}let x={get action(){return a},get location(){return n(r,i)},listen(v){if(l)throw new Error("A history only accepts one active listener");return r.addEventListener(eN,p),l=v,()=>{r.removeEventListener(eN,p),l=null}},createHref(v){return e(r,v)},createURL:y,encodeLocation(v){let w=y(v);return{pathname:w.pathname,search:w.search,hash:w.hash}},push:f,replace:m,go(v){return i.go(v)}};return x}function UM(n,e=!1){let t="http://localhost";typeof window<"u"&&(t=window.location.origin!=="null"?window.location.origin:window.location.href),jt(t,"No window.location.(origin|href) available to create URL");let s=typeof n=="string"?n:Rc(n);return s=s.replace(/ $/,"%20"),!e&&s.startsWith("//")&&(s=t+s),new URL(s,t)}function N2(n,e,t="/"){return GM(n,e,t,!1)}function GM(n,e,t,s){let r=typeof e=="string"?ou(e):e,o=Eo(r.pathname||"/",t);if(o==null)return null;let i=I2(n);jM(i);let a=null;for(let l=0;a==null&&l<i.length;++l){let u=nz(o);a=ez(i[l],u,s)}return a}function I2(n,e=[],t=[],s="",r=!1){let o=(i,a,l=r,u)=>{let h={relativePath:u===void 0?i.path||"":u,caseSensitive:i.caseSensitive===!0,childrenIndex:a,route:i};if(h.relativePath.startsWith("/")){if(!h.relativePath.startsWith(s)&&l)return;jt(h.relativePath.startsWith(s),`Absolute route path "${h.relativePath}" nested under path "${s}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),h.relativePath=h.relativePath.slice(s.length)}let p=No([s,h.relativePath]),f=t.concat(h);i.children&&i.children.length>0&&(jt(i.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${p}".`),I2(i.children,e,f,p,l)),!(i.path==null&&!i.index)&&e.push({path:p,score:ZM(p,i.index),routesMeta:f})};return n.forEach((i,a)=>{var l;if(i.path===""||!((l=i.path)!=null&&l.includes("?")))o(i,a);else for(let u of $2(i.path))o(i,a,!0,u)}),e}function $2(n){let e=n.split("/");if(e.length===0)return[];let[t,...s]=e,r=t.endsWith("?"),o=t.replace(/\?$/,"");if(s.length===0)return r?[o,""]:[o];let i=$2(s.join("/")),a=[];return a.push(...i.map(l=>l===""?o:[o,l].join("/"))),r&&a.push(...i),a.map(l=>n.startsWith("/")&&l===""?"/":l)}function jM(n){n.sort((e,t)=>e.score!==t.score?t.score-e.score:JM(e.routesMeta.map(s=>s.childrenIndex),t.routesMeta.map(s=>s.childrenIndex)))}var HM=/^:[\w-]+$/,KM=3,qM=2,XM=1,YM=10,QM=-2,nN=n=>n==="*";function ZM(n,e){let t=n.split("/"),s=t.length;return t.some(nN)&&(s+=QM),e&&(s+=qM),t.filter(r=>!nN(r)).reduce((r,o)=>r+(HM.test(o)?KM:o===""?XM:YM),s)}function JM(n,e){return n.length===e.length&&n.slice(0,-1).every((s,r)=>s===e[r])?n[n.length-1]-e[e.length-1]:0}function ez(n,e,t=!1){let{routesMeta:s}=n,r={},o="/",i=[];for(let a=0;a<s.length;++a){let l=s[a],u=a===s.length-1,h=o==="/"?e:e.slice(o.length)||"/",p=Cf({path:l.relativePath,caseSensitive:l.caseSensitive,end:u},h),f=l.route;if(!p&&u&&t&&!s[s.length-1].route.index&&(p=Cf({path:l.relativePath,caseSensitive:l.caseSensitive,end:!1},h)),!p)return null;Object.assign(r,p.params),i.push({params:r,pathname:No([o,p.pathname]),pathnameBase:iz(No([o,p.pathnameBase])),route:f}),p.pathnameBase!=="/"&&(o=No([o,p.pathnameBase]))}return i}function Cf(n,e){typeof n=="string"&&(n={path:n,caseSensitive:!1,end:!0});let[t,s]=tz(n.path,n.caseSensitive,n.end),r=e.match(t);if(!r)return null;let o=r[0],i=o.replace(/(.)\/+$/,"$1"),a=r.slice(1);return{params:s.reduce((u,{paramName:h,isOptional:p},f)=>{if(h==="*"){let y=a[f]||"";i=o.slice(0,o.length-y.length).replace(/(.)\/+$/,"$1")}const m=a[f];return p&&!m?u[h]=void 0:u[h]=(m||"").replace(/%2F/g,"/"),u},{}),pathname:o,pathnameBase:i,pattern:n}}function tz(n,e=!1,t=!0){io(n==="*"||!n.endsWith("*")||n.endsWith("/*"),`Route path "${n}" will be treated as if it were "${n.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${n.replace(/\*$/,"/*")}".`);let s=[],r="^"+n.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(i,a,l)=>(s.push({paramName:a,isOptional:l!=null}),l?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return n.endsWith("*")?(s.push({paramName:"*"}),r+=n==="*"||n==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):t?r+="\\/*$":n!==""&&n!=="/"&&(r+="(?:(?=\\/|$))"),[new RegExp(r,e?void 0:"i"),s]}function nz(n){try{return n.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return io(!1,`The URL path "${n}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),n}}function Eo(n,e){if(e==="/")return n;if(!n.toLowerCase().startsWith(e.toLowerCase()))return null;let t=e.endsWith("/")?e.length-1:e.length,s=n.charAt(t);return s&&s!=="/"?null:n.slice(t)||"/"}var sz=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i;function rz(n,e="/"){let{pathname:t,search:s="",hash:r=""}=typeof n=="string"?ou(n):n,o;return t?(t=t.replace(/\/\/+/g,"/"),t.startsWith("/")?o=sN(t.substring(1),"/"):o=sN(t,e)):o=e,{pathname:o,search:az(s),hash:lz(r)}}function sN(n,e){let t=e.replace(/\/+$/,"").split("/");return n.split("/").forEach(r=>{r===".."?t.length>1&&t.pop():r!=="."&&t.push(r)}),t.length>1?t.join("/"):"/"}function nx(n,e,t,s){return`Cannot include a '${n}' character in a manually specified \`to.${e}\` field [${JSON.stringify(s)}].  Please separate it out to the \`to.${t}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function oz(n){return n.filter((e,t)=>t===0||e.route.path&&e.route.path.length>0)}function E2(n){let e=oz(n);return e.map((t,s)=>s===e.length-1?t.pathname:t.pathnameBase)}function R2(n,e,t,s=!1){let r;typeof n=="string"?r=ou(n):(r={...n},jt(!r.pathname||!r.pathname.includes("?"),nx("?","pathname","search",r)),jt(!r.pathname||!r.pathname.includes("#"),nx("#","pathname","hash",r)),jt(!r.search||!r.search.includes("#"),nx("#","search","hash",r)));let o=n===""||r.pathname==="",i=o?"/":r.pathname,a;if(i==null)a=t;else{let p=e.length-1;if(!s&&i.startsWith("..")){let f=i.split("/");for(;f[0]==="..";)f.shift(),p-=1;r.pathname=f.join("/")}a=p>=0?e[p]:"/"}let l=rz(r,a),u=i&&i!=="/"&&i.endsWith("/"),h=(o||i===".")&&t.endsWith("/");return!l.pathname.endsWith("/")&&(u||h)&&(l.pathname+="/"),l}var No=n=>n.join("/").replace(/\/\/+/g,"/"),iz=n=>n.replace(/\/+$/,"").replace(/^\/*/,"/"),az=n=>!n||n==="?"?"":n.startsWith("?")?n:"?"+n,lz=n=>!n||n==="#"?"":n.startsWith("#")?n:"#"+n,uz=class{constructor(n,e,t,s=!1){this.status=n,this.statusText=e||"",this.internal=s,t instanceof Error?(this.data=t.toString(),this.error=t):this.data=t}};function cz(n){return n!=null&&typeof n.status=="number"&&typeof n.statusText=="string"&&typeof n.internal=="boolean"&&"data"in n}function hz(n){return n.map(e=>e.route.path).filter(Boolean).join("/").replace(/\/\/*/g,"/")||"/"}var D2=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function A2(n,e){let t=n;if(typeof t!="string"||!sz.test(t))return{absoluteURL:void 0,isExternal:!1,to:t};let s=t,r=!1;if(D2)try{let o=new URL(window.location.href),i=t.startsWith("//")?new URL(o.protocol+t):new URL(t),a=Eo(i.pathname,e);i.origin===o.origin&&a!=null?t=a+i.search+i.hash:r=!0}catch{io(!1,`<Link to="${t}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}return{absoluteURL:s,isExternal:r,to:t}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var O2=["POST","PUT","PATCH","DELETE"];new Set(O2);var dz=["GET",...O2];new Set(dz);var iu=J.createContext(null);iu.displayName="DataRouter";var um=J.createContext(null);um.displayName="DataRouterState";var pz=J.createContext(!1),_2=J.createContext({isTransitioning:!1});_2.displayName="ViewTransition";var fz=J.createContext(new Map);fz.displayName="Fetchers";var mz=J.createContext(null);mz.displayName="Await";var gr=J.createContext(null);gr.displayName="Navigation";var Zc=J.createContext(null);Zc.displayName="Location";var Po=J.createContext({outlet:null,matches:[],isDataRoute:!1});Po.displayName="Route";var mw=J.createContext(null);mw.displayName="RouteError";var F2="REACT_ROUTER_ERROR",gz="REDIRECT",yz="ROUTE_ERROR_RESPONSE";function xz(n){if(n.startsWith(`${F2}:${gz}:{`))try{let e=JSON.parse(n.slice(28));if(typeof e=="object"&&e&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.location=="string"&&typeof e.reloadDocument=="boolean"&&typeof e.replace=="boolean")return e}catch{}}function vz(n){if(n.startsWith(`${F2}:${yz}:{`))try{let e=JSON.parse(n.slice(40));if(typeof e=="object"&&e&&typeof e.status=="number"&&typeof e.statusText=="string")return new uz(e.status,e.statusText,e.data)}catch{}}function wz(n,{relative:e}={}){jt(Jc(),"useHref() may be used only in the context of a <Router> component.");let{basename:t,navigator:s}=J.useContext(gr),{hash:r,pathname:o,search:i}=eh(n,{relative:e}),a=o;return t!=="/"&&(a=o==="/"?t:No([t,o])),s.createHref({pathname:a,search:i,hash:r})}function Jc(){return J.useContext(Zc)!=null}function za(){return jt(Jc(),"useLocation() may be used only in the context of a <Router> component."),J.useContext(Zc).location}var P2="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function L2(n){J.useContext(gr).static||J.useLayoutEffect(n)}function bz(){let{isDataRoute:n}=J.useContext(Po);return n?_z():Sz()}function Sz(){jt(Jc(),"useNavigate() may be used only in the context of a <Router> component.");let n=J.useContext(iu),{basename:e,navigator:t}=J.useContext(gr),{matches:s}=J.useContext(Po),{pathname:r}=za(),o=JSON.stringify(E2(s)),i=J.useRef(!1);return L2(()=>{i.current=!0}),J.useCallback((l,u={})=>{if(io(i.current,P2),!i.current)return;if(typeof l=="number"){t.go(l);return}let h=R2(l,JSON.parse(o),r,u.relative==="path");n==null&&e!=="/"&&(h.pathname=h.pathname==="/"?e:No([e,h.pathname])),(u.replace?t.replace:t.push)(h,u.state,u)},[e,t,o,r,n])}J.createContext(null);function eh(n,{relative:e}={}){let{matches:t}=J.useContext(Po),{pathname:s}=za(),r=JSON.stringify(E2(t));return J.useMemo(()=>R2(n,JSON.parse(r),s,e==="path"),[n,r,s,e])}function Cz(n,e){return M2(n,e)}function M2(n,e,t,s,r){var S;jt(Jc(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:o}=J.useContext(gr),{matches:i}=J.useContext(Po),a=i[i.length-1],l=a?a.params:{},u=a?a.pathname:"/",h=a?a.pathnameBase:"/",p=a&&a.route;{let k=p&&p.path||"";V2(u,!p||k.endsWith("*")||k.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${u}" (under <Route path="${k}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${k}"> to <Route path="${k==="/"?"*":`${k}/*`}">.`)}let f=za(),m;if(e){let k=typeof e=="string"?ou(e):e;jt(h==="/"||((S=k.pathname)==null?void 0:S.startsWith(h)),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${h}" but pathname "${k.pathname}" was given in the \`location\` prop.`),m=k}else m=f;let y=m.pathname||"/",x=y;if(h!=="/"){let k=h.replace(/^\//,"").split("/");x="/"+y.replace(/^\//,"").split("/").slice(k.length).join("/")}let v=N2(n,{pathname:x});io(p||v!=null,`No routes matched location "${m.pathname}${m.search}${m.hash}" `),io(v==null||v[v.length-1].route.element!==void 0||v[v.length-1].route.Component!==void 0||v[v.length-1].route.lazy!==void 0,`Matched leaf route at location "${m.pathname}${m.search}${m.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let w=$z(v&&v.map(k=>Object.assign({},k,{params:Object.assign({},l,k.params),pathname:No([h,o.encodeLocation?o.encodeLocation(k.pathname.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:k.pathname]),pathnameBase:k.pathnameBase==="/"?h:No([h,o.encodeLocation?o.encodeLocation(k.pathnameBase.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:k.pathnameBase])})),i,t,s,r);return e&&w?J.createElement(Zc.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...m},navigationType:"POP"}},w):w}function kz(){let n=Oz(),e=cz(n)?`${n.status} ${n.statusText}`:n instanceof Error?n.message:JSON.stringify(n),t=n instanceof Error?n.stack:null,s="rgba(200,200,200, 0.5)",r={padding:"0.5rem",backgroundColor:s},o={padding:"2px 4px",backgroundColor:s},i=null;return console.error("Error handled by React Router default ErrorBoundary:",n),i=J.createElement(J.Fragment,null,J.createElement("p",null," Hey developer "),J.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",J.createElement("code",{style:o},"ErrorBoundary")," or"," ",J.createElement("code",{style:o},"errorElement")," prop on your route.")),J.createElement(J.Fragment,null,J.createElement("h2",null,"Unexpected Application Error!"),J.createElement("h3",{style:{fontStyle:"italic"}},e),t?J.createElement("pre",{style:r},t):null,i)}var Tz=J.createElement(kz,null),z2=class extends J.Component{constructor(n){super(n),this.state={location:n.location,revalidation:n.revalidation,error:n.error}}static getDerivedStateFromError(n){return{error:n}}static getDerivedStateFromProps(n,e){return e.location!==n.location||e.revalidation!=="idle"&&n.revalidation==="idle"?{error:n.error,location:n.location,revalidation:n.revalidation}:{error:n.error!==void 0?n.error:e.error,location:e.location,revalidation:n.revalidation||e.revalidation}}componentDidCatch(n,e){this.props.onError?this.props.onError(n,e):console.error("React Router caught the following error during render",n)}render(){let n=this.state.error;if(this.context&&typeof n=="object"&&n&&"digest"in n&&typeof n.digest=="string"){const t=vz(n.digest);t&&(n=t)}let e=n!==void 0?J.createElement(Po.Provider,{value:this.props.routeContext},J.createElement(mw.Provider,{value:n,children:this.props.component})):this.props.children;return this.context?J.createElement(Nz,{error:n},e):e}};z2.contextType=pz;var sx=new WeakMap;function Nz({children:n,error:e}){let{basename:t}=J.useContext(gr);if(typeof e=="object"&&e&&"digest"in e&&typeof e.digest=="string"){let s=xz(e.digest);if(s){let r=sx.get(e);if(r)throw r;let o=A2(s.location,t);if(D2&&!sx.get(e))if(o.isExternal||s.reloadDocument)window.location.href=o.absoluteURL||o.to;else{const i=Promise.resolve().then(()=>window.__reactRouterDataRouter.navigate(o.to,{replace:s.replace}));throw sx.set(e,i),i}return J.createElement("meta",{httpEquiv:"refresh",content:`0;url=${o.absoluteURL||o.to}`})}}return n}function Iz({routeContext:n,match:e,children:t}){let s=J.useContext(iu);return s&&s.static&&s.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(s.staticContext._deepestRenderedBoundaryId=e.route.id),J.createElement(Po.Provider,{value:n},t)}function $z(n,e=[],t=null,s=null,r=null){if(n==null){if(!t)return null;if(t.errors)n=t.matches;else if(e.length===0&&!t.initialized&&t.matches.length>0)n=t.matches;else return null}let o=n,i=t==null?void 0:t.errors;if(i!=null){let h=o.findIndex(p=>p.route.id&&(i==null?void 0:i[p.route.id])!==void 0);jt(h>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(i).join(",")}`),o=o.slice(0,Math.min(o.length,h+1))}let a=!1,l=-1;if(t)for(let h=0;h<o.length;h++){let p=o[h];if((p.route.HydrateFallback||p.route.hydrateFallbackElement)&&(l=h),p.route.id){let{loaderData:f,errors:m}=t,y=p.route.loader&&!f.hasOwnProperty(p.route.id)&&(!m||m[p.route.id]===void 0);if(p.route.lazy||y){a=!0,l>=0?o=o.slice(0,l+1):o=[o[0]];break}}}let u=t&&s?(h,p)=>{var f,m;s(h,{location:t.location,params:((m=(f=t.matches)==null?void 0:f[0])==null?void 0:m.params)??{},unstable_pattern:hz(t.matches),errorInfo:p})}:void 0;return o.reduceRight((h,p,f)=>{let m,y=!1,x=null,v=null;t&&(m=i&&p.route.id?i[p.route.id]:void 0,x=p.route.errorElement||Tz,a&&(l<0&&f===0?(V2("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),y=!0,v=null):l===f&&(y=!0,v=p.route.hydrateFallbackElement||null)));let w=e.concat(o.slice(0,f+1)),S=()=>{let k;return m?k=x:y?k=v:p.route.Component?k=J.createElement(p.route.Component,null):p.route.element?k=p.route.element:k=h,J.createElement(Iz,{match:p,routeContext:{outlet:h,matches:w,isDataRoute:t!=null},children:k})};return t&&(p.route.ErrorBoundary||p.route.errorElement||f===0)?J.createElement(z2,{location:t.location,revalidation:t.revalidation,component:x,error:m,children:S(),routeContext:{outlet:null,matches:w,isDataRoute:!0},onError:u}):S()},null)}function gw(n){return`${n} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function Ez(n){let e=J.useContext(iu);return jt(e,gw(n)),e}function Rz(n){let e=J.useContext(um);return jt(e,gw(n)),e}function Dz(n){let e=J.useContext(Po);return jt(e,gw(n)),e}function yw(n){let e=Dz(n),t=e.matches[e.matches.length-1];return jt(t.route.id,`${n} can only be used on routes that contain a unique "id"`),t.route.id}function Az(){return yw("useRouteId")}function Oz(){var s;let n=J.useContext(mw),e=Rz("useRouteError"),t=yw("useRouteError");return n!==void 0?n:(s=e.errors)==null?void 0:s[t]}function _z(){let{router:n}=Ez("useNavigate"),e=yw("useNavigate"),t=J.useRef(!1);return L2(()=>{t.current=!0}),J.useCallback(async(r,o={})=>{io(t.current,P2),t.current&&(typeof r=="number"?await n.navigate(r):await n.navigate(r,{fromRouteId:e,...o}))},[n,e])}var rN={};function V2(n,e,t){!e&&!rN[n]&&(rN[n]=!0,io(!1,t))}J.memo(Fz);function Fz({routes:n,future:e,state:t,onError:s}){return M2(n,void 0,t,s,e)}function ef(n){jt(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function Pz({basename:n="/",children:e=null,location:t,navigationType:s="POP",navigator:r,static:o=!1,unstable_useTransitions:i}){jt(!Jc(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let a=n.replace(/^\/*/,"/"),l=J.useMemo(()=>({basename:a,navigator:r,static:o,unstable_useTransitions:i,future:{}}),[a,r,o,i]);typeof t=="string"&&(t=ou(t));let{pathname:u="/",search:h="",hash:p="",state:f=null,key:m="default"}=t,y=J.useMemo(()=>{let x=Eo(u,a);return x==null?null:{location:{pathname:x,search:h,hash:p,state:f,key:m},navigationType:s}},[a,u,h,p,f,m,s]);return io(y!=null,`<Router basename="${a}"> is not able to match the URL "${u}${h}${p}" because it does not start with the basename, so the <Router> won't render anything.`),y==null?null:J.createElement(gr.Provider,{value:l},J.createElement(Zc.Provider,{children:e,value:y}))}function Lz({children:n,location:e}){return Cz(Hx(n),e)}function Hx(n,e=[]){let t=[];return J.Children.forEach(n,(s,r)=>{if(!J.isValidElement(s))return;let o=[...e,r];if(s.type===J.Fragment){t.push.apply(t,Hx(s.props.children,o));return}jt(s.type===ef,`[${typeof s.type=="string"?s.type:s.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),jt(!s.props.index||!s.props.children,"An index route cannot have child routes.");let i={id:s.props.id||o.join("-"),caseSensitive:s.props.caseSensitive,element:s.props.element,Component:s.props.Component,index:s.props.index,path:s.props.path,middleware:s.props.middleware,loader:s.props.loader,action:s.props.action,hydrateFallbackElement:s.props.hydrateFallbackElement,HydrateFallback:s.props.HydrateFallback,errorElement:s.props.errorElement,ErrorBoundary:s.props.ErrorBoundary,hasErrorBoundary:s.props.hasErrorBoundary===!0||s.props.ErrorBoundary!=null||s.props.errorElement!=null,shouldRevalidate:s.props.shouldRevalidate,handle:s.props.handle,lazy:s.props.lazy};s.props.children&&(i.children=Hx(s.props.children,o)),t.push(i)}),t}var tf="get",nf="application/x-www-form-urlencoded";function cm(n){return typeof HTMLElement<"u"&&n instanceof HTMLElement}function Mz(n){return cm(n)&&n.tagName.toLowerCase()==="button"}function zz(n){return cm(n)&&n.tagName.toLowerCase()==="form"}function Vz(n){return cm(n)&&n.tagName.toLowerCase()==="input"}function Bz(n){return!!(n.metaKey||n.altKey||n.ctrlKey||n.shiftKey)}function Wz(n,e){return n.button===0&&(!e||e==="_self")&&!Bz(n)}var _p=null;function Uz(){if(_p===null)try{new FormData(document.createElement("form"),0),_p=!1}catch{_p=!0}return _p}var Gz=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function rx(n){return n!=null&&!Gz.has(n)?(io(!1,`"${n}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${nf}"`),null):n}function jz(n,e){let t,s,r,o,i;if(zz(n)){let a=n.getAttribute("action");s=a?Eo(a,e):null,t=n.getAttribute("method")||tf,r=rx(n.getAttribute("enctype"))||nf,o=new FormData(n)}else if(Mz(n)||Vz(n)&&(n.type==="submit"||n.type==="image")){let a=n.form;if(a==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let l=n.getAttribute("formaction")||a.getAttribute("action");if(s=l?Eo(l,e):null,t=n.getAttribute("formmethod")||a.getAttribute("method")||tf,r=rx(n.getAttribute("formenctype"))||rx(a.getAttribute("enctype"))||nf,o=new FormData(a,n),!Uz()){let{name:u,type:h,value:p}=n;if(h==="image"){let f=u?`${u}.`:"";o.append(`${f}x`,"0"),o.append(`${f}y`,"0")}else u&&o.append(u,p)}}else{if(cm(n))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');t=tf,s=null,r=nf,i=n}return o&&r==="text/plain"&&(i=o,o=void 0),{action:s,method:t.toLowerCase(),encType:r,formData:o,body:i}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function xw(n,e){if(n===!1||n===null||typeof n>"u")throw new Error(e)}function Hz(n,e,t,s){let r=typeof n=="string"?new URL(n,typeof window>"u"?"server://singlefetch/":window.location.origin):n;return t?r.pathname.endsWith("/")?r.pathname=`${r.pathname}_.${s}`:r.pathname=`${r.pathname}.${s}`:r.pathname==="/"?r.pathname=`_root.${s}`:e&&Eo(r.pathname,e)==="/"?r.pathname=`${e.replace(/\/$/,"")}/_root.${s}`:r.pathname=`${r.pathname.replace(/\/$/,"")}.${s}`,r}async function Kz(n,e){if(n.id in e)return e[n.id];try{let t=await import(n.module);return e[n.id]=t,t}catch(t){return console.error(`Error loading route module \`${n.module}\`, reloading page...`),console.error(t),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function qz(n){return n==null?!1:n.href==null?n.rel==="preload"&&typeof n.imageSrcSet=="string"&&typeof n.imageSizes=="string":typeof n.rel=="string"&&typeof n.href=="string"}async function Xz(n,e,t){let s=await Promise.all(n.map(async r=>{let o=e.routes[r.route.id];if(o){let i=await Kz(o,t);return i.links?i.links():[]}return[]}));return Jz(s.flat(1).filter(qz).filter(r=>r.rel==="stylesheet"||r.rel==="preload").map(r=>r.rel==="stylesheet"?{...r,rel:"prefetch",as:"style"}:{...r,rel:"prefetch"}))}function oN(n,e,t,s,r,o){let i=(l,u)=>t[u]?l.route.id!==t[u].route.id:!0,a=(l,u)=>{var h;return t[u].pathname!==l.pathname||((h=t[u].route.path)==null?void 0:h.endsWith("*"))&&t[u].params["*"]!==l.params["*"]};return o==="assets"?e.filter((l,u)=>i(l,u)||a(l,u)):o==="data"?e.filter((l,u)=>{var p;let h=s.routes[l.route.id];if(!h||!h.hasLoader)return!1;if(i(l,u)||a(l,u))return!0;if(l.route.shouldRevalidate){let f=l.route.shouldRevalidate({currentUrl:new URL(r.pathname+r.search+r.hash,window.origin),currentParams:((p=t[0])==null?void 0:p.params)||{},nextUrl:new URL(n,window.origin),nextParams:l.params,defaultShouldRevalidate:!0});if(typeof f=="boolean")return f}return!0}):[]}function Yz(n,e,{includeHydrateFallback:t}={}){return Qz(n.map(s=>{let r=e.routes[s.route.id];if(!r)return[];let o=[r.module];return r.clientActionModule&&(o=o.concat(r.clientActionModule)),r.clientLoaderModule&&(o=o.concat(r.clientLoaderModule)),t&&r.hydrateFallbackModule&&(o=o.concat(r.hydrateFallbackModule)),r.imports&&(o=o.concat(r.imports)),o}).flat(1))}function Qz(n){return[...new Set(n)]}function Zz(n){let e={},t=Object.keys(n).sort();for(let s of t)e[s]=n[s];return e}function Jz(n,e){let t=new Set;return new Set(e),n.reduce((s,r)=>{let o=JSON.stringify(Zz(r));return t.has(o)||(t.add(o),s.push({key:o,link:r})),s},[])}function B2(){let n=J.useContext(iu);return xw(n,"You must render this element inside a <DataRouterContext.Provider> element"),n}function eV(){let n=J.useContext(um);return xw(n,"You must render this element inside a <DataRouterStateContext.Provider> element"),n}var vw=J.createContext(void 0);vw.displayName="FrameworkContext";function W2(){let n=J.useContext(vw);return xw(n,"You must render this element inside a <HydratedRouter> element"),n}function tV(n,e){let t=J.useContext(vw),[s,r]=J.useState(!1),[o,i]=J.useState(!1),{onFocus:a,onBlur:l,onMouseEnter:u,onMouseLeave:h,onTouchStart:p}=e,f=J.useRef(null);J.useEffect(()=>{if(n==="render"&&i(!0),n==="viewport"){let x=w=>{w.forEach(S=>{i(S.isIntersecting)})},v=new IntersectionObserver(x,{threshold:.5});return f.current&&v.observe(f.current),()=>{v.disconnect()}}},[n]),J.useEffect(()=>{if(s){let x=setTimeout(()=>{i(!0)},100);return()=>{clearTimeout(x)}}},[s]);let m=()=>{r(!0)},y=()=>{r(!1),i(!1)};return t?n!=="intent"?[o,f,{}]:[o,f,{onFocus:dc(a,m),onBlur:dc(l,y),onMouseEnter:dc(u,m),onMouseLeave:dc(h,y),onTouchStart:dc(p,m)}]:[!1,f,{}]}function dc(n,e){return t=>{n&&n(t),t.defaultPrevented||e(t)}}function nV({page:n,...e}){let{router:t}=B2(),s=J.useMemo(()=>N2(t.routes,n,t.basename),[t.routes,n,t.basename]);return s?J.createElement(rV,{page:n,matches:s,...e}):null}function sV(n){let{manifest:e,routeModules:t}=W2(),[s,r]=J.useState([]);return J.useEffect(()=>{let o=!1;return Xz(n,e,t).then(i=>{o||r(i)}),()=>{o=!0}},[n,e,t]),s}function rV({page:n,matches:e,...t}){let s=za(),{future:r,manifest:o,routeModules:i}=W2(),{basename:a}=B2(),{loaderData:l,matches:u}=eV(),h=J.useMemo(()=>oN(n,e,u,o,s,"data"),[n,e,u,o,s]),p=J.useMemo(()=>oN(n,e,u,o,s,"assets"),[n,e,u,o,s]),f=J.useMemo(()=>{if(n===s.pathname+s.search+s.hash)return[];let x=new Set,v=!1;if(e.forEach(S=>{var T;let k=o.routes[S.route.id];!k||!k.hasLoader||(!h.some(I=>I.route.id===S.route.id)&&S.route.id in l&&((T=i[S.route.id])!=null&&T.shouldRevalidate)||k.hasClientLoader?v=!0:x.add(S.route.id))}),x.size===0)return[];let w=Hz(n,a,r.unstable_trailingSlashAwareDataRequests,"data");return v&&x.size>0&&w.searchParams.set("_routes",e.filter(S=>x.has(S.route.id)).map(S=>S.route.id).join(",")),[w.pathname+w.search]},[a,r.unstable_trailingSlashAwareDataRequests,l,s,o,h,e,n,i]),m=J.useMemo(()=>Yz(p,o),[p,o]),y=sV(p);return J.createElement(J.Fragment,null,f.map(x=>J.createElement("link",{key:x,rel:"prefetch",as:"fetch",href:x,...t})),m.map(x=>J.createElement("link",{key:x,rel:"modulepreload",href:x,...t})),y.map(({key:x,link:v})=>J.createElement("link",{key:x,nonce:t.nonce,...v,crossOrigin:v.crossOrigin??t.crossOrigin})))}function oV(...n){return e=>{n.forEach(t=>{typeof t=="function"?t(e):t!=null&&(t.current=e)})}}var iV=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{iV&&(window.__reactRouterVersion="7.13.0")}catch{}function aV({basename:n,children:e,unstable_useTransitions:t,window:s}){let r=J.useRef();r.current==null&&(r.current=VM({window:s,v5Compat:!0}));let o=r.current,[i,a]=J.useState({action:o.action,location:o.location}),l=J.useCallback(u=>{t===!1?a(u):J.startTransition(()=>a(u))},[t]);return J.useLayoutEffect(()=>o.listen(l),[o,l]),J.createElement(Pz,{basename:n,children:e,location:i.location,navigationType:i.action,navigator:o,unstable_useTransitions:t})}var U2=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,jl=J.forwardRef(function({onClick:e,discover:t="render",prefetch:s="none",relative:r,reloadDocument:o,replace:i,state:a,target:l,to:u,preventScrollReset:h,viewTransition:p,unstable_defaultShouldRevalidate:f,...m},y){let{basename:x,unstable_useTransitions:v}=J.useContext(gr),w=typeof u=="string"&&U2.test(u),S=A2(u,x);u=S.to;let k=wz(u,{relative:r}),[T,I,E]=tV(s,m),D=hV(u,{replace:i,state:a,target:l,preventScrollReset:h,relative:r,viewTransition:p,unstable_defaultShouldRevalidate:f,unstable_useTransitions:v});function O(P){e&&e(P),P.defaultPrevented||D(P)}let _=J.createElement("a",{...m,...E,href:S.absoluteURL||k,onClick:S.isExternal||o?e:O,ref:oV(y,I),target:l,"data-discover":!w&&t==="render"?"true":void 0});return T&&!w?J.createElement(J.Fragment,null,_,J.createElement(nV,{page:k})):_});jl.displayName="Link";var lV=J.forwardRef(function({"aria-current":e="page",caseSensitive:t=!1,className:s="",end:r=!1,style:o,to:i,viewTransition:a,children:l,...u},h){let p=eh(i,{relative:u.relative}),f=za(),m=J.useContext(um),{navigator:y,basename:x}=J.useContext(gr),v=m!=null&&gV(p)&&a===!0,w=y.encodeLocation?y.encodeLocation(p).pathname:p.pathname,S=f.pathname,k=m&&m.navigation&&m.navigation.location?m.navigation.location.pathname:null;t||(S=S.toLowerCase(),k=k?k.toLowerCase():null,w=w.toLowerCase()),k&&x&&(k=Eo(k,x)||k);const T=w!=="/"&&w.endsWith("/")?w.length-1:w.length;let I=S===w||!r&&S.startsWith(w)&&S.charAt(T)==="/",E=k!=null&&(k===w||!r&&k.startsWith(w)&&k.charAt(w.length)==="/"),D={isActive:I,isPending:E,isTransitioning:v},O=I?e:void 0,_;typeof s=="function"?_=s(D):_=[s,I?"active":null,E?"pending":null,v?"transitioning":null].filter(Boolean).join(" ");let P=typeof o=="function"?o(D):o;return J.createElement(jl,{...u,"aria-current":O,className:_,ref:h,style:P,to:i,viewTransition:a},typeof l=="function"?l(D):l)});lV.displayName="NavLink";var uV=J.forwardRef(({discover:n="render",fetcherKey:e,navigate:t,reloadDocument:s,replace:r,state:o,method:i=tf,action:a,onSubmit:l,relative:u,preventScrollReset:h,viewTransition:p,unstable_defaultShouldRevalidate:f,...m},y)=>{let{unstable_useTransitions:x}=J.useContext(gr),v=fV(),w=mV(a,{relative:u}),S=i.toLowerCase()==="get"?"get":"post",k=typeof a=="string"&&U2.test(a),T=I=>{if(l&&l(I),I.defaultPrevented)return;I.preventDefault();let E=I.nativeEvent.submitter,D=(E==null?void 0:E.getAttribute("formmethod"))||i,O=()=>v(E||I.currentTarget,{fetcherKey:e,method:D,navigate:t,replace:r,state:o,relative:u,preventScrollReset:h,viewTransition:p,unstable_defaultShouldRevalidate:f});x&&t!==!1?J.startTransition(()=>O()):O()};return J.createElement("form",{ref:y,method:S,action:w,onSubmit:s?l:T,...m,"data-discover":!k&&n==="render"?"true":void 0})});uV.displayName="Form";function cV(n){return`${n} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function G2(n){let e=J.useContext(iu);return jt(e,cV(n)),e}function hV(n,{target:e,replace:t,state:s,preventScrollReset:r,relative:o,viewTransition:i,unstable_defaultShouldRevalidate:a,unstable_useTransitions:l}={}){let u=bz(),h=za(),p=eh(n,{relative:o});return J.useCallback(f=>{if(Wz(f,e)){f.preventDefault();let m=t!==void 0?t:Rc(h)===Rc(p),y=()=>u(n,{replace:m,state:s,preventScrollReset:r,relative:o,viewTransition:i,unstable_defaultShouldRevalidate:a});l?J.startTransition(()=>y()):y()}},[h,u,p,t,s,e,n,r,o,i,a,l])}var dV=0,pV=()=>`__${String(++dV)}__`;function fV(){let{router:n}=G2("useSubmit"),{basename:e}=J.useContext(gr),t=Az(),s=n.fetch,r=n.navigate;return J.useCallback(async(o,i={})=>{let{action:a,method:l,encType:u,formData:h,body:p}=jz(o,e);if(i.navigate===!1){let f=i.fetcherKey||pV();await s(f,t,i.action||a,{unstable_defaultShouldRevalidate:i.unstable_defaultShouldRevalidate,preventScrollReset:i.preventScrollReset,formData:h,body:p,formMethod:i.method||l,formEncType:i.encType||u,flushSync:i.flushSync})}else await r(i.action||a,{unstable_defaultShouldRevalidate:i.unstable_defaultShouldRevalidate,preventScrollReset:i.preventScrollReset,formData:h,body:p,formMethod:i.method||l,formEncType:i.encType||u,replace:i.replace,state:i.state,fromRouteId:t,flushSync:i.flushSync,viewTransition:i.viewTransition})},[s,r,e,t])}function mV(n,{relative:e}={}){let{basename:t}=J.useContext(gr),s=J.useContext(Po);jt(s,"useFormAction must be used inside a RouteContext");let[r]=s.matches.slice(-1),o={...eh(n||".",{relative:e})},i=za();if(n==null){o.search=i.search;let a=new URLSearchParams(o.search),l=a.getAll("index");if(l.some(h=>h==="")){a.delete("index"),l.filter(p=>p).forEach(p=>a.append("index",p));let h=a.toString();o.search=h?`?${h}`:""}}return(!n||n===".")&&r.route.index&&(o.search=o.search?o.search.replace(/^\?/,"?index&"):"?index"),t!=="/"&&(o.pathname=o.pathname==="/"?t:No([t,o.pathname])),Rc(o)}function gV(n,{relative:e}={}){let t=J.useContext(_2);jt(t!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:s}=G2("useViewTransitionState"),r=eh(n,{relative:e});if(!t.isTransitioning)return!1;let o=Eo(t.currentLocation.pathname,s)||t.currentLocation.pathname,i=Eo(t.nextLocation.pathname,s)||t.nextLocation.pathname;return Cf(r.pathname,i)!=null||Cf(r.pathname,o)!=null}const yV={mood:"neutral",moodScore:50,isListening:!1,lastTranslation:"",voice:"Robot"},Tl={SET_MOOD:"SET_MOOD",UPDATE_MOOD_SCORE:"UPDATE_MOOD_SCORE",SET_LISTENING:"SET_LISTENING",SET_TRANSLATION:"SET_TRANSLATION",SET_VOICE:"SET_VOICE"};function xV(n,e){switch(e.type){case Tl.SET_MOOD:return{...n,mood:e.payload};case Tl.UPDATE_MOOD_SCORE:const t=Math.min(100,Math.max(0,n.moodScore+e.payload));return{...n,moodScore:t};case Tl.SET_LISTENING:return{...n,isListening:e.payload};case Tl.SET_TRANSLATION:return{...n,lastTranslation:e.payload};case Tl.SET_VOICE:return{...n,voice:e.payload};default:return n}}const j2=J.createContext();function vV({children:n}){const[e,t]=J.useReducer(xV,yV),s={state:e,dispatch:t,ACTIONS:Tl};return ke.jsx(j2.Provider,{value:s,children:n})}function hm(){return J.useContext(j2)}var sf={exports:{}},wV=sf.exports,iN;function bV(){return iN||(iN=1,(function(n,e){(function(s,r){n.exports=r(lm())})(wV,function(t){return(function(s){var r={};function o(i){if(r[i])return r[i].exports;var a=r[i]={i,l:!1,exports:{}};return s[i].call(a.exports,a,a.exports,o),a.l=!0,a.exports}return o.m=s,o.c=r,o.d=function(i,a,l){o.o(i,a)||Object.defineProperty(i,a,{enumerable:!0,get:l})},o.r=function(i){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(i,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(i,"__esModule",{value:!0})},o.t=function(i,a){if(a&1&&(i=o(i)),a&8||a&4&&typeof i=="object"&&i&&i.__esModule)return i;var l=Object.create(null);if(o.r(l),Object.defineProperty(l,"default",{enumerable:!0,value:i}),a&2&&typeof i!="string")for(var u in i)o.d(l,u,(function(h){return i[h]}).bind(null,u));return l},o.n=function(i){var a=i&&i.__esModule?function(){return i.default}:function(){return i};return o.d(a,"a",a),a},o.o=function(i,a){return Object.prototype.hasOwnProperty.call(i,a)},o.p="",o(o.s="./src/react-webcam.tsx")})({"./src/react-webcam.tsx":(function(s,r,o){o.r(r);var i=o("react"),a=(function(){var f=function(m,y){return f=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(x,v){x.__proto__=v}||function(x,v){for(var w in v)v.hasOwnProperty(w)&&(x[w]=v[w])},f(m,y)};return function(m,y){f(m,y);function x(){this.constructor=m}m.prototype=y===null?Object.create(y):(x.prototype=y.prototype,new x)}})(),l=function(){return l=Object.assign||function(f){for(var m,y=1,x=arguments.length;y<x;y++){m=arguments[y];for(var v in m)Object.prototype.hasOwnProperty.call(m,v)&&(f[v]=m[v])}return f},l.apply(this,arguments)},u=function(f,m){var y={};for(var x in f)Object.prototype.hasOwnProperty.call(f,x)&&m.indexOf(x)<0&&(y[x]=f[x]);if(f!=null&&typeof Object.getOwnPropertySymbols=="function")for(var v=0,x=Object.getOwnPropertySymbols(f);v<x.length;v++)m.indexOf(x[v])<0&&Object.prototype.propertyIsEnumerable.call(f,x[v])&&(y[x[v]]=f[x[v]]);return y};(function(){typeof window>"u"||(navigator.mediaDevices===void 0&&(navigator.mediaDevices={}),navigator.mediaDevices.getUserMedia===void 0&&(navigator.mediaDevices.getUserMedia=function(m){var y=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia;return y?new Promise(function(x,v){y.call(navigator,m,x,v)}):Promise.reject(new Error("getUserMedia is not implemented in this browser"))}))})();function h(){return!!(navigator.mediaDevices&&navigator.mediaDevices.getUserMedia)}var p=(function(f){a(m,f);function m(y){var x=f.call(this,y)||this;return x.canvas=null,x.ctx=null,x.requestUserMediaId=0,x.unmounted=!1,x.state={hasUserMedia:!1},x}return m.prototype.componentDidMount=function(){var y=this,x=y.state,v=y.props;if(this.unmounted=!1,!h()){v.onUserMediaError("getUserMedia not supported");return}x.hasUserMedia||this.requestUserMedia(),v.children&&typeof v.children!="function"&&console.warn("children must be a function")},m.prototype.componentDidUpdate=function(y){var x=this.props;if(!h()){x.onUserMediaError("getUserMedia not supported");return}var v=JSON.stringify(y.audioConstraints)!==JSON.stringify(x.audioConstraints),w=JSON.stringify(y.videoConstraints)!==JSON.stringify(x.videoConstraints),S=y.minScreenshotWidth!==x.minScreenshotWidth,k=y.minScreenshotHeight!==x.minScreenshotHeight;(w||S||k)&&(this.canvas=null,this.ctx=null),(v||w)&&(this.stopAndCleanup(),this.requestUserMedia())},m.prototype.componentWillUnmount=function(){this.unmounted=!0,this.stopAndCleanup()},m.stopMediaStream=function(y){y&&(y.getVideoTracks&&y.getAudioTracks?(y.getVideoTracks().map(function(x){y.removeTrack(x),x.stop()}),y.getAudioTracks().map(function(x){y.removeTrack(x),x.stop()})):y.stop())},m.prototype.stopAndCleanup=function(){var y=this.state;y.hasUserMedia&&(m.stopMediaStream(this.stream),y.src&&window.URL.revokeObjectURL(y.src))},m.prototype.getScreenshot=function(y){var x=this,v=x.state,w=x.props;if(!v.hasUserMedia)return null;var S=this.getCanvas(y);return S&&S.toDataURL(w.screenshotFormat,w.screenshotQuality)},m.prototype.getCanvas=function(y){var x=this,v=x.state,w=x.props;if(!this.video||!v.hasUserMedia||!this.video.videoHeight)return null;if(!this.ctx){var S=this.video.videoWidth,k=this.video.videoHeight;if(!this.props.forceScreenshotSourceSize){var T=S/k;S=w.minScreenshotWidth||this.video.clientWidth,k=S/T,w.minScreenshotHeight&&k<w.minScreenshotHeight&&(k=w.minScreenshotHeight,S=k*T)}this.canvas=document.createElement("canvas"),this.canvas.width=(y==null?void 0:y.width)||S,this.canvas.height=(y==null?void 0:y.height)||k,this.ctx=this.canvas.getContext("2d")}var I=this,E=I.ctx,D=I.canvas;return E&&D&&(D.width=(y==null?void 0:y.width)||D.width,D.height=(y==null?void 0:y.height)||D.height,w.mirrored&&(E.translate(D.width,0),E.scale(-1,1)),E.imageSmoothingEnabled=w.imageSmoothing,E.drawImage(this.video,0,0,(y==null?void 0:y.width)||D.width,(y==null?void 0:y.height)||D.height),w.mirrored&&(E.scale(-1,1),E.translate(-D.width,0))),D},m.prototype.requestUserMedia=function(){var y=this,x=this.props,v=function(k,T){var I={video:typeof T<"u"?T:!0};x.audio&&(I.audio=typeof k<"u"?k:!0),y.requestUserMediaId++;var E=y.requestUserMediaId;navigator.mediaDevices.getUserMedia(I).then(function(D){y.unmounted||E!==y.requestUserMediaId?m.stopMediaStream(D):y.handleUserMedia(null,D)}).catch(function(D){y.handleUserMedia(D)})};if("mediaDevices"in navigator)v(x.audioConstraints,x.videoConstraints);else{var w=function(k){return{optional:[{sourceId:k}]}},S=function(k){var T=k.deviceId;return typeof T=="string"?T:Array.isArray(T)&&T.length>0?T[0]:typeof T=="object"&&T.ideal?T.ideal:null};MediaStreamTrack.getSources(function(k){var T=null,I=null;k.forEach(function(O){O.kind==="audio"?T=O.id:O.kind==="video"&&(I=O.id)});var E=S(x.audioConstraints);E&&(T=E);var D=S(x.videoConstraints);D&&(I=D),v(w(T),w(I))})}},m.prototype.handleUserMedia=function(y,x){var v=this.props;if(y||!x){this.setState({hasUserMedia:!1}),v.onUserMediaError(y);return}this.stream=x;try{this.video&&(this.video.srcObject=x),this.setState({hasUserMedia:!0})}catch{this.setState({hasUserMedia:!0,src:window.URL.createObjectURL(x)})}v.onUserMedia(x)},m.prototype.render=function(){var y=this,x=this,v=x.state,w=x.props,S=w.audio;w.forceScreenshotSourceSize;var k=w.disablePictureInPicture;w.onUserMedia,w.onUserMediaError,w.screenshotFormat,w.screenshotQuality,w.minScreenshotWidth,w.minScreenshotHeight,w.audioConstraints,w.videoConstraints,w.imageSmoothing;var T=w.mirrored,I=w.style,E=I===void 0?{}:I,D=w.children,O=u(w,["audio","forceScreenshotSourceSize","disablePictureInPicture","onUserMedia","onUserMediaError","screenshotFormat","screenshotQuality","minScreenshotWidth","minScreenshotHeight","audioConstraints","videoConstraints","imageSmoothing","mirrored","style","children"]),_=T?l(l({},E),{transform:(E.transform||"")+" scaleX(-1)"}):E,P={getScreenshot:this.getScreenshot.bind(this)};return i.createElement(i.Fragment,null,i.createElement("video",l({autoPlay:!0,disablePictureInPicture:k,src:v.src,muted:!S,playsInline:!0,ref:function(R){y.video=R},style:_},O)),D&&D(P))},m.defaultProps={audio:!1,disablePictureInPicture:!1,forceScreenshotSourceSize:!1,imageSmoothing:!0,mirrored:!1,onUserMedia:function(){},onUserMediaError:function(){},screenshotFormat:"image/webp",screenshotQuality:.92},m})(i.Component);r.default=p}),react:(function(s,r){s.exports=t})}).default})})(sf)),sf.exports}var SV=bV();const CV=am(SV);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kV=1e-7,TV=1e-4;class H2{constructor(e,t){this.backend=e,this.dataMover=t,this.data=new WeakMap,this.dataIdsCount=0}get(e){return this.data.has(e)||this.dataMover.moveData(this.backend,e),this.data.get(e)}set(e,t){this.dataIdsCount++,this.data.set(e,t)}has(e){return this.data.has(e)}delete(e){return this.dataIdsCount--,this.data.delete(e)}numDataIds(){return this.dataIdsCount}}class ww{refCount(e){return ks("refCount")}incRef(e){return ks("incRef")}timerAvailable(){return!0}time(e){return ks("time")}read(e){return ks("read")}readSync(e){return ks("readSync")}readToGPU(e,t){return ks("readToGPU")}numDataIds(){return ks("numDataIds")}disposeData(e,t){return ks("disposeData")}write(e,t,s){return ks("write")}move(e,t,s,r,o){return ks("move")}createTensorFromGPUData(e,t,s){return ks("createTensorFromGPUData")}memory(){return ks("memory")}floatPrecision(){return ks("floatPrecision")}epsilon(){return this.floatPrecision()===32?kV:TV}dispose(){return ks("dispose")}}function ks(n){throw new Error(`'${n}' not yet implemented or not found in the registry. This kernel may not be supported by the tfjs backend you have chosen`)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function NV(n){let e=n.length,t=0;for(;e>0;)t=Math.random()*e|0,e--,Nl(n,e,t)}function bw(n,e,t){return Math.max(n,Math.min(e,t))}function Sw(n){return n%2===0?n:n+1}function Nl(n,e,t){const s=n[e];n[e]=n[t],n[t]=s}function IV(n){let e=0;for(let t=0;t<n.length;t++)e+=n[t];return e}function L(n,e){if(!n)throw new Error(typeof e=="string"?e:e())}function Ls(n,e,t=""){L(ct(n,e),()=>t+` Shapes ${n} and ${e} must match`)}function au(n){L(n!=null,()=>"The input to the tensor constructor must be a non-null value.")}function fe(n){if(n.length===0)return 1;let e=n[0];for(let t=1;t<n.length;t++)e*=n[t];return e}function $V(n,e){if(n===e)return!0;if(n==null||e==null||n.length!==e.length)return!1;for(let t=0;t<n.length;t++)if(n[t]!==null&&e[t]!==null&&n[t]!==e[t])return!1;return!0}function ct(n,e){if(n===e)return!0;if(n==null||e==null||n.length!==e.length)return!1;for(let t=0;t<n.length;t++)if(n[t]!==e[t])return!1;return!0}function Hl(n){return n%1===0}function Kx(n){const e=Math.ceil(Math.sqrt(n));return[e,Math.ceil(n/e)]}function Pl(n,e){return e<=n.length?n:n+" ".repeat(e-n.length)}function aN(n,e=r=>0,t,s){return new Promise((r,o)=>{let i=0;const a=()=>{if(n()){r();return}i++;const l=e(i);if(t!=null&&i>=t){o();return}s!=null?s(a,l):setTimeout(a,l)};a()})}function K2(n,e){let t=1,s=-1;for(let o=0;o<n.length;++o)if(n[o]>=0)t*=n[o];else if(n[o]===-1){if(s!==-1)throw Error(`Shapes can only have 1 implicit size. Found -1 at dim ${s} and dim ${o}`);s=o}else if(n[o]<0)throw Error(`Shapes can not be < 0. Found ${n[o]} at dim ${o}`);if(s===-1){if(e>0&&e!==t)throw Error(`Size(${e}) must match the product of shape ${n}`);return n}if(t===0)throw Error(`Cannot infer the missing size in [${n}] when there are 0 elements`);if(e%t!==0)throw Error(`The implicit shape can't be a fractional number. Got ${e} / ${t}`);const r=n.slice();return r[s]=e/t,r}function it(n,e){const t=e.length;return n=n==null?e.map((s,r)=>r):[].concat(n),L(n.every(s=>s>=-t&&s<t),()=>`All values in axis param must be in range [-${t}, ${t}) but got axis ${n}`),L(n.every(s=>Hl(s)),()=>`All values in axis param must be integers but got axis ${n}`),n.map(s=>s<0?t+s:s)}function Oi(n,e){const t=[],s=[],r=e!=null&&Array.isArray(e)&&e.length===0,o=e==null||r?null:it(e,n).sort();let i=0;for(let a=0;a<n.length;++a){if(o!=null){if(o[i]===a&&n[a]!==1)throw new Error(`Can't squeeze axis ${a} since its dim '${n[a]}' is not 1`);(o[i]==null||o[i]>a)&&n[a]===1&&(t.push(n[a]),s.push(a)),o[i]<=a&&i++}n[a]!==1&&(t.push(n[a]),s.push(a))}return{newShape:t,keptDims:s}}function Fn(n,e){return Qt(n,e)}function Qt(n,e){let t=null;if(n==null||n==="float32")t=new Float32Array(e);else if(n==="int32")t=new Int32Array(e);else if(n==="bool")t=new Uint8Array(e);else if(n==="string")t=new Array(e);else throw new Error(`Unknown data type ${n}`);return t}function EV(n,e){for(let t=0;t<n.length;t++){const s=n[t];if(isNaN(s)||!isFinite(s))throw Error(`A tensor of type ${e} being uploaded contains ${s}.`)}}function RV(n){return n==="bool"||n==="complex64"||n==="float32"||n==="int32"||n==="string"}function q2(n,e){return!(e==="complex64"||e==="float32"&&n!=="complex64"||e==="int32"&&n!=="float32"&&n!=="complex64"||e==="bool"&&n==="bool")}function kf(n){if(n==="float32"||n==="int32")return 4;if(n==="complex64")return 8;if(n==="bool")return 1;throw new Error(`Unknown dtype ${n}`)}function DV(n){if(n==null)return 0;let e=0;return n.forEach(t=>e+=t.length),e}function th(n){return typeof n=="string"||n instanceof String}function AV(n){return typeof n=="boolean"}function qx(n){return typeof n=="number"}function lu(n){return Array.isArray(n)?lu(n[0]):n instanceof Float32Array?"float32":n instanceof Int32Array||n instanceof Uint8Array||n instanceof Uint8ClampedArray?"int32":qx(n)?"float32":th(n)?"string":AV(n)?"bool":"float32"}function Xx(n){return!!(n&&n.constructor&&n.call&&n.apply)}function Yx(n,e){for(let t=e;t<n;++t)if(n%t===0)return t;return n}function Be(n){const e=n.length;if(e<2)return[];const t=new Array(e-1);t[e-2]=n[e-1];for(let s=e-3;s>=0;--s)t[s]=t[s+1]*n[s+1];return t}function X2(n,e,t,s=!1){const r=new Array;if(e.length===1){const o=e[0]*(s?2:1);for(let i=0;i<o;i++)r[i]=t[n+i]}else{const o=e[0],i=e.slice(1),a=i.reduce((l,u)=>l*u)*(s?2:1);for(let l=0;l<o;l++)r[l]=X2(n+l*a,i,t,s)}return r}function cr(n,e,t=!1){if(n.length===0)return e[0];const s=n.reduce((r,o)=>r*o)*(t?2:1);if(s===0)return[];if(s!==e.length)throw new Error(`[${n}] does not match the input size ${e.length}${t?" for a complex tensor":""}.`);return X2(0,n,e,t)}function OV(n,e){if(Array.isArray(n))return n;if(e==="float32")return n instanceof Float32Array?n:new Float32Array(n);if(e==="int32")return n instanceof Int32Array?n:new Int32Array(n);if(e==="bool"||e==="string")return Uint8Array.from(new Int32Array(n));throw new Error(`Unknown dtype ${e}`)}function Cw(n,e){const t=Kn(n,e);for(let s=0;s<t.length;s++)t[s]=1;return t}function Kn(n,e){if(e==null||e==="float32"||e==="complex64")return new Float32Array(n);if(e==="int32")return new Int32Array(n);if(e==="bool")return new Uint8Array(n);throw new Error(`Unknown data type ${e}`)}function Y2(n,e){const t=n.reduce((s,r)=>s*r,1);if(e==null||e==="float32")return cr(n,new Float32Array(t));if(e==="int32")return cr(n,new Int32Array(t));if(e==="bool")return cr(n,new Uint8Array(t));throw new Error(`Unknown data type ${e}`)}function Ks(n){n.forEach(e=>{L(Number.isInteger(e)&&e>=0,()=>`Tensor must have a shape comprised of positive integers but got shape [${n}].`)})}function eo(n,e,t){if(e===0)return 0;if(e===1)return n[0];let s=n[n.length-1];for(let r=0;r<n.length-1;++r)s+=t[r]*n[r];return s}function uu(n,e,t){if(e===0)return[];if(e===1)return[n];const s=new Array(e);for(let r=0;r<s.length-1;++r)s[r]=Math.floor(n/t[r]),n-=s[r]*t[r];return s[s.length-1]=n,s}function Ca(n){return n&&n.then&&typeof n.then=="function"}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lN="tfjsflags";class _V{constructor(e){this.global=e,this.flags={},this.flagRegistry={},this.urlFlags={},this.getQueryParams=FV,this.populateURLFlags()}setPlatform(e,t){this.platform!=null&&(ae().getBool("IS_TEST")||ae().getBool("PROD")||console.warn(`Platform ${this.platformName} has already been set. Overwriting the platform with ${e}.`)),this.platformName=e,this.platform=t}registerFlag(e,t,s){if(this.flagRegistry[e]={evaluationFn:t,setHook:s},this.urlFlags[e]!=null){const r=this.urlFlags[e];ae().getBool("IS_TEST")||ae().getBool("PROD")||console.warn(`Setting feature override from URL ${e}: ${r}.`),this.set(e,r)}}async getAsync(e){return e in this.flags?this.flags[e]:(this.flags[e]=await this.evaluateFlag(e),this.flags[e])}get(e){if(e in this.flags)return this.flags[e];const t=this.evaluateFlag(e);if(Ca(t))throw new Error(`Flag ${e} cannot be synchronously evaluated. Please use getAsync() instead.`);return this.flags[e]=t,this.flags[e]}getNumber(e){return this.get(e)}getBool(e){return this.get(e)}getString(e){return this.get(e)}getFlags(){return this.flags}get features(){return this.flags}set(e,t){if(this.flagRegistry[e]==null)throw new Error(`Cannot set flag ${e} as it has not been registered.`);this.flags[e]=t,this.flagRegistry[e].setHook!=null&&this.flagRegistry[e].setHook(t)}evaluateFlag(e){if(this.flagRegistry[e]==null)throw new Error(`Cannot evaluate flag '${e}': no evaluation function found.`);return this.flagRegistry[e].evaluationFn()}setFlags(e){this.flags=Object.assign({},e)}reset(){this.flags={},this.urlFlags={},this.populateURLFlags()}populateURLFlags(){if(typeof this.global>"u"||typeof this.global.location>"u"||typeof this.global.location.search>"u")return;const e=this.getQueryParams(this.global.location.search);lN in e&&e[lN].split(",").forEach(s=>{const[r,o]=s.split(":");this.urlFlags[r]=LV(r,o)})}}function FV(n){const e={};return n.replace(/[?&]([^=?&]+)(?:=([^&]*))?/g,(t,...s)=>(PV(e,s[0],s[1]),s.join("="))),e}function PV(n,e,t){n[decodeURIComponent(e)]=decodeURIComponent(t||"")}function LV(n,e){const t=e.toLowerCase();return t==="true"||t==="false"?t==="true":`${+t}`===t?+t:e}function ae(){return Q2}let Q2=null;function MV(n){Q2=n}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let ox;function Z2(){if(ox==null){let n;if(typeof window<"u")n=window;else if(typeof global<"u")n=global;else if(typeof process<"u")n=process;else if(typeof self<"u")n=self;else throw new Error("Could not find a global object");ox=n}return ox}function zV(){const n=Z2();return n._tfGlobals==null&&(n._tfGlobals=new Map),n._tfGlobals}function kw(n,e){const t=zV();if(t.has(n))return t.get(n);{const s=e();return t.set(n,s),t.get(n)}}const dm="Abs",nh="Acos",sh="Acosh",cu="Add",pm="AddN",Tw="All",Nw="Any",fm="ArgMax",mm="ArgMin",rh="Asin",oh="Asinh",ih="Atan",ah="Atanh",lh="Atan2",gm="AvgPool",Iw="AvgPoolGrad",ym="AvgPool3D",$w="AvgPool3DGrad",xm="BatchMatMul",vm="BatchToSpaceND",Ew="Bincount",wm="BitwiseAnd",VV="BroadcastTo",Rw="BroadcastArgs",uh="Cast",ch="Ceil",hh="ClipByValue",Dw="Complex",bm="ComplexAbs",Sm="Concat",Cm="Conv2D",Aw="Conv2DBackpropFilter",km="Conv2DBackpropInput",Tm="Conv3D",Ow="Conv3DBackpropFilterV2",_w="Conv3DBackpropInputV2",dh="Cos",ph="Cosh",Fw="Cumprod",Nm="Cumsum",Pw="CropAndResize",Lw="DenseBincount",Mw="DepthToSpace",Im="DepthwiseConv2dNative",zw="DepthwiseConv2dNativeBackpropFilter",Vw="DepthwiseConv2dNativeBackpropInput",Bw="Diag",$m="Dilation2D",Qx="Dilation2DBackpropInput",Zx="Dilation2DBackpropFilter",BV="Draw",fh="RealDiv",Ww="Einsum",mh="Elu",Uw="EluGrad",gh="Erf",Em="Equal",yh="Exp",Rm="ExpandDims",xh="Expm1",Gw="FFT",jw="Fill",Hw="FlipLeftRight",vh="Floor",wh="FloorDiv",Dm="FusedBatchNorm",Am="GatherV2",Kw="GatherNd",Om="Greater",bh="GreaterEqual",Sh="Identity",qw="IFFT",Xw="Imag",Ch="IsFinite",kh="IsInf",Th="IsNan",_m="LeakyRelu",Fm="Less",Pm="LessEqual",Yw="LinSpace",Nh="Log",Ih="Log1p",Lm="LogicalAnd",Mm="LogicalNot",zm="LogicalOr",WV="LogSoftmax",Vm="LRN",Qw="LRNGrad",Bm="Max",$h="Maximum",Wm="MaxPool",Zw="MaxPoolGrad",Um="MaxPool3D",Jw="MaxPool3DGrad",e1="MaxPoolWithArgmax",Gm="Mean",jm="Min",Eh="Minimum",Hm="MirrorPad",Rh="Mod",t1="Multinomial",Dh="Multiply",Km="Neg",qm="NotEqual",n1="NonMaxSuppressionV3",s1="NonMaxSuppressionV4",r1="NonMaxSuppressionV5",Xm="OnesLike",Ym="OneHot",Qm="Pack",Zm="PadV2",Ah="Pow",Jm="Prelu",eg="Prod",o1="RaggedGather",i1="RaggedRange",a1="RaggedTensorToTensor",l1="Range",u1="Real",Oh="Reciprocal",_h="Relu",tg="Reshape",ng="ResizeNearestNeighbor",c1="ResizeNearestNeighborGrad",sg="ResizeBilinear",h1="ResizeBilinearGrad",Fh="Relu6",rg="Reverse",Ph="Round",Lh="Rsqrt",d1="ScatterNd",p1="TensorScatterUpdate",f1="SearchSorted",og="Select",Mh="Selu",ig="Slice",zh="Sin",Vh="Sinh",Bh="Sign",Wh="Sigmoid",Uh="Softplus",Gh="Sqrt",ag="Sum",lg="SpaceToBatchND",ug="SplitV",cg="Softmax",m1="SparseFillEmptyRows",g1="SparseReshape",y1="SparseSegmentMean",x1="SparseSegmentSum",v1="SparseToDense",jh="SquaredDifference",w1="Square",hg="StaticRegexReplace",b1="StridedSlice",S1="StringNGrams",C1="StringSplit",k1="StringToHashBucketFast",Hh="Sub",Kh="Tan",qh="Tanh",Xh="Tile",T1="TopK",N1="Transform",Ll="Transpose",I1="Unique",dg="Unpack",pg="UnsortedSegmentSum",fg="ZerosLike",Yh="Step",Jx="FromPixels",$1="RotateWithOffset",Tf="_FusedMatMul",Nf="FusedConv2D",If="FusedDepthwiseConv2D";/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Us(...n){ae().getBool("IS_TEST")||ae().getBool("PROD")||console.warn(...n)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $f=kw("kernelRegistry",()=>new Map),ev=kw("gradRegistry",()=>new Map);function tv(n,e){const t=eE(n,e);return $f.get(t)}function uN(n){return ev.get(n)}function cN(n){const e=$f.entries(),t=[];for(;;){const{done:s,value:r}=e.next();if(s)break;const[o,i]=r,[a]=o.split("_");a===n&&t.push(i)}return t}function J2(n){const{kernelName:e,backendName:t}=n,s=eE(e,t);$f.has(s)&&Us(`The kernel '${e}' for backend '${t}' is already registered`),$f.set(s,n)}function UV(n){const{kernelName:e}=n;ev.has(e)&&ae().getBool("DEBUG")&&Us(`Overriding the gradient for '${e}'`),ev.set(e,n)}function eE(n,e){return`${e}_${n}`}/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tE(n){return n instanceof Float32Array||n instanceof Int32Array||n instanceof Uint8Array||n instanceof Uint8ClampedArray}var ix,hN;function GV(){if(hN)return ix;hN=1,ix=e;var n=null;try{n=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch{}function e(P,R,W){this.low=P|0,this.high=R|0,this.unsigned=!!W}e.prototype.__isLong__,Object.defineProperty(e.prototype,"__isLong__",{value:!0});function t(P){return(P&&P.__isLong__)===!0}e.isLong=t;var s={},r={};function o(P,R){var W,Q,ee;return R?(P>>>=0,(ee=0<=P&&P<256)&&(Q=r[P],Q)?Q:(W=a(P,(P|0)<0?-1:0,!0),ee&&(r[P]=W),W)):(P|=0,(ee=-128<=P&&P<128)&&(Q=s[P],Q)?Q:(W=a(P,P<0?-1:0,!1),ee&&(s[P]=W),W))}e.fromInt=o;function i(P,R){if(isNaN(P))return R?S:w;if(R){if(P<0)return S;if(P>=y)return D}else{if(P<=-x)return O;if(P+1>=x)return E}return P<0?i(-P,R).neg():a(P%m|0,P/m|0,R)}e.fromNumber=i;function a(P,R,W){return new e(P,R,W)}e.fromBits=a;var l=Math.pow;function u(P,R,W){if(P.length===0)throw Error("empty string");if(P==="NaN"||P==="Infinity"||P==="+Infinity"||P==="-Infinity")return w;if(typeof R=="number"?(W=R,R=!1):R=!!R,W=W||10,W<2||36<W)throw RangeError("radix");var Q;if((Q=P.indexOf("-"))>0)throw Error("interior hyphen");if(Q===0)return u(P.substring(1),R,W).neg();for(var ee=i(l(W,8)),te=w,oe=0;oe<P.length;oe+=8){var se=Math.min(8,P.length-oe),G=parseInt(P.substring(oe,oe+se),W);if(se<8){var V=i(l(W,se));te=te.mul(V).add(i(G))}else te=te.mul(ee),te=te.add(i(G))}return te.unsigned=R,te}e.fromString=u;function h(P,R){return typeof P=="number"?i(P,R):typeof P=="string"?u(P,R):a(P.low,P.high,typeof R=="boolean"?R:P.unsigned)}e.fromValue=h;var p=65536,f=1<<24,m=p*p,y=m*m,x=y/2,v=o(f),w=o(0);e.ZERO=w;var S=o(0,!0);e.UZERO=S;var k=o(1);e.ONE=k;var T=o(1,!0);e.UONE=T;var I=o(-1);e.NEG_ONE=I;var E=a(-1,2147483647,!1);e.MAX_VALUE=E;var D=a(-1,-1,!0);e.MAX_UNSIGNED_VALUE=D;var O=a(0,-2147483648,!1);e.MIN_VALUE=O;var _=e.prototype;return _.toInt=function(){return this.unsigned?this.low>>>0:this.low},_.toNumber=function(){return this.unsigned?(this.high>>>0)*m+(this.low>>>0):this.high*m+(this.low>>>0)},_.toString=function(R){if(R=R||10,R<2||36<R)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative())if(this.eq(O)){var W=i(R),Q=this.div(W),ee=Q.mul(W).sub(this);return Q.toString(R)+ee.toInt().toString(R)}else return"-"+this.neg().toString(R);for(var te=i(l(R,6),this.unsigned),oe=this,se="";;){var G=oe.div(te),V=oe.sub(G.mul(te)).toInt()>>>0,B=V.toString(R);if(oe=G,oe.isZero())return B+se;for(;B.length<6;)B="0"+B;se=""+B+se}},_.getHighBits=function(){return this.high},_.getHighBitsUnsigned=function(){return this.high>>>0},_.getLowBits=function(){return this.low},_.getLowBitsUnsigned=function(){return this.low>>>0},_.getNumBitsAbs=function(){if(this.isNegative())return this.eq(O)?64:this.neg().getNumBitsAbs();for(var R=this.high!=0?this.high:this.low,W=31;W>0&&(R&1<<W)==0;W--);return this.high!=0?W+33:W+1},_.isZero=function(){return this.high===0&&this.low===0},_.eqz=_.isZero,_.isNegative=function(){return!this.unsigned&&this.high<0},_.isPositive=function(){return this.unsigned||this.high>=0},_.isOdd=function(){return(this.low&1)===1},_.isEven=function(){return(this.low&1)===0},_.equals=function(R){return t(R)||(R=h(R)),this.unsigned!==R.unsigned&&this.high>>>31===1&&R.high>>>31===1?!1:this.high===R.high&&this.low===R.low},_.eq=_.equals,_.notEquals=function(R){return!this.eq(R)},_.neq=_.notEquals,_.ne=_.notEquals,_.lessThan=function(R){return this.comp(R)<0},_.lt=_.lessThan,_.lessThanOrEqual=function(R){return this.comp(R)<=0},_.lte=_.lessThanOrEqual,_.le=_.lessThanOrEqual,_.greaterThan=function(R){return this.comp(R)>0},_.gt=_.greaterThan,_.greaterThanOrEqual=function(R){return this.comp(R)>=0},_.gte=_.greaterThanOrEqual,_.ge=_.greaterThanOrEqual,_.compare=function(R){if(t(R)||(R=h(R)),this.eq(R))return 0;var W=this.isNegative(),Q=R.isNegative();return W&&!Q?-1:!W&&Q?1:this.unsigned?R.high>>>0>this.high>>>0||R.high===this.high&&R.low>>>0>this.low>>>0?-1:1:this.sub(R).isNegative()?-1:1},_.comp=_.compare,_.negate=function(){return!this.unsigned&&this.eq(O)?O:this.not().add(k)},_.neg=_.negate,_.add=function(R){t(R)||(R=h(R));var W=this.high>>>16,Q=this.high&65535,ee=this.low>>>16,te=this.low&65535,oe=R.high>>>16,se=R.high&65535,G=R.low>>>16,V=R.low&65535,B=0,F=0,z=0,q=0;return q+=te+V,z+=q>>>16,q&=65535,z+=ee+G,F+=z>>>16,z&=65535,F+=Q+se,B+=F>>>16,F&=65535,B+=W+oe,B&=65535,a(z<<16|q,B<<16|F,this.unsigned)},_.subtract=function(R){return t(R)||(R=h(R)),this.add(R.neg())},_.sub=_.subtract,_.multiply=function(R){if(this.isZero())return w;if(t(R)||(R=h(R)),n){var W=n.mul(this.low,this.high,R.low,R.high);return a(W,n.get_high(),this.unsigned)}if(R.isZero())return w;if(this.eq(O))return R.isOdd()?O:w;if(R.eq(O))return this.isOdd()?O:w;if(this.isNegative())return R.isNegative()?this.neg().mul(R.neg()):this.neg().mul(R).neg();if(R.isNegative())return this.mul(R.neg()).neg();if(this.lt(v)&&R.lt(v))return i(this.toNumber()*R.toNumber(),this.unsigned);var Q=this.high>>>16,ee=this.high&65535,te=this.low>>>16,oe=this.low&65535,se=R.high>>>16,G=R.high&65535,V=R.low>>>16,B=R.low&65535,F=0,z=0,q=0,re=0;return re+=oe*B,q+=re>>>16,re&=65535,q+=te*B,z+=q>>>16,q&=65535,q+=oe*V,z+=q>>>16,q&=65535,z+=ee*B,F+=z>>>16,z&=65535,z+=te*V,F+=z>>>16,z&=65535,z+=oe*G,F+=z>>>16,z&=65535,F+=Q*B+ee*V+te*G+oe*se,F&=65535,a(q<<16|re,F<<16|z,this.unsigned)},_.mul=_.multiply,_.divide=function(R){if(t(R)||(R=h(R)),R.isZero())throw Error("division by zero");if(n){if(!this.unsigned&&this.high===-2147483648&&R.low===-1&&R.high===-1)return this;var W=(this.unsigned?n.div_u:n.div_s)(this.low,this.high,R.low,R.high);return a(W,n.get_high(),this.unsigned)}if(this.isZero())return this.unsigned?S:w;var Q,ee,te;if(this.unsigned){if(R.unsigned||(R=R.toUnsigned()),R.gt(this))return S;if(R.gt(this.shru(1)))return T;te=S}else{if(this.eq(O)){if(R.eq(k)||R.eq(I))return O;if(R.eq(O))return k;var oe=this.shr(1);return Q=oe.div(R).shl(1),Q.eq(w)?R.isNegative()?k:I:(ee=this.sub(R.mul(Q)),te=Q.add(ee.div(R)),te)}else if(R.eq(O))return this.unsigned?S:w;if(this.isNegative())return R.isNegative()?this.neg().div(R.neg()):this.neg().div(R).neg();if(R.isNegative())return this.div(R.neg()).neg();te=w}for(ee=this;ee.gte(R);){Q=Math.max(1,Math.floor(ee.toNumber()/R.toNumber()));for(var se=Math.ceil(Math.log(Q)/Math.LN2),G=se<=48?1:l(2,se-48),V=i(Q),B=V.mul(R);B.isNegative()||B.gt(ee);)Q-=G,V=i(Q,this.unsigned),B=V.mul(R);V.isZero()&&(V=k),te=te.add(V),ee=ee.sub(B)}return te},_.div=_.divide,_.modulo=function(R){if(t(R)||(R=h(R)),n){var W=(this.unsigned?n.rem_u:n.rem_s)(this.low,this.high,R.low,R.high);return a(W,n.get_high(),this.unsigned)}return this.sub(this.div(R).mul(R))},_.mod=_.modulo,_.rem=_.modulo,_.not=function(){return a(~this.low,~this.high,this.unsigned)},_.and=function(R){return t(R)||(R=h(R)),a(this.low&R.low,this.high&R.high,this.unsigned)},_.or=function(R){return t(R)||(R=h(R)),a(this.low|R.low,this.high|R.high,this.unsigned)},_.xor=function(R){return t(R)||(R=h(R)),a(this.low^R.low,this.high^R.high,this.unsigned)},_.shiftLeft=function(R){return t(R)&&(R=R.toInt()),(R&=63)===0?this:R<32?a(this.low<<R,this.high<<R|this.low>>>32-R,this.unsigned):a(0,this.low<<R-32,this.unsigned)},_.shl=_.shiftLeft,_.shiftRight=function(R){return t(R)&&(R=R.toInt()),(R&=63)===0?this:R<32?a(this.low>>>R|this.high<<32-R,this.high>>R,this.unsigned):a(this.high>>R-32,this.high>=0?0:-1,this.unsigned)},_.shr=_.shiftRight,_.shiftRightUnsigned=function(R){if(t(R)&&(R=R.toInt()),R&=63,R===0)return this;var W=this.high;if(R<32){var Q=this.low;return a(Q>>>R|W<<32-R,W>>>R,this.unsigned)}else return R===32?a(W,0,this.unsigned):a(W>>>R-32,0,this.unsigned)},_.shru=_.shiftRightUnsigned,_.shr_u=_.shiftRightUnsigned,_.toSigned=function(){return this.unsigned?a(this.low,this.high,!1):this},_.toUnsigned=function(){return this.unsigned?this:a(this.low,this.high,!0)},_.toBytes=function(R){return R?this.toBytesLE():this.toBytesBE()},_.toBytesLE=function(){var R=this.high,W=this.low;return[W&255,W>>>8&255,W>>>16&255,W>>>24,R&255,R>>>8&255,R>>>16&255,R>>>24]},_.toBytesBE=function(){var R=this.high,W=this.low;return[R>>>24,R>>>16&255,R>>>8&255,R&255,W>>>24,W>>>16&255,W>>>8&255,W&255]},e.fromBytes=function(R,W,Q){return Q?e.fromBytesLE(R,W):e.fromBytesBE(R,W)},e.fromBytesLE=function(R,W){return new e(R[0]|R[1]<<8|R[2]<<16|R[3]<<24,R[4]|R[5]<<8|R[6]<<16|R[7]<<24,W)},e.fromBytesBE=function(R,W){return new e(R[4]<<24|R[5]<<16|R[6]<<8|R[7],R[0]<<24|R[1]<<16|R[2]<<8|R[3],W)},ix}var nE=GV();const sE=am(nE),jV=IM({__proto__:null,default:sE},[nE]);/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ha=sE||jV;function mg(n){return ha.fromString(n,!0,16)}const rE=mg("c3a5c85c97cb3127"),ua=mg("b492b66fbe98f273"),ts=mg("9ae16a3b2f90404f");function nv(n){return n.xor(n.shru(47))}function oE(n,e,t){const s=n.slice(e,e+t);return ha.fromBytes(Array.from(s),!0,!0)}function Tt(n,e){return oE(n,e,8)}function dN(n,e){return oE(n,e,4)}function Cn(n,e){return e===0?n:n.shru(e).or(n.shl(64-e))}function mi(n,e,t=mg("9ddfea08eb382d69")){let s=n.xor(e).mul(t);s=s.xor(s.shru(47));let r=e.xor(s).mul(t);return r=r.xor(r.shru(47)),r=r.mul(t),r}function HV(n,e,t,s,r,o){r=r.add(n),o=Cn(o.add(r).add(s),21);const i=r;return r=r.add(e),r=r.add(t),o=o.add(Cn(r,44)),[r.add(s),o.add(i)]}function Fp(n,e,t,s){return HV(Tt(n,e),Tt(n,e+8),Tt(n,e+16),Tt(n,e+24),t,s)}function KV(n,e=n.length){if(e>=8){const t=ts.add(e*2),s=Tt(n,0).add(ts),r=Tt(n,e-8),o=Cn(r,37).mul(t).add(s),i=Cn(s,25).add(r).mul(t);return mi(o,i,t)}if(e>=4){const t=ts.add(e*2),s=dN(n,0);return mi(s.shl(3).add(e),dN(n,e-4),t)}if(e>0){const t=n[0],s=n[e>>1],r=n[e-1],o=t+(s<<8),i=e+(r<<2);return nv(ts.mul(o).xor(rE.mul(i))).mul(ts)}return ts}function qV(n,e=n.length){const t=ts.add(e*2),s=Tt(n,0).mul(ua),r=Tt(n,8),o=Tt(n,e-8).mul(t),i=Tt(n,e-16).mul(ts);return mi(Cn(s.add(r),43).add(Cn(o,30)).add(i),s.add(Cn(r.add(ts),18)).add(o),t)}function XV(n,e=n.length){const t=ts.add(e*2),s=Tt(n,0).mul(ts),r=Tt(n,8),o=Tt(n,e-8).mul(t),i=Tt(n,e-16).mul(ts),a=Cn(s.add(r),43).add(Cn(o,30)).add(i),l=mi(a,s.add(Cn(r.add(ts),18)).add(o),t),u=Tt(n,16).mul(t),h=Tt(n,24),p=a.add(Tt(n,e-32)).mul(t),f=l.add(Tt(n,e-24)).mul(t);return mi(Cn(u.add(h),43).add(Cn(p,30)).add(f),u.add(Cn(h.add(s),18)).add(p),t)}function YV(n,e=n.length){const t=ha.fromNumber(81,!0);if(e<=32)return e<=16?KV(n,e):qV(n,e);if(e<=64)return XV(n,e);let s=t,r=t.mul(ua).add(113),o=nv(r.mul(ts).add(113)).mul(ts),i=[ha.UZERO,ha.UZERO],a=[ha.UZERO,ha.UZERO];s=s.mul(ts).add(Tt(n,0));let l=0;const u=(e-1>>6)*64,h=u+(e-1&63)-63;do s=Cn(s.add(r).add(i[0]).add(Tt(n,l+8)),37).mul(ua),r=Cn(r.add(i[1]).add(Tt(n,l+48)),42).mul(ua),s=s.xor(a[1]),r=r.add(i[0]).add(Tt(n,l+40)),o=Cn(o.add(a[0]),33).mul(ua),i=Fp(n,l,i[1].mul(ua),s.add(a[0])),a=Fp(n,l+32,o.add(a[1]),r.add(Tt(n,l+16))),[o,s]=[s,o],l+=64;while(l!==u);const p=ua.add(o.and(255).shl(1));return l=h,a[0]=a[0].add(e-1&63),i[0]=i[0].add(a[0]),a[0]=a[0].add(i[0]),s=Cn(s.add(r).add(i[0]).add(Tt(n,l+8)),37).mul(p),r=Cn(r.add(i[1]).add(Tt(n,l+48)),42).mul(p),s=s.xor(a[1].mul(9)),r=r.add(i[0].mul(9).add(Tt(n,l+40))),o=Cn(o.add(a[0]),33).mul(p),i=Fp(n,l,i[1].mul(p),s.add(a[0])),a=Fp(n,l+32,o.add(a[1]),r.add(Tt(n,l+16))),[o,s]=[s,o],mi(mi(i[0],a[0],p).add(nv(r).mul(rE)).add(o),mi(i[1],a[1],p).add(s),p)}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _i(n,e){return e==="string"?gi(n):Va([n],e)}function QV(n,e){return n instanceof Float32Array&&e==="float32"||n instanceof Int32Array&&e==="int32"||n instanceof Uint8Array&&e==="bool"}function Va(n,e){if(e==="string")throw new Error("Cannot convert a string[] to a TypedArray");if(Array.isArray(n)&&(n=ka(n)),ae().getBool("DEBUG")&&EV(n,e),QV(n,e))return n;if(e==null||e==="float32"||e==="complex64")return new Float32Array(n);if(e==="int32")return new Int32Array(n);if(e==="bool"){const t=new Uint8Array(n.length);for(let s=0;s<t.length;++s)Math.round(n[s])!==0&&(t[s]=1);return t}else throw new Error(`Unknown data type ${e}`)}function us(){return ae().platform.now()}function ZV(n,e){return ae().platform.fetch(n,e)}function gi(n,e="utf-8"){return e=e||"utf-8",ae().platform.encode(n,e)}function vi(n,e="utf-8"){return e=e||"utf-8",ae().platform.decode(n,e)}function pr(n){return ae().platform.isTypedArray!=null?ae().platform.isTypedArray(n):tE(n)}function ka(n,e=[],t=!1){if(e==null&&(e=[]),typeof n=="boolean"||typeof n=="number"||typeof n=="string"||Ca(n)||n==null||pr(n)&&t)e.push(n);else if(Array.isArray(n)||pr(n))for(let s=0;s<n.length;++s)ka(n[s],e,t);else{let s=-1;for(const r of Object.keys(n))/^([1-9]+[0-9]*|0)$/.test(r)&&(s=Math.max(s,Number(r)));for(let r=0;r<=s;r++)ka(n[r],e,t)}return e}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class JV{constructor(e,t){this.backendTimer=e,this.logger=t,t==null&&(this.logger=new tB)}profileKernel(e,t,s){let r;const o=()=>{r=s()};let i;const a=us();if(this.backendTimer.timerAvailable())i=this.backendTimer.time(o);else{o();for(const u of r)u.dataSync();i=Promise.resolve({kernelMs:us()-a})}if(ae().getBool("CHECK_COMPUTATION_FOR_ERRORS"))for(let u=0;u<r.length;u++){const h=r[u];h.data().then(p=>{eB(p,h.dtype,e)})}return{kernelName:e,outputs:r,inputs:t,timeMs:i.then(u=>u.kernelMs),extraInfo:i.then(u=>u.getExtraProfileInfo!=null?u.getExtraProfileInfo():"")}}logKernelProfile(e){const{kernelName:t,outputs:s,timeMs:r,inputs:o,extraInfo:i}=e;s.forEach(a=>{Promise.all([a.data(),r,i]).then(l=>{this.logger.logKernelProfile(t,a,l[0],l[1],o,l[2])})})}}function eB(n,e,t){if(e!=="float32")return!1;for(let s=0;s<n.length;s++){const r=n[s];if(isNaN(r)||!isFinite(r))return console.warn(`Found ${r} in the result of '${t}'`),!0}return!1}class tB{logKernelProfile(e,t,s,r,o,i){const a=typeof r=="number"?Pl(`${r}ms`,9):r.error,l=Pl(e,25),u=t.rank,h=t.size,p=Pl(t.shape.toString(),14);let f="";for(const m in o){const y=o[m];if(y!=null){const x=y.shape||t.shape,v=x.length;f+=`${m}: ${v}D ${v>0?x:""} `}}console.log(`%c${l}	%c${a}	%c${u}D ${p}	%c${h}	%c${f}	%c${i}`,"font-weight:bold","color:red","color:blue","color: orange","color: green","color: steelblue")}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nB(n,e,t){const s={},r={};for(let l=0;l<e.length;l++)s[e[l].id]=!0;for(let l=0;l<n.length;l++){const u=n[l],h=u.inputs;for(const p in h){const f=h[p];let m=!1;for(let y=0;y<e.length;y++)if(s[f.id]){u.outputs.forEach(x=>s[x.id]=!0),m=!0,r[u.id]=!0;break}if(m)break}}const o={};o[t.id]=!0;const i={};for(let l=n.length-1;l>=0;l--){const u=n[l],h=u.inputs;for(let p=0;p<u.outputs.length;p++)if(o[u.outputs[p].id]){for(const f in h)o[h[f].id]=!0,i[u.id]=!0;break}}const a=[];for(let l=0;l<n.length;l++){const u=n[l];if(r[u.id]&&i[u.id]){const h={};for(const f in u.inputs){const m=u.inputs[f];s[m.id]&&(h[f]=m)}const p=Object.assign({},u);p.inputs=h,p.outputs=u.outputs,a.push(p)}}return a}function sB(n,e,t,s){for(let r=e.length-1;r>=0;r--){const o=e[r],i=[];if(o.outputs.forEach(l=>{const u=n[l.id];u!=null?i.push(u):i.push(null)}),o.gradient==null)throw new Error(`Cannot compute gradient: gradient function not found for ${o.kernelName}.`);const a=o.gradient(i);for(const l in o.inputs){if(!(l in a))throw new Error(`Cannot backprop through input ${l}. Available gradients found: ${Object.keys(a)}.`);const u=t(()=>a[l]());if(u.dtype!=="float32")throw new Error(`Error in gradient for op ${o.kernelName}. The gradient of input ${l} must have 'float32' dtype, but has '${u.dtype}'`);const h=o.inputs[l];if(!ct(u.shape,h.shape))throw new Error(`Error in gradient for op ${o.kernelName}. The gradient of input '${l}' has shape '${u.shape}', which does not match the shape of the input '${h.shape}'`);if(n[h.id]==null)n[h.id]=u;else{const p=n[h.id];n[h.id]=s(p,u),p.dispose()}}}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pN=20,pc=3,ax=7;function rB(n,e,t,s){const r=Be(e),o=oB(n,e,t,r),i=e.length,a=rf(n,e,t,r,o),l=["Tensor"];return s&&(l.push(`  dtype: ${t}`),l.push(`  rank: ${i}`),l.push(`  shape: [${e}]`),l.push("  values:")),l.push(a.map(u=>"    "+u).join(`
`)),l.join(`
`)}function oB(n,e,t,s){const r=fe(e),o=s[s.length-1],i=new Array(o).fill(0),a=e.length,l=t==="complex64"?vc(n):n;if(a>1)for(let u=0;u<r/o;u++){const h=u*o;for(let p=0;p<o;p++)i[p]=Math.max(i[p],xc(l[h+p],0,t).length)}return i}function xc(n,e,t){let s;return Array.isArray(n)?s=`${parseFloat(n[0].toFixed(ax))} + ${parseFloat(n[1].toFixed(ax))}j`:th(n)?s=`'${n}'`:t==="bool"?s=iE(n):s=parseFloat(n.toFixed(ax)).toString(),Pl(s,e)}function iE(n){return n===0?"false":"true"}function rf(n,e,t,s,r,o=!0){const i=t==="complex64"?2:1,a=e[0],l=e.length;if(l===0){if(t==="complex64"){const x=vc(n);return[xc(x[0],0,t)]}return t==="bool"?[iE(n[0])]:[n[0].toString()]}if(l===1){if(a>pN){const v=pc*i;let w=Array.from(n.slice(0,v)),S=Array.from(n.slice((a-pc)*i,a*i));return t==="complex64"&&(w=vc(w),S=vc(S)),["["+w.map((k,T)=>xc(k,r[T],t)).join(", ")+", ..., "+S.map((k,T)=>xc(k,r[a-pc+T],t)).join(", ")+"]"]}return["["+(t==="complex64"?vc(n):Array.from(n)).map((v,w)=>xc(v,r[w],t)).join(", ")+"]"]}const u=e.slice(1),h=s.slice(1),p=s[0]*i,f=[];if(a>pN){for(let x=0;x<pc;x++){const v=x*p,w=v+p;f.push(...rf(n.slice(v,w),u,t,h,r,!1))}f.push("...");for(let x=a-pc;x<a;x++){const v=x*p,w=v+p;f.push(...rf(n.slice(v,w),u,t,h,r,x===a-1))}}else for(let x=0;x<a;x++){const v=x*p,w=v+p;f.push(...rf(n.slice(v,w),u,t,h,r,x===a-1))}const m=l===2?",":"";f[0]="["+(a>0?f[0]+m:"");for(let x=1;x<f.length-1;x++)f[x]=" "+f[x]+m;let y=`,
`;for(let x=2;x<l;x++)y+=`
`;return f[f.length-1]=" "+f[f.length-1]+"]"+(o?"":y),f}function vc(n){const e=[];for(let t=0;t<n.length;t+=2)e.push([n[t],n[t+1]]);return e}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class mn{constructor(e,t,s){if(this.dtype=t,this.shape=e.slice(),this.size=fe(e),s!=null){const r=s.length;L(r===this.size,()=>`Length of values '${r}' does not match the size inferred by the shape '${this.size}'.`)}if(t==="complex64")throw new Error("complex64 dtype TensorBuffers are not supported. Please create a TensorBuffer for the real and imaginary parts separately and call tf.complex(real, imag).");this.values=s||Qt(t,this.size),this.strides=Be(e)}set(e,...t){t.length===0&&(t=[0]),L(t.length===this.rank,()=>`The number of provided coordinates (${t.length}) must match the rank (${this.rank})`);const s=this.locToIndex(t);this.values[s]=e}get(...e){e.length===0&&(e=[0]);let t=0;for(const r of e){if(r<0||r>=this.shape[t]){const o=`Requested out of range element at ${e}.   Buffer shape=${this.shape}`;throw new Error(o)}t++}let s=e[e.length-1];for(let r=0;r<e.length-1;++r)s+=this.strides[r]*e[r];return this.values[s]}locToIndex(e){if(this.rank===0)return 0;if(this.rank===1)return e[0];let t=e[e.length-1];for(let s=0;s<e.length-1;++s)t+=this.strides[s]*e[s];return t}indexToLoc(e){if(this.rank===0)return[];if(this.rank===1)return[e];const t=new Array(this.shape.length);for(let s=0;s<t.length-1;++s)t[s]=Math.floor(e/this.strides[s]),e-=t[s]*this.strides[s];return t[t.length-1]=e,t}get rank(){return this.shape.length}toTensor(){return Ar().makeTensor(this.values,this.shape,this.dtype)}}let Ar=null,Il=null;function iB(n){Ar=n}function aB(n){Il=n}class $t{constructor(e,t,s,r){this.kept=!1,this.isDisposedInternal=!1,this.shape=e.slice(),this.dtype=t||"float32",this.size=fe(e),this.strides=Be(e),this.dataId=s,this.id=r,this.rankType=this.rank<5?this.rank.toString():"higher"}get rank(){return this.shape.length}async buffer(){const e=await this.data();return Il.buffer(this.shape,this.dtype,e)}bufferSync(){return Il.buffer(this.shape,this.dtype,this.dataSync())}async array(){const e=await this.data();return cr(this.shape,e,this.dtype==="complex64")}arraySync(){return cr(this.shape,this.dataSync(),this.dtype==="complex64")}async data(){this.throwIfDisposed();const e=Ar().read(this.dataId);if(this.dtype==="string"){const t=await e;try{return t.map(s=>vi(s))}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}}return e}dataToGPU(e){return this.throwIfDisposed(),Ar().readToGPU(this.dataId,e)}dataSync(){this.throwIfDisposed();const e=Ar().readSync(this.dataId);if(this.dtype==="string")try{return e.map(t=>vi(t))}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}return e}async bytes(){this.throwIfDisposed();const e=await Ar().read(this.dataId);return this.dtype==="string"?e:new Uint8Array(e.buffer)}dispose(){this.isDisposed||(this.kerasMask&&this.kerasMask.dispose(),Ar().disposeTensor(this),this.isDisposedInternal=!0)}get isDisposed(){return this.isDisposedInternal}throwIfDisposed(){if(this.isDisposed)throw new Error("Tensor is disposed.")}print(e=!1){return Il.print(this,e)}clone(){return this.throwIfDisposed(),Il.clone(this)}toString(e=!1){const t=this.dataSync();return rB(t,this.shape,this.dtype,e)}cast(e){return this.throwIfDisposed(),Il.cast(this,e)}variable(e=!0,t,s){return this.throwIfDisposed(),Ar().makeVariable(this,e,t,s)}}Object.defineProperty($t,Symbol.hasInstance,{value:n=>!!n&&n.data!=null&&n.dataSync!=null&&n.throwIfDisposed!=null});function me(){return kw("Tensor",()=>$t)}me();class Ef extends $t{constructor(e,t,s,r){super(e.shape,e.dtype,e.dataId,r),this.trainable=t,this.name=s}assign(e){if(e.dtype!==this.dtype)throw new Error(`dtype of the new value (${e.dtype}) and previous value (${this.dtype}) must match`);if(!ct(e.shape,this.shape))throw new Error(`shape of the new value (${e.shape}) and previous value (${this.shape}) must match`);Ar().disposeTensor(this),this.dataId=e.dataId,Ar().incRef(this,null)}dispose(){Ar().disposeVariable(this),this.isDisposedInternal=!0}}Object.defineProperty(Ef,Symbol.hasInstance,{value:n=>n instanceof $t&&n.assign!=null&&n.assign instanceof Function});/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var fN;(function(n){n.R0="R0",n.R1="R1",n.R2="R2",n.R3="R3",n.R4="R4",n.R5="R5",n.R6="R6"})(fN||(fN={}));var sv;(function(n){n.float32="float32",n.int32="int32",n.bool="int32",n.complex64="complex64"})(sv||(sv={}));var rv;(function(n){n.float32="float32",n.int32="int32",n.bool="bool",n.complex64="complex64"})(rv||(rv={}));var ov;(function(n){n.float32="float32",n.int32="float32",n.bool="float32",n.complex64="complex64"})(ov||(ov={}));var iv;(function(n){n.float32="complex64",n.int32="complex64",n.bool="complex64",n.complex64="complex64"})(iv||(iv={}));const lB={float32:ov,int32:sv,bool:rv,complex64:iv};function Ds(n,e){if(n==="string"||e==="string"){if(n==="string"&&e==="string")return"string";throw new Error(`Can not upcast ${n} with ${e}`)}return lB[n][e]}function E1(n){return Ds(n,"int32")}function aE(n){return n!=null&&typeof n=="object"&&"texture"in n&&n.texture instanceof WebGLTexture}function lE(n){return typeof GPUBuffer<"u"&&n!=null&&typeof n=="object"&&"buffer"in n&&n.buffer instanceof GPUBuffer}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ht(n,e){if(n.dtype===e.dtype)return[n,e];const t=Ds(n.dtype,e.dtype);return[n.cast(t),e.cast(t)]}function uB(n,e){L(n.dtype===e.dtype,()=>`The dtypes of the first(${n.dtype}) and second(${e.dtype}) input must match`)}function uE(n){const e=[];return cE(n,e,new Set),e}function cE(n,e,t){if(n==null)return;if(n instanceof $t){e.push(n);return}if(!cB(n))return;const s=n;for(const r in s){const o=s[r];t.has(o)||(t.add(o),cE(o,e,t))}}function cB(n){return Array.isArray(n)||typeof n=="object"}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lx(n){return n.kernelName!=null}class mN{constructor(){this.registeredVariables={},this.nextTapeNodeId=0,this.numBytes=0,this.numTensors=0,this.numStringTensors=0,this.numDataBuffers=0,this.gradientDepth=0,this.kernelDepth=0,this.scopeStack=[],this.numDataMovesStack=[],this.nextScopeId=0,this.tensorInfo=new WeakMap,this.profiling=!1,this.activeProfile={newBytes:0,newTensors:0,peakBytes:0,kernels:[],result:null,get kernelNames(){return Array.from(new Set(this.kernels.map(e=>e.name)))}}}dispose(){for(const e in this.registeredVariables)this.registeredVariables[e].dispose()}}class Kl{constructor(e){this.ENV=e,this.registry={},this.registryFactory={},this.pendingBackendInitId=0,this.state=new mN}async ready(){if(this.pendingBackendInit!=null)return this.pendingBackendInit.then(()=>{});if(this.backendInstance!=null)return;const e=this.getSortedBackends();for(let t=0;t<e.length;t++){const s=e[t];if(await this.initializeBackend(s).success){await this.setBackend(s);return}}throw new Error("Could not initialize any backends, all backend initializations failed.")}get backend(){if(this.pendingBackendInit!=null)throw new Error(`Backend '${this.backendName}' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods`);if(this.backendInstance==null){const{name:e,asyncInit:t}=this.initializeBackendsAndReturnBest();if(t)throw new Error(`The highest priority backend '${e}' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods`);this.setBackend(e)}return this.backendInstance}backendNames(){return Object.keys(this.registryFactory)}findBackend(e){if(!(e in this.registry))if(e in this.registryFactory){const{asyncInit:t}=this.initializeBackend(e);if(t)return null}else return null;return this.registry[e]}findBackendFactory(e){return e in this.registryFactory?this.registryFactory[e].factory:null}registerBackend(e,t,s=1){return e in this.registryFactory?(Us(`${e} backend was already registered. Reusing existing backend factory.`),!1):(this.registryFactory[e]={factory:t,priority:s},!0)}async setBackend(e){if(this.registryFactory[e]==null)throw new Error(`Backend name '${e}' not found in registry`);if(this.backendName=e,this.registry[e]==null){this.backendInstance=null;const{success:t,asyncInit:s}=this.initializeBackend(e);if(!(s?await t:t))return!1}return this.backendInstance=this.registry[e],this.setupRegisteredKernels(),this.profiler=new JV(this.backendInstance),!0}setupRegisteredKernels(){cN(this.backendName).forEach(t=>{t.setupFunc!=null&&t.setupFunc(this.backendInstance)})}disposeRegisteredKernels(e){cN(e).forEach(s=>{s.disposeFunc!=null&&s.disposeFunc(this.registry[e])})}initializeBackend(e){const t=this.registryFactory[e];if(t==null)throw new Error(`Cannot initialize backend ${e}, no registration found.`);try{const s=t.factory();if(s&&!(s instanceof ww)&&typeof s.then=="function"){const r=++this.pendingBackendInitId,o=s.then(i=>r<this.pendingBackendInitId?!1:(this.registry[e]=i,this.pendingBackendInit=null,!0)).catch(i=>(r<this.pendingBackendInitId||(this.pendingBackendInit=null,Us(`Initialization of backend ${e} failed`),Us(i.stack||i.message)),!1));return this.pendingBackendInit=o,{success:o,asyncInit:!0}}else return this.registry[e]=s,{success:!0,asyncInit:!1}}catch(s){return Us(`Initialization of backend ${e} failed`),Us(s.stack||s.message),{success:!1,asyncInit:!1}}}removeBackend(e){if(!(e in this.registryFactory))throw new Error(`${e} backend not found in registry`);this.backendName===e&&this.pendingBackendInit!=null&&this.pendingBackendInitId++,e in this.registry&&(this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e]),delete this.registryFactory[e],this.backendName===e&&(this.pendingBackendInit=null,this.backendName=null,this.backendInstance=null)}getSortedBackends(){if(Object.keys(this.registryFactory).length===0)throw new Error("No backend found in registry.");return Object.keys(this.registryFactory).sort((e,t)=>this.registryFactory[t].priority-this.registryFactory[e].priority)}initializeBackendsAndReturnBest(){const e=this.getSortedBackends();for(let t=0;t<e.length;t++){const s=e[t],{success:r,asyncInit:o}=this.initializeBackend(s);if(o||r)return{name:s,asyncInit:o}}throw new Error("Could not initialize any backends, all backend initializations failed.")}moveData(e,t){const s=this.state.tensorInfo.get(t),r=s.backend,o=this.readSync(t),i=r.refCount(t);r.disposeData(t,!0),s.backend=e,e.move(t,o,s.shape,s.dtype,i),this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack[this.state.numDataMovesStack.length-1]++}tidy(e,t){let s=null;if(t==null){if(typeof e!="function")throw new Error("Please provide a function to tidy()");t=e}else{if(typeof e!="string"&&!(e instanceof String))throw new Error("When calling with two arguments, the first argument to tidy() must be a string");if(typeof t!="function")throw new Error("When calling with two arguments, the 2nd argument to tidy() must be a function");s=e}let r;return this.scopedRun(()=>this.startScope(s),()=>this.endScope(r),()=>(r=t(),r instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),r))}scopedRun(e,t,s){e();try{const r=s();return t(),r}catch(r){throw t(),r}}nextTensorId(){return Kl.nextTensorId++}nextVariableId(){return Kl.nextVariableId++}clone(e){const t=K.runKernel(Sh,{x:e}),s={x:e},r=i=>({x:()=>{const a="float32",l={x:i},u={dtype:a};return K.runKernel(uh,l,u)}}),o=[];return this.addTapeNode(this.state.activeScope.name,s,[t],r,o,{}),t}runKernel(e,t,s){if(this.backendName==null&&this.backend,!(tv(e,this.backendName)!=null))throw new Error(`Kernel '${e}' not registered for backend '${this.backendName}'`);return this.runKernelFunc({kernelName:e,inputs:t,attrs:s})}shouldCheckForMemLeaks(){return this.ENV.getBool("IS_TEST")}checkKernelForMemLeak(e,t,s){const r=this.backend.numDataIds();let o=0;s.forEach(l=>{o+=l.dtype==="complex64"?3:1});const i=this.state.numDataMovesStack[this.state.numDataMovesStack.length-1],a=r-t-o-i;if(a>0)throw new Error(`Backend '${this.backendName}' has an internal memory leak (${a} data ids) after running '${e}'`)}runKernelFunc(e){let t,s=[];const r=this.isTapeOn(),o=this.state.numBytes,i=this.state.numTensors;this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack.push(0);let a;this.backendName==null&&this.backend;let l;const u=lx(e)?e.kernelName:this.state.activeScope!=null?this.state.activeScope.name:"";if(lx(e)){const{kernelName:y,inputs:x,attrs:v}=e;this.backendName==null&&this.backend;const w=tv(y,this.backendName);L(w!=null,()=>`Cannot find registered kernel '${y}' for backend '${this.backendName}'`),a=()=>{const S=this.backend.numDataIds();l=w.kernelFunc({inputs:x,attrs:v,backend:this.backend});const k=Array.isArray(l)?l:[l];this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(y,S,k);const T=k.map(I=>I.rank!=null?I:this.makeTensorFromTensorInfo(I));if(r){const I=this.getTensorsForGradient(y,x,T);s=this.saveTensorsForBackwardMode(I)}return T}}else{const{forwardFunc:y}=e,x=v=>{r&&(s=v.map(w=>this.keep(this.clone(w))))};a=()=>{const v=this.backend.numDataIds();l=this.tidy(()=>y(this.backend,x));const w=Array.isArray(l)?l:[l];return this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(u,v,w),w}}const{inputs:h,attrs:p}=e,f=lx(e)?null:e.backwardsFunc;let m;return this.scopedRun(()=>this.state.kernelDepth++,()=>this.state.kernelDepth--,()=>{!this.ENV.getBool("DEBUG")&&!this.state.profiling?t=a():(m=this.profiler.profileKernel(u,h,()=>a()),this.ENV.getBool("DEBUG")&&this.profiler.logKernelProfile(m),t=m.outputs)}),r&&this.addTapeNode(u,h,t,f,s,p),this.state.profiling&&this.state.activeProfile.kernels.push({name:u,bytesAdded:this.state.numBytes-o,totalBytesSnapshot:this.state.numBytes,tensorsAdded:this.state.numTensors-i,totalTensorsSnapshot:this.state.numTensors,inputShapes:Object.keys(h).map(y=>h[y]!=null?h[y].shape:null),outputShapes:t.map(y=>y.shape),kernelTimeMs:m.timeMs,extraInfo:m.extraInfo}),Array.isArray(l)?t:t[0]}saveTensorsForBackwardMode(e){return e.map(s=>this.keep(this.clone(s)))}getTensorsForGradient(e,t,s){const r=uN(e);if(r!=null){const o=r.inputsToSave||[],i=r.outputsToSave||[];let a;r.saveAllInputs?(L(Array.isArray(t),()=>"saveAllInputs is true, expected inputs to be an array."),a=Object.keys(t).map(u=>t[u])):a=o.map(u=>t[u]);const l=s.filter((u,h)=>i[h]);return a.concat(l)}return[]}makeTensor(e,t,s,r){if(e==null)throw new Error("Values passed to engine.makeTensor() are null");s=s||"float32",r=r||this.backend;let o=e;s==="string"&&th(e[0])&&(o=e.map(l=>gi(l)));const i=r.write(o,t,s),a=new $t(t,s,i,this.nextTensorId());if(this.trackTensor(a,r),s==="string"){const l=this.state.tensorInfo.get(i),u=DV(o);this.state.numBytes+=u-l.bytes,l.bytes=u}return a}makeTensorFromDataId(e,t,s,r){s=s||"float32";const o={dataId:e,shape:t,dtype:s};return this.makeTensorFromTensorInfo(o,r)}makeTensorFromTensorInfo(e,t){const{dataId:s,shape:r,dtype:o}=e,i=new $t(r,o,s,this.nextTensorId());return this.trackTensor(i,t),i}makeVariable(e,t=!0,s,r){s=s||this.nextVariableId().toString(),r!=null&&r!==e.dtype&&(e=e.cast(r));const o=new Ef(e,t,s,this.nextTensorId());if(this.state.registeredVariables[o.name]!=null)throw new Error(`Variable with name ${o.name} was already registered`);return this.state.registeredVariables[o.name]=o,this.incRef(o,this.backend),o}trackTensor(e,t){this.state.numTensors++,e.dtype==="string"&&this.state.numStringTensors++;let s=0;e.dtype!=="complex64"&&e.dtype!=="string"&&(s=e.size*kf(e.dtype)),this.state.numBytes+=s,this.state.tensorInfo.has(e.dataId)||(this.state.numDataBuffers++,this.state.tensorInfo.set(e.dataId,{backend:t||this.backend,dtype:e.dtype,shape:e.shape,bytes:s})),e instanceof Ef||this.track(e)}incRef(e,t){this.trackTensor(e,t),this.backend.incRef(e.dataId)}removeDataId(e,t){this.state.tensorInfo.has(e)&&this.state.tensorInfo.get(e).backend===t&&(this.state.tensorInfo.delete(e),this.state.numDataBuffers--)}disposeTensor(e){if(!this.state.tensorInfo.has(e.dataId))return;const t=this.state.tensorInfo.get(e.dataId);if(this.state.numTensors--,e.dtype==="string"&&(this.state.numStringTensors--,this.state.numBytes-=t.bytes),e.dtype!=="complex64"&&e.dtype!=="string"){const s=e.size*kf(e.dtype);this.state.numBytes-=s}t.backend.disposeData(e.dataId)&&this.removeDataId(e.dataId,t.backend)}disposeVariables(){for(const e in this.state.registeredVariables){const t=this.state.registeredVariables[e];this.disposeVariable(t)}}disposeVariable(e){this.disposeTensor(e),this.state.registeredVariables[e.name]!=null&&delete this.state.registeredVariables[e.name]}memory(){const e=this.backend.memory();return e.numTensors=this.state.numTensors,e.numDataBuffers=this.state.numDataBuffers,e.numBytes=this.state.numBytes,this.state.numStringTensors>0&&(e.unreliable=!0,e.reasons==null&&(e.reasons=[]),e.reasons.push("Memory usage by string tensors is approximate (2 bytes per character)")),e}async profile(e){this.state.profiling=!0;const t=this.state.numBytes,s=this.state.numTensors;this.state.activeProfile.kernels=[],this.state.activeProfile.result=await e(),this.state.profiling=!1,this.state.activeProfile.peakBytes=Math.max(...this.state.activeProfile.kernels.map(r=>r.totalBytesSnapshot)),this.state.activeProfile.newBytes=this.state.numBytes-t,this.state.activeProfile.newTensors=this.state.numTensors-s;for(const r of this.state.activeProfile.kernels)r.kernelTimeMs=await r.kernelTimeMs,r.extraInfo=await r.extraInfo;return this.state.activeProfile}isTapeOn(){return this.state.gradientDepth>0&&this.state.kernelDepth===0}addTapeNode(e,t,s,r,o,i){const a={id:this.state.nextTapeNodeId++,kernelName:e,inputs:t,outputs:s,saved:o},l=uN(e);l!=null&&(r=l.gradFunc),r!=null&&(a.gradient=u=>(u=u.map((h,p)=>{if(h==null){const f=s[p],m=Kn(f.size,f.dtype);return this.makeTensor(m,f.shape,f.dtype)}return h}),r(u.length>1?u:u[0],o,i))),this.state.activeTape.push(a)}keep(e){return e.kept=!0,e}startTape(){this.state.gradientDepth===0&&(this.state.activeTape=[]),this.state.gradientDepth++}endTape(){this.state.gradientDepth--}startScope(e){const t={track:[],name:"unnamed scope",id:this.state.nextScopeId++};e&&(t.name=e),this.state.scopeStack.push(t),this.state.activeScope=t}endScope(e){const t=uE(e),s=new Set(t.map(o=>o.id));for(let o=0;o<this.state.activeScope.track.length;o++){const i=this.state.activeScope.track[o];!i.kept&&!s.has(i.id)&&i.dispose()}const r=this.state.scopeStack.pop();this.state.activeScope=this.state.scopeStack.length===0?null:this.state.scopeStack[this.state.scopeStack.length-1],t.forEach(o=>{!o.kept&&o.scopeId===r.id&&this.track(o)})}gradients(e,t,s,r=!1){if(L(t.length>0,()=>"gradients() received an empty list of xs."),s!=null&&s.dtype!=="float32")throw new Error(`dy must have 'float32' dtype, but has '${s.dtype}'`);const o=this.scopedRun(()=>this.startTape(),()=>this.endTape(),()=>this.tidy("forward",e));L(o instanceof $t,()=>"The result y returned by f() must be a tensor.");const i=nB(this.state.activeTape,t,o);if(!r&&i.length===0&&t.length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that the f you passed encloses all operations that lead from x to y.");return this.tidy("backward",()=>{const a={};a[o.id]=s??hB(o.shape),sB(a,i,u=>this.tidy(u),dB);const l=t.map(u=>a[u.id]);return this.state.gradientDepth===0&&(this.state.activeTape.forEach(u=>{for(const h of u.saved)h.dispose()}),this.state.activeTape=null),{value:o,grads:l}})}customGrad(e){return L(Xx(e),()=>"The f passed in customGrad(f) must be a function."),(...t)=>{L(t.every(a=>a instanceof $t),()=>"The args passed in customGrad(f)(x1, x2,...) must all be tensors");let s;const r={};t.forEach((a,l)=>{r[l]=a});const o=(a,l)=>(s=e(...t,l),L(s.value instanceof $t,()=>"The function f passed in customGrad(f) must return an object where `obj.value` is a tensor"),L(Xx(s.gradFunc),()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function."),s.value),i=(a,l)=>{const u=s.gradFunc(a,l),h=Array.isArray(u)?u:[u];L(h.length===t.length,()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns the same number of tensors as inputs passed to f(...)."),L(h.every(f=>f instanceof $t),()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns a list of only tensors.");const p={};return h.forEach((f,m)=>{p[m]=()=>f}),p};return this.runKernelFunc({forwardFunc:o,backwardsFunc:i,inputs:r})}}readSync(e){return this.state.tensorInfo.get(e).backend.readSync(e)}read(e){return this.state.tensorInfo.get(e).backend.read(e)}readToGPU(e,t){return this.state.tensorInfo.get(e).backend.readToGPU(e,t)}async time(e){const t=us(),s=await this.backend.time(e);return s.wallMs=us()-t,s}track(e){return this.state.activeScope!=null&&(e.scopeId=this.state.activeScope.id,this.state.activeScope.track.push(e)),e}get registeredVariables(){return this.state.registeredVariables}reset(){this.pendingBackendInitId++,this.state.dispose(),this.ENV.reset(),this.state=new mN;for(const e in this.registry)this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e];this.backendName=null,this.backendInstance=null,this.pendingBackendInit=null}}Kl.nextTensorId=0;Kl.nextVariableId=0;function hB(n){const e=Cw(fe(n),"float32");return K.makeTensor(e,n,"float32")}function hE(){const n=Z2();if(n._tfengine==null){const e=new _V(n);n._tfengine=new Kl(e)}return MV(n._tfengine.ENV),iB(()=>n._tfengine),n._tfengine}const K=hE();function dB(n,e){const t={a:n,b:e};return K.runKernel(cu,t)}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pB(){return typeof navigator<"u"&&navigator!=null}function dE(n){if(n||pB()){if(n||(n=navigator),n.product==="ReactNative")return!0;const e=n.userAgent||n.vendor||(typeof window<"u"?window.opera:"");if(!e){const t=n;return t.userAgentData&&t.userAgentData.mobile}return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(e.substr(0,4))}return!1}function pE(){return typeof window<"u"&&window.document!=null||typeof WorkerGlobalScope<"u"}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fs=ae();fs.registerFlag("DEBUG",()=>!1,n=>{n&&console.warn("Debugging mode is ON. The output of every math call will be downloaded to CPU and checked for NaNs. This significantly impacts performance.")});fs.registerFlag("IS_BROWSER",()=>pE());fs.registerFlag("IS_NODE",()=>typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u");fs.registerFlag("IS_CHROME",()=>typeof navigator<"u"&&navigator!=null&&navigator.userAgent!=null&&/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor));fs.registerFlag("IS_SAFARI",()=>typeof navigator<"u"&&navigator!=null&&navigator.userAgent!=null&&/Safari/.test(navigator.userAgent)&&/Apple/.test(navigator.vendor));fs.registerFlag("PROD",()=>!1);fs.registerFlag("TENSORLIKE_CHECK_SHAPE_CONSISTENCY",()=>fs.getBool("DEBUG"));fs.registerFlag("DEPRECATION_WARNINGS_ENABLED",()=>!0);fs.registerFlag("IS_TEST",()=>!1);fs.registerFlag("CHECK_COMPUTATION_FOR_ERRORS",()=>fs.getBool("DEBUG"));fs.registerFlag("WRAP_TO_IMAGEBITMAP",()=>!1);fs.registerFlag("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU",()=>!1);fs.registerFlag("USE_SETTIMEOUTCUSTOM",()=>!1);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fi(n,e){let t=n;if(pr(n))return e==="string"?[]:[n.length];if(aE(n)){const r=n.channels||"RGBA";return[n.height,n.width*r.length]}else if(lE(n))return[n.buffer.size/(e==null?4:kf(e))];if(!Array.isArray(n))return[];const s=[];for(;Array.isArray(t)||pr(t)&&e!=="string";)s.push(t.length),t=t[0];return Array.isArray(n)&&ae().getBool("TENSORLIKE_CHECK_SHAPE_CONSISTENCY")&&fE(n,s,[]),s}function fE(n,e,t){if(t=t||[],!Array.isArray(n)&&!pr(n)){L(e.length===0,()=>`Element arr[${t.join("][")}] is a primitive, but should be an array/TypedArray of ${e[0]} elements`);return}L(e.length>0,()=>`Element arr[${t.join("][")}] should be a primitive, but is an array of ${n.length} elements`),L(n.length===e[0],()=>`Element arr[${t.join("][")}] should have ${e[0]} elements, but has ${n.length} elements`);const s=e.slice(1);for(let r=0;r<n.length;++r)fE(n[r],s,t.concat(r))}function gN(n,e,t,s){if(n!=="string_or_numeric"){if(n==null)throw new Error("Expected dtype cannot be null.");if(n!=="numeric"&&n!==e||n==="numeric"&&e==="string")throw new Error(`Argument '${t}' passed to '${s}' must be ${n} tensor, but got ${e} tensor`)}}function M(n,e,t,s="numeric"){if(n instanceof me())return gN(s,n.dtype,e,t),n;let r=lu(n);if(r!=="string"&&["bool","int32","float32"].indexOf(s)>=0&&(r=s),gN(s,r,e,t),n==null||!pr(n)&&!Array.isArray(n)&&typeof n!="number"&&typeof n!="boolean"&&typeof n!="string"){const l=n==null?"null":n.constructor.name;throw new Error(`Argument '${e}' passed to '${t}' must be a Tensor or TensorLike, but got '${l}'`)}const o=Fi(n,r);!pr(n)&&!Array.isArray(n)&&(n=[n]);const a=r!=="string"?Va(n,r):ka(n,[],!0);return K.makeTensor(a,o,r)}function Rf(n,e,t,s="numeric"){if(!Array.isArray(n))throw new Error(`Argument ${e} passed to ${t} must be a \`Tensor[]\` or \`TensorLike[]\``);return n.map((o,i)=>M(o,`${e}[${i}]`,t,s))}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mE="__op";function j(n){const e=Object.keys(n);if(e.length!==1)throw new Error(`Please provide an object with a single key (operation name) mapping to a function. Got an object with ${e.length} keys.`);let t=e[0];const s=n[t];t.endsWith("_")&&(t=t.substring(0,t.length-1)),t=t+mE;const r=(...o)=>{K.startScope(t);try{const i=s(...o);return Ca(i)&&console.error("Cannot return a Promise inside of tidy."),K.endScope(i),i}catch(i){throw K.endScope(null),i}};return Object.defineProperty(r,"name",{value:t,configurable:!0}),r}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fB(n,e){const t=M(n,"real","complex"),s=M(e,"imag","complex");Ls(t.shape,s.shape,`real and imag shapes, ${t.shape} and ${s.shape}, must match in call to tf.complex().`);const r={real:t,imag:s};return K.runKernel(Dw,r)}const wi=j({complex_:fB});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pi(n,e,t,s){if(s==null)s=lu(n);else if(s==="complex64")throw new Error("Cannot construct a complex64 tensor directly. Please use tf.complex(real, imag).");if(lE(n)||aE(n)){if(s!=="float32"&&s!=="int32")throw new Error(`Creating tensor from GPU data only supports 'float32'|'int32' dtype, while the dtype is ${s}.`);return K.backend.createTensorFromGPUData(n,e||t,s)}if(!pr(n)&&!Array.isArray(n)&&typeof n!="number"&&typeof n!="boolean"&&typeof n!="string")throw new Error("values passed to tensor(values) must be a number/boolean/string or an array of numbers/booleans/strings, or a TypedArray");if(e!=null){Ks(e);const r=fe(e),o=fe(t);L(r===o,()=>`Based on the provided shape, [${e}], the tensor should have ${r} values but has ${o}`);for(let i=0;i<t.length;++i){const a=t[i],l=i===t.length-1?a!==fe(e.slice(i)):!0;L(t[i]===e[i]||!l,()=>`Error creating a new Tensor. Inferred shape (${t}) does not match the provided shape (${e}). `)}}return!pr(n)&&!Array.isArray(n)&&(n=[n]),e=e||t,n=s!=="string"?Va(n,s):ka(n,[],!0),K.makeTensor(n,e,s)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _r(n,e,t){const s=Fi(n,t);return Pi(n,e,s,t)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ta={float32:4,float16:2,int32:4,uint16:2,uint8:1,bool:1,complex64:8};class Br{static join(e){return new Br(e).slice()}constructor(e){if(this.shards=[],this.previousShardIndex=0,e==null||(e instanceof Array||(e=[e]),e=e.map(s=>pr(s)?s.buffer:s),e.length===0))return;this.bufferUniformSize=e[0].byteLength;let t=0;for(let s=0;s<e.length;s++){const r=e[s];s!==e.length-1&&r.byteLength!==this.bufferUniformSize&&(this.bufferUniformSize=void 0);const o=t+r.byteLength;this.shards.push({buffer:r,start:t,end:o}),t=o}this.shards.length===0&&(this.byteLength=0),this.byteLength=this.shards[this.shards.length-1].end}slice(e=0,t=this.byteLength){if(this.shards.length===0)return new ArrayBuffer(0);if(e=isNaN(Number(e))?0:e,t=isNaN(Number(t))?0:t,e=Math.max(0,e),t=Math.min(this.byteLength,t),t<=e)return new ArrayBuffer(0);const s=this.findShardForByte(e);if(s===-1)throw new Error(`Could not find start shard for byte ${e}`);const r=t-e,o=new ArrayBuffer(r),i=new Uint8Array(o);let a=0;for(let l=s;l<this.shards.length;l++){const u=this.shards[l],p=e+a-u.start,f=a,y=Math.min(t,u.end)-u.start,x=new Uint8Array(u.buffer,p,y-p);if(i.set(x,f),a+=x.length,t<u.end)break}return o}findShardForByte(e){if(this.shards.length===0||e<0||e>=this.byteLength)return-1;if(this.bufferUniformSize!=null)return this.previousShardIndex=Math.floor(e/this.bufferUniformSize),this.previousShardIndex;function t(r){return e<r.start?-1:e>=r.end?1:0}if(t(this.shards[this.previousShardIndex])===0)return this.previousShardIndex;const s=mB(this.shards,t);return s===-1?-1:(this.previousShardIndex=s,this.previousShardIndex)}}function mB(n,e){let t=0,s=n.length;for(;t<=s;){const r=Math.floor((s-t)/2)+t,o=e(n[r]);if(o===0)return r;o<0?s=r:t=r+1}return-1}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qr(){return K}function yN(){return K.memory()}function ie(n,e){return K.tidy(n,e)}function ot(n){uE(n).forEach(t=>t.dispose())}function kn(n){return K.keep(n)}function gB(){return K.ready()}function R1(){return K.backendName}function gE(n,e,t=1){return K.registerBackend(n,e,t)}function yE(){return K.backend}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bi=4;async function av(n,e){const t=[],s=[],r=Array.isArray(n)?n.map(i=>i.name):Object.keys(n);for(let i=0;i<r.length;++i){const a=r[i],l=Array.isArray(n)?n[i].tensor:n[a];if(l.dtype!=="float32"&&l.dtype!=="int32"&&l.dtype!=="bool"&&l.dtype!=="string"&&l.dtype!=="complex64")throw new Error(`Unsupported dtype in weight '${a}': ${l.dtype}`);const u={name:a,shape:l.shape,dtype:l.dtype};if(l.dtype==="string"){const h=new Promise(async p=>{const f=await l.bytes(),m=f.reduce((v,w)=>v+w.length,0)+bi*f.length,y=new Uint8Array(m);let x=0;for(let v=0;v<f.length;v++){const w=f[v],S=new Uint8Array(new Uint32Array([w.length]).buffer);y.set(S,x),x+=bi,y.set(w,x),x+=w.length}p(y)});s.push(h)}else s.push(l.data());e!=null&&(u.group=e),t.push(u)}const o=await Promise.all(s);return{data:vB(o),specs:t}}function xE(n,e){const t=new Br(n),s={};let r=0;for(const o of e){const i=yB(o,(a,l)=>t.slice(r+a,r+l));s[o.name]=vE(o,t.slice(r,r+i)),r+=i}return s}function yB(n,e){const t=fe(n.shape);let s;if("quantization"in n){const r=n.quantization;s=Ta[r.dtype]}else if(n.dtype==="string"){let r=0;for(let o=0;o<t;o++)r+=bi+new Uint32Array(e(r,r+bi))[0];return r}else s=Ta[n.dtype];return t*s}async function xB(n,e){const t=fe(n.shape);let s;if("quantization"in n){const r=n.quantization;s=Ta[r.dtype]}else if(n.dtype==="string"){let r=0;for(let o=0;o<t;o++)r+=bi+new Uint32Array(await e(r,r+bi))[0];return r}else s=Ta[n.dtype];return t*s}function vE(n,e){const t=n.name,s=n.dtype,r=n.shape,o=fe(r);let i,a=0;if("quantization"in n){const l=n.quantization;if(l.dtype==="uint8"||l.dtype==="uint16"){if(!("min"in l&&"scale"in l))throw new Error(`Weight ${n.name} with quantization ${l.dtype} doesn't have corresponding metadata min and scale.`)}else if(l.dtype==="float16"){if(s!=="float32")throw new Error(`Weight ${n.name} is quantized with ${l.dtype} which only supports weights of type float32 not ${s}.`)}else throw new Error(`Weight ${n.name} has unknown quantization dtype ${l.dtype}. Supported quantization dtypes are: 'uint8', 'uint16', and 'float16'.`);const u=Ta[l.dtype],h=l.dtype==="uint8"?new Uint8Array(e):new Uint16Array(e);if(s==="float32")if(l.dtype==="uint8"||l.dtype==="uint16"){i=new Float32Array(h.length);for(let p=0;p<h.length;p++){const f=h[p];i[p]=f*l.scale+l.min}}else if(l.dtype==="float16")i=TB()(h);else throw new Error(`Unsupported quantization type ${l.dtype} for weight type float32.`);else if(s==="int32"){if(l.dtype!=="uint8"&&l.dtype!=="uint16")throw new Error(`Unsupported quantization type ${l.dtype} for weight type int32.`);i=new Int32Array(h.length);for(let p=0;p<h.length;p++){const f=h[p];i[p]=Math.round(f*l.scale+l.min)}}else throw new Error(`Unsupported dtype in weight '${t}': ${s}`);a+=o*u}else if(s==="string"){const l=fe(n.shape);i=[];for(let u=0;u<l;u++){const h=new Uint32Array(e.slice(a,a+bi))[0];a+=bi;const p=new Uint8Array(e.slice(a,a+h));i.push(p),a+=h}}else{const l=Ta[s];if(s==="float32")i=new Float32Array(e);else if(s==="int32")i=new Int32Array(e);else if(s==="bool")i=new Uint8Array(e);else if(s==="complex64"){i=new Float32Array(e);const u=new Float32Array(i.length/2),h=new Float32Array(i.length/2);for(let y=0;y<u.length;y++)u[y]=i[y*2],h[y]=i[y*2+1];const p=_r(u,r,"float32"),f=_r(h,r,"float32"),m=wi(p,f);return p.dispose(),f.dispose(),m}else throw new Error(`Unsupported dtype in weight '${t}': ${s}`);a+=o*l}return _r(i,r,s)}async function xN(n,e,t){let s=new Uint8Array(e);for(;s.byteLength<t;){const{done:r,value:o}=await n.read();if(r&&o==null){const a=t-s.byteLength;throw new Error(`Reader is done but ${a} bytes are still expected`)}const i=new Uint8Array(s.length+o.byteLength);i.set(s,0),i.set(new Uint8Array(o),s.length),s=i}return s.buffer}async function wE(n,e){const t={},s=n.getReader();let r=new ArrayBuffer(0);for(const o of e){const i=await xB(o,async(u,h)=>(r=await xN(s,r,h),r.slice(u,h)));r=await xN(s,r,i);const a=r.slice(0,i);r=r.slice(i);const l=vE(o,a);if(t[o.name]=l,R1()==="webgpu"){const u=yE();"uploadToGPU"in u&&fe(l.shape)>=ae().get("WEBGPU_CPU_HANDOFF_SIZE_THRESHOLD")&&u.uploadToGPU(l.dataId)}}return t}function vB(n){if(n===null)throw new Error(`Invalid input value: ${JSON.stringify(n)}`);let e=0;const t=[];n.forEach(o=>{if(e+=o.byteLength,t.push(o.byteLength===o.buffer.byteLength?o:new o.constructor(o)),!(o instanceof Float32Array||o instanceof Int32Array||o instanceof Uint8Array))throw new Error(`Unsupported TypedArray subtype: ${o.constructor.name}`)});const s=new Uint8Array(e);let r=0;return t.forEach(o=>{s.set(new Uint8Array(o.buffer),r),r+=o.byteLength}),s.buffer}const D1=typeof Buffer<"u"&&(typeof Blob>"u"||typeof atob>"u"||typeof btoa>"u");function vN(n){return D1?Buffer.byteLength(n,"utf8"):new Blob([n]).size}function wB(n){if(D1)return Buffer.from(n).toString("base64");const e=new Uint8Array(n);let t="";for(let s=0,r=e.length;s<r;s++)t+=String.fromCharCode(e[s]);return btoa(t)}function bB(n){if(D1){const s=Buffer.from(n,"base64");return s.buffer.slice(s.byteOffset,s.byteOffset+s.byteLength)}const e=atob(n),t=new Uint8Array(e.length);for(let s=0;s<e.length;++s)t.set([e.charCodeAt(s)],s);return t.buffer}function bE(n){return Br.join(n)}function wN(n){for(n=n.trim();n.endsWith("/");)n=n.slice(0,n.length-1);const t=n.split("/");return t[t.length-1]}function SE(n,e){const t={modelTopology:n.modelTopology,format:n.format,generatedBy:n.generatedBy,convertedBy:n.convertedBy,weightsManifest:e};return n.signature!=null&&(t.signature=n.signature),n.userDefinedMetadata!=null&&(t.userDefinedMetadata=n.userDefinedMetadata),n.modelInitializer!=null&&(t.modelInitializer=n.modelInitializer),n.initializerSignature!=null&&(t.initializerSignature=n.initializerSignature),n.trainingConfig!=null&&(t.trainingConfig=n.trainingConfig),t}function CE(n,e,t){const s={modelTopology:n.modelTopology,format:n.format,generatedBy:n.generatedBy,convertedBy:n.convertedBy};if(n.trainingConfig!=null&&(s.trainingConfig=n.trainingConfig),n.weightsManifest!=null){if(!e)throw new Error("modelJSON has weightsManifest but weightSpecs is null");if(!t)throw new Error("modelJSON has weightsManifest but weightData is null");s.weightSpecs=e,s.weightData=t}return n.signature!=null&&(s.signature=n.signature),n.userDefinedMetadata!=null&&(s.userDefinedMetadata=n.userDefinedMetadata),n.modelInitializer!=null&&(s.modelInitializer=n.modelInitializer),n.initializerSignature!=null&&(s.initializerSignature=n.initializerSignature),s}async function A1(n,e){let t,s;return n.weightsManifest!=null&&([t,s]=await e(n.weightsManifest)),CE(n,t,s)}function Qh(n){if(n.modelTopology instanceof ArrayBuffer)throw new Error("Expected JSON model topology, received ArrayBuffer.");return{dateSaved:new Date,modelTopologyType:"JSON",modelTopologyBytes:n.modelTopology==null?0:vN(JSON.stringify(n.modelTopology)),weightSpecsBytes:n.weightSpecs==null?0:vN(JSON.stringify(n.weightSpecs)),weightDataBytes:n.weightData==null?0:new Br(n.weightData).byteLength}}function lv(n){const e=[];for(const t of n)e.push(...t.weights);return e}function SB(){const n=t=>{let s=t<<13,r=0;for(;(s&8388608)===0;)r-=8388608,s<<=1;return s&=-8388609,r+=947912704,s|r},e=new Uint32Array(2048);e[0]=0;for(let t=1;t<1024;t++)e[t]=n(t);for(let t=1024;t<2048;t++)e[t]=939524096+(t-1024<<13);return e}function CB(){const n=new Uint32Array(64);n[0]=0,n[31]=1199570944,n[32]=2147483648,n[63]=3347054592;for(let e=1;e<31;e++)n[e]=e<<23;for(let e=33;e<63;e++)n[e]=2147483648+(e-32<<23);return n}function kB(){const n=new Uint32Array(64);for(let e=0;e<64;e++)n[e]=1024;return n[0]=n[32]=0,n}function TB(){const n=SB(),e=CB(),t=kB();return s=>{const r=new ArrayBuffer(4*s.length),o=new Uint32Array(r);for(let i=0;i<s.length;i++){const a=s[i],l=n[t[a>>10]+(a&1023)]+e[a>>10];o[i]=l}return new Float32Array(r)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Lt{constructor(){this.saveRouters=[],this.loadRouters=[]}static getInstance(){return Lt.instance==null&&(Lt.instance=new Lt),Lt.instance}static registerSaveRouter(e){Lt.getInstance().saveRouters.push(e)}static registerLoadRouter(e){Lt.getInstance().loadRouters.push(e)}static getSaveHandlers(e){return Lt.getHandlers(e,"save")}static getLoadHandlers(e,t){return Lt.getHandlers(e,"load",t)}static getHandlers(e,t,s){const r=[];return(t==="load"?Lt.getInstance().loadRouters:Lt.getInstance().saveRouters).forEach(i=>{const a=i(e,s);a!==null&&r.push(a)}),r}}const NB=n=>Lt.registerSaveRouter(n),IB=n=>Lt.registerLoadRouter(n),kE=n=>Lt.getSaveHandlers(n),$B=(n,e)=>Lt.getLoadHandlers(n,e);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const uv="tensorflowjs",cv=1,ma="models_store",ci="model_info_store";function TE(){if(!ae().getBool("IS_BROWSER"))throw new Error("Failed to obtain IndexedDB factory because the current environmentis not a web browser.");const n=typeof window>"u"?self:window,e=n.indexedDB||n.mozIndexedDB||n.webkitIndexedDB||n.msIndexedDB||n.shimIndexedDB;if(e==null)throw new Error("The current browser does not appear to support IndexedDB.");return e}function hv(n){const e=n.result;e.createObjectStore(ma,{keyPath:"modelPath"}),e.createObjectStore(ci,{keyPath:"modelPath"})}class Na{constructor(e){if(this.indexedDB=TE(),e==null||!e)throw new Error("For IndexedDB, modelPath must not be null, undefined or empty.");this.modelPath=e}async save(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");return this.databaseAction(this.modelPath,e)}async load(){return this.databaseAction(this.modelPath)}databaseAction(e,t){return new Promise((s,r)=>{const o=this.indexedDB.open(uv,cv);o.onupgradeneeded=()=>hv(o),o.onsuccess=()=>{const i=o.result;if(t==null){const a=i.transaction(ma,"readonly"),u=a.objectStore(ma).get(this.modelPath);u.onsuccess=()=>{if(u.result==null)return i.close(),r(new Error(`Cannot find model with path '${this.modelPath}' in IndexedDB.`));s(u.result.modelArtifacts)},u.onerror=h=>(i.close(),r(u.error)),a.oncomplete=()=>i.close()}else{t.weightData=Br.join(t.weightData);const a=Qh(t),l=i.transaction(ci,"readwrite");let u=l.objectStore(ci),h;try{h=u.put({modelPath:this.modelPath,modelArtifactsInfo:a})}catch(f){return r(f)}let p;h.onsuccess=()=>{p=i.transaction(ma,"readwrite");const f=p.objectStore(ma);let m;try{m=f.put({modelPath:this.modelPath,modelArtifacts:t,modelArtifactsInfo:a})}catch(y){return r(y)}m.onsuccess=()=>s({modelArtifactsInfo:a}),m.onerror=y=>{u=l.objectStore(ci);const x=u.delete(this.modelPath);x.onsuccess=()=>(i.close(),r(m.error)),x.onerror=v=>(i.close(),r(m.error))}},h.onerror=f=>(i.close(),r(h.error)),l.oncomplete=()=>{p==null?i.close():p.oncomplete=()=>i.close()}}},o.onerror=i=>r(o.error)})}}Na.URL_SCHEME="indexeddb://";const NE=n=>ae().getBool("IS_BROWSER")&&!Array.isArray(n)&&n.startsWith(Na.URL_SCHEME)?EB(n.slice(Na.URL_SCHEME.length)):null;Lt.registerSaveRouter(NE);Lt.registerLoadRouter(NE);function EB(n){return new Na(n)}function RB(n){return n.startsWith(Na.URL_SCHEME)?n.slice(Na.URL_SCHEME.length):n}class DB{constructor(){this.indexedDB=TE()}async listModels(){return new Promise((e,t)=>{const s=this.indexedDB.open(uv,cv);s.onupgradeneeded=()=>hv(s),s.onsuccess=()=>{const r=s.result,o=r.transaction(ci,"readonly"),a=o.objectStore(ci).getAll();a.onsuccess=()=>{const l={};for(const u of a.result)l[u.modelPath]=u.modelArtifactsInfo;e(l)},a.onerror=l=>(r.close(),t(a.error)),o.oncomplete=()=>r.close()},s.onerror=r=>t(s.error)})}async removeModel(e){return e=RB(e),new Promise((t,s)=>{const r=this.indexedDB.open(uv,cv);r.onupgradeneeded=()=>hv(r),r.onsuccess=()=>{const o=r.result,i=o.transaction(ci,"readwrite"),a=i.objectStore(ci),l=a.get(e);let u;l.onsuccess=()=>{if(l.result==null)return o.close(),s(new Error(`Cannot find model with path '${e}' in IndexedDB.`));{const h=a.delete(e),p=()=>{u=o.transaction(ma,"readwrite");const m=u.objectStore(ma).delete(e);m.onsuccess=()=>t(l.result.modelArtifactsInfo),m.onerror=y=>s(l.error)};h.onsuccess=p,h.onerror=f=>(p(),o.close(),s(l.error))}},l.onerror=h=>(o.close(),s(l.error)),i.oncomplete=()=>{u==null?o.close():u.oncomplete=()=>o.close()}},r.onerror=o=>s(r.error)})}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const To="/",$l="tensorflowjs_models",IE="info",AB="model_topology",OB="weight_specs",_B="weight_data",FB="model_metadata";function $E(n){return{info:[$l,n,IE].join(To),topology:[$l,n,AB].join(To),weightSpecs:[$l,n,OB].join(To),weightData:[$l,n,_B].join(To),modelMetadata:[$l,n,FB].join(To)}}function EE(n){for(const e of Object.values(n))window.localStorage.removeItem(e)}function PB(n){const e=n.split(To);if(e.length<3)throw new Error(`Invalid key format: ${n}`);return e.slice(1,e.length-1).join(To)}function LB(n){return n.startsWith(Ia.URL_SCHEME)?n.slice(Ia.URL_SCHEME.length):n}class Ia{constructor(e){if(!ae().getBool("IS_BROWSER")||typeof window>"u"||typeof window.localStorage>"u")throw new Error("The current environment does not support local storage.");if(this.LS=window.localStorage,e==null||!e)throw new Error("For local storage, modelPath must not be null, undefined or empty.");this.modelPath=e,this.keys=$E(this.modelPath)}async save(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");{const t=JSON.stringify(e.modelTopology),s=JSON.stringify(e.weightSpecs),r=Qh(e),o=Br.join(e.weightData);try{this.LS.setItem(this.keys.info,JSON.stringify(r)),this.LS.setItem(this.keys.topology,t),this.LS.setItem(this.keys.weightSpecs,s),this.LS.setItem(this.keys.weightData,wB(o));const i={format:e.format,generatedBy:e.generatedBy,convertedBy:e.convertedBy,signature:e.signature!=null?e.signature:void 0,userDefinedMetadata:e.userDefinedMetadata!=null?e.userDefinedMetadata:void 0,modelInitializer:e.modelInitializer!=null?e.modelInitializer:void 0,initializerSignature:e.initializerSignature!=null?e.initializerSignature:void 0,trainingConfig:e.trainingConfig!=null?e.trainingConfig:void 0};return this.LS.setItem(this.keys.modelMetadata,JSON.stringify(i)),{modelArtifactsInfo:r}}catch{throw EE(this.keys),new Error(`Failed to save model '${this.modelPath}' to local storage: size quota being exceeded is a possible cause of this failure: modelTopologyBytes=${r.modelTopologyBytes}, weightSpecsBytes=${r.weightSpecsBytes}, weightDataBytes=${r.weightDataBytes}.`)}}}async load(){const e=JSON.parse(this.LS.getItem(this.keys.info));if(e==null)throw new Error(`In local storage, there is no model with name '${this.modelPath}'`);if(e.modelTopologyType!=="JSON")throw new Error("BrowserLocalStorage does not support loading non-JSON model topology yet.");const t={},s=JSON.parse(this.LS.getItem(this.keys.topology));if(s==null)throw new Error(`In local storage, the topology of model '${this.modelPath}' is missing.`);t.modelTopology=s;const r=JSON.parse(this.LS.getItem(this.keys.weightSpecs));if(r==null)throw new Error(`In local storage, the weight specs of model '${this.modelPath}' are missing.`);t.weightSpecs=r;const o=this.LS.getItem(this.keys.modelMetadata);if(o!=null){const a=JSON.parse(o);t.format=a.format,t.generatedBy=a.generatedBy,t.convertedBy=a.convertedBy,a.signature!=null&&(t.signature=a.signature),a.userDefinedMetadata!=null&&(t.userDefinedMetadata=a.userDefinedMetadata),a.modelInitializer!=null&&(t.modelInitializer=a.modelInitializer),a.initializerSignature!=null&&(t.initializerSignature=a.initializerSignature),a.trainingConfig!=null&&(t.trainingConfig=a.trainingConfig)}const i=this.LS.getItem(this.keys.weightData);if(i==null)throw new Error(`In local storage, the binary weight values of model '${this.modelPath}' are missing.`);return t.weightData=bB(i),t}}Ia.URL_SCHEME="localstorage://";const RE=n=>ae().getBool("IS_BROWSER")&&!Array.isArray(n)&&n.startsWith(Ia.URL_SCHEME)?MB(n.slice(Ia.URL_SCHEME.length)):null;Lt.registerSaveRouter(RE);Lt.registerLoadRouter(RE);function MB(n){return new Ia(n)}class zB{constructor(){L(ae().getBool("IS_BROWSER"),()=>"Current environment is not a web browser"),L(typeof window>"u"||typeof window.localStorage<"u",()=>"Current browser does not appear to support localStorage"),this.LS=window.localStorage}async listModels(){const e={},t=$l+To,s=To+IE;for(let r=0;r<this.LS.length;++r){const o=this.LS.key(r);if(o.startsWith(t)&&o.endsWith(s)){const i=PB(o);e[i]=JSON.parse(this.LS.getItem(o))}}return e}async removeModel(e){e=LB(e);const t=$E(e);if(this.LS.getItem(t.info)==null)throw new Error(`Cannot find model at path '${e}'`);const s=JSON.parse(this.LS.getItem(t.info));return EE(t),s}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ml="://";class es{constructor(){this.managers={}}static getInstance(){return es.instance==null&&(es.instance=new es),es.instance}static registerManager(e,t){L(e!=null,()=>"scheme must not be undefined or null."),e.endsWith(Ml)&&(e=e.slice(0,e.indexOf(Ml))),L(e.length>0,()=>"scheme must not be an empty string.");const s=es.getInstance();L(s.managers[e]==null,()=>`A model store manager is already registered for scheme '${e}'.`),s.managers[e]=t}static getManager(e){const t=es.getInstance().managers[e];if(t==null)throw new Error(`Cannot find model manager for scheme '${e}'`);return t}static getSchemes(){return Object.keys(es.getInstance().managers)}}function of(n){if(n.indexOf(Ml)===-1)throw new Error(`The url string provided does not contain a scheme. Supported schemes are: ${es.getSchemes().join(",")}`);return{scheme:n.split(Ml)[0],path:n.split(Ml)[1]}}async function DE(n,e,t=!1){L(n!==e,()=>`Old path and new path are the same: '${n}'`);const s=Lt.getLoadHandlers(n);L(s.length>0,()=>`Copying failed because no load handler is found for source URL ${n}.`),L(s.length<2,()=>`Copying failed because more than one (${s.length}) load handlers for source URL ${n}.`);const r=s[0],o=Lt.getSaveHandlers(e);L(o.length>0,()=>`Copying failed because no save handler is found for destination URL ${e}.`),L(o.length<2,()=>`Copying failed because more than one (${s.length}) save handlers for destination URL ${e}.`);const i=o[0],a=of(n).scheme,l=of(n).path,u=a===of(n).scheme,h=await r.load();t&&u&&await es.getManager(a).removeModel(l);const p=await i.save(h);return t&&!u&&await es.getManager(a).removeModel(l),p.modelArtifactsInfo}async function VB(){const n=es.getSchemes(),e={};for(const t of n){const s=await es.getManager(t).listModels();for(const r in s){const o=t+Ml+r;e[o]=s[r]}}return e}async function BB(n){const e=of(n);return es.getManager(e.scheme).removeModel(e.path)}async function WB(n,e){return DE(n,e,!1)}async function UB(n,e){return DE(n,e,!0)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class GB{constructor(){this.messageName="setTimeoutCustom",this.functionRefs=[],this.handledMessageCount=0,this.hasEventListener=!1}fetch(e,t){return fetch(e,t)}now(){return performance.now()}encode(e,t){if(t!=="utf-8"&&t!=="utf8")throw new Error(`Browser's encoder only supports utf-8, but got ${t}`);return this.textEncoder==null&&(this.textEncoder=new TextEncoder),this.textEncoder.encode(e)}decode(e,t){return new TextDecoder(t).decode(e)}setTimeoutCustom(e,t){if(typeof window>"u"||!ae().getBool("USE_SETTIMEOUTCUSTOM")){setTimeout(e,t);return}this.functionRefs.push(e),setTimeout(()=>{window.postMessage({name:this.messageName,index:this.functionRefs.length-1},"*")},t),this.hasEventListener||(this.hasEventListener=!0,window.addEventListener("message",s=>{if(s.source===window&&s.data.name===this.messageName){s.stopPropagation();const r=this.functionRefs[s.data.index];r(),this.handledMessageCount++,this.handledMessageCount===this.functionRefs.length&&(this.functionRefs=[],this.handledMessageCount=0)}},!0))}isTypedArray(e){return tE(e)}}if(ae().get("IS_BROWSER")){ae().setPlatform("browser",new GB);try{es.registerManager(Ia.URL_SCHEME,new zB)}catch{}try{es.registerManager(Na.URL_SCHEME,new DB)}catch{}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jB={importFetch:()=>require("node-fetch")};let ux;class HB{constructor(){this.util=require("util"),this.textEncoder=new this.util.TextEncoder}fetch(e,t){return ae().global.fetch!=null?ae().global.fetch(e,t):(ux==null&&(ux=jB.importFetch()),ux(e,t))}now(){const e=process.hrtime();return e[0]*1e3+e[1]/1e6}encode(e,t){if(t!=="utf-8"&&t!=="utf8")throw new Error(`Node built-in encoder only supports utf-8, but got ${t}`);return this.textEncoder.encode(e)}decode(e,t){return e.length===0?"":new this.util.TextDecoder(t).decode(e)}isTypedArray(e){return this.util.types.isFloat32Array(e)||this.util.types.isInt32Array(e)||this.util.types.isUint8Array(e)||this.util.types.isUint8ClampedArray(e)}}ae().get("IS_NODE")&&!ae().get("IS_BROWSER")&&ae().setPlatform("node",new HB);/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nt(n,e="float32",t){return e=e||"float32",Ks(n),new mn(n,e,t)}/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function KB(n,e){const t=M(n,"x","cast");if(!RV(e))throw new Error(`Failed to cast to unknown dtype ${e}`);if(e==="string"&&t.dtype!=="string"||e!=="string"&&t.dtype==="string")throw new Error("Only strings can be casted to strings");const s={x:t},r={dtype:e};return K.runKernel(uh,s,r)}const Ne=j({cast_:KB});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qB(n){const t={x:M(n,"x","clone","string_or_numeric")};return K.runKernel(Sh,t)}const Io=j({clone_:qB});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function AE(n,e=!1){console.log(n.toString(e))}/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */hE();const XB={buffer:nt,cast:Ne,clone:Io,print:AE};aB(XB);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function YB(n,e){let t=M(n,"a","add"),s=M(e,"b","add");[t,s]=Ht(t,s);const r={a:t,b:s};return K.runKernel(cu,r)}const ye=j({add_:YB});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function QB(n,e){let t=M(n,"a","floorDiv"),s=M(e,"b","floorDiv");[t,s]=Ht(t,s);const r={a:t,b:s};return K.runKernel(wh,r)}const O1=j({floorDiv_:QB});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ZB(n,e){let t=M(n,"a","div"),s=M(e,"b","div");if([t,s]=Ht(t,s),t.dtype==="int32"&&s.dtype==="int32")return O1(t,s);const r={a:t,b:s},o={};return K.runKernel(fh,r,o)}const Ae=j({div_:ZB});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function JB(n,e){let t=M(n,"a","mul"),s=M(e,"b","mul");[t,s]=Ht(t,s);const r={a:t,b:s};return K.runKernel(Dh,r)}const H=j({mul_:JB});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function e4(n){const e=M(n,"x","abs");if(e.dtype==="complex64"){const t={x:e};return K.runKernel(bm,t)}else{const t={x:e};return K.runKernel(dm,t)}}const hn=j({abs_:e4});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function t4(n){const t={x:M(n,"x","acos")};return K.runKernel(nh,t)}const OE=j({acos_:t4});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function n4(n){const t={x:M(n,"x","acosh")};return K.runKernel(sh,t)}const _E=j({acosh_:n4});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function s4(n){L(Array.isArray(n),()=>"The argument passed to tf.addN() must be a list of tensors"),L(n.length>=1,()=>`Must pass at least one tensor to tf.addN(), but got ${n.length}`);const e=n.map((r,o)=>M(r,`tensors${o}`,"addN")),t=e[0];e.forEach(r=>{if(r.dtype!==t.dtype)throw new Error("All tensors passed to tf.addN() must have the same dtype")}),e.forEach(r=>{if(!ct(r.shape,t.shape))throw new Error("All tensors passed to tf.addN() must have the same shape")});const s=e;return K.runKernel(pm,s)}const r4=j({addN_:s4});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function o4(n,e=null,t=!1){const r={x:M(n,"x","all","bool")},o={axis:e,keepDims:t};return K.runKernel(Tw,r,o)}const _1=j({all_:o4});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function i4(n,e=null,t=!1){const r={x:M(n,"x","any","bool")},o={axis:e,keepDims:t};return K.runKernel(Nw,r,o)}const Df=j({any_:i4});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function a4(n,e=0){const s={x:M(n,"x","argMax")},r={axis:e};return K.runKernel(fm,s,r)}const ql=j({argMax_:a4});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function l4(n,e=0){const s={x:M(n,"x","argMin")},r={axis:e};return K.runKernel(mm,s,r)}const FE=j({argMin_:l4});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function u4(n){const t={x:M(n,"x","asin")};return K.runKernel(rh,t)}const PE=j({asin_:u4});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function c4(n){const t={x:M(n,"x","asinh")};return K.runKernel(oh,t)}const LE=j({asinh_:c4});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function h4(n){const t={x:M(n,"x","atan")};return K.runKernel(ih,t)}const ME=j({atan_:h4});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function d4(n,e){let t=M(n,"a","atan2"),s=M(e,"b","atan2");[t,s]=Ht(t,s);const r={a:t,b:s};return K.runKernel(lh,r)}const zE=j({atan2_:d4});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function p4(n){const t={x:M(n,"x","atanh")};return K.runKernel(ah,t)}const VE=j({atanh_:p4});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zh(n,e,t,s,r="NHWC",o){const i=n[3],a=[...e,i],l=Mo(r);return Nn(n,a,t,o,s,null,null,l)}function yr(n,e,t,s,r,o,i="channelsLast"){const[a,l]=Dc(e);let u;if(i==="channelsLast")u=[a,l,n[3],n[3]];else if(i==="channelsFirst")u=[a,l,n[1],n[1]];else throw new Error(`Unknown dataFormat ${i}`);return Nn(n,u,t,s,r,o,!1,i)}function Lo(n,e,t,s,r,o,i="NDHWC"){const[a,l,u]=dv(e);let h,p;if(i==="NDHWC")p="channelsLast",h=[a,l,u,n[4],n[4]];else if(i==="NCDHW")p="channelsFirst",h=[a,l,u,n[1],n[1]];else throw new Error(`Unknown dataFormat ${i}`);return Li(n,h,t,s,r,!1,p,o)}function Nn(n,e,t,s,r,o,i=!1,a="channelsLast"){let[l,u,h,p]=[-1,-1,-1,-1];if(a==="channelsLast")[l,u,h,p]=n;else if(a==="channelsFirst")[l,p,u,h]=n;else throw new Error(`Unknown dataFormat ${a}`);const[f,m,,y]=e,[x,v]=Dc(t),[w,S]=Dc(s),k=zl(f,w),T=zl(m,S),{padInfo:I,outHeight:E,outWidth:D}=g4(r,u,h,x,v,k,T,o,a),O=i?y*p:y;let _;return a==="channelsFirst"?_=[l,O,E,D]:a==="channelsLast"&&(_=[l,E,D,O]),{batchSize:l,dataFormat:a,inHeight:u,inWidth:h,inChannels:p,outHeight:E,outWidth:D,outChannels:O,padInfo:I,strideHeight:x,strideWidth:v,filterHeight:f,filterWidth:m,effectiveFilterHeight:k,effectiveFilterWidth:T,dilationHeight:w,dilationWidth:S,inShape:n,outShape:_,filterShape:e}}function Li(n,e,t,s,r,o=!1,i="channelsLast",a){let[l,u,h,p,f]=[-1,-1,-1,-1,-1];if(i==="channelsLast")[l,u,h,p,f]=n;else if(i==="channelsFirst")[l,f,u,h,p]=n;else throw new Error(`Unknown dataFormat ${i}`);const[m,y,x,,v]=e,[w,S,k]=dv(t),[T,I,E]=dv(s),D=zl(m,T),O=zl(y,I),_=zl(x,E),{padInfo:P,outDepth:R,outHeight:W,outWidth:Q}=y4(r,u,h,p,w,S,k,D,O,_,a),ee=o?v*f:v;let te;return i==="channelsFirst"?te=[l,ee,R,W,Q]:i==="channelsLast"&&(te=[l,R,W,Q,ee]),{batchSize:l,dataFormat:i,inDepth:u,inHeight:h,inWidth:p,inChannels:f,outDepth:R,outHeight:W,outWidth:Q,outChannels:ee,padInfo:P,strideDepth:w,strideHeight:S,strideWidth:k,filterDepth:m,filterHeight:y,filterWidth:x,effectiveFilterDepth:D,effectiveFilterHeight:O,effectiveFilterWidth:_,dilationDepth:T,dilationHeight:I,dilationWidth:E,inShape:n,outShape:te,filterShape:e}}function f4(n,e,t,s,r){s==null&&(s=F1(n,e,t));const o=n[0],i=n[1],a=Ac((o-e+2*s)/t+1,r),l=Ac((i-e+2*s)/t+1,r);return[a,l]}function m4(n,e,t,s,r,o){r==null&&(r=F1(n,e[0],s[0]));const i=[0,0,0,t];for(let a=0;a<3;a++)n[a]+2*r>=e[a]&&(i[a]=Ac((n[a]-e[a]+2*r)/s[a]+1,o));return i}function F1(n,e,t,s=1){const r=zl(e,s);return Math.floor((n[0]*(t-1)-t+r)/2)}function Dc(n){return typeof n=="number"?[n,n,n]:n.length===2?[n[0],n[1],1]:n}function dv(n){return typeof n=="number"?[n,n,n]:n}function zl(n,e){return e<=1?n:n+(n-1)*(e-1)}function g4(n,e,t,s,r,o,i,a,l){let u,h,p;if(typeof n=="number"){u={top:n,bottom:n,left:n,right:n,type:n===0?"VALID":"NUMBER"};const m=f4([e,t],o,s,n,a);h=m[0],p=m[1]}else if(n==="same"){h=Math.ceil(e/s),p=Math.ceil(t/r);const f=Math.max(0,(h-1)*s+o-e),m=Math.max(0,(p-1)*r+i-t),y=Math.floor(f/2),x=f-y,v=Math.floor(m/2),w=m-v;u={top:y,bottom:x,left:v,right:w,type:"SAME"}}else if(n==="valid")u={top:0,bottom:0,left:0,right:0,type:"VALID"},h=Math.ceil((e-o+1)/s),p=Math.ceil((t-i+1)/r);else if(typeof n=="object"){const f=l==="channelsLast"?n[1][0]:n[2][0],m=l==="channelsLast"?n[1][1]:n[2][1],y=l==="channelsLast"?n[2][0]:n[3][0],x=l==="channelsLast"?n[2][1]:n[3][1];u={top:f,bottom:m,left:y,right:x,type:f===0&&m===0&&y===0&&x===0?"VALID":"EXPLICIT"},h=Ac((e-o+f+m)/s+1,a),p=Ac((t-i+y+x)/r+1,a)}else throw Error(`Unknown padding parameter: ${n}`);return{padInfo:u,outHeight:h,outWidth:p}}function y4(n,e,t,s,r,o,i,a,l,u,h){let p,f,m,y;if(n==="valid"&&(n=0),typeof n=="number"){p={top:n,bottom:n,left:n,right:n,front:n,back:n,type:n===0?"VALID":"NUMBER"};const v=m4([e,t,s,1],[a,l,u],1,[r,o,i],n,h);f=v[0],m=v[1],y=v[2]}else if(n==="same"){f=Math.ceil(e/r),m=Math.ceil(t/o),y=Math.ceil(s/i);const x=(f-1)*r+a-e,v=(m-1)*o+l-t,w=(y-1)*i+u-s,S=Math.floor(x/2),k=x-S,T=Math.floor(v/2),I=v-T,E=Math.floor(w/2),D=w-E;p={top:T,bottom:I,left:E,right:D,front:S,back:k,type:"SAME"}}else throw Error(`Unknown padding parameter: ${n}`);return{padInfo:p,outDepth:f,outHeight:m,outWidth:y}}function Ac(n,e){if(!e)return Math.trunc(n);switch(e){case"round":return Math.round(n);case"ceil":return Math.ceil(n);case"floor":return Math.floor(n);default:throw new Error(`Unknown roundingMode ${e}`)}}function Si(n){const[e,t,s]=Dc(n);return e===1&&t===1&&s===1}function Ln(n,e){return Si(n)||Si(e)}function $a(n){return Dc(n).every(e=>e>0)}function Mo(n){if(n==="NHWC")return"channelsLast";if(n==="NCHW")return"channelsFirst";throw new Error(`Unknown dataFormat ${n}`)}function os(n,e,t){if(t!=null){if(typeof e=="string")throw Error(`Error in ${n}: pad must be an integer when using dimRoundingMode ${t} but got pad ${e}.`);if(typeof e=="number")L(Hl(e),()=>`Error in ${n}: pad must be an integer when using dimRoundingMode ${t} but got pad ${e}.`);else if(typeof e=="object")e.forEach(s=>{s.forEach(r=>{L(Hl(r),()=>`Error in ${n}: pad must be an integer when using dimRoundingMode ${t} but got pad ${r}.`)})});else throw Error(`Error in ${n}: Unknown padding parameter: ${e}`)}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function x4(n,e){const s={x:M(n,"x","reshape","string_or_numeric")},r={shape:e};return K.runKernel(tg,s,r)}const X=j({reshape_:x4});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function v4(n,e,t,s,r){const o=M(n,"x","avgPool","float32"),i=1;L(Ln(t,i),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${t} and dilations '${i}'`);let a=o,l=!1;o.rank===3&&(l=!0,a=X(o,[1,o.shape[0],o.shape[1],o.shape[2]])),L(a.rank===4,()=>`Error in avgPool: x must be rank 4 but got rank ${a.rank}.`),os("avgPool",s,r);const u={x:a},h={filterSize:e,strides:t,pad:s,dimRoundingMode:r};let p=K.runKernel(gm,u,h);return p=Ne(p,o.dtype),l?X(p,[p.shape[1],p.shape[2],p.shape[3]]):p}const gg=j({avgPool_:v4});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function w4(n,e,t,s,r,o="NDHWC"){const i=M(n,"x","avgPool3d","float32");let a=i,l=!1;i.rank===4&&(l=!0,a=X(i,[1,i.shape[0],i.shape[1],i.shape[2],i.shape[3]])),L(a.rank===5,()=>`Error in avgPool3d: x must be rank 5 but got rank ${a.rank}.`),L(o==="NDHWC",()=>`Error in avgPool3d: Only NDHWC is currently supported, but got dataFormat of ${o}`),L(typeof t=="number"&&t>0||Array.isArray(t)&&t[0]>0&&t[1]>0&&t[2]>0,()=>`Error in avgPool3d: Stride must be > 0, but got '${t}'`),os("avgPool3d",s,r);const u={x:a},h={filterSize:e,strides:t,pad:s,dimRoundingMode:r,dataFormat:o};let p=K.runKernel(ym,u,h);return p=Ne(p,a.dtype),l?X(p,[p.shape[1],p.shape[2],p.shape[3],p.shape[4]]):p}const BE=j({avgPool3d_:w4});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function b4(n,e=0){L(n.length>=1,()=>"Pass at least one tensor to concat");const t=Rf(n,"tensors","concat","string_or_numeric");if(t[0].dtype==="complex64"&&t.forEach(o=>{if(o.dtype!=="complex64")throw new Error(`Cannot concatenate complex64 tensors with a tensor
          with dtype ${o.dtype}. `)}),t.length===1)return Io(t[0]);const s=t,r={axis:e};return K.runKernel(Sm,s,r)}const on=j({concat_:b4});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function S4(n,e,t=!1,s=!1){let r=M(n,"a","matMul"),o=M(e,"b","matMul");[r,o]=Ht(r,o);const i={a:r,b:o},a={transposeA:t,transposeB:s};return K.runKernel(xm,i,a)}const lt=j({matMul_:S4});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function C4(n){const t={x:M(n,"x","sigmoid","float32")};return K.runKernel(Wh,t)}const Fr=j({sigmoid_:C4});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function k4(n,e,t){const s=M(n,"x","slice","string_or_numeric");if(s.rank===0)throw new Error("Slicing scalar is not possible");const r={x:s},o={begin:e,size:t};return K.runKernel(ig,r,o)}const et=j({slice_:k4});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function T4(n){const t={x:M(n,"x","tanh","float32")};return K.runKernel(qh,t)}const Ea=j({tanh_:T4});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function N4(n,e,t,s,r,o){const i=M(n,"forgetBias","basicLSTMCell"),a=M(e,"lstmKernel","basicLSTMCell"),l=M(t,"lstmBias","basicLSTMCell"),u=M(s,"data","basicLSTMCell"),h=M(r,"c","basicLSTMCell"),p=M(o,"h","basicLSTMCell"),f=on([u,p],1),m=lt(f,a),y=ye(m,l),x=y.shape[0],v=y.shape[1]/4,w=[x,v],S=et(y,[0,0],w),k=et(y,[0,v],w),T=et(y,[0,v*2],w),I=et(y,[0,v*3],w),E=ye(H(Fr(S),Ea(k)),H(h,Fr(ye(i,T)))),D=H(Ea(E),Fr(I));return[E,D]}const I4=j({basicLSTMCell_:N4});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $4(n,e,t){const s=M(n,"x","batchToSpaceND"),r=e.reduce((a,l)=>a*l);L(s.rank>=1+e.length,()=>`input rank is ${s.rank} but should be > than blockShape.length ${e.length}`),L(t.length===e.length,()=>`crops.length is ${t.length} but should be equal to blockShape.length  ${e.length}`),L(s.shape[0]%r===0,()=>`input tensor batch is ${s.shape[0]} but is not divisible by the product of the elements of blockShape ${e.join(" * ")} === ${r}`);const o={x:s},i={blockShape:e,crops:t};return K.runKernel(vm,o,i)}const yg=j({batchToSpaceND_:$4});function E4(n){let e;return n.rank===0||n.rank===1?e=X(n,[1,1,1,n.size]):n.rank===2?e=X(n,[1,1,n.shape[0],n.shape[1]]):n.rank===3?e=X(n,[1,n.shape[0],n.shape[1],n.shape[2]]):e=n,e}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function R4(n,e,t,s,r,o){o==null&&(o=.001);const i=M(n,"x","batchNorm"),a=M(e,"mean","batchNorm"),l=M(t,"variance","batchNorm");let u;r!=null&&(u=M(r,"scale","batchNorm"));let h;s!=null&&(h=M(s,"offset","batchNorm")),L(a.rank===l.rank,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),L(h==null||a.rank===h.rank,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),L(u==null||a.rank===u.rank,()=>"Batch normalization gradient requires mean and scale to have equal ranks.");const f={x:E4(i),scale:u,offset:h,mean:a,variance:l},m={varianceEpsilon:o},y=K.runKernel(Dm,f,m);return X(y,i.shape)}const Jh=j({batchNorm_:R4});function D4(n,e,t,s,r,o){const i=M(n,"x","batchNorm"),a=M(e,"mean","batchNorm"),l=M(t,"variance","batchNorm");let u;r!=null&&(u=M(r,"scale","batchNorm"));let h;return s!=null&&(h=M(s,"offset","batchNorm")),L(i.rank===2,()=>`Error in batchNorm2D: x must be rank 2 but got rank ${i.rank}.`),L(a.rank===2||a.rank===1,()=>`Error in batchNorm2D: mean must be rank 2 or rank 1 but got rank ${a.rank}.`),L(l.rank===2||l.rank===1,()=>`Error in batchNorm2D: variance must be rank 2 or rank 1 but got rank ${l.rank}.`),u!=null&&L(u.rank===2||u.rank===1,()=>`Error in batchNorm2D: scale must be rank 2 or rank 1 but got rank ${u.rank}.`),h!=null&&L(h.rank===2||h.rank===1,()=>`Error in batchNorm2D: offset must be rank 2 or rank 1 but got rank ${h.rank}.`),Jh(i,a,l,h,u,o)}const WE=j({batchNorm2d_:D4});function A4(n,e,t,s,r,o){const i=M(n,"x","batchNorm"),a=M(e,"mean","batchNorm"),l=M(t,"variance","batchNorm");let u;r!=null&&(u=M(r,"scale","batchNorm"));let h;return s!=null&&(h=M(s,"offset","batchNorm")),L(i.rank===3,()=>`Error in batchNorm3D: x must be rank 3 but got rank ${i.rank}.`),L(a.rank===3||a.rank===1,()=>`Error in batchNorm3D: mean must be rank 3 or rank 1 but got rank ${a.rank}.`),L(l.rank===3||l.rank===1,()=>`Error in batchNorm3D: variance must be rank 3 or rank 1 but got rank ${l.rank}.`),u!=null&&L(u.rank===3||u.rank===1,()=>`Error in batchNorm3D: scale must be rank 3 or rank 1 but got rank ${u.rank}.`),h!=null&&L(h.rank===3||h.rank===1,()=>`Error in batchNorm3D: offset must be rank 3 or rank 1 but got rank ${h.rank}.`),Jh(i,a,l,h,u,o)}const UE=j({batchNorm3d_:A4});function O4(n,e,t,s,r,o){const i=M(n,"x","batchNorm"),a=M(e,"mean","batchNorm"),l=M(t,"variance","batchNorm");let u;r!=null&&(u=M(r,"scale","batchNorm"));let h;return s!=null&&(h=M(s,"offset","batchNorm")),L(i.rank===4,()=>`Error in batchNorm4D: x must be rank 4 but got rank ${i.rank}.`),L(a.rank===4||a.rank===1,()=>`Error in batchNorm4D: mean must be rank 4 or rank 1 but got rank ${a.rank}.`),L(l.rank===4||l.rank===1,()=>`Error in batchNorm4D: variance must be rank 4 or rank 1 but got rank ${l.rank}.`),u!=null&&L(u.rank===4||u.rank===1,()=>`Error in batchNorm4D: scale must be rank 4 or rank 1 but got rank ${u.rank}.`),h!=null&&L(h.rank===4||h.rank===1,()=>`Error in batchNorm4D: offset must be rank 4 or rank 1 but got rank ${h.rank}.`),Jh(i,a,l,h,u,o)}const GE=j({batchNorm4d_:O4});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _4(n,e,t){const s=M(n,"x","bincount"),r=M(e,"weights","bincount");L(s.dtype==="int32",()=>`Error in bincount: input dtype must be int32, but got ${s.dtype}`),L(t>=0,()=>`size must be non-negative, but got ${t}.`),L(r.size===s.size||r.size===0,()=>`Error in bincount: weights must have the same size as input or0-length, but got input shape: ${s.shape}, weights shape: ${r.shape}.`);const o={x:s,weights:r},i={size:t};return K.runKernel(Ew,o,i)}const jE=j({bincount_:_4});/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function F4(n,e){const t=M(n,"x","bitwiseAnd"),s=M(e,"y","bitwiseAnd");if(!ct(t.shape,s.shape))throw new Error(`BitwiseAnd: Tensors must have the same shape. x: ${t.shape}, y: ${s.shape}`);if(t.dtype!=="int32"||s.dtype!=="int32")throw new Error(`BitwiseAnd: Only supports 'int32' values in tensor, found type of x: ${t.dtype} and type of y: ${s.dtype}`);const r={a:t,b:s};return K.runKernel(wm,r)}const P4=j({bitwiseAnd_:F4});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function L4(n,e){const t=M(n,"s0","broadcastArgs","int32"),s=M(e,"s1","broadcastArgs","int32");if(t.rank!==1)throw new Error(`broadcastArgs(): first input must be a vector (rank=1). Has rank ${t.rank}`);if(s.rank!==1)throw new Error(`broadcastArgs(): second input must be a vector (rank=1). Has rank ${s.rank}`);const r={s0:t,s1:s};return K.runKernel(Rw,r)}const M4=j({broadcastArgs_:L4});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function z4(n,e){let t=M(n,"broadcastTo","x");const s=t.shape;if(Ks(e),e.length<t.rank)throw new Error(`broadcastTo(): shape.length=${e.length} < input.rank=${t.rank}.`);if(e.length>t.rank){const u=t.shape.slice();for(;u.length<e.length;)u.unshift(1);t=X(t,u)}const r=t.shape,o=Array.from(e);for(let u=e.length-1;u>=0;u--)if(r[u]===e[u])o[u]=1;else if(t.shape[u]!==1)throw new Error(`broadcastTo(): [${s}] cannot be broadcast to [${e}].`);if(o.map((u,h)=>u>1?h:-1).filter(u=>u>=0).length===0)return Io(t);const a={x:t},l={reps:o};return K.runKernel(Xh,a,l)}const Vl=j({broadcastTo_:z4});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function V4(n){const t={x:M(n,"x","ceil","float32")};return K.runKernel(ch,t)}const HE=j({ceil_:V4});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hu(n,e,t){Ks(n),t=t||lu(e);const s={shape:n,value:e,dtype:t};return K.runKernel(jw,{},s)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function B4(n,e,t){const s=M(n,"x","clipByValue");if(L(e<=t,()=>`Error in clip: min (${e}) must be less than or equal to max (${t}).`),e===t)return hu(s.shape,e,s.dtype);const r={x:s},o={clipValueMin:e,clipValueMax:t};return K.runKernel(hh,r,o)}const As=j({clipByValue_:B4});function W4(n){return on(n,0)}const KE=j({concat1d_:W4});function U4(n,e){return on(n,e)}const P1=j({concat2d_:U4});function G4(n,e){return on(n,e)}const qE=j({concat3d_:G4});function j4(n,e){return on(n,e)}const XE=j({concat4d_:j4});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function H4(n,e,t,s,r="NHWC",o=[1,1],i){const a=M(n,"x","conv2d","float32"),l=M(e,"filter","conv2d","float32");let u=a,h=!1;a.rank===3&&(h=!0,u=X(a,[1,a.shape[0],a.shape[1],a.shape[2]])),L(u.rank===4,()=>`Error in conv2d: input must be rank 4, but got rank ${u.rank}.`),L(l.rank===4,()=>`Error in conv2d: filter must be rank 4, but got rank ${l.rank}.`),os("conv2d",s,i);const p=r==="NHWC"?u.shape[3]:u.shape[1];L(p===l.shape[2],()=>`Error in conv2d: depth of input (${p}) must match input depth for filter ${l.shape[2]}.`),L(Ln(t,o),()=>`Error in conv2D: Either strides or dilations must be 1. Got strides ${t} and dilations '${o}'`),L($a(o),()=>"Error in conv2D: Dilated rates should be larger than 0."),L($a(t),()=>"Error in conv2D: Strides should be larger than 0.");const f={x:u,filter:l},m={strides:t,pad:s,dataFormat:r,dilations:o,dimRoundingMode:i},y=K.runKernel(Cm,f,m);return h?X(y,[y.shape[1],y.shape[2],y.shape[3]]):y}const Ci=j({conv2d_:H4});function K4(n,e,t,s,r="NWC",o=1,i){const a=M(n,"x","conv1d"),l=M(e,"filter","conv1d");let u=a,h=!1;a.rank===2&&(h=!0,u=X(a,[1,a.shape[0],a.shape[1]])),L(u.rank===3,()=>`Error in conv1d: input must be rank 3, but got rank ${u.rank}.`),L(l.rank===3,()=>`Error in conv1d: filter must be rank 3, but got rank ${l.rank}.`),os("conv1d",s,i),L(u.shape[2]===l.shape[1],()=>`Error in conv1d: depth of input (${u.shape[2]}) must match input depth for filter ${l.shape[1]}.`),L(Ln(t,o),()=>`Error in conv1D: Either stride or dilation must be 1. Got stride ${t} and dilation '${o}'`),L($a(o),()=>"Error in conv1D: Dilated rates should be larger than 0."),L($a(t),()=>"Error in conv1D: Stride should be larger than 0."),L(r==="NWC",()=>`Error in conv1d: got dataFormat of ${r} but only NWC is currently supported.`);const p=X(l,[1,l.shape[0],l.shape[1],l.shape[2]]),f=X(u,[u.shape[0],1,u.shape[1],u.shape[2]]),v=Ci(f,p,[1,t],s,"NHWC",[1,o],i);return h?X(v,[v.shape[2],v.shape[3]]):X(v,[v.shape[0],v.shape[2],v.shape[3]])}const L1=j({conv1d_:K4});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function q4(n,e,t,s,r,o="NHWC",i){L(n.length===e.rank,()=>`Length of inShape (${n.length}) and rank of dy (${e.rank}) must match`);let a=n,l=e,u=!1;e.rank===3&&(u=!0,l=X(e,[1,e.shape[0],e.shape[1],e.shape[2]]),a=[1,n[0],n[1],n[2]]),L(a.length===4,()=>`Error in conv2dDerInput: inShape must be length 4, but got length ${a.length}.`),L(l.rank===4,()=>`Error in conv2dDerInput: dy must be rank 4, but got rank ${l.rank}`),L(t.rank===4,()=>`Error in conv2dDerInput: filter must be rank 4, but got rank ${t.rank}`);const h=o==="NHWC"?a[3]:a[1],p=o==="NHWC"?l.shape[3]:l.shape[1];L(h===t.shape[2],()=>`Error in conv2dDerInput: depth of input (${h}) must match input depth for filter ${t.shape[2]}.`),L(p===t.shape[3],()=>`Error in conv2dDerInput: depth of output (${p}) must match output depth for filter ${t.shape[3]}.`),os("conv2dDerInput",r,i);const f={dy:l,filter:t},m={strides:s,pad:r,dataFormat:o,dimRoundingMode:i,inputShape:a},y=K.runKernel(km,f,m);return u?X(y,[y.shape[1],y.shape[2],y.shape[3]]):y}const M1=j({conv2DBackpropInput_:q4});function X4(n,e,t,s,r,o){const i=M(n,"x","conv2dTranspose"),a=M(e,"filter","conv2dTranspose");return M1(t,i,a,s,r,"NHWC",o)}const z1=j({conv2dTranspose_:X4});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Y4(n,e,t,s,r="NDHWC",o=[1,1,1]){const i=M(n,"x","conv3d"),a=M(e,"filter","conv3d");let l=i,u=!1;i.rank===4&&(u=!0,l=X(i,[1,i.shape[0],i.shape[1],i.shape[2],i.shape[3]])),L(l.rank===5,()=>`Error in conv3d: input must be rank 5, but got rank ${l.rank}.`),L(a.rank===5,()=>`Error in conv3d: filter must be rank 5, but got rank ${a.rank}.`),L(l.shape[4]===a.shape[3],()=>`Error in conv3d: depth of input (${l.shape[4]}) must match input depth for filter ${a.shape[3]}.`),L(Ln(t,o),()=>`Error in conv3D: Either strides or dilations must be 1. Got strides ${t} and dilations '${o}'`),L(r==="NDHWC",()=>`Error in conv3d: got dataFormat of ${r} but only NDHWC is currently supported.`),L($a(o),()=>"Error in conv3D: Dilated rates should be larger than 0."),L($a(t),()=>"Error in conv3D: Strides should be larger than 0.");const h={x:l,filter:a},p={strides:t,pad:s,dataFormat:r,dilations:o},f=K.runKernel(Tm,h,p);return u?X(f,[f.shape[1],f.shape[2],f.shape[3],f.shape[4]]):f}const YE=j({conv3d_:Y4});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Q4(n,e,t,s,r){L(n.length===e.rank,()=>`Length of inShape (${n.length}) and rank of dy (${e.rank}) must match`);let o=n,i=e,a=!1;e.rank===4&&(a=!0,i=X(e,[1,e.shape[0],e.shape[1],e.shape[2],e.shape[3]]),o=[1,n[0],n[1],n[2],n[3]]);const l=o[4],u=i.shape[4];L(o.length===5,()=>`Error in conv3dDerInput: inShape must be length 5, but got length ${o.length}.`),L(i.rank===5,()=>`Error in conv3dDerInput: dy must be rank 5, but got rank ${i.rank}`),L(t.rank===5,()=>`Error in conv3dDerInput: filter must be rank 5, but got rank ${t.rank}`),L(l===t.shape[3],()=>`Error in conv3dDerInput: depth of input (${l}) must match input depth for filter ${t.shape[3]}.`),L(u===t.shape[4],()=>`Error in conv3dDerInput: depth of output (${u}) must match output depth for filter ${t.shape[4]}.`);const h={dy:i,filter:t},p={pad:r,strides:s,inputShape:o},f=K.runKernel(_w,h,p);return a?X(f,[f.shape[1],f.shape[2],f.shape[3],f.shape[4]]):f}const QE=j({conv3DBackpropInput_:Q4});function Z4(n,e,t,s,r){const o=M(n,"x","conv3dTranspose"),i=M(e,"filter","conv3dTranspose");return QE(t,o,i,s,r)}const ZE=j({conv3dTranspose_:Z4});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function J4(n){const t={x:M(n,"x","cos","float32")};return K.runKernel(dh,t)}const xg=j({cos_:J4});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eW(n){const t={x:M(n,"x","cosh","float32")};return K.runKernel(ph,t)}const V1=j({cosh_:eW});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tW(n,e=0,t=!1,s=!1){const o={x:M(n,"x","cumprod")},i={axis:e,exclusive:t,reverse:s};return K.runKernel(Fw,o,i)}const Af=j({cumprod_:tW});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nW(n,e=0,t=!1,s=!1){const o={x:M(n,"x","cumsum")},i={axis:e,exclusive:t,reverse:s};return K.runKernel(Nm,o,i)}const B1=j({cumsum_:nW});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sW(n,e,t,s=!1){const r=M(n,"x","denseBincount"),o=M(e,"weights","denseBincount");L(r.dtype==="int32",()=>`Error in denseBincount: input dtype must be int32, but got ${r.dtype}`),L(r.rank<=2,()=>`Error in denseBincount: input must be at most rank 2, but got rank ${r.rank}.`),L(t>=0,()=>`size must be non-negative, but got ${t}.`),L(o.size===r.size||o.size===0,()=>`Error in denseBincount: weights must have the same shape as x or 0-length, but got x shape: ${r.shape}, weights shape: ${o.shape}.`);const i={x:r,weights:o},a={size:t,binaryOutput:s};return K.runKernel(Lw,i,a)}const pv=j({denseBincount_:sW});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rW(n,e,t="NHWC"){const s=M(n,"x","depthToSpace","float32"),r=t==="NHWC"?s.shape[1]:s.shape[2],o=t==="NHWC"?s.shape[2]:s.shape[3],i=t==="NHWC"?s.shape[3]:s.shape[1];L(e>1,()=>`blockSize should be > 1 for depthToSpace, but was: ${e}`),L(r*e>=0,()=>`Negative dimension size caused by overflow when multiplying
    ${r} and ${e}  for depthToSpace with input shape
    ${s.shape}`),L(o*e>=0,()=>`Negative dimension size caused by overflow when multiplying
    ${o} and ${e} for depthToSpace with input shape
        ${s.shape}`),L(i%(e*e)===0,()=>`Dimension size must be evenly divisible by ${e*e} but is ${i} for depthToSpace with input shape ${s.shape}`);const a={x:s},l={blockSize:e,dataFormat:t};return K.runKernel(Mw,a,l)}const JE=j({depthToSpace_:rW});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oW(n,e,t,s,r="NHWC",o=[1,1],i){const a=M(n,"x","depthwiseConv2d","float32"),l=M(e,"filter","depthwiseConv2d","float32");let u=a,h=!1;a.rank===3&&(h=!0,u=X(a,[1,a.shape[0],a.shape[1],a.shape[2]])),L(u.rank===4,()=>`Error in depthwiseConv2d: input must be rank 4, but got rank ${u.rank}.`),L(l.rank===4,()=>`Error in depthwiseConv2d: filter must be rank 4, but got rank ${l.rank}.`);const p=r==="NHWC"?u.shape[3]:u.shape[1];L(p===l.shape[2],()=>`Error in depthwiseConv2d: number of input channels (${p}) must match the inChannels dimension in filter ${l.shape[2]}.`),os("depthwiseConv2d",s,i);const f={x:u,filter:l},m={strides:t,pad:s,dataFormat:r,dilations:o,dimRoundingMode:i},y=K.runKernel(Im,f,m);return h?X(y,[y.shape[1],y.shape[2],y.shape[3]]):y}const ed=j({depthwiseConv2d_:oW});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iW(n){const t={x:M(n,"x","diag")};return K.runKernel(Bw,t)}const aW=j({diag_:iW});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lW(n,e,t,s,r=[1,1],o="NHWC"){const i=M(n,"x","dilation2d"),a=M(e,"filter","dilation2d");L(i.rank===3||i.rank===4,()=>`Error in dilation2d: input must be rank 3 or 4, but got rank ${i.rank}.`),L(a.rank===3,()=>`Error in dilation2d: filter must be rank 3, but got rank ${a.rank}.`),L(o==="NHWC",()=>`Error in dilation2d: Only NHWC is currently supported, but got dataFormat of ${o}`);let l=i,u=!1;i.rank===3&&(l=X(i,[1,i.shape[0],i.shape[1],i.shape[2]]),u=!0),L(l.shape[3]===a.shape[2],()=>`Error in dilation2d:  input and filter must have the same depth: ${l.shape[3]} vs ${a.shape[2]}`);const h={x:l,filter:a},p={strides:t,pad:s,dilations:r},f=K.runKernel($m,h,p);return u?X(f,[f.shape[1],f.shape[2],f.shape[3]]):f}const eR=j({dilation2d_:lW});/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xl(n,e){const t=n.length,s=[];for(let r=0;r<t;r++){const o=t-1-r,i=n[o]||1;(e[e.length-1-r]||1)>1&&i===1&&s.unshift(o)}return s}function xn(n,e){const t=[];for(let s=0;s<e.length;s++){const r=n[n.length-s-1],o=e.length-s-1,i=e[o];(r==null||r===1&&i>1)&&t.unshift(o)}return t}function Ze(n,e){const t=Math.max(n.length,e.length),s=new Array(t);for(let r=0;r<t;r++){let o=n[n.length-r-1];o==null&&(o=1);let i=e[e.length-r-1];if(i==null&&(i=1),o===1)s[t-r-1]=i;else if(i===1)s[t-r-1]=o;else if(o!==i){const a=`Operands could not be broadcast together with shapes ${n} and ${e}.`;throw Error(a)}else s[t-r-1]=o}return s}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uW(n,e){let t=M(n,"a","equal","string_or_numeric"),s=M(e,"b","equal","string_or_numeric");[t,s]=Ht(t,s),Ze(t.shape,s.shape);const r={a:t,b:s};return K.runKernel(Em,r)}const Lr=j({equal_:uW});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cW(n,e,t){const s=M(e,"a","where"),r=M(t,"b","where"),o=M(n,"condition","where","bool"),i=Ze(Ze(o.shape,s.shape),r.shape),a=Vl(o,i),l=Vl(s,i),u=Vl(r,i),h={condition:a,t:l,e:u};return K.runKernel(og,h)}const Hn=j({where_:cW});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hW(n){const t={x:M(n,"x","zerosLike")};return K.runKernel(fg,t)}const dt=j({zerosLike_:hW});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dW(n,e){let t=M(n,"a","div"),s=M(e,"b","div");[t,s]=Ht(t,s);const r=Ae(t,s),o=dt(r),i=Lr(s,o);return Hn(i,o,r)}const tR=j({divNoNan_:dW});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pW(n,e){const t=M(n,"t1","dot"),s=M(e,"t2","dot");L((t.rank===1||t.rank===2)&&(s.rank===1||s.rank===2),()=>`Error in dot: inputs must all be rank 1 or 2, but got ranks ${t.rank} and ${s.rank}.`);const r=t.rank===1?t.size:t.shape[1],o=s.rank===1?s.size:s.shape[0];if(L(r===o,()=>`Error in dot: inner dimensions of inputs must match, but got ${r} and ${o}.`),t.rank===1&&s.rank===1){const i=X(t,[1,-1]),a=X(s,[-1,1]),l=lt(i,a);return X(l,[])}else if(t.rank===1&&s.rank===2){const i=X(t,[1,-1]),a=X(s,[s.shape[0],s.shape[1]]),l=lt(i,a);return X(l,[l.size])}else if(t.rank===2&&s.rank===1){const i=X(s,[-1,1]),a=lt(t,i);return X(a,[a.size])}else{const i=X(s,[s.shape[0],s.shape[1]]);return lt(t,i)}}const nR=j({dot_:pW});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fW(n,...e){const t=e.map((r,o)=>M(r,`tensors${o}`,"einsum")),s={equation:n};return K.runKernel(Ww,t,s)}const El=j({einsum_:fW});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mW(n){const t={x:M(n,"x","elu","float32")};return K.runKernel(mh,t)}const td=j({elu_:mW});/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gW(n,e){const t=M(n,"x","ensureShape","string_or_numeric");if(!$V(t.shape,e))throw new Error(`EnsureShape: Shape of tensor ${t.shape} is not compatible with expected shape ${e}`);return n}const yW=j({ensureShape_:gW});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xW(n){let e=M(n,"x","erf");L(e.dtype==="int32"||e.dtype==="float32",()=>"Input dtype must be `int32` or `float32`."),e.dtype==="int32"&&(e=Ne(e,"float32"));const t={x:e};return K.runKernel(gh,t)}const W1=j({erf_:xW});/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function U1(n,e){for(let t=0;t<n.length;++t)if(n[n.length-t-1]!==e-1-t)return!1;return!0}function sR(n,e,t){const s=n.length+e.length,r=[];let o=0,i=0;for(let a=0;a<s;a++)t.indexOf(a)===-1?r.push(n[o++]):r.push(e[i++]);return r}function In(n,e){const t=[],s=n.length;for(let o=0;o<s;o++)e.indexOf(o)===-1&&t.push(n[o]);const r=e.map(o=>n[o]);return[t,r]}function Zt(n,e){const t=e.map(s=>1);return sR(n,t,e)}function Mn(n,e,t){L(U1(e,t),()=>`${n} supports only inner-most axes for now. Got axes ${e} and rank-${t} input.`)}function zt(n,e){if(U1(n,e))return null;const t=[];for(let s=0;s<e;++s)n.indexOf(s)===-1&&t.push(s);return n.forEach(s=>t.push(s)),t}function Mi(n){return n.map((e,t)=>[t,e]).sort((e,t)=>e[1]-t[1]).map(e=>e[0])}function Jt(n,e){const t=[];for(let s=e-n;s<e;++s)t.push(s);return t}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vW(n,e=null,t=!1){const r={x:M(n,"x","max")},o={reductionIndices:e,keepDims:t};return K.runKernel(Bm,r,o)}const hr=j({max_:vW});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wW(n,e=null,t=!1){const r={x:M(n,"x","min")},o={axis:e,keepDims:t};return K.runKernel(jm,r,o)}const Oc=j({min_:wW});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bW(n,e){let t=M(n,"base","pow"),s=M(e,"exp","pow");[t,s]=Ht(t,s);const r={a:t,b:s};return K.runKernel(Ah,r)}const Ro=j({pow_:bW});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function We(n,e){if((pr(n)&&e!=="string"||Array.isArray(n))&&e!=="complex64")throw new Error("Error creating a new Scalar: value must be a primitive (number|boolean|string)");if(e==="string"&&pr(n)&&!(n instanceof Uint8Array))throw new Error("When making a scalar from encoded string, the value must be `Uint8Array`.");return Pi(n,[],[],e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function SW(n){const t={x:M(n,"x","sqrt","float32")};return K.runKernel(Gh,t)}const Pn=j({sqrt_:SW});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function CW(n){const e=M(n,"x","square"),t={};return K.runKernel("Square",{x:e},t)}const Ct=j({square_:CW});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kW(n,e=null,t=!1){let s=M(n,"x","sum");s.dtype==="bool"&&(s=Ne(s,"int32"));const r={x:s},o={axis:e,keepDims:t};return K.runKernel(ag,r,o)}const _e=j({sum_:kW});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function TW(n,e="euclidean",t=null,s=!1){n=M(n,"x","norm");const r=rR(n,e,t);let o=r.shape;if(s){const i=it(t,n.shape);o=Zt(r.shape,i)}return X(r,o)}function rR(n,e,t=null){if(n.rank===0)return hn(n);if(n.rank!==1&&t===null)return rR(X(n,[-1]),e,t);if(n.rank===1||typeof t=="number"||Array.isArray(t)&&t.length===1){if(e===1)return _e(hn(n),t);if(e===1/0)return hr(hn(n),t);if(e===-1/0)return Oc(hn(n),t);if(e==="euclidean"||e===2)return Pn(_e(Ro(hn(n),We(2,"int32")),t));throw new Error(`Error in norm: invalid ord value: ${e}`)}if(Array.isArray(t)&&t.length===2){if(e===1)return hr(_e(hn(n),t[0]),t[1]-1);if(e===1/0)return hr(_e(hn(n),t[1]),t[0]);if(e===-1/0)return Oc(_e(hn(n),t[1]),t[0]);if(e==="fro"||e==="euclidean")return Pn(_e(Ct(n),t));throw new Error(`Error in norm: invalid ord value: ${e}`)}throw new Error(`Error in norm: invalid axis: ${t}`)}const nd=j({norm_:TW});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function NW(n,e=null,t=!1){return nd(n,"euclidean",e,t)}const oR=j({euclideanNorm_:NW});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function IW(n){const t={x:M(n,"x","exp")};return K.runKernel(yh,t)}const Os=j({exp_:IW});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $W(n,e=0){const t=M(n,"x","expandDims","string_or_numeric");L(e<=t.rank,()=>"Axis must be <= rank of the tensor");const s={input:t},r={dim:e};return K.runKernel(Rm,s,r)}const jn=j({expandDims_:$W});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function EW(n){const t={x:M(n,"x","expm1")};return K.runKernel(xh,t)}const iR=j({expm1_:EW});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function RW(n,e){const t=M(n,"x","tile","string_or_numeric");L(t.rank===e.length,()=>`Error in transpose: rank of input ${t.rank} must match length of reps ${e}.`);const s={x:t},r={reps:e};return K.runKernel(Xh,s,r)}const ir=j({tile_:RW});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function DW(n,e,t,s="float32"){e==null&&(e=n);const r=nt([n,e],s),o=n<=e?n:e;for(let a=0;a<o;++a)r.set(1,a,a);const i=X(r.toTensor(),[n,e]);if(t==null)return i;if(t.length===1)return ir(jn(i,0),[t[0],1,1]);if(t.length===2)return ir(jn(jn(i,0),0),[t[0],t[1],1,1]);if(t.length===3)return ir(jn(jn(jn(i,0),0),0),[t[0],t[1],t[2],1,1]);throw new Error(`eye() currently supports only 1D and 2D batchShapes, but received ${t.length}D.`)}const G1=j({eye_:DW});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function AW(n){const t={x:M(n,"x","floor","float32")};return K.runKernel(vh,t)}const sd=j({floor_:AW});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function OW(n,e,t=0,s=0){const r=M(n,"x","gather"),o=M(e,"indices","gather","int32"),i={x:r,indices:o},a={axis:t,batchDims:s};return K.runKernel(Am,i,a)}const rd=j({gather_:OW});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _W(n,e){let t=M(n,"a","greater","string_or_numeric"),s=M(e,"b","greater","string_or_numeric");[t,s]=Ht(t,s),Ze(t.shape,s.shape);const r={a:t,b:s};return K.runKernel(Om,r)}const Ms=j({greater_:_W});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function FW(n,e){let t=M(n,"a","greaterEqual","string_or_numeric"),s=M(e,"b","greaterEqual","string_or_numeric");[t,s]=Ht(t,s),Ze(t.shape,s.shape);const r={a:t,b:s};return K.runKernel(bh,r)}const zi=j({greaterEqual_:FW});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function PW(n){const t={input:M(n,"input","imag")};return K.runKernel(Xw,t)}const vg=j({imag_:PW});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function LW(n){const t={x:M(n,"x","isFinite")};return K.runKernel(Ch,t)}const aR=j({isFinite_:LW});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function MW(n){const t={x:M(n,"x","isInf")};return K.runKernel(kh,t)}const lR=j({isInf_:MW});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zW(n){const t={x:M(n,"x","isNaN")};return K.runKernel(Th,t)}const uR=j({isNaN_:zW});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function VW(n,e=.2){const s={x:M(n,"x","leakyRelu")},r={alpha:e};return K.runKernel(_m,s,r)}const wg=j({leakyRelu_:VW});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function BW(n,e){let t=M(n,"a","less","string_or_numeric"),s=M(e,"b","less","string_or_numeric");[t,s]=Ht(t,s),Ze(t.shape,s.shape);const r={a:t,b:s};return K.runKernel(Fm,r)}const _c=j({less_:BW});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function WW(n,e){let t=M(n,"a","lessEqual","string_or_numeric"),s=M(e,"b","lessEqual","string_or_numeric");[t,s]=Ht(t,s),Ze(t.shape,s.shape);const r={a:t,b:s};return K.runKernel(Pm,r)}const Ba=j({lessEqual_:WW});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function UW(n,e,t){if(t<=0)throw new Error("The number of values should be positive.");const s={start:n,stop:e,num:t};return K.runKernel(Yw,{},s)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function GW(n,e=5,t=1,s=1,r=.5){const o=M(n,"x","localResponseNormalization");L(o.rank===4||o.rank===3,()=>`Error in localResponseNormalization: x must be rank 3 or 4 but got
               rank ${o.rank}.`),L(Hl(e),()=>`Error in localResponseNormalization: depthRadius must be an integer but got depthRadius ${e}.`);let i=o,a=!1;o.rank===3&&(a=!0,i=X(o,[1,o.shape[0],o.shape[1],o.shape[2]]));const l={x:i},u={depthRadius:e,bias:t,alpha:s,beta:r},h=K.runKernel(Vm,l,u);return a?X(h,[h.shape[1],h.shape[2],h.shape[3]]):h}const cR=j({localResponseNormalization_:GW});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jW(n){const t={x:M(n,"x","log","float32")};return K.runKernel(Nh,t)}const js=j({log_:jW});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function HW(n){const t={x:M(n,"x","log1p")};return K.runKernel(Ih,t)}const bg=j({log1p_:HW});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function KW(n,e){L(Xx(n),()=>"The f passed in variableGrads(f) must be a function"),L(e==null||Array.isArray(e)&&e.every(u=>u instanceof Ef),()=>"The varList passed in variableGrads(f, varList) must be an array of variables");const t=e!=null;if(!t){e=[];for(const u in K.registeredVariables)e.push(K.registeredVariables[u])}const s=t?e.filter(u=>!u.trainable):null,r=e.length;e=e.filter(u=>u.trainable),L(e.length>0,()=>`variableGrads() expects at least one of the input variables to be trainable, but none of the ${r} variables is trainable.`);const o=!0,{value:i,grads:a}=K.gradients(n,e,null,o);L(a.some(u=>u!=null),()=>"Cannot find a connection between any variable and the result of the loss function y=f(x). Please make sure the operations that use variables are inside the function f passed to minimize()."),L(i.rank===0,()=>`The f passed in variableGrads(f) must return a scalar, but it returned a rank-${i.rank} tensor`);const l={};return e.forEach((u,h)=>{a[h]!=null&&(l[u.name]=a[h])}),s!=null&&s.forEach(u=>l[u.name]=null),{value:i,grads:l}}function Do(n){return K.customGrad(n)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qW(n){const t={x:M(n,"x","neg")};return K.runKernel(Km,t)}const Rt=j({neg_:qW});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function XW(n){const t={x:M(n,"x","softplus")};return K.runKernel(Uh,t)}const du=j({softplus_:XW});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function YW(n){const e=M(n,"x","logSigmoid");return Do(s=>({value:Rt(du(Rt(s))),gradFunc:i=>H(i,Fr(Rt(s)))}))(e)}const hR=j({logSigmoid_:YW});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function QW(n,e){let t=M(n,"a","sub"),s=M(e,"b","sub");[t,s]=Ht(t,s);const r={a:t,b:s};return K.runKernel(Hh,r)}const Ee=j({sub_:QW});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ZW(n,e=-1){const t=M(n,"logits","logSoftmax");if(e===-1&&(e=t.rank-1),e!==t.rank-1)throw Error(`Log Softmax along a non-last dimension is not yet supported. Logits was rank ${t.rank} and axis was ${e}`);return Do((r,o)=>{const a=hr(r,e,!0),l=Ee(r,a),u=Ee(Ne(l,"float32"),js(_e(Os(l),e,!0)));return o([u]),{value:u,gradFunc:(p,f)=>{const[m]=f,y=!0,x=Os(m);return Ee(p,H(_e(p,e,y),x))}}})(t)}const j1=j({logSoftmax_:ZW});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function JW(n,e=null,t=!1){const s=M(n,"x","logSumExp"),r=it(e,s.shape),o=hr(s,r,!0),i=Ee(s,o),a=Os(i),l=_e(a,r),u=js(l),h=ye(X(o,u.shape),u);if(t){const p=Zt(h.shape,r);return X(h,p)}return h}const Sg=j({logSumExp_:JW});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eU(n,e){const t=M(n,"a","logicalAnd","bool"),s=M(e,"b","logicalAnd","bool");Ze(t.shape,s.shape);const r={a:t,b:s};return K.runKernel(Lm,r)}const ao=j({logicalAnd_:eU});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tU(n){const t={x:M(n,"x","logicalNot","bool")};return K.runKernel(Mm,t)}const Cg=j({logicalNot_:tU});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nU(n,e){const t=M(n,"a","logicalOr","bool"),s=M(e,"b","logicalOr","bool");Ze(t.shape,s.shape);const r={a:t,b:s};return K.runKernel(zm,r)}const H1=j({logicalOr_:nU});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sU(n,e){const t=M(n,"a","logicalXor","bool"),s=M(e,"b","logicalXor","bool");return Ze(t.shape,s.shape),ao(H1(n,e),Cg(ao(n,e)))}const dR=j({logicalXor_:sU});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Pp=2147483648;function rU(n,e,t="left"){const s=M(n,"sortedSequence","searchSorted"),r=M(e,"values","searchSorted"),o=s.shape[s.shape.length-1],i=r.shape[r.shape.length-1],a=X(s,[-1,o]),l=X(r,[-1,i]);if(a.rank<2)throw new Error("Sorted input argument must be at least 2-dimensional");if(a.shape[0]!==l.shape[0])throw new Error("Leading dimension of 'sortedSequence' and 'values' must match.");if(fe(l.shape)>=Pp)throw new Error(`values tensor size must less than ${Pp}`);if(a.shape[1]>=Pp)throw new Error(`trailing dim_size must less than ${Pp} for int32 output type, was ${a.shape[1]}`);const u={sortedSequence:a,values:l},h={side:t};return K.runKernel(f1,u,h)}const K1=j({searchSorted_:rU});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oU(n,e){return K1(n,e,"left")}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iU(n,e,t,s,r){const o=M(n,"x","maxPool"),i=1;let a=o,l=!1;o.rank===3&&(l=!0,a=X(o,[1,o.shape[0],o.shape[1],o.shape[2]])),L(a.rank===4,()=>`Error in maxPool: input must be rank 4 but got rank ${a.rank}.`),L(Ln(t,i),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${t} and dilations '${i}'`),os("maxPool",s,r);const u={x:a},h={filterSize:e,strides:t,pad:s,dimRoundingMode:r},p=K.runKernel(Wm,u,h);return l?X(p,[p.shape[1],p.shape[2],p.shape[3]]):p}const kg=j({maxPool_:iU});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aU(n,e=[1,1,1],t,s,r,o="NDHWC"){const i=M(n,"x","maxPool3d");let a=i,l=!1;i.rank===4&&(l=!0,a=X(i,[1,i.shape[0],i.shape[1],i.shape[2],i.shape[3]])),L(a.rank===5,()=>`Error in maxPool3d: x must be rank 5 but got rank ${a.rank}.`),L(o==="NDHWC",()=>`Error in maxPool3d: Only NDHWC is currently supported, but got dataFormat of ${o}`),os("maxPool3d",s,r);const u={x:a},h={filterSize:e,strides:t,pad:s,dimRoundingMode:r,dataFormat:o},p=K.runKernel(Um,u,h);return l?X(p,[p.shape[1],p.shape[2],p.shape[3],p.shape[4]]):p}const pR=j({maxPool3d_:aU});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lU(n,e,t,s,r=!1){const i={x:M(n,"x","maxPoolWithArgmax")},a={filterSize:e,strides:t,pad:s,includeBatchInIndex:r},l=K.runKernel(e1,i,a);return{result:l[0],indexes:l[1]}}const uU=j({maxPoolWithArgmax_:lU});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cU(n,e){let t=M(n,"a","maximum"),s=M(e,"b","maximum");[t,s]=Ht(t,s),t.dtype==="bool"&&(t=Ne(t,"int32"),s=Ne(s,"int32")),Ze(t.shape,s.shape);const r={a:t,b:s};return K.runKernel($h,r)}const zo=j({maximum_:cU});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hU(n,e=null,t=!1){const r={x:M(n,"x","mean")},o={axis:e,keepDims:t};return K.runKernel(Gm,r,o)}const Ut=j({mean_:hU});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dn(n,e="float32"){if(Ks(n),e==="complex64"){const s=dn(n,"float32"),r=dn(n,"float32");return wi(s,r)}const t=Kn(fe(n),e);return K.makeTensor(t,n,e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $s(n,e="float32"){if(Ks(n),e==="complex64"){const s=$s(n,"float32"),r=dn(n,"float32");return wi(s,r)}const t=Cw(fe(n),e);return K.makeTensor(t,n,e)}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dU(n,e,{indexing:t="xy"}={}){if(t!=="xy"&&t!=="ij")throw new TypeError(`${t} is not a valid third argument to meshgrid`);if(n===void 0)return[];let s=M(n,"x","meshgrid",n instanceof $t?n.dtype:"float32");if(e===void 0)return[s];let r=M(e,"y","meshgrid",e instanceof $t?e.dtype:"float32");const o=fe(s.shape),i=fe(r.shape);return t==="xy"?(s=X(s,[1,-1]),r=X(r,[-1,1]),[lt($s([i,1],s.dtype),s),lt(r,$s([1,o],r.dtype))]):(s=X(s,[-1,1]),r=X(r,[1,-1]),[lt(s,$s([1,i],s.dtype)),lt($s([o,1],r.dtype),r)])}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pU(n,e){let t=M(n,"a","minimum"),s=M(e,"b","minimum");[t,s]=Ht(t,s),t.dtype==="bool"&&(t=Ne(t,"int32"),s=Ne(s,"int32")),Ze(t.shape,s.shape);const r={a:t,b:s};return K.runKernel(Eh,r)}const Ra=j({minimum_:pU});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fU(n,e,t){L(t==="reflect"||t==="symmetric",()=>`Invalid mode. Mode must be either reflect or symmetric. Got ${t}.`);const s=M(n,"x","mirrorPad");if(s.rank===0)throw new Error("mirrorPad(scalar) is not defined. Pass non-scalar to mirrorPad");L(e.length===s.rank,()=>`Padding doesn't match input. Must be ${s.rank}. Got ${e.length}.`);const r=t==="reflect"?1:0;for(let a=0;a<s.rank;a++)L(e[a].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),L(e[a][0]>=0&&e[a][0]<=s.shape[a]-r&&e[a][1]>=0&&e[a][1]<=s.shape[a]-r,()=>`Padding in dimension ${a} cannot be greater than or equal to ${s.shape[a]-r} or less than 0 for input of shape ${s.shape}`);const o={paddings:e,mode:t},i={x:s};return K.runKernel(Hm,i,o)}const fR=j({mirrorPad_:fU});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mU(n,e){let t=M(n,"a","mod"),s=M(e,"b","mod");[t,s]=Ht(t,s);const r={a:t,b:s};return K.runKernel(Rh,r)}const mR=j({mod_:mU});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gU(n,e=null,t=!1){n=M(n,"x","moments");const s=it(e,n.shape),r=Ut(n,s,t);let o=r.shape;t||(o=Zt(r.shape,s));const i=Ct(Ee(Ne(n,"float32"),X(r,o))),a=Ut(i,s,t);return{mean:r,variance:a}}const Tg=j({moments_:gU});function yU(n,e,t,s){const r=M(e,"data","multiRNNCell"),o=Rf(t,"c","multiRNNCell"),i=Rf(s,"h","multiRNNCell");let a=r;const l=[];for(let p=0;p<n.length;p++){const f=n[p](a,o[p],i[p]);l.push(f[0]),l.push(f[1]),a=f[1]}const u=[],h=[];for(let p=0;p<l.length;p+=2)u.push(l[p]),h.push(l[p+1]);return[u,h]}const xU=j({multiRNNCell_:yU});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vU(n,e,t,s=!1){const r=M(n,"logits","multinomial"),o=r.size,i=r.rank;if(o<2)throw new Error(`Error in multinomial: you need at least 2 outcomes, but got ${o}.`);if(i>2)throw new Error(`Rank of probabilities must be 1 or 2, but is ${i}`);t=t||Math.random();const l={logits:i===1?X(r,[1,-1]):r},u={numSamples:e,seed:t,normalized:s},h=K.runKernel(t1,l,u);return i===1?X(h,[h.size]):h}const wU=j({multinomial_:vU});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bU(n,e){let t=M(n,"a","notEqual","string_or_numeric"),s=M(e,"b","notEqual","string_or_numeric");[t,s]=Ht(t,s),Ze(t.shape,s.shape);const r={a:t,b:s};return K.runKernel(qm,r)}const Yl=j({notEqual_:bU});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function SU(n,e,t=1,s=0,r="int32"){if(e<2)throw new Error(`Error in oneHot: depth must be >=2, but it is ${e}`);const i={indices:M(n,"indices","oneHot","int32")},a={dtype:r,depth:e,onValue:t,offValue:s};return K.runKernel(Ym,i,a)}const q1=j({oneHot_:SU});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function CU(n){const t={x:M(n,"x","onesLike")};return K.runKernel(Xm,t)}const Hs=j({onesLike_:CU});function kU(n,e){const t=M(n,"v1","outerProduct"),s=M(e,"v2","outerProduct");L(t.rank===1&&s.rank===1,()=>`Error in outerProduct: inputs must be rank 1, but got ranks ${t.rank} and ${s.rank}.`);const r=X(t,[-1,1]),o=X(s,[1,-1]);return lt(r,o)}const TU=j({outerProduct_:kU});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function NU(n,e,t=0){const s=M(n,"x","pad");if(s.rank===0)throw new Error("pad(scalar) is not defined. Pass non-scalar to pad");const r={paddings:e,constantValue:t},o={x:s};return K.runKernel(Zm,o,r)}const Vi=j({pad_:NU});function IU(n,e,t=0){return L(e.length===2,()=>"Invalid number of paddings. Must be length of 2."),Vi(n,[e],t)}const $U=j({pad1d_:IU});function EU(n,e,t=0){return L(e.length===2&&e[0].length===2&&e[1].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),Vi(n,e,t)}const RU=j({pad2d_:EU});function DU(n,e,t=0){return L(e.length===3&&e[0].length===2&&e[1].length===2&&e[2].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),Vi(n,e,t)}const AU=j({pad3d_:DU});function OU(n,e,t=0){return L(e.length===4&&e[0].length===2&&e[1].length===2&&e[2].length===2&&e[3].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),Vi(n,e,t)}const _U=j({pad4d_:OU});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function FU(n,e,t){const s=M(n,"x","spaceToBatchND");L(s.rank>=1+e.length,()=>`input rank ${s.rank} should be > than [blockShape] ${e.length}`),L(t.length===e.length,()=>`paddings.shape[0] ${t.length} must be equal to [blockShape] ${e.length}`),L(s.shape.reduce((i,a,l)=>l>0&&l<=e.length?i&&(a+t[l-1][0]+t[l-1][1])%e[l-1]===0:i,!0),()=>`input spatial dimensions ${s.shape.slice(1)} with paddings ${t.toString()} must be divisible by blockShapes ${e.toString()}`);const r={x:s},o={blockShape:e,paddings:t};return K.runKernel(lg,r,o)}const Ng=j({spaceToBatchND_:FU});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function PU(n,e,t,s,r,o,i){r==null&&(r=[1,1]),o==null&&(o=1),s===0&&(s="valid");const a=M(n,"x","maxPool");let l=a,u=!1;a.rank===3&&(u=!0,l=X(a,[1,a.shape[0],a.shape[1],a.shape[2]])),L(Ln(o,r),()=>`Error in pool: Either strides or dilations must be 1. Got strides ${o} and dilations '${r}'`);const h=yr(l.shape,e,o,r,s),p=[h.dilationHeight,h.dilationWidth];let f;s==="same"?f=MU([h.filterHeight,h.filterWidth],p):f=[[0,0],[0,0]];const m=p[0]===1&&p[1]===1,[y,x]=LU([h.inHeight,h.inWidth],p,f),v=m?s:"valid",w=m?l:Ng(l,p,y),k=(t==="avg"?()=>gg(w,e,o,v,i):()=>kg(w,e,o,v,i))(),T=m?k:yg(k,p,x);return u?X(T,[T.shape[1],T.shape[2],T.shape[3]]):T}function LU(n,e,t){const s=t.map(h=>h[0]),r=t.map(h=>h[1]),o=n.concat(s,r),i=e.map((h,p)=>(h-o[p]%h)%h),a=r.map((h,p)=>h+i[p]),l=e.map((h,p)=>[s[p],a[p]]),u=e.map((h,p)=>[0,i[p]]);return[l,u]}function MU(n,e){const s=n.map((i,a)=>i+(i-1)*(e[a]-1)).map(i=>i-1),r=s.map(i=>Math.floor(i/2)),o=s.map((i,a)=>i-r[a]);return s.map((i,a)=>[r[a],o[a]])}const gR=j({pool_:PU});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zU(n,e){const t=M(n,"x","prelu"),s=M(e,"alpha","prelu"),r={x:t,alpha:s};return K.runKernel(Jm,r)}const Ig=j({prelu_:zU});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function VU(n,e=null,t=!1){let s=M(n,"x","prod");s.dtype==="bool"&&(s=Ne(s,"int32"));const r={x:s},o={axis:e,keepDims:t};return K.runKernel(eg,r,o)}const yR=j({prod_:VU});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function BU(n,e,t,s){const r=n.map((h,p)=>M(h,`tensors${p}`,"raggedGather","int32")),o=M(e,"paramsDenseValues","raggedGather"),i=M(t,"indices","raggedGather","int32"),a={paramsNestedSplits:r,paramsDenseValues:o,indices:i},l={outputRaggedRank:s},u=K.runKernel(o1,a,l);return{outputNestedSplits:u.slice(0,u.length-1),outputDenseValues:u[u.length-1]}}const WU=j({raggedGather_:BU});/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function UU(n,e,t){const s=M(n,"starts","raggedRange"),r=M(e,"limits","raggedRange",s.dtype),o=M(t,"deltas","raggedRange",s.dtype),i={starts:s,limits:r,deltas:o},a=K.runKernel(i1,i);return{rtNestedSplits:a[0],rtDenseValues:a[1]}}const GU=j({raggedRange_:UU});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jU(n,e,t,s,r){const o=M(n,"shape","raggedTensorToTensor","int32"),i=M(e,"values","raggedTensorToTensor"),a=M(t,"defaultValue","raggedTensorToTensor",i.dtype),l=s.map((p,f)=>M(p,`tensors${f}`,"raggedTensorToTensor","int32")),u={shape:o,values:i,defaultValue:a,rowPartitionTensors:l},h={rowPartitionTypes:r};return K.runKernel(a1,u,h)}const HU=j({raggedTensorToTensor_:jU});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function KU(n,e,t){Ks(n);const s=fe(n);let r=null;if(t==null||t==="float32")r=new Float32Array(s);else if(t==="int32")r=new Int32Array(s);else if(t==="bool")r=new Uint8Array(s);else throw new Error(`Unknown data type ${t}`);for(let o=0;o<s;o++)r[o]=e();return K.makeTensor(r,n,t)}const qU=j({rand_:KU});var af={exports:{}},XU=af.exports,bN;function YU(){return bN||(bN=1,(function(n){(function(e,t,s){function r(l){var u=this,h=a();u.next=function(){var p=2091639*u.s0+u.c*23283064365386963e-26;return u.s0=u.s1,u.s1=u.s2,u.s2=p-(u.c=p|0)},u.c=1,u.s0=h(" "),u.s1=h(" "),u.s2=h(" "),u.s0-=h(l),u.s0<0&&(u.s0+=1),u.s1-=h(l),u.s1<0&&(u.s1+=1),u.s2-=h(l),u.s2<0&&(u.s2+=1),h=null}function o(l,u){return u.c=l.c,u.s0=l.s0,u.s1=l.s1,u.s2=l.s2,u}function i(l,u){var h=new r(l),p=u&&u.state,f=h.next;return f.int32=function(){return h.next()*4294967296|0},f.double=function(){return f()+(f()*2097152|0)*11102230246251565e-32},f.quick=f,p&&(typeof p=="object"&&o(p,h),f.state=function(){return o(h,{})}),f}function a(){var l=4022871197,u=function(h){h=String(h);for(var p=0;p<h.length;p++){l+=h.charCodeAt(p);var f=.02519603282416938*l;l=f>>>0,f-=l,f*=l,l=f>>>0,f-=l,l+=f*4294967296}return(l>>>0)*23283064365386963e-26};return u}t&&t.exports?t.exports=i:this.alea=i})(XU,n)})(af)),af.exports}var lf={exports:{}},QU=lf.exports,SN;function ZU(){return SN||(SN=1,(function(n){(function(e,t,s){function r(a){var l=this,u="";l.x=0,l.y=0,l.z=0,l.w=0,l.next=function(){var p=l.x^l.x<<11;return l.x=l.y,l.y=l.z,l.z=l.w,l.w^=l.w>>>19^p^p>>>8},a===(a|0)?l.x=a:u+=a;for(var h=0;h<u.length+64;h++)l.x^=u.charCodeAt(h)|0,l.next()}function o(a,l){return l.x=a.x,l.y=a.y,l.z=a.z,l.w=a.w,l}function i(a,l){var u=new r(a),h=l&&l.state,p=function(){return(u.next()>>>0)/4294967296};return p.double=function(){do var f=u.next()>>>11,m=(u.next()>>>0)/4294967296,y=(f+m)/(1<<21);while(y===0);return y},p.int32=u.next,p.quick=p,h&&(typeof h=="object"&&o(h,u),p.state=function(){return o(u,{})}),p}t&&t.exports?t.exports=i:this.xor128=i})(QU,n)})(lf)),lf.exports}var uf={exports:{}},JU=uf.exports,CN;function eG(){return CN||(CN=1,(function(n){(function(e,t,s){function r(a){var l=this,u="";l.next=function(){var p=l.x^l.x>>>2;return l.x=l.y,l.y=l.z,l.z=l.w,l.w=l.v,(l.d=l.d+362437|0)+(l.v=l.v^l.v<<4^(p^p<<1))|0},l.x=0,l.y=0,l.z=0,l.w=0,l.v=0,a===(a|0)?l.x=a:u+=a;for(var h=0;h<u.length+64;h++)l.x^=u.charCodeAt(h)|0,h==u.length&&(l.d=l.x<<10^l.x>>>4),l.next()}function o(a,l){return l.x=a.x,l.y=a.y,l.z=a.z,l.w=a.w,l.v=a.v,l.d=a.d,l}function i(a,l){var u=new r(a),h=l&&l.state,p=function(){return(u.next()>>>0)/4294967296};return p.double=function(){do var f=u.next()>>>11,m=(u.next()>>>0)/4294967296,y=(f+m)/(1<<21);while(y===0);return y},p.int32=u.next,p.quick=p,h&&(typeof h=="object"&&o(h,u),p.state=function(){return o(u,{})}),p}t&&t.exports?t.exports=i:this.xorwow=i})(JU,n)})(uf)),uf.exports}var cf={exports:{}},tG=cf.exports,kN;function nG(){return kN||(kN=1,(function(n){(function(e,t,s){function r(a){var l=this;l.next=function(){var h=l.x,p=l.i,f,m;return f=h[p],f^=f>>>7,m=f^f<<24,f=h[p+1&7],m^=f^f>>>10,f=h[p+3&7],m^=f^f>>>3,f=h[p+4&7],m^=f^f<<7,f=h[p+7&7],f=f^f<<13,m^=f^f<<9,h[p]=m,l.i=p+1&7,m};function u(h,p){var f,m=[];if(p===(p|0))m[0]=p;else for(p=""+p,f=0;f<p.length;++f)m[f&7]=m[f&7]<<15^p.charCodeAt(f)+m[f+1&7]<<13;for(;m.length<8;)m.push(0);for(f=0;f<8&&m[f]===0;++f);for(f==8?m[7]=-1:m[f],h.x=m,h.i=0,f=256;f>0;--f)h.next()}u(l,a)}function o(a,l){return l.x=a.x.slice(),l.i=a.i,l}function i(a,l){a==null&&(a=+new Date);var u=new r(a),h=l&&l.state,p=function(){return(u.next()>>>0)/4294967296};return p.double=function(){do var f=u.next()>>>11,m=(u.next()>>>0)/4294967296,y=(f+m)/(1<<21);while(y===0);return y},p.int32=u.next,p.quick=p,h&&(h.x&&o(h,u),p.state=function(){return o(u,{})}),p}t&&t.exports?t.exports=i:this.xorshift7=i})(tG,n)})(cf)),cf.exports}var hf={exports:{}},sG=hf.exports,TN;function rG(){return TN||(TN=1,(function(n){(function(e,t,s){function r(a){var l=this;l.next=function(){var h=l.w,p=l.X,f=l.i,m,y;return l.w=h=h+1640531527|0,y=p[f+34&127],m=p[f=f+1&127],y^=y<<13,m^=m<<17,y^=y>>>15,m^=m>>>12,y=p[f]=y^m,l.i=f,y+(h^h>>>16)|0};function u(h,p){var f,m,y,x,v,w=[],S=128;for(p===(p|0)?(m=p,p=null):(p=p+"\0",m=0,S=Math.max(S,p.length)),y=0,x=-32;x<S;++x)p&&(m^=p.charCodeAt((x+32)%p.length)),x===0&&(v=m),m^=m<<10,m^=m>>>15,m^=m<<4,m^=m>>>13,x>=0&&(v=v+1640531527|0,f=w[x&127]^=m+v,y=f==0?y+1:0);for(y>=128&&(w[(p&&p.length||0)&127]=-1),y=127,x=512;x>0;--x)m=w[y+34&127],f=w[y=y+1&127],m^=m<<13,f^=f<<17,m^=m>>>15,f^=f>>>12,w[y]=m^f;h.w=v,h.X=w,h.i=y}u(l,a)}function o(a,l){return l.i=a.i,l.w=a.w,l.X=a.X.slice(),l}function i(a,l){a==null&&(a=+new Date);var u=new r(a),h=l&&l.state,p=function(){return(u.next()>>>0)/4294967296};return p.double=function(){do var f=u.next()>>>11,m=(u.next()>>>0)/4294967296,y=(f+m)/(1<<21);while(y===0);return y},p.int32=u.next,p.quick=p,h&&(h.X&&o(h,u),p.state=function(){return o(u,{})}),p}t&&t.exports?t.exports=i:this.xor4096=i})(sG,n)})(hf)),hf.exports}var df={exports:{}},oG=df.exports,NN;function iG(){return NN||(NN=1,(function(n){(function(e,t,s){function r(a){var l=this,u="";l.next=function(){var p=l.b,f=l.c,m=l.d,y=l.a;return p=p<<25^p>>>7^f,f=f-m|0,m=m<<24^m>>>8^y,y=y-p|0,l.b=p=p<<20^p>>>12^f,l.c=f=f-m|0,l.d=m<<16^f>>>16^y,l.a=y-p|0},l.a=0,l.b=0,l.c=-1640531527,l.d=1367130551,a===Math.floor(a)?(l.a=a/4294967296|0,l.b=a|0):u+=a;for(var h=0;h<u.length+20;h++)l.b^=u.charCodeAt(h)|0,l.next()}function o(a,l){return l.a=a.a,l.b=a.b,l.c=a.c,l.d=a.d,l}function i(a,l){var u=new r(a),h=l&&l.state,p=function(){return(u.next()>>>0)/4294967296};return p.double=function(){do var f=u.next()>>>11,m=(u.next()>>>0)/4294967296,y=(f+m)/(1<<21);while(y===0);return y},p.int32=u.next,p.quick=p,h&&(typeof h=="object"&&o(h,u),p.state=function(){return o(u,{})}),p}t&&t.exports?t.exports=i:this.tychei=i})(oG,n)})(df)),df.exports}var pf={exports:{}};const aG={},lG=Object.freeze(Object.defineProperty({__proto__:null,default:aG},Symbol.toStringTag,{value:"Module"})),uG=$M(lG);var cG=pf.exports,IN;function hG(){return IN||(IN=1,(function(n){(function(e,t,s){var r=256,o=6,i=52,a="random",l=s.pow(r,o),u=s.pow(2,i),h=u*2,p=r-1,f;function m(T,I,E){var D=[];I=I==!0?{entropy:!0}:I||{};var O=w(v(I.entropy?[T,k(t)]:T??S(),3),D),_=new y(D),P=function(){for(var R=_.g(o),W=l,Q=0;R<u;)R=(R+Q)*r,W*=r,Q=_.g(1);for(;R>=h;)R/=2,W/=2,Q>>>=1;return(R+Q)/W};return P.int32=function(){return _.g(4)|0},P.quick=function(){return _.g(4)/4294967296},P.double=P,w(k(_.S),t),(I.pass||E||function(R,W,Q,ee){return ee&&(ee.S&&x(ee,_),R.state=function(){return x(_,{})}),Q?(s[a]=R,W):R})(P,O,"global"in I?I.global:this==s,I.state)}function y(T){var I,E=T.length,D=this,O=0,_=D.i=D.j=0,P=D.S=[];for(E||(T=[E++]);O<r;)P[O]=O++;for(O=0;O<r;O++)P[O]=P[_=p&_+T[O%E]+(I=P[O])],P[_]=I;(D.g=function(R){for(var W,Q=0,ee=D.i,te=D.j,oe=D.S;R--;)W=oe[ee=p&ee+1],Q=Q*r+oe[p&(oe[ee]=oe[te=p&te+W])+(oe[te]=W)];return D.i=ee,D.j=te,Q})(r)}function x(T,I){return I.i=T.i,I.j=T.j,I.S=T.S.slice(),I}function v(T,I){var E=[],D=typeof T,O;if(I&&D=="object")for(O in T)try{E.push(v(T[O],I-1))}catch{}return E.length?E:D=="string"?T:T+"\0"}function w(T,I){for(var E=T+"",D,O=0;O<E.length;)I[p&O]=p&(D^=I[p&O]*19)+E.charCodeAt(O++);return k(I)}function S(){try{var T;return f&&(T=f.randomBytes)?T=T(r):(T=new Uint8Array(r),(e.crypto||e.msCrypto).getRandomValues(T)),k(T)}catch{var I=e.navigator,E=I&&I.plugins;return[+new Date,e,E,e.screen,k(t)]}}function k(T){return String.fromCharCode.apply(0,T)}if(w(s.random(),t),n.exports){n.exports=m;try{f=uG}catch{}}else s["seed"+a]=m})(typeof self<"u"?self:cG,[],Math)})(pf)),pf.exports}var cx,$N;function dG(){if($N)return cx;$N=1;var n=YU(),e=ZU(),t=eG(),s=nG(),r=rG(),o=iG(),i=hG();return i.alea=n,i.xor128=e,i.xorwow=t,i.xorshift7=s,i.xor4096=r,i.tychei=o,cx=i,cx}var $g=dG();/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class X1{constructor(e,t,s,r,o){this.mean=e,this.stdDev=t,this.dtype=s,this.nextVal=NaN,this.truncated=r,this.truncated&&(this.upper=this.mean+this.stdDev*2,this.lower=this.mean-this.stdDev*2);const i=o||Math.random();this.random=$g.alea(i.toString())}nextValue(){if(!isNaN(this.nextVal)){const r=this.nextVal;return this.nextVal=NaN,r}let e,t,s=!1;for(;!s;){let r,o,i;do r=2*this.random()-1,o=2*this.random()-1,i=r*r+o*o;while(i>=1||i===0);const a=Math.sqrt(-2*Math.log(i)/i);e=this.mean+this.stdDev*r*a,t=this.mean+this.stdDev*o*a,(!this.truncated||this.isValidTruncated(e))&&(s=!0)}return(!this.truncated||this.isValidTruncated(t))&&(this.nextVal=this.convertValue(t)),this.convertValue(e)}convertValue(e){return this.dtype==null||this.dtype==="float32"?e:Math.round(e)}isValidTruncated(e){return e<=this.upper&&e>=this.lower}}class pG{constructor(e,t,s,r){this.alpha=e,this.beta=1/t,this.dtype=s;const o=r||Math.random();this.randu=$g.alea(o.toString()),this.randn=new X1(0,1,s,!1,this.randu()),e<1?this.d=e+2/3:this.d=e-1/3,this.c=1/Math.sqrt(9*this.d)}nextValue(){let e,t,s,r,o,i;for(;;){do r=this.randn.nextValue(),i=1+this.c*r;while(i<=0);if(i*=i*i,e=r*r,t=1-.331*e*e,s=.5*e+this.d*(1-i+Math.log(i)),o=this.randu(),o<t||Math.log(o)<s)break}return i=1/this.beta*this.d*i,this.alpha<1&&(i*=Math.pow(this.randu(),1/this.alpha)),this.convertValue(i)}convertValue(e){return this.dtype==="float32"?e:Math.round(e)}}class fG{constructor(e=0,t=1,s,r){if(this.canReturnFloat=()=>this.dtype==null||this.dtype==="float32",this.min=e,this.range=t-e,this.dtype=s,r==null&&(r=Math.random()),typeof r=="number"&&(r=r.toString()),!this.canReturnFloat()&&this.range<=1)throw new Error(`The difference between ${e} - ${t} <= 1 and dtype is not float`);this.random=$g.alea(r)}convertValue(e){return this.canReturnFloat()?e:Math.round(e)}nextValue(){return this.convertValue(this.min+this.range*this.random())}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mG(n,e,t=1,s="float32",r){if(Ks(n),t==null&&(t=1),s==null&&(s="float32"),s!=="float32"&&s!=="int32")throw new Error(`Unsupported data type ${s}`);const o=new pG(e,t,s,r),i=nt(n,s);for(let a=0;a<i.values.length;a++)i.values[a]=o.nextValue();return i.toTensor()}const gG=j({randomGamma_:mG});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yG(n,e=0,t=1,s,r){if(Ks(n),s!=null&&s==="bool")throw new Error(`Unsupported data type ${s}`);const o=new X1(e,t,s,!1,r),i=nt(n,s);for(let a=0;a<i.values.length;a++)i.values[a]=o.nextValue();return i.toTensor()}const Y1=j({randomNormal_:yG});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xG(n,e,t){if(e!=null&&e==="bool")throw new Error(`Unsupported data type ${e}`);return Y1(n,0,1,e,t)}const vG=j({randomStandardNormal_:xG});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wG(n,e=0,t=1,s="float32",r){Ks(n);const o=nt(n,s),i=new fG(e,t,null,r);for(let a=0;a<o.values.length;a++)o.values[a]=i.nextValue();return o.toTensor()}const Wa=j({randomUniform_:wG});/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bG(n,e,t,s){return Wa(n,e,t,"int32",s)}const SG=j({randomUniformInt_:bG});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ql(n,e,t=1,s="float32"){if(t===0)throw new Error("Cannot have a step of zero");const r={start:n,stop:e,step:t,dtype:s};return K.runKernel(l1,{},r)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function CG(n){const t={input:M(n,"input","real")};return K.runKernel(u1,t)}const Fc=j({real_:CG});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kG(n){const t={x:M(n,"x","reciprocal")};return K.runKernel(Oh,t)}const xR=j({reciprocal_:kG});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function TG(n){const t={x:M(n,"x","relu")};return K.runKernel(_h,t)}const ho=j({relu_:TG});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function NG(n){const t={x:M(n,"x","relu6")};return K.runKernel(Fh,t)}const Q1=j({relu6_:NG});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function IG(n,e){const s={x:M(n,"x","reverse")},r={dims:e};return K.runKernel(rg,s,r)}const fr=j({reverse_:IG});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $G(n){const e=M(n,"x","reverse");return L(e.rank===1,()=>`Error in reverse1D: x must be rank 1 but got rank ${e.rank}.`),fr(e,0)}const EG=j({reverse1d_:$G});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function RG(n,e){const t=M(n,"x","reverse");return L(t.rank===2,()=>`Error in reverse2D: x must be rank 2 but got rank ${t.rank}.`),fr(t,e)}const DG=j({reverse2d_:RG});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function AG(n,e){const t=M(n,"x","reverse");return L(t.rank===3,()=>`Error in reverse3D: x must be rank 3 but got rank ${t.rank}.`),fr(t,e)}const OG=j({reverse3d_:AG});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _G(n,e){const t=M(n,"x","reverse");return L(t.rank===4,()=>`Error in reverse4D: x must be rank 4 but got rank ${t.rank}.`),fr(t,e)}const FG=j({reverse4d_:_G});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function PG(n){const t={x:M(n,"x","round")};return K.runKernel(Ph,t)}const Z1=j({round_:PG});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function LG(n){const t={x:M(n,"x","rsqrt","float32")};return K.runKernel(Lh,t)}const J1=j({rsqrt_:LG});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function MG(n){const t={x:M(n,"x","selu")};return K.runKernel(Mh,t)}const eb=j({selu_:MG});function zG(n,e,t,s,r,o=[1,1],i="NHWC"){const a=M(n,"x","separableConv2d"),l=M(e,"depthwiseFilter","separableConv2d"),u=M(t,"pointwiseFilter","separableConv2d");let h=a,p=!1;if(a.rank===3&&(p=!0,h=X(a,[1,a.shape[0],a.shape[1],a.shape[2]])),i==="NCHW")throw new Error("separableConv2d currently does not support dataFormat NCHW; only NHWC is supported");L(h.rank===4,()=>`Error in separableConv2d: input must be rank 4, but got rank ${h.rank}.`),L(l.rank===4,()=>`Error in separableConv2d: depthwise filter must be rank 4, but got rank ${l.rank}.`),L(u.rank===4,()=>`Error in separableConv2d: pointwise filter must be rank 4, but got rank ${l.rank}.`),L(u.shape[0]===1,()=>`Error in separableConv2d: the first dimension of pointwise filter  must be 1, but got ${u.shape[0]}.`),L(u.shape[1]===1,()=>`Error in separableConv2d: the second dimension of pointwise filter must be 1, but got ${u.shape[1]}.`);const f=l.shape[2],m=l.shape[3];L(u.shape[2]===f*m,()=>`Error in separableConv2d: the third dimension of pointwise filter must be ${f*m}, but got ${u.shape[2]}.`);const y=ed(h,l,s,r,i,o),v=Ci(y,u,1,"valid",i);return p?X(v,[v.shape[1],v.shape[2],v.shape[3]]):v}const tb=j({separableConv2d_:zG});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function VG(n,e){const t=M(n,"x","setdiff1d"),s=M(e,"y","setdiff1d");L(t.dtype===s.dtype,()=>`x and y should have the same dtype, but got x (${t.dtype}) and y (${s.dtype}).`),L(t.rank===1,()=>`x should be 1D tensor, but got x (${t.shape}).`),L(s.rank===1,()=>`y should be 1D tensor, but got y (${s.shape}).`);const r=await t.data(),o=await s.data(),i=new Set(o);let a=0;for(let h=0;h<r.length;h++)i.has(r[h])||a++;const l=new mn([a],t.dtype),u=new mn([a],"int32");for(let h=0,p=0;h<r.length;h++)i.has(r[h])||(l.values[p]=r[h],u.values[p]=h,p++);return[l.toTensor(),u.toTensor()]}const BG=VG;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function WG(n){const t={x:M(n,"x","sign")};return K.runKernel(Bh,t)}const vR=j({sign_:WG});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function UG(n){const t={x:M(n,"x","sin","float32")};return K.runKernel(zh,t)}const nb=j({sin_:UG});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function GG(n){const t={x:M(n,"x","sinh")};return K.runKernel(Vh,t)}const sb=j({sinh_:GG});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jG(n,e,t){const s=M(n,"x","slice1d");return L(s.rank===1,()=>`slice1d expects a rank-1 tensor, but got a rank-${s.rank} tensor`),et(s,[e],[t])}const Eg=j({slice1d_:jG});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function HG(n,e,t){const s=M(n,"x","slice2d");return L(s.rank===2,()=>`slice2d expects a rank-2 tensor, but got a rank-${s.rank} tensor`),et(s,e,t)}const rb=j({slice2d_:HG});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function KG(n,e,t){const s=M(n,"x","slice3d");return L(s.rank===3,()=>`slice3d expects a rank-3 tensor, but got a rank-${s.rank} tensor`),et(s,e,t)}const Rg=j({slice3d_:KG});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qG(n,e,t){const s=M(n,"x","slice4d");return L(s.rank===4,()=>`slice4d expects a rank-4 tensor, but got a rank-${s.rank} tensor`),et(s,e,t)}const Pc=j({slice4d_:qG});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function XG(n,e=-1){const t=M(n,"logits","softmax","float32");if(e===-1&&(e=t.rank-1),e!==t.rank-1)throw Error(`Softmax along a non-last dimension is not yet supported. Logits was rank ${t.rank} and dim was ${e}`);const s={logits:t},r={dim:e};return K.runKernel(cg,s,r)}const Dg=j({softmax_:XG});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function YG(n){L(n.dtype==="complex64",()=>`The dtype for tf.spectral.fft() must be complex64 but got ${n.dtype}.`);const e={input:n};return K.runKernel(Gw,e)}const Ag=j({fft_:YG});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function QG(n){L(n.dtype==="complex64",()=>`The dtype for tf.spectral.ifft() must be complex64 but got ${n.dtype}.`);const e={input:n};return K.runKernel(qw,e)}const Lc=j({ifft_:QG});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ZG(n){const e=n.shape[n.shape.length-1],t=n.size/e;let s;if(e<=2){const r=X(n,[t,e]);s=Lc(r)}else{const r=[t,2*(e-1)],o=X(Fc(n),[t,e]),i=X(vg(n),[t,e]),a=fr(et(o,[0,1],[t,e-2]),1),l=H(fr(et(i,[0,1],[t,e-2]),1),We(-1)),u=on([o,a],1),h=on([i,l],1),p=X(wi(u,h),[r[0],r[1]]);s=Lc(p)}if(s=Fc(s),n.rank===3&&n.shape[0]!==0){const r=s,o=n.shape[0];s=X(s,[o,s.shape[0]/o,s.shape[1]]),r.dispose()}return s}const ob=j({irfft_:ZG});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function JG(n,e,t=0){const r={x:M(n,"x","split")},o={numOrSizeSplits:e,axis:t};return K.runKernel(ug,r,o)}const Rs=j({split_:JG});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ej(n,e){L(n.dtype==="float32",()=>`The dtype for rfft() must be real value but got ${n.dtype}`);let t=n.shape[n.shape.length-1];const s=n.size/t;let r;if(e!=null&&e<t){const y=n.shape.map(v=>0),x=n.shape.map(v=>v);x[n.shape.length-1]=e,r=et(n,y,x),t=e}else if(e!=null&&e>t){const y=n.shape.map(x=>x);y[n.shape.length-1]=e-t,r=on([n,dn(y)],n.shape.length-1),t=e}else r=n;const o=dt(r),i=X(wi(r,o),[s,t]),a=Ag(i),l=Math.floor(t/2)+1,u=Fc(a),h=vg(a),p=Rs(u,[l,t-l],u.shape.length-1),f=Rs(h,[l,t-l],h.shape.length-1),m=r.shape.slice();return m[r.shape.length-1]=l,X(wi(p[0],f[0]),m)}const Og=j({rfft_:ej});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tj(n,e){let t=M(n,"a","squaredDifference"),s=M(e,"b","squaredDifference");[t,s]=Ht(t,s),Ze(t.shape,s.shape);const r={a:t,b:s},o={};return K.runKernel(jh,r,o)}const ib=j({squaredDifference_:tj});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nj(n,e){const t=M(n,"x","squeeze","string_or_numeric");return X(t,Oi(t.shape,e).newShape)}const Ao=j({squeeze_:nj});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sj(n,e=0){const t=Rf(n,"tensors","stack","string_or_numeric");L(t.length>=1,()=>"Pass at least one tensor to tf.stack"),t.length>0&&L(e<=t[0].rank,()=>"Axis must be <= rank of the tensor");const s=t,r={axis:e};return K.runKernel(Qm,s,r)}const _s=j({stack_:sj});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rj(n,e=0){const s={x:M(n,"x","step")},r={alpha:e};return K.runKernel(Yh,s,r)}const pu=j({step_:rj});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oj(n,e,t,s,r=0,o=0,i=0,a=0,l=0){const h={x:M(n,"x","stridedSlice","string_or_numeric")},p={begin:e,end:t,strides:s,beginMask:r,endMask:o,ellipsisMask:i,newAxisMask:a,shrinkAxisMask:l};return K.runKernel(b1,h,p)}const wR=j({stridedSlice_:oj});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ij(n){const t={x:M(n,"x","tan","float32")};return K.runKernel(Kh,t)}const bR=j({tan_:ij});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _n(n,e){au(n);const t=Fi(n,e);if(t.length!==1)throw new Error("tensor1d() requires values to be a flat/TypedArray");return Pi(n,null,t,e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bl(n,e,t){if(au(n),e!=null&&e.length!==2)throw new Error("tensor2d() requires shape to have two numbers");const s=Fi(n,t);if(s.length!==2&&s.length!==1)throw new Error("tensor2d() requires values to be number[][] or flat/TypedArray");if(s.length===1&&e==null)throw new Error("tensor2d() requires shape to be provided when `values` are a flat/TypedArray");return Pi(n,e,s,t)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function SR(n,e,t){if(au(n),e!=null&&e.length!==3)throw new Error("tensor3d() requires shape to have three numbers");const s=Fi(n,t);if(s.length!==3&&s.length!==1)throw new Error("tensor3d() requires values to be number[][][] or flat/TypedArray");if(s.length===1&&e==null)throw new Error("tensor3d() requires shape to be provided when `values` are a flat array");return Pi(n,e,s,t)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aj(n,e,t){if(au(n),e!=null&&e.length!==4)throw new Error("tensor4d() requires shape to have four numbers");const s=Fi(n,t);if(s.length!==4&&s.length!==1)throw new Error("tensor4d() requires values to be number[][][][] or flat/TypedArray");if(s.length===1&&e==null)throw new Error("tensor4d() requires shape to be provided when `values` are a flat array");return Pi(n,e,s,t)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lj(n,e,t){if(au(n),e!=null&&e.length!==5)throw new Error("tensor5d() requires shape to have five numbers");const s=Fi(n,t);if(s.length!==5&&s.length!==1)throw new Error("tensor5d() requires values to be number[][][][][] or flat/TypedArray");if(s.length===1&&e==null)throw new Error("tensor5d() requires shape to be provided when `values` are a flat array");return Pi(n,e,s,t)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uj(n,e,t){if(au(n),e!=null&&e.length!==6)throw new Error("tensor6d() requires shape to have six numbers");const s=Fi(n,t);if(s.length!==6&&s.length!==1)throw new Error("tensor6d() requires values to be number[][][][][][] or flat/TypedArray");if(s.length===1&&e==null)throw new Error("tensor6d() requires shape to be provided when `values` are a flat array");return e=e||s,Pi(n,e,s,t)}function CR(n,e,t){const s=e.rank>1?e.shape[e.rank-1]:1,r=e.rank>1?e.rank-1:1,o=`Must have updates.shape = indices.shape[:batchDim] + shape[sliceDim:], got updates.shape: ${t.shape}, indices.shape: ${e.shape}, shape: ${n}, sliceDim: ${s}, and batchDim: ${r}.`;if(t.rank<r)throw new Error(o+` update.rank < ${r}. `);if(n.length<s+(t.rank-r))throw new Error(o+` Output shape length < ${s+(t.rank-r)}`);if(t.rank!==r+n.length-s)throw new Error(o+` update.rank != ${r+n.length-s}`);for(let i=0;i<r;++i)if(t.shape[i]!==e.shape[i])throw new Error(o+` updates.shape[${i}] (${t.shape[i]}) != indices.shape[${i}] (${e.shape[i]}).`);for(let i=0;i<t.rank-r;++i)if(t.shape[i+r]!==n[i+s])throw new Error(o+` updates.shape[${i+r}] (${t.shape[i+r]}) != shape[${i+r}] (${n[i+r]})`)}function ab(n,e,t){if(e.rank<1)throw new Error(`tf.scatterND() expects the indices to be rank 1 or higher, but the rank was ${e.rank}.`);if(n.rank<1)throw new Error(`tf.scatterND() expects the updates to be rank 1 or higher, but the rank was ${n.rank}.`);if(e.dtype!=="int32")throw new Error(`The dtype of 'indices' should be int32, but got dtype: ${e.dtype}`);if(t.length<1)throw new Error(`Output rank must be greater or equal to 1, but got shape: ${t}`);if(t.length===0){if(e.size===0)throw new Error(`Indices specified for empty output. indices shape: ${e.shape}`);if(n.size===0)throw new Error(`Updates specified for empty output. updates shape: ${n.shape}`)}CR(t,e,n)}function Ua(n,e,t){const s=e.shape.length,r=s>1?e.shape[s-1]:1,o=t.length;let i=1;for(let p=r;p<o;++p)i*=t[p];const a=r<1?1:r,l=fe(e.shape)/a,u=[...Be(t.slice(0,r)),1],h=fe(t);return{sliceRank:r,numUpdates:l,sliceSize:i,strides:u,outputSize:h}}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cj(n,e,t){const s=M(n,"tensor","tensorScatterupdate"),r=M(e,"indices","tensorScatterupdate","int32"),o=M(t,"updates","tensorScatterupdate");if(ab(o,r,s.shape),s.dtype!==o.dtype)throw new Error(`tensor and updates must have the same dtype, instead they are ${s.dtype} and ${o.dtype}.`);const i={tensor:s,indices:r,updates:o},a={};return K.runKernel(p1,i,a)}const hj=j({tensorScatterUpdate_:cj});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dj(n,e=1,t=!0){const s=M(n,"x","topk");if(s.rank===0)throw new Error("topk() expects the input to be of rank 1 or higher");const r=s.shape[s.shape.length-1];if(e<0)throw new Error(`'k' passed to topk() must be >= 0 but got ${e}`);if(e>r)throw new Error(`'k' passed to topk() must be <= the last dimension (${r}) but got ${e}`);const o={x:s},i={k:e,sorted:t},[a,l]=K.runKernel(T1,o,i);return{values:a,indices:l}}const kR=j({topk_:dj});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pj(n,e=0,t=1,s,r){if(Ks(n),s!=null&&s==="bool")throw new Error("Unsupported data type $ { dtype }");const o=new X1(e,t,s,!0,r),i=nt(n,s);for(let a=0;a<i.values.length;a++)i.values[a]=o.nextValue();return i.toTensor()}const lb=j({truncatedNormal_:pj});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fj(n,e=0){const t=M(n,"x","unique","string_or_numeric");L(t.rank>0,()=>"The input tensor must be at least 1D");const s={x:t},r={axis:e},[o,i]=K.runKernel(I1,s,r);return{values:o,indices:i}}const TR=j({unique_:fj});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mj(n,e,t){const s=M(n,"x","unsortedSegmentSum"),r=M(e,"segmentIds","unsortedSegmentSum","int32");L(Hl(t),()=>"numSegments must be of dtype int");const o={x:s,segmentIds:r},i={numSegments:t};return K.runKernel(pg,o,i)}const ub=j({unsortedSegmentSum_:mj});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gj(n,e=0){const t=M(n,"x","unstack","string_or_numeric");L(e>=-t.shape.length&&e<t.shape.length,()=>`Axis = ${e} is not in [-${t.shape.length}, ${t.shape.length})`);const s={value:t},r={axis:e};return K.runKernel(dg,s,r)}const mr=j({unstack_:gj});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yj(n,e){return K1(n,e,"right")}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function NR(n,e=!0,t,s){return K.makeVariable(n,e,t,s)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cb(n,e){const t=[];for(let o=0;o<e.length;o++)e[o]&&t.push(o);const s=nt(n,"int32"),r=nt([t.length,n.length],"int32");for(let o=0;o<t.length;o++){const i=s.indexToLoc(t[o]),a=o*n.length;r.values.set(i,a)}return r.toTensor()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function xj(n){const e=M(n,"condition","whereAsync","bool"),t=await e.data(),s=cb(e.shape,t);return n!==e&&e.dispose(),s}const IR=xj;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function vj(n,e,t){const s=M(n,"tensor","boolMask"),r=M(e,"mask","boolMask","bool"),o=t??0,i=r.rank,a=s.shape;L(i>0,()=>"mask cannot be scalar"),Ls(a.slice(o,o+i),r.shape,"mask's shape must match the first K dimensions of tensor's shape,");let l=1;for(let x=o;x<o+i;x++)l*=a[x];const u=a.slice(0,o).concat([l],a.slice(o+i)),h=X(s,u),p=X(r,[-1]),f=await IR(p),m=Ao(f,[1]),y=rd(h,m,o);return n!==s&&s.dispose(),e!==r&&r.dispose(),m.dispose(),h.dispose(),p.dispose(),f.dispose(),y}const wj=vj;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bj(n,e,t){const s=M(n,"x","transpose");if(e==null&&(e=s.shape.map((i,a)=>a).reverse()),L(s.rank===e.length,()=>`Error in transpose: rank of input ${s.rank} must match length of perm ${e}.`),e.forEach(i=>{L(i>=0&&i<s.rank,()=>`All entries in 'perm' must be between 0 and ${s.rank-1} but got ${e}`)}),s.rank<=1)return s.clone();const r={x:s},o={perm:e};return s.dtype==="complex64"?ie(()=>{let i=Fc(s),a=vg(s);return i=K.runKernel(Ll,{x:i},o),a=K.runKernel(Ll,{x:a},o),t&&(a=Rt(a)),wi(i,a)}):K.runKernel(Ll,r,o)}const ht=j({transpose_:bj});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Sj(n,e,t,s,r=!0){const o=M(n,"v","movingAverage"),i=M(e,"x","movingAverage"),a=M(t,"decay","movingAverage");uB(o,i),L(ct(o.shape,i.shape),()=>"Shape mismatch in v and x");const l=We(1),u=Ee(l,a);let h=H(Ee(i,o),u);if(r){L(s!=null,()=>"When using zeroDebias: true, step is required.");const p=M(s,"step","movingAverage");h=Ae(h,Ee(l,Ro(a,p)))}return ye(o,h)}const Cj=j({movingAverage_:Sj});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kj(n,e,t){Ks(t);const s=M(n,"indices","scatterND","int32"),r=M(e,"updates","scatterND");ab(r,s,t);const o={indices:s,updates:r},i={shape:t};return K.runKernel(d1,o,i)}const Tj=j({scatterND_:kj});function Nj(n,e,t,s){if(n.dtype!=="int32")throw new Error(`tf.sparseToDense() expects the indices to be int32 type, but the dtype was ${n.dtype}.`);if(n.rank>2)throw new Error(`sparseIndices should be a scalar, vector, or matrix, but got shape ${n.shape}.`);const r=n.rank>0?n.shape[0]:1,o=n.rank>1?n.shape[1]:1;if(t.length!==o)throw new Error(`outputShape has incorrect number of elements:, ${t.length}, should be: ${o}.`);const i=e.size;if(!(e.rank===0||e.rank===1&&i===r))throw new Error(`sparseValues has incorrect shape ${e.shape}, should be [] or [${r}]`);if(e.dtype!==s.dtype)throw new Error("sparseValues.dtype must match defaultValues.dtype")}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ij(n,e,t,s=0){Ks(t);const r=M(n,"sparseIndices","sparseToDense","int32"),o=M(e,"sparseValues","sparseToDense","string_or_numeric"),i=M(s,"defaultValue","sparseToDense",o.dtype);Nj(r,o,t,i);const a={sparseIndices:r,sparseValues:o,defaultValue:i},l={outputShape:t};return K.runKernel(v1,a,l)}const $j=j({sparseToDense_:Ij});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ej(n,e){const t=M(e,"indices","gatherND","int32"),r={params:M(n,"x","gatherND","string_or_numeric"),indices:t};return K.runKernel(Kw,r)}const Rj=j({gatherND_:Ej});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dj(n,e){if(e==null)return n.shape.slice();if(ct(n.shape,e))return e;if(n.shape.length===e.length){const t=[];for(let s=0;s<n.shape.length;s++)e[s]==null&&n.shape[s]!=null?t.push(n.shape[s]):t.push(e[s]);return t}return e}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Aj(n,e,t,s){const r=M(n,"x","dropout");if(L(r.dtype==="float32",()=>`x has to be a floating point tensor since it's going to be scaled, but got a ${r.dtype} tensor instead.`),L(e>=0&&e<1,()=>`rate must be a float in the range [0, 1), but got ${e}.`),e===0)return n instanceof $t?r.clone():r;const o=Dj(r,t),i=1-e,a=Ae(sd(ye(Wa(o,0,1,"float32",s),i)),i);return H(r,a)}const $R=j({dropout_:Aj});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ER(n){return Math.floor(Math.pow(2,Math.ceil(Math.log(n)/Math.log(2))))}function hb(n,e,t){const s=1-n%2,r=new Float32Array(n);for(let o=0;o<n;++o){const i=2*Math.PI*o/(n+s-1);r[o]=e-t*Math.cos(i)}return _n(r,"float32")}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function Oj(n,e,t=1){const s=M(n,"predictions","inTopK"),r=M(e,"targets","inTopK");L(s.rank>1,()=>`inTopK() expects the predictions to be of rank 2 or higher, but got ${s.rank}`),L(s.rank-1===r.rank,()=>`predictions rank should be 1 larger than targets rank, but got predictions rank ${s.rank} and targets rank ${r.rank}`),Ls(s.shape.slice(0,s.shape.length-1),r.shape,"predictions's shape should be align with the targets' shape, except the last dimension.");const o=s.shape[s.shape.length-1];L(t>0&&t<=o,()=>`'k' passed to inTopK() must be > 0 && <= the predictions last dimension (${o}), but got ${t}`);const i=await s.data(),a=await r.data(),[l,u]=[i.length/o,o],h=Fn("bool",l);for(let p=0;p<l;p++){const f=p*u,m=i.subarray(f,f+u),y=[];for(let x=0;x<m.length;x++)y.push({value:m[x],index:x});y.sort((x,v)=>v.value-x.value),h[p]=0;for(let x=0;x<t;x++)if(y[x].index===a[p]){h[p]=1;break}}return n!==s&&s.dispose(),e!==r&&r.dispose(),_r(h,r.shape,"bool")}const _j=Oj;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fj(n,e,t,s,r,o="NHWC",i){let a=n;n.rank===3&&(a=X(n,[1,n.shape[0],n.shape[1],n.shape[2]]));let l=e;l.rank===3&&(l=X(e,[1,e.shape[0],e.shape[1],e.shape[2]])),L(a.rank===4,()=>`Error in conv2dDerFilter: input must be rank 4, but got shape ${a.shape}.`),L(l.rank===4,()=>`Error in conv2dDerFilter: dy must be rank 4, but got shape ${l.shape}.`),L(t.length===4,()=>`Error in conv2dDerFilter: filterShape must be length 4, but got ${t}.`);const u=o==="NHWC"?a.shape[3]:a.shape[1],h=o==="NHWC"?l.shape[3]:l.shape[1];L(u===t[2],()=>`Error in conv2dDerFilter: depth of input ${u}) must match input depth in filter (${t[2]}.`),L(h===t[3],()=>`Error in conv2dDerFilter: depth of dy (${h}) must match output depth for filter (${t[3]}).`),os("conv2dDerFilter",r,i);const p={x:a,dy:l},f={strides:s,pad:r,dataFormat:o,dimRoundingMode:i,filterShape:t};return K.runKernel(Aw,p,f)}const db=j({conv2DBackpropFilter_:Fj});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _g(n,e,t){if(t==null||t==="linear")return n;if(t==="relu")return H(n,pu(e));throw new Error(`Cannot compute gradient for fused activation ${t}.`)}function Fg(n,e){let t=e;const s=xn(n.shape,e.shape);return s.length>0&&(t=_e(t,s)),X(t,n.shape)}function Pg(n,e,t,s){if(e==="linear")return n;if(e==="relu")return ho(n);if(e==="elu")return td(n);if(e==="relu6")return Q1(n);if(e==="prelu")return Ig(n,t);if(e==="leakyrelu")return wg(n,s);if(e==="sigmoid")return Fr(n);throw new Error(`Unknown fused activation ${e}.`)}const Lg=(n,e)=>!(n>0)||e==="linear";/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pj({x:n,filter:e,strides:t,pad:s,dataFormat:r="NHWC",dilations:o=[1,1],dimRoundingMode:i,bias:a,activation:l="linear",preluActivationWeights:u,leakyreluAlpha:h}){if(l=l||"linear",Lg(K.state.gradientDepth,l)===!1){L(r==="NHWC",()=>`Error in fused conv2d: got dataFormat of ${r} but only NHWC is currently supported for the case of gradient depth is 0 and the activation is not linear.`);let E=Ci(n,e,t,s,r,o,i);return a!=null&&(E=ye(E,a)),Pg(E,l,u,h)}const p=M(n,"x","conv2d","float32"),f=M(e,"filter","conv2d","float32");let m=p,y=!1;p.rank===3&&(y=!0,m=X(p,[1,p.shape[0],p.shape[1],p.shape[2]])),L(m.rank===4,()=>`Error in fused conv2d: input must be rank 4, but got rank ${m.rank}.`),L(f.rank===4,()=>`Error in fused conv2d: filter must be rank 4, but got rank ${f.rank}.`),os("fused conv2d",s,i);const x=r==="NHWC"?m.shape[3]:m.shape[1];L(f.shape[2]===x,()=>`Error in conv2d: depth of input (${x}) must match input depth for filter ${f.shape[2]}.`),L(Ln(t,o),()=>`Error in conv2D: Either strides or dilations must be 1. Got strides ${t} and dilations '${o}'`);const v=Nn(m.shape,f.shape,t,o,s,i);let w;a!=null&&(w=M(a,"bias","fused conv2d"),[w]=Ht(w,p),r==="NHWC"?Ze(v.outShape,w.shape):(L(w.shape.length<=1,()=>`Error in fused conv2d: only supports scalar or 1-D Tensor bias for NCHW format but got the bias of rank-${w.shape.length}.`),L(w.shape.length===0||w.shape[0]===v.outChannels||w.shape[0]===1,()=>`Error in fused conv2d: bias shape (${w.shape}) is not compatible with the number of output channels (${v.outChannels})`)));let S;if(u!=null){const E=u.shape;if(L(E.length<=1||E.length===3,()=>`Error in fused conv2d: only supports scalar, 1-D Tensor or 3-D Tensor PReLU activation weights but got a tensor of rank-${E.length}.`),E.length===1)L(E[0]===1||E[0]===v.outChannels,()=>`Error in fused conv2d: PReLU activation weights (${E}) is not compatible with the number of output channels (${v.outChannels}).`);else if(E.length===3)try{Ze(E,v.outShape)}catch{const O=`Error in fused conv2d: PReLU activation weights (${E}) is not compatible with the output shape of the conv2d (${v.outShape}).`;throw Error(O)}S=M(u,"prelu weights","fused conv2d")}const k=(E,D)=>{L(r==="NHWC",()=>`Error in gradient of fused conv2D: got dataFormat of ${r} but only NHWC is currently supported.`);const[O,_,P,R]=D,W=_g(E,P,l);L(Si(o),()=>`Error in gradient of fused conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${o}'`);const Q=M1(_.shape,W,O,t,s),ee=db(_,W,O.shape,t,s),te=[Q,ee];if(R!=null){const oe=Fg(R,W);te.push(oe)}return te},T={x:m,filter:f,bias:w,preluActivationWeights:S},I={strides:t,pad:s,dataFormat:r,dilations:o,dimRoundingMode:i,activation:l,leakyreluAlpha:h};return a==null?Do((D,O,_)=>{let P=K.runKernel(Nf,T,I);return _([O,D,P]),y&&(P=X(P,[P.shape[1],P.shape[2],P.shape[3]])),{value:P,gradFunc:k}})(m,f):Do((D,O,_,P)=>{let R=K.runKernel(Nf,T,I);return P([O,D,R,_]),y&&(R=X(R,[R.shape[1],R.shape[2],R.shape[3]])),{value:R,gradFunc:k}})(m,f,w)}const RR=j({fusedConv2d_:Pj});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lj(n,e,t,s,r,o=[1,1],i){let a=n;n.rank===3&&(a=X(n,[1,n.shape[0],n.shape[1],n.shape[2]]));let l=e;l.rank===3&&(l=X(e,[1,e.shape[0],e.shape[1],e.shape[2]]));const u={x:a,dy:l},h={strides:s,pad:r,dimRoundingMode:i,dilations:o,filterShape:t};return K.runKernel(zw,u,h)}const DR=j({depthwiseConv2dNativeBackpropFilter_:Lj});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mj(n,e,t,s,r,o=[1,1],i){let a=e,l=!1;e.rank===3&&(l=!0,a=X(e,[1,e.shape[0],e.shape[1],e.shape[2]]));const u={dy:a,filter:t},h={strides:s,pad:r,dimRoundingMode:i,dilations:o,inputShape:n},p=K.runKernel(Vw,u,h);return l?X(p,[p.shape[1],p.shape[2],p.shape[3]]):p}const AR=j({depthwiseConv2dNativeBackpropInput_:Mj});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zj({x:n,filter:e,strides:t,pad:s,dataFormat:r="NHWC",dilations:o=[1,1],dimRoundingMode:i,bias:a,activation:l="linear",preluActivationWeights:u,leakyreluAlpha:h}){if(Lg(K.state.gradientDepth,l)===!1){let I=ed(n,e,t,s,r,o,i);return a!=null&&(I=ye(I,a)),Pg(I,l,u,h)}const p=M(n,"x","depthwiseConv2d","float32"),f=M(e,"filter","depthwiseConv2d","float32");let m=p,y=!1;p.rank===3&&(y=!0,m=X(p,[1,p.shape[0],p.shape[1],p.shape[2]])),L(m.rank===4,()=>`Error in fused depthwiseConv2d: input must be rank 4, but got rank ${m.rank}.`),L(f.rank===4,()=>`Error in fused depthwiseConv2d: filter must be rank 4, but got rank ${f.rank}.`),L(m.shape[3]===f.shape[2],()=>`Error in fused depthwiseConv2d: number of input channels (${m.shape[3]}) must match the inChannels dimension in filter ${f.shape[2]}.`),o==null&&(o=[1,1]),L(Ln(t,o),()=>`Error in fused depthwiseConv2d: Either strides or dilations must be 1. Got strides ${t} and dilations '${o}'`),os("fused depthwiseConv2d",s,i);const x=Nn(m.shape,f.shape,t,o,s,i,!0);let v;a!=null&&(v=M(a,"bias","fused conv2d"),[v]=Ht(v,p),Ze(x.outShape,v.shape));let w;u!=null&&(w=M(u,"prelu weights","fused depthwiseConv2d"));const S=(I,E)=>{L(Si(o),()=>`Error in gradient of fused depthwiseConv2d: dilation rates greater than 1 are not yet supported. Got dilations '${o}'`);const[D,O,_,P]=E,R=_g(I,_,l),W=AR(O.shape,R,D,t,s,o,i),Q=DR(O,R,D.shape,t,s,o,i);if(P!=null){const ee=Fg(v,R);return[W,Q,ee]}return[W,Q]},k={x:m,filter:f,bias:v,preluActivationWeights:w},T={strides:t,pad:s,dataFormat:r,dilations:o,dimRoundingMode:i,activation:l,leakyreluAlpha:h};return a==null?Do((E,D,O)=>{let _=K.runKernel(If,k,T);return O([D,E,_]),y&&(_=X(_,[_.shape[1],_.shape[2],_.shape[3]])),{value:_,gradFunc:S}})(m,f):Do((E,D,O,_)=>{let P=K.runKernel(If,k,T);return _([D,E,P,O]),y&&(P=X(P,[P.shape[1],P.shape[2],P.shape[3]])),{value:P,gradFunc:S}})(m,f,v)}const Vj=j({fusedDepthwiseConv2d_:zj});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bj({a:n,b:e,transposeA:t=!1,transposeB:s=!1,bias:r,activation:o="linear",preluActivationWeights:i,leakyreluAlpha:a=.2}){if(Lg(K.state.gradientDepth,o)===!1){let R=lt(n,e,t,s);return r!=null&&(R=ye(R,r)),Pg(R,o,i,a)}let l=M(n,"a","fused matMul"),u=M(e,"b","fused matMul");[l,u]=Ht(l,u);const h=t?l.shape[l.rank-2]:l.shape[l.rank-1],p=s?u.shape[u.rank-1]:u.shape[u.rank-2],f=t?l.shape[l.rank-1]:l.shape[l.rank-2],m=s?u.shape[u.rank-2]:u.shape[u.rank-1],y=l.shape.slice(0,-2),x=u.shape.slice(0,-2),v=fe(y),w=fe(x);L(h===p,()=>`Error in fused matMul: inner shapes (${h}) and (${p}) of Tensors with shapes ${l.shape} and ${u.shape} and transposeA=${t} and transposeB=${s} must match.`);const k=Ze(l.shape.slice(0,-2),u.shape.slice(0,-2)).concat([f,m]),T=t?X(l,[v,h,f]):X(l,[v,f,h]),I=s?X(u,[w,m,p]):X(u,[w,p,m]);let E;r!=null&&(E=M(r,"bias","fused matMul"),[E]=Ht(E,l),Ze(k,E.shape));let D;i!=null&&(D=M(i,"prelu weights","fused matMul"));const O=(R,W)=>{const[Q,ee,te,oe]=W,se=_g(X(R,te.shape),te,o);let G,V;if(!t&&!s?(G=lt(se,ee,!1,!0),V=lt(Q,se,!0,!1)):!t&&s?(G=lt(se,ee,!1,!1),V=lt(se,Q,!0,!1)):t&&!s?(G=lt(ee,se,!1,!0),V=lt(Q,se,!1,!1)):(G=lt(ee,se,!0,!0),V=lt(se,Q,!0,!0)),r!=null){const B=Fg(oe,se);return[G,V,B]}else return[G,V]},_={a:T,b:I,bias:E,preluActivationWeights:D},P={transposeA:t,transposeB:s,activation:o,leakyreluAlpha:a};return r==null?Do((W,Q,ee)=>{const te=K.runKernel(Tf,_,P);return ee([W,Q,te]),{value:X(te,k),gradFunc:O}})(T,I):Do((W,Q,ee,te)=>{const oe=K.runKernel(Tf,_,P);return te([W,Q,oe,ee]),{value:X(oe,k),gradFunc:O}})(T,I,E)}const fv=j({fusedMatMul_:Bj});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Wj=Object.freeze(Object.defineProperty({__proto__:null,conv2d:RR,depthwiseConv2d:Vj,matMul:fv},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Uj(n){return hb(n,.54,.46)}const Gj=j({hammingWindow_:Uj});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jj(n){return hb(n,.5,.5)}const OR=j({hannWindow_:jj});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hj(n,e,t,s=!1,r=0){let o=0;const i=[];for(;o+e<=n.size;)i.push(et(n,o,e)),o+=t;if(s)for(;o<n.size;){const a=o+e-n.size,l=on([et(n,o,e-a),hu([a],r)]);i.push(l),o+=t}return i.length===0?Bl([],[0,e]):X(on(i),[i.length,e])}const _R=j({frame_:Hj});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Kj(n,e,t,s,r=OR){s==null&&(s=ER(e));const o=_R(n,e,t),i=H(o,r(e));return Og(i,s)}const qj=j({stft_:Kj});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xj(n,e,t,s,r="bilinear",o=0){const i=M(n,"image","cropAndResize"),a=M(e,"boxes","cropAndResize","float32"),l=M(t,"boxInd","cropAndResize","int32"),u=a.shape[0];L(i.rank===4,()=>`Error in cropAndResize: image must be rank 4,but got rank ${i.rank}.`),L(a.rank===2&&a.shape[1]===4,()=>`Error in cropAndResize: boxes must be have size [${u},4] but had shape ${a.shape}.`),L(l.rank===1&&l.shape[0]===u,()=>`Error in cropAndResize: boxInd must be have size [${u}] but had shape ${a.shape}.`),L(s.length===2,()=>`Error in cropAndResize: cropSize must be of length 2, but got length ${s.length}.`),L(s[0]>=1&&s[1]>=1,()=>`cropSize must be atleast [1,1], but was ${s}`),L(r==="bilinear"||r==="nearest",()=>`method must be bilinear or nearest, but was ${r}`);const h={image:i,boxes:a,boxInd:l},p={method:r,extrapolationValue:o,cropSize:s};return K.runKernel(Pw,h,p)}const Yj=j({cropAndResize_:Xj});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qj(n){const e=M(n,"image","flipLeftRight","float32");L(e.rank===4,()=>`Error in flipLeftRight: image must be rank 4,but got rank ${e.rank}.`);const t={image:e};return K.runKernel(Hw,t,{})}const Zj=j({flipLeftRight_:Qj});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jj(n){const e=M(n,"image","grayscaleToRGB"),t=e.rank-1,s=e.shape[t];L(e.rank>=2,()=>`Error in grayscaleToRGB: images must be at least rank 2, but got rank ${e.rank}.`),L(s===1,()=>`Error in grayscaleToRGB: last dimension of a grayscale image should be size 1, but got size ${s}.`);const r=new Array(e.rank);return r.fill(1,0,t),r[t]=3,ir(e,r)}const eH=j({grayscaleToRGB_:Jj});/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tH(n){const e=M(n,"image","RGBToGrayscale"),t=e.rank-1,s=e.shape[t];L(e.rank>=2,()=>`Error in RGBToGrayscale: images must be at least rank 2, but got rank ${e.rank}.`),L(s===3,()=>`Error in RGBToGrayscale: last dimension of an RGB image should be size 3, but got size ${s}.`);const r=e.dtype,o=Ne(e,"float32"),i=_n([.2989,.587,.114]);let a;switch(e.rank){case 2:a=El("ij,j->i",o,i);break;case 3:a=El("ijk,k->ij",o,i);break;case 4:a=El("ijkl,l->ijk",o,i);break;case 5:a=El("ijklm,m->ijkl",o,i);break;case 6:a=El("ijklmn,n->ijklm",o,i);break;default:throw new Error("Not a valid tensor rank.")}return a=jn(a,-1),Ne(a,r)}const nH=j({rgbToGrayscale_:tH});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sH(n,e,t=0,s=.5){const r=M(n,"image","rotateWithOffset","float32");L(r.rank===4,()=>`Error in rotateWithOffset: image must be rank 4,but got rank ${r.rank}.`);const o={image:r},i={radians:e,fillValue:t,center:s};return K.runKernel($1,o,i)}const rH=j({rotateWithOffset_:sH});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fu(n,e,t,s,r,o){s==null&&(s=.5),r==null&&(r=Number.NEGATIVE_INFINITY),o==null&&(o=0);const i=n.shape[0];return t=Math.min(t,i),L(0<=s&&s<=1,()=>`iouThreshold must be in [0, 1], but was '${s}'`),L(n.rank===2,()=>`boxes must be a 2D tensor, but was of rank '${n.rank}'`),L(n.shape[1]===4,()=>`boxes must have 4 columns, but 2nd dimension was ${n.shape[1]}`),L(e.rank===1,()=>"scores must be a 1D tensor"),L(e.shape[0]===i,()=>`scores has incompatible shape with boxes. Expected ${i}, but was ${e.shape[0]}`),L(0<=o&&o<=1,()=>`softNmsSigma must be in [0, 1], but was '${o}'`),{maxOutputSize:t,iouThreshold:s,scoreThreshold:r,softNmsSigma:o}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oH(n,e,t,s=.5,r=Number.NEGATIVE_INFINITY){const o=M(n,"boxes","nonMaxSuppression","float32"),i=M(e,"scores","nonMaxSuppression","float32"),a=fu(o,i,t,s,r);t=a.maxOutputSize,s=a.iouThreshold,r=a.scoreThreshold;const l={maxOutputSize:t,iouThreshold:s,scoreThreshold:r};return K.runKernel(n1,{boxes:o,scores:i},l)}const iH=j({nonMaxSuppression_:oH});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aH(n,e,t){const s=lH(n,e,t),r=s<0?-(s+1):s;n.splice(r,0,e)}function lH(n,e,t){return cH(n,e,t||uH)}function uH(n,e){return n>e?1:n<e?-1:0}function cH(n,e,t){let s=0,r=n.length,o=0,i=!1;for(;s<r;){o=s+(r-s>>>1);const a=t(e,n[o]);a>0?s=o+1:(r=o,i=!a)}return i?s:-s-1}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pb(n,e,t,s,r){return gb(n,e,t,s,r,0)}function fb(n,e,t,s,r,o){return gb(n,e,t,s,r,0,!1,o,!0)}function mb(n,e,t,s,r,o){return gb(n,e,t,s,r,o,!0)}function gb(n,e,t,s,r,o,i=!1,a=!1,l=!1){const u=[];for(let v=0;v<e.length;v++)e[v]>r&&u.push({score:e[v],boxIndex:v,suppressBeginIndex:0});u.sort(EN);const h=o>0?-.5/o:0,p=[],f=[];for(;p.length<t&&u.length>0;){const v=u.pop(),{score:w,boxIndex:S,suppressBeginIndex:k}=v;if(w<r)break;let T=!1;for(let I=p.length-1;I>=k;--I){const E=hH(n,S,p[I]);if(E>=s){T=!0;break}if(v.score=v.score*dH(s,h,E),v.score<=r)break}v.suppressBeginIndex=p.length,T||(v.score===w?(p.push(S),f.push(v.score)):v.score>r&&aH(u,v,EN))}const m=p.length,y=t-m;a&&y>0&&(p.push(...new Array(y).fill(0)),f.push(...new Array(y).fill(0)));const x={selectedIndices:p};return i&&(x.selectedScores=f),l&&(x.validOutputs=m),x}function hH(n,e,t){const s=n.subarray(e*4,e*4+4),r=n.subarray(t*4,t*4+4),o=Math.min(s[0],s[2]),i=Math.min(s[1],s[3]),a=Math.max(s[0],s[2]),l=Math.max(s[1],s[3]),u=Math.min(r[0],r[2]),h=Math.min(r[1],r[3]),p=Math.max(r[0],r[2]),f=Math.max(r[1],r[3]),m=(a-o)*(l-i),y=(p-u)*(f-h);if(m<=0||y<=0)return 0;const x=Math.max(o,u),v=Math.max(i,h),w=Math.min(a,p),S=Math.min(l,f),k=Math.max(w-x,0)*Math.max(S-v,0);return k/(m+y-k)}function dH(n,e,t){const s=Math.exp(e*t*t);return t<=n?s:0}function EN(n,e){return n.score-e.score||n.score===e.score&&e.boxIndex-n.boxIndex}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function pH(n,e,t,s=.5,r=Number.NEGATIVE_INFINITY){const o=M(n,"boxes","nonMaxSuppressionAsync"),i=M(e,"scores","nonMaxSuppressionAsync"),a=fu(o,i,t,s,r);t=a.maxOutputSize,s=a.iouThreshold,r=a.scoreThreshold;const l=await Promise.all([o.data(),i.data()]),u=l[0],h=l[1],{selectedIndices:p}=pb(u,h,t,s,r);return o!==n&&o.dispose(),i!==e&&i.dispose(),_n(p,"int32")}const fH=pH;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mH(n,e,t,s=.5,r=Number.NEGATIVE_INFINITY,o=0){const i=M(n,"boxes","nonMaxSuppression"),a=M(e,"scores","nonMaxSuppression"),l=fu(i,a,t,s,r,o);t=l.maxOutputSize,s=l.iouThreshold,r=l.scoreThreshold,o=l.softNmsSigma;const u={boxes:i,scores:a},h={maxOutputSize:t,iouThreshold:s,scoreThreshold:r,softNmsSigma:o},p=K.runKernel(r1,u,h);return{selectedIndices:p[0],selectedScores:p[1]}}const gH=j({nonMaxSuppressionWithScore_:mH});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function yH(n,e,t,s=.5,r=Number.NEGATIVE_INFINITY,o=0){const i=M(n,"boxes","nonMaxSuppressionAsync"),a=M(e,"scores","nonMaxSuppressionAsync"),l=fu(i,a,t,s,r,o);t=l.maxOutputSize,s=l.iouThreshold,r=l.scoreThreshold,o=l.softNmsSigma;const u=await Promise.all([i.data(),a.data()]),h=u[0],p=u[1],{selectedIndices:f,selectedScores:m}=mb(h,p,t,s,r,o);return i!==n&&i.dispose(),a!==e&&a.dispose(),{selectedIndices:_n(f,"int32"),selectedScores:_n(m)}}const xH=yH;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vH(n,e,t,s=.5,r=Number.NEGATIVE_INFINITY,o=!1){const i=M(n,"boxes","nonMaxSuppression"),a=M(e,"scores","nonMaxSuppression"),l=fu(i,a,t,s,r,null),u=l.maxOutputSize,h=l.iouThreshold,p=l.scoreThreshold,f={boxes:i,scores:a},m={maxOutputSize:u,iouThreshold:h,scoreThreshold:p,padToMaxOutputSize:o},y=K.runKernel(s1,f,m);return{selectedIndices:y[0],validOutputs:y[1]}}const wH=j({nonMaxSuppressionPadded_:vH});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function bH(n,e,t,s=.5,r=Number.NEGATIVE_INFINITY,o=!1){const i=M(n,"boxes","nonMaxSuppressionAsync"),a=M(e,"scores","nonMaxSuppressionAsync"),l=fu(i,a,t,s,r,null),u=l.maxOutputSize,h=l.iouThreshold,p=l.scoreThreshold,[f,m]=await Promise.all([i.data(),a.data()]),{selectedIndices:y,validOutputs:x}=fb(f,m,u,h,p,o);return i!==n&&i.dispose(),a!==e&&a.dispose(),{selectedIndices:_n(y,"int32"),validOutputs:We(x,"int32")}}const SH=bH;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function CH(n,e,t=!1,s=!1){const r=M(n,"images","resizeBilinear");L(r.rank===3||r.rank===4,()=>`Error in resizeBilinear: x must be rank 3 or 4, but got rank ${r.rank}.`),L(e.length===2,()=>`Error in resizeBilinear: new shape must 2D, but got shape ${e}.`),L(s===!1||t===!1,()=>"Error in resizeBilinear: If halfPixelCenters is true, alignCorners must be false.");let o=r,i=!1;r.rank===3&&(i=!0,o=X(r,[1,r.shape[0],r.shape[1],r.shape[2]]));const a={images:o},l={alignCorners:t,halfPixelCenters:s,size:e},u=K.runKernel(sg,a,l);return i?X(u,[u.shape[1],u.shape[2],u.shape[3]]):u}const FR=j({resizeBilinear_:CH});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kH(n,e,t=!1,s=!1){const r=M(n,"images","resizeNearestNeighbor");L(r.rank===3||r.rank===4,()=>`Error in resizeNearestNeighbor: x must be rank 3 or 4, but got rank ${r.rank}.`),L(e.length===2,()=>`Error in resizeNearestNeighbor: new shape must 2D, but got shape ${e}.`),L(r.dtype==="float32"||r.dtype==="int32",()=>"`images` must have `int32` or `float32` as dtype"),L(s===!1||t===!1,()=>"Error in resizeNearestNeighbor: If halfPixelCenters is true, alignCorners must be false.");let o=r,i=!1;r.rank===3&&(i=!0,o=X(r,[1,r.shape[0],r.shape[1],r.shape[2]]));const a={images:o},l={alignCorners:t,halfPixelCenters:s,size:e},u=K.runKernel(ng,a,l);return i?X(u,[u.shape[1],u.shape[2],u.shape[3]]):u}const PR=j({resizeNearestNeighbor_:kH});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * https://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function TH(n,e="binary",t=!1,s=.5){const r=M(n,"image","threshold"),o=.2989,i=.587,a=.114,l=r.shape[0]*r.shape[1];let u=H(_n([s]),255),h,p,f,m;if(L(r.rank===3,()=>`Error in threshold: image must be rank 3,but got rank ${r.rank}.`),L(r.shape[2]===3||r.shape[2]===1,()=>`Error in threshold: image color channel must be equal to 3 or 1but got ${r.shape[2]}.`),L(r.dtype==="int32"||r.dtype==="float32",()=>`Error in dtype: image dtype must be int32 or float32,but got dtype ${r.dtype}.`),L(e==="otsu"||e==="binary",()=>`Method must be binary or otsu, but was ${e}`),r.shape[2]===3){[h,p,f]=Rs(r,[1,1,1],-1);const v=H(h,o),w=H(p,i),S=H(f,a);m=ye(ye(v,w),S)}else m=n;if(e==="otsu"){const v=jE(Ne(Z1(m),"int32"),_r([]),256);u=NH(v,l)}const y=t?Ba(m,u):Ms(m,u);return Ne(H(y,255),"int32")}function NH(n,e){let t=_n([-1]),s=_n([0]),r=_n([0]),o,i,a,l,u,h;for(let p=0;p<n.size-1;p++){o=et(n,0,p+1),i=et(n,p+1),u=Ae(_e(o),e),h=Ae(_e(i),e);const f=_e(H(o,Ql(0,o.size)));a=Ae(f,_e(o));const m=hu(i.shape,o.size),y=ye(Ql(0,i.size),m),x=H(i,y);l=Ae(_e(x),_e(i));const v=Ee(a,l),w=Ee(a,l),S=H(u,h);r=H(H(S,v),w);const k=Ms(r,s);s=Hn(k,r,s),t=Hn(k,_n([p]),t)}return t}const IH=j({threshold_:TH});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $H(n,e,t="nearest",s="constant",r=0,o){const i=M(n,"image","transform","float32"),a=M(e,"transforms","transform","float32");L(i.rank===4,()=>`Error in transform: image must be rank 4,but got rank ${i.rank}.`),L(a.rank===2&&(a.shape[0]===i.shape[0]||a.shape[0]===1)&&a.shape[1]===8,()=>"Error in transform: Input transform should be batch x 8 or 1 x 8"),L(o==null||o.length===2,()=>`Error in transform: outputShape must be [height, width] or null, but got ${o}.`);const l={image:i,transforms:a},u={interpolation:t,fillMode:s,fillValue:r,outputShape:o};return K.runKernel(N1,l,u)}const EH=j({transform_:$H});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function RH(n,e,t){const s=M(n,"a","bandPart");L(s.rank>=2,()=>`bandPart(): Rank must be at least 2, got ${s.rank}.`);const r=s.shape,[o,i]=s.shape.slice(-2);let a,l;typeof e=="number"?(L(e%1===0,()=>`bandPart(): numLower must be an integer, got ${e}.`),L(e<=o,()=>`bandPart(): numLower (${e}) must not be greater than the number of rows (${o}).`),a=M(e<0?o:e,"numLower","bandPart")):(L(e.dtype==="int32",()=>"bandPart(): numLower's dtype must be an int32."),a=Hn(_c(e,0),o,Ra(e,o))),typeof t=="number"?(L(t%1===0,()=>`bandPart(): numUpper must be an integer, got ${t}.`),L(t<=i,()=>`bandPart(): numUpper (${t}) must not be greater than the number of columns (${i}).`),l=M(t<0?i:t,"numUpper","bandPart")):(L(t.dtype==="int32",()=>"bandPart(): numUpper's dtype must be an int32."),l=Hn(_c(t,0),i,Ra(t,i)));const u=X(Ql(0,o,1,"int32"),[-1,1]),h=Ql(0,i,1,"int32"),p=Ee(u,h),f=ao(Ba(p,a),zi(p,Rt(l))),m=dn([o,i],s.dtype);return X(_s(mr(X(s,[-1,o,i])).map(y=>Hn(f,y,m))),r)}const DH=j({bandPart_:RH});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function AH(n){let e;if(Array.isArray(n)){e=!1,L(n!=null&&n.length>0,()=>"Gram-Schmidt process: input must not be null, undefined, or empty");const r=n[0].shape[0];for(let o=1;o<n.length;++o)L(n[o].shape[0]===r,()=>`Gram-Schmidt: Non-unique lengths found in the input vectors: (${n[o].shape[0]} vs. ${r})`)}else e=!0,n=Rs(n,n.shape[0],0).map(r=>Ao(r,[0]));L(n.length<=n[0].shape[0],()=>`Gram-Schmidt: Number of vectors (${n.length}) exceeds number of dimensions (${n[0].shape[0]}).`);const t=[],s=n;for(let r=0;r<n.length;++r)t.push(K.tidy(()=>{let o=s[r];if(r>0)for(let i=0;i<r;++i){const a=H(_e(H(t[i],o)),t[i]);o=Ee(o,a)}return Ae(o,nd(o,"euclidean"))}));return e?_s(t,0):t}const OH=j({gramSchmidt_:AH});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _H(n,e=!1){if(L(n.rank>=2,()=>`qr() requires input tensor to have a rank >= 2, but got rank ${n.rank}`),n.rank===2)return RN(n,e);{const t=n.shape.slice(0,n.shape.length-2).reduce((l,u)=>l*u),s=mr(X(n,[t,n.shape[n.shape.length-2],n.shape[n.shape.length-1]]),0),r=[],o=[];s.forEach(l=>{const[u,h]=RN(l,e);r.push(u),o.push(h)});const i=X(_s(r,0),n.shape),a=X(_s(o,0),n.shape);return[i,a]}}function RN(n,e=!1){return K.tidy(()=>{L(n.shape.length===2,()=>`qr2d() requires a 2D Tensor, but got a ${n.shape.length}D Tensor.`);const t=n.shape[0],s=n.shape[1];let r=G1(t),o=Io(n);const i=Bl([[1]],[1,1]);let a=Io(i);const l=t>=s?s:t;for(let u=0;u<l;++u){const h=o,p=a,f=r;[a,o,r]=K.tidy(()=>{const m=et(o,[u,u],[t-u,1]),y=nd(m),x=et(o,[u,u],[1,1]),v=Hn(Ms(x,0),Bl([[-1]]),Bl([[1]])),w=Ee(x,H(v,y)),S=Ae(m,w);S.shape[0]===1?a=Io(i):a=on([i,et(S,[1,0],[S.shape[0]-1,S.shape[1]])],0);const k=Rt(Ae(lt(v,w),y)),T=et(o,[u,0],[t-u,s]),I=H(k,a),E=ht(a);if(u===0)o=Ee(T,lt(I,lt(E,T)));else{const _=Ee(T,lt(I,lt(E,T)));o=on([et(o,[0,0],[u,s]),_],0)}const D=ht(I),O=et(r,[0,u],[t,r.shape[1]-u]);if(u===0)r=Ee(O,lt(lt(O,a),D));else{const _=Ee(O,lt(lt(O,a),D));r=on([et(r,[0,0],[t,u]),_],1)}return[a,o,r]}),ot([h,p,f])}return!e&&t>s&&(r=et(r,[0,0],[t,s]),o=et(o,[0,0],[s,s])),[r,o]})}const FH=j({qr_:_H});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var hs;(function(n){n[n.NONE=0]="NONE",n[n.MEAN=1]="MEAN",n[n.SUM=2]="SUM",n[n.SUM_BY_NONZERO_WEIGHTS=3]="SUM_BY_NONZERO_WEIGHTS"})(hs||(hs={}));function PH(n,e,t=hs.SUM_BY_NONZERO_WEIGHTS){const s=M(n,"losses","computeWeightedLoss");let r=null;e!=null&&(r=M(e,"weights","computeWeightedLoss"));const o=r==null?s:H(s,r);if(t===hs.NONE)return o;if(t===hs.SUM)return _e(o);if(t===hs.MEAN){if(r==null)return Ut(o);{const i=s.size/r.size,a=Ae(_e(o),_e(r));return i>1?Ae(a,We(i)):a}}if(t===hs.SUM_BY_NONZERO_WEIGHTS){if(r==null)return Ae(_e(o),We(s.size));{const i=H(r,$s(s.shape)),a=Ne(_e(Yl(i,We(0))),"float32");return Ae(_e(o),a)}}throw Error(`Unknown reduction: ${t}`)}const Vo=j({computeWeightedLoss_:PH});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function LH(n,e,t,s=hs.SUM_BY_NONZERO_WEIGHTS){const r=M(n,"labels","absoluteDifference"),o=M(e,"predictions","absoluteDifference");let i=null;t!=null&&(i=M(t,"weights","absoluteDifference")),Ls(r.shape,o.shape,"Error in absoluteDifference: ");const a=hn(Ee(r,o));return Vo(a,i,s)}const MH=j({absoluteDifference_:LH});function zH(n,e,t,s,r=hs.SUM_BY_NONZERO_WEIGHTS){const o=M(n,"labels","cosineDistance"),i=M(e,"predictions","cosineDistance");let a=null;s!=null&&(a=M(s,"weights","cosineDistance")),Ls(o.shape,i.shape,"Error in cosineDistance: ");const l=We(1),u=Ee(l,_e(H(o,i),t,!0));return Vo(u,a,r)}const VH=j({cosineDistance_:zH});function BH(n,e,t,s=hs.SUM_BY_NONZERO_WEIGHTS){let r=M(n,"labels","hingeLoss");const o=M(e,"predictions","hingeLoss");let i=null;t!=null&&(i=M(t,"weights","hingeLoss")),Ls(r.shape,o.shape,"Error in hingeLoss: ");const a=We(1);r=Ee(H(We(2),r),a);const l=ho(Ee(a,H(r,o)));return Vo(l,i,s)}const WH=j({hingeLoss_:BH});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function UH(n,e,t,s=1,r=hs.SUM_BY_NONZERO_WEIGHTS){const o=M(n,"labels","huberLoss"),i=M(e,"predictions","huberLoss");let a=null;t!=null&&(a=M(t,"weights","huberLoss")),Ls(o.shape,i.shape,"Error in huberLoss: ");const l=We(s),u=hn(Ee(i,o)),h=Ra(u,l),p=Ee(u,h),f=ye(H(We(.5),Ct(h)),H(l,p));return Vo(f,a,r)}const GH=j({huberLoss_:UH});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jH(n,e,t,s=1e-7,r=hs.SUM_BY_NONZERO_WEIGHTS){const o=M(n,"labels","logLoss"),i=M(e,"predictions","logLoss");let a=null;t!=null&&(a=M(t,"weights","logLoss")),Ls(o.shape,i.shape,"Error in logLoss: ");const l=We(1),u=We(s),h=Rt(H(o,js(ye(i,u)))),p=H(Ee(l,o),js(ye(Ee(l,i),u))),f=Ee(h,p);return Vo(f,a,r)}const HH=j({logLoss_:jH});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function KH(n,e,t,s=hs.SUM_BY_NONZERO_WEIGHTS){const r=M(n,"labels","meanSquaredError"),o=M(e,"predictions","meanSquaredError");let i=null;t!=null&&(i=M(t,"weights","meanSquaredError")),Ls(r.shape,o.shape,"Error in meanSquaredError: ");const a=ib(r,o);return Vo(a,i,s)}const qH=j({meanSquaredError_:KH});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function XH(n,e){const t=M(n,"labels","sigmoidCrossEntropyWithLogits"),s=M(e,"logits","sigmoidCrossEntropyWithLogits");Ls(t.shape,s.shape,"Error in sigmoidCrossEntropyWithLogits: ");const r=ho(s),o=H(s,t),i=bg(Os(Rt(hn(s))));return ye(Ee(r,o),i)}function YH(n,e,t,s=0,r=hs.SUM_BY_NONZERO_WEIGHTS){let o=M(n,"multiClassLabels","sigmoidCrossEntropy");const i=M(e,"logits","sigmoidCrossEntropy");let a=null;if(t!=null&&(a=M(t,"weights","sigmoidCrossEntropy")),Ls(o.shape,i.shape,"Error in sigmoidCrossEntropy: "),s>0){const u=We(s),h=We(1),p=We(.5);o=ye(H(o,Ee(h,u)),H(p,u))}const l=XH(o,i);return Vo(l,a,r)}const QH=j({sigmoidCrossEntropy_:YH});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ZH(n,e,t=-1){if(t===-1&&(t=e.rank-1),t!==e.rank-1)throw Error(`Softmax cross entropy along a non-last dimension is not yet supported. Labels / logits was rank ${e.rank} and dim was ${t}`);return Do((r,o,i)=>{const l=Sg(o,[t],!0),u=Ee(Ne(o,"float32"),l);i([r,u]);const h=Rt(H(u,r));return{value:_e(h,[t]),gradFunc:(m,y)=>{const[x,v]=y,w=Zt(m.shape,[t]);return[H(X(m,w),Ee(Ne(x,"float32"),Os(v))),H(X(m,w),Ee(Os(v),Ne(x,"float32")))]}}})(n,e)}function JH(n,e,t,s=0,r=hs.SUM_BY_NONZERO_WEIGHTS){let o=M(n,"onehotLabels","softmaxCrossEntropy");const i=M(e,"logits","softmaxCrossEntropy");let a=null;if(t!=null&&(a=M(t,"weights","softmaxCrossEntropy")),Ls(o.shape,i.shape,"Error in softmaxCrossEntropy: "),s>0){const u=We(s),h=We(1),p=We(o.shape[1]);o=ye(H(o,Ee(h,u)),Ae(u,p))}const l=ZH(o,i);return Vo(l,a,r)}const e6=j({softmaxCrossEntropy_:JH});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function t6(n,e,t,s){const r=M(n,"indices","sparseFillEmptyRows","int32"),o=M(e,"values","sparseFillEmptyRows"),i=M(t,"denseShape","sparseFillEmptyRows","int32"),a=M(s,"defaultValue","sparseFillEmptyRows",o.dtype);if(r.rank!==2)throw new Error(`Indices should be Tensor2D but received shape
        ${r.shape}`);if(o.rank!==1)throw new Error(`Values should be Tensor1D but received shape ${o.shape}`);if(i.rank!==1)throw new Error(`Dense shape should be Tensor1D but received shape ${i.shape}`);if(a.rank!==0)throw new Error(`Default value should be a scalar but received shape ${a.shape}`);const l={indices:r,values:o,denseShape:i,defaultValue:a},u=K.runKernel(m1,l);return{outputIndices:u[0],outputValues:u[1],emptyRowIndicator:u[2],reverseIndexMap:u[3]}}const n6=j({sparseFillEmptyRows_:t6});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function s6(n,e,t){const s=M(n,"inputIndices","sparseReshape","int32"),r=M(e,"inputShape","sparseReshape","int32"),o=M(t,"newShape","sparseReshape","int32");if(s.rank!==2)throw new Error(`Input indices should be Tensor2D but received shape
        ${s.shape}`);if(r.rank!==1)throw new Error(`Input shape should be Tensor1D but received shape ${r.shape}`);if(o.rank!==1)throw new Error(`New shape should be Tensor1D but received shape ${o.shape}`);const i={inputIndices:s,inputShape:r,newShape:o},a=K.runKernel(g1,i);return{outputIndices:a[0],outputShape:a[1]}}const r6=j({sparseReshape_:s6});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function o6(n,e,t){const s=M(n,"data","sparseSegmentMean"),r=M(e,"indices","sparseSegmentMean","int32"),o=M(t,"segmentIds","sparseSegmentMean","int32");if(s.rank<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(r.rank!==1)throw new Error(`Indices should be Tensor1D but received shape
          ${r.shape}`);if(o.rank!==1)throw new Error(`Segment ids should be Tensor1D but received shape
          ${o.shape}`);const i={data:s,indices:r,segmentIds:o};return K.runKernel(y1,i)}const i6=j({sparseSegmentMean_:o6});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function a6(n,e,t){const s=M(n,"data","sparseSegmentSum"),r=M(e,"indices","sparseSegmentSum","int32"),o=M(t,"segmentIds","sparseSegmentSum","int32");if(s.rank<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(r.rank!==1)throw new Error(`Indices should be Tensor1D but received shape
         ${r.shape}`);if(o.rank!==1)throw new Error(`Segment ids should be Tensor1D but received shape
         ${o.shape}`);const i={data:s,indices:r,segmentIds:o};return K.runKernel(x1,i)}const l6=j({sparseSegmentSum_:a6});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function u6(n,e,t,s,r,o,i,a){const l=M(n,"data","stringNGrams","string");if(l.dtype!=="string")throw new Error("Data must be of datatype string");if(l.shape.length!==1)throw new Error(`Data must be a vector, saw: ${l.shape}`);const u=M(e,"dataSplits","stringNGrams");if(u.dtype!=="int32")throw new Error("Data splits must be of datatype int32");const h={separator:t,nGramWidths:s,leftPad:r,rightPad:o,padWidth:i,preserveShortSequences:a},p={data:l,dataSplits:u},f=K.runKernel(S1,p,h);return{nGrams:f[0],nGramsSplits:f[1]}}const c6=j({stringNGrams_:u6});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function h6(n,e,t=!0){const s=M(n,"input","stringSplit","string"),r=M(e,"delimiter","stringSplit","string");if(s.rank!==1)throw new Error(`Input should be Tensor1D but received shape ${s.shape}`);if(r.rank!==0)throw new Error(`Delimiter should be a scalar but received shape ${r.shape}`);const o={skipEmpty:t},i={input:s,delimiter:r},a=K.runKernel(C1,i,o);return{indices:a[0],values:a[1],shape:a[2]}}const d6=j({stringSplit_:h6});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function p6(n,e){const t=M(n,"input","stringToHashBucketFast","string"),s={numBuckets:e};if(e<=0)throw new Error("Number of buckets must be at least 1");const r={input:t};return K.runKernel(k1,r,s)}const f6=j({stringToHashBucketFast_:p6});/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function m6(n,e,t,s=!0){const r=M(n,"input","staticRegexReplace","string"),o={pattern:e,rewrite:t,replaceGlobal:s};return K.runKernel(hg,{x:r},o)}const g6=j({staticRegexReplace_:m6});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const y6={fft:Ag,ifft:Lc,rfft:Og,irfft:ob},x6={hammingWindow:Gj,hannWindow:OR,frame:_R,stft:qj},Es={flipLeftRight:Zj,grayscaleToRGB:eH,resizeNearestNeighbor:PR,resizeBilinear:FR,rgbToGrayscale:nH,rotateWithOffset:rH,cropAndResize:Yj,nonMaxSuppression:iH,nonMaxSuppressionAsync:fH,nonMaxSuppressionWithScore:gH,nonMaxSuppressionWithScoreAsync:xH,nonMaxSuppressionPadded:wH,nonMaxSuppressionPaddedAsync:SH,threshold:IH,transform:EH},LR={bandPart:DH,gramSchmidt:OH,qr:FH},v6={absoluteDifference:MH,computeWeightedLoss:Vo,cosineDistance:VH,hingeLoss:WH,huberLoss:GH,logLoss:HH,meanSquaredError:qH,sigmoidCrossEntropy:QH,softmaxCrossEntropy:e6},w6={sparseFillEmptyRows:n6,sparseReshape:r6,sparseSegmentMean:i6,sparseSegmentSum:l6},b6={stringNGrams:c6,stringSplit:d6,stringToHashBucketFast:f6,staticRegexReplace:g6};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const S6=new Map,C6=new Map;class mu{getClassName(){return this.constructor.className}static fromConfig(e,t){return new e(t)}}class or{constructor(){this.classNameMap={}}static getMap(){return or.instance==null&&(or.instance=new or),or.instance}static register(e){or.getMap().classNameMap[e.className]=[e,e.fromConfig]}}function ve(n,e,t){L(n.className!=null,()=>"Class being registered does not have the static className property defined."),L(typeof n.className=="string",()=>"className is required to be a string, but got type "+typeof n.className),L(n.className.length>0,()=>"Class being registered has an empty-string as its className, which is disallowed."),typeof e>"u"&&(e="Custom"),typeof t>"u"&&(t=n.className);const s=t,r=e+">"+s;return or.register(n),S6.set(r,n),C6.set(n,r),n}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Bi extends mu{minimize(e,t=!1,s){const{value:r,grads:o}=this.computeGradients(e,s);if(s!=null){const i=s.map(a=>({name:a.name,tensor:o[a.name]}));this.applyGradients(i)}else this.applyGradients(o);return ot(o),t?r:(r.dispose(),null)}get iterations(){return this.iterations_==null&&(this.iterations_=0),this.iterations_}incrementIterations(){this.iterations_=this.iterations+1}computeGradients(e,t){return KW(e,t)}dispose(){this.iterations_!=null&&ot(this.iterations_)}async saveIterations(){return this.iterations_==null&&(this.iterations_=0),{name:"iter",tensor:We(this.iterations_,"int32")}}async getWeights(){throw new Error("getWeights() is not implemented for this optimizer yet.")}async setWeights(e){throw new Error(`setWeights() is not implemented for this optimizer class ${this.getClassName()}`)}async extractIterations(e){return this.iterations_=(await e[0].tensor.data())[0],e.slice(1)}}Object.defineProperty(Bi,Symbol.hasInstance,{value:n=>n.minimize!=null&&n.computeGradients!=null&&n.applyGradients!=null});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class MR extends Bi{static get className(){return"Adadelta"}constructor(e,t,s=null){super(),this.learningRate=e,this.rho=t,this.epsilon=s,this.accumulatedGrads=[],this.accumulatedUpdates=[],s==null&&(this.epsilon=K.backend.epsilon())}applyGradients(e){(Array.isArray(e)?e.map(s=>s.name):Object.keys(e)).forEach((s,r)=>{const o=K.registeredVariables[s],i=!1;this.accumulatedGrads[r]==null&&(this.accumulatedGrads[r]={originalName:`${s}/accum_grad`,variable:ie(()=>dt(o).variable(i))}),this.accumulatedUpdates[r]==null&&(this.accumulatedUpdates[r]={originalName:`${s}/accum_var`,variable:ie(()=>dt(o).variable(i))});const a=Array.isArray(e)?e[r].tensor:e[s];if(a==null)return;const l=this.accumulatedGrads[r].variable,u=this.accumulatedUpdates[r].variable;ie(()=>{const h=ye(H(l,this.rho),H(Ct(a),1-this.rho)),p=H(Ae(Pn(ye(u,this.epsilon)),Pn(ye(l,this.epsilon))),a),f=ye(H(u,this.rho),H(Ct(p),1-this.rho));l.assign(h),u.assign(f);const m=ye(H(p,-this.learningRate),o);o.assign(m)})}),this.incrementIterations()}dispose(){this.accumulatedUpdates!=null&&(ot(this.accumulatedGrads.map(e=>e.variable)),ot(this.accumulatedUpdates.map(e=>e.variable)))}async getWeights(){const e=[...this.accumulatedGrads,...this.accumulatedUpdates];return[await this.saveIterations()].concat(e.map(t=>({name:t.originalName,tensor:t.variable})))}async setWeights(e){e=await this.extractIterations(e);const t=e.length/2,s=!1;this.accumulatedGrads=e.slice(0,t).map(r=>({originalName:r.name,variable:r.tensor.variable(s)})),this.accumulatedUpdates=e.slice(t,t*2).map(r=>({originalName:r.name,variable:r.tensor.variable(s)}))}getConfig(){return{learningRate:this.learningRate,rho:this.rho,epsilon:this.epsilon}}static fromConfig(e,t){return new e(t.learningRate,t.rho,t.epsilon)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class zR extends Bi{static get className(){return"Adagrad"}constructor(e,t=.1){super(),this.learningRate=e,this.initialAccumulatorValue=t,this.accumulatedGrads=[]}applyGradients(e){(Array.isArray(e)?e.map(s=>s.name):Object.keys(e)).forEach((s,r)=>{const o=K.registeredVariables[s];this.accumulatedGrads[r]==null&&(this.accumulatedGrads[r]={originalName:`${s}/accumulator`,variable:ie(()=>hu(o.shape,this.initialAccumulatorValue).variable(!1))});const i=Array.isArray(e)?e[r].tensor:e[s];if(i==null)return;const a=this.accumulatedGrads[r].variable;ie(()=>{const l=ye(a,Ct(i));a.assign(l);const u=ye(H(Ae(i,Pn(ye(l,K.backend.epsilon()))),-this.learningRate),o);o.assign(u)})}),this.incrementIterations()}dispose(){this.accumulatedGrads!=null&&ot(this.accumulatedGrads.map(e=>e.variable))}async getWeights(){return[await this.saveIterations()].concat(this.accumulatedGrads.map(e=>({name:e.originalName,tensor:e.variable})))}async setWeights(e){e=await this.extractIterations(e);const t=!1;this.accumulatedGrads=e.map(s=>({originalName:s.name,variable:s.tensor.variable(t)}))}getConfig(){return{learningRate:this.learningRate,initialAccumulatorValue:this.initialAccumulatorValue}}static fromConfig(e,t){return new e(t.learningRate,t.initialAccumulatorValue)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class VR extends Bi{static get className(){return"Adam"}constructor(e,t,s,r=null){super(),this.learningRate=e,this.beta1=t,this.beta2=s,this.epsilon=r,this.accumulatedFirstMoment=[],this.accumulatedSecondMoment=[],ie(()=>{this.accBeta1=We(t).variable(),this.accBeta2=We(s).variable()}),r==null&&(this.epsilon=K.backend.epsilon())}applyGradients(e){const t=Array.isArray(e)?e.map(s=>s.name):Object.keys(e);ie(()=>{const s=Ee(1,this.accBeta1),r=Ee(1,this.accBeta2);t.forEach((o,i)=>{const a=K.registeredVariables[o],l=!1;this.accumulatedFirstMoment[i]==null&&(this.accumulatedFirstMoment[i]={originalName:`${o}/m`,variable:ie(()=>dt(a).variable(l))}),this.accumulatedSecondMoment[i]==null&&(this.accumulatedSecondMoment[i]={originalName:`${o}/v`,variable:ie(()=>dt(a).variable(l))});const u=Array.isArray(e)?e[i].tensor:e[o];if(u==null)return;const h=this.accumulatedFirstMoment[i].variable,p=this.accumulatedSecondMoment[i].variable,f=ye(H(h,this.beta1),H(u,1-this.beta1)),m=ye(H(p,this.beta2),H(Ct(u),1-this.beta2)),y=Ae(f,s),x=Ae(m,r);h.assign(f),p.assign(m);const v=ye(H(Ae(y,ye(Pn(x),this.epsilon)),-this.learningRate),a);a.assign(v)}),this.accBeta1.assign(H(this.accBeta1,this.beta1)),this.accBeta2.assign(H(this.accBeta2,this.beta2))}),this.incrementIterations()}dispose(){this.accBeta1.dispose(),this.accBeta2.dispose(),this.accumulatedFirstMoment!=null&&ot(this.accumulatedFirstMoment.map(e=>e.variable)),this.accumulatedSecondMoment!=null&&ot(this.accumulatedSecondMoment.map(e=>e.variable))}async getWeights(){const e=[...this.accumulatedFirstMoment,...this.accumulatedSecondMoment];return[await this.saveIterations()].concat(e.map(t=>({name:t.originalName,tensor:t.variable})))}async setWeights(e){e=await this.extractIterations(e),ie(()=>{this.accBeta1.assign(Ro(this.beta1,this.iterations_+1)),this.accBeta2.assign(Ro(this.beta2,this.iterations_+1))});const t=e.length/2,s=!1;this.accumulatedFirstMoment=e.slice(0,t).map(r=>({originalName:r.name,variable:r.tensor.variable(s)})),this.accumulatedSecondMoment=e.slice(t,t*2).map(r=>({originalName:r.name,variable:r.tensor.variable(s)}))}getConfig(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon}}static fromConfig(e,t){return new e(t.learningRate,t.beta1,t.beta2,t.epsilon)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class BR extends Bi{static get className(){return"Adamax"}constructor(e,t,s,r=null,o=0){super(),this.learningRate=e,this.beta1=t,this.beta2=s,this.epsilon=r,this.decay=o,this.accumulatedFirstMoment=[],this.accumulatedWeightedInfNorm=[],ie(()=>{this.iteration=We(0).variable(),this.accBeta1=We(t).variable()}),r==null&&(this.epsilon=K.backend.epsilon())}applyGradients(e){const t=Array.isArray(e)?e.map(s=>s.name):Object.keys(e);ie(()=>{const s=Ee(1,this.accBeta1),r=Ae(-this.learningRate,ye(H(this.iteration,this.decay),1));t.forEach((o,i)=>{const a=K.registeredVariables[o],l=!1;this.accumulatedFirstMoment[i]==null&&(this.accumulatedFirstMoment[i]={originalName:`${o}/m`,variable:dt(a).variable(l)}),this.accumulatedWeightedInfNorm[i]==null&&(this.accumulatedWeightedInfNorm[i]={originalName:`${o}/v`,variable:dt(a).variable(l)});const u=Array.isArray(e)?e[i].tensor:e[o];if(u==null)return;const h=this.accumulatedFirstMoment[i].variable,p=this.accumulatedWeightedInfNorm[i].variable,f=ye(H(h,this.beta1),H(u,1-this.beta1)),m=H(p,this.beta2),y=hn(u),x=zo(m,y);h.assign(f),p.assign(x);const v=ye(H(Ae(r,s),Ae(f,ye(x,this.epsilon))),a);a.assign(v)}),this.iteration.assign(ye(this.iteration,1)),this.accBeta1.assign(H(this.accBeta1,this.beta1))}),this.incrementIterations()}dispose(){this.accBeta1.dispose(),this.iteration.dispose(),this.accumulatedFirstMoment!=null&&ot(this.accumulatedFirstMoment.map(e=>e.variable)),this.accumulatedWeightedInfNorm!=null&&ot(this.accumulatedWeightedInfNorm.map(e=>e.variable))}async getWeights(){throw new Error("getWeights() is not implemented for Adamax yet.")}async setWeights(e){throw new Error("setWeights() is not implemented for Adamax yet.")}getConfig(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon,decay:this.decay}}static fromConfig(e,t){return new e(t.learningRate,t.beta1,t.beta2,t.epsilon,t.decay)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class yb extends Bi{static get className(){return"SGD"}constructor(e){super(),this.learningRate=e,this.setLearningRate(e)}applyGradients(e){(Array.isArray(e)?e.map(s=>s.name):Object.keys(e)).forEach((s,r)=>{const o=Array.isArray(e)?e[r].tensor:e[s];if(o==null)return;const i=K.registeredVariables[s];ie(()=>{const a=ye(H(this.c,o),i);i.assign(a)})}),this.incrementIterations()}setLearningRate(e){this.learningRate=e,this.c!=null&&this.c.dispose(),this.c=kn(We(-e))}dispose(){this.c.dispose()}async getWeights(){return[await this.saveIterations()]}async setWeights(e){if(e=await this.extractIterations(e),e.length!==0)throw new Error("SGD optimizer does not have settable weights.")}getConfig(){return{learningRate:this.learningRate}}static fromConfig(e,t){return new e(t.learningRate)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class WR extends yb{static get className(){return"Momentum"}constructor(e,t,s=!1){super(e),this.learningRate=e,this.momentum=t,this.useNesterov=s,this.accumulations=[],this.m=We(this.momentum)}applyGradients(e){(Array.isArray(e)?e.map(s=>s.name):Object.keys(e)).forEach((s,r)=>{const o=K.registeredVariables[s];this.accumulations[r]==null&&(this.accumulations[r]={originalName:`${s}/momentum`,variable:ie(()=>dt(o).variable(!1))});const i=this.accumulations[r].variable,a=Array.isArray(e)?e[r].tensor:e[s];a!=null&&ie(()=>{let l;const u=ye(H(this.m,i),a);this.useNesterov?l=ye(H(this.c,ye(a,H(u,this.m))),o):l=ye(H(this.c,u),o),i.assign(u),o.assign(l)})}),this.incrementIterations()}dispose(){this.m.dispose(),this.accumulations!=null&&ot(this.accumulations.map(e=>e.variable))}setMomentum(e){this.momentum=e}async getWeights(){return[await this.saveIterations()].concat(this.accumulations.map(e=>({name:e.originalName,tensor:e.variable})))}async setWeights(e){e=await this.extractIterations(e);const t=!1;this.accumulations=e.map(s=>({originalName:s.name,variable:s.tensor.variable(t)}))}getConfig(){return{learningRate:this.learningRate,momentum:this.momentum,useNesterov:this.useNesterov}}static fromConfig(e,t){return new e(t.learningRate,t.momentum,t.useNesterov)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class UR extends Bi{static get className(){return"RMSProp"}constructor(e,t=.9,s=0,r=null,o=!1){if(super(),this.learningRate=e,this.decay=t,this.momentum=s,this.epsilon=r,this.accumulatedMeanSquares=[],this.accumulatedMoments=[],this.accumulatedMeanGrads=[],this.centered=o,r==null&&(this.epsilon=K.backend.epsilon()),e==null)throw new Error("learningRate for RMSPropOptimizer must be defined.")}applyGradients(e){(Array.isArray(e)?e.map(s=>s.name):Object.keys(e)).forEach((s,r)=>{const o=K.registeredVariables[s],i=!1;this.accumulatedMeanSquares[r]==null&&(this.accumulatedMeanSquares[r]={originalName:`${s}/rms`,variable:ie(()=>dt(o).variable(i))}),this.accumulatedMoments[r]==null&&(this.accumulatedMoments[r]={originalName:`${s}/momentum`,variable:ie(()=>dt(o).variable(i))}),this.accumulatedMeanGrads[r]==null&&this.centered&&(this.accumulatedMeanGrads[r]={originalName:`${s}/mg`,variable:ie(()=>dt(o).variable(i))});const a=Array.isArray(e)?e[r].tensor:e[s];if(a==null)return;const l=this.accumulatedMeanSquares[r].variable,u=this.accumulatedMoments[r].variable;ie(()=>{const h=ye(H(l,this.decay),H(Ct(a),1-this.decay));if(this.centered){const p=this.accumulatedMeanGrads[r].variable,f=ye(H(p,this.decay),H(a,1-this.decay)),m=Ae(H(a,this.learningRate),Pn(Ee(h,ye(Ct(f),this.epsilon)))),y=ye(H(u,this.momentum),m);l.assign(h),p.assign(f),u.assign(y);const x=Ee(o,y);o.assign(x)}else{const p=ye(H(l,this.decay),H(Ct(a),1-this.decay)),f=ye(H(u,this.momentum),Ae(H(a,this.learningRate),Pn(ye(p,this.epsilon))));l.assign(p),u.assign(f);const m=Ee(o,f);o.assign(m)}})}),this.incrementIterations()}dispose(){this.accumulatedMeanSquares!=null&&ot(this.accumulatedMeanSquares.map(e=>e.variable)),this.accumulatedMeanGrads!=null&&this.centered&&ot(this.accumulatedMeanGrads.map(e=>e.variable)),this.accumulatedMoments!=null&&ot(this.accumulatedMoments.map(e=>e.variable))}async getWeights(){const e=[...this.accumulatedMeanSquares,...this.accumulatedMoments];return this.centered&&e.push(...this.accumulatedMeanGrads),[await this.saveIterations()].concat(e.map(t=>({name:t.originalName,tensor:t.variable})))}async setWeights(e){e=await this.extractIterations(e);const t=this.centered?e.length/3:e.length/2,s=!1;this.accumulatedMeanSquares=e.slice(0,t).map(r=>({originalName:r.name,variable:r.tensor.variable(s)})),this.accumulatedMoments=e.slice(t,t*2).map(r=>({originalName:r.name,variable:r.tensor.variable(s)})),this.centered&&(this.accumulatedMeanGrads=e.slice(t*2,t*3).map(r=>({originalName:r.name,variable:r.tensor.variable(s)})))}getConfig(){return{learningRate:this.learningRate,decay:this.decay,momentum:this.momentum,epsilon:this.epsilon,centered:this.centered}}static fromConfig(e,t){return new e(t.learningRate,t.decay,t.momentum,t.epsilon,t.centered)}}/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const k6=[MR,zR,VR,BR,WR,UR,yb];function T6(){for(const n of k6)ve(n)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const N6="model",I6=".json",$6=".weights.bin";function DN(n){return new Promise(e=>setTimeout(e)).then(n)}class Da{constructor(e){if(!ae().getBool("IS_BROWSER"))throw new Error("browserDownloads() cannot proceed because the current environment is not a browser.");e.startsWith(Da.URL_SCHEME)&&(e=e.slice(Da.URL_SCHEME.length)),(e==null||e.length===0)&&(e=N6),this.modelJsonFileName=e+I6,this.weightDataFileName=e+$6}async save(e){if(typeof document>"u")throw new Error("Browser downloads are not supported in this environment since `document` is not present");const t=Br.join(e.weightData),s=window.URL.createObjectURL(new Blob([t],{type:"application/octet-stream"}));if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserDownloads.save() does not support saving model topology in binary formats yet.");{const r=[{paths:["./"+this.weightDataFileName],weights:e.weightSpecs}],o=SE(e,r),i=window.URL.createObjectURL(new Blob([JSON.stringify(o)],{type:"application/json"})),a=this.modelJsonAnchor==null?document.createElement("a"):this.modelJsonAnchor;if(a.download=this.modelJsonFileName,a.href=i,await DN(()=>a.dispatchEvent(new MouseEvent("click"))),e.weightData!=null){const l=this.weightDataAnchor==null?document.createElement("a"):this.weightDataAnchor;l.download=this.weightDataFileName,l.href=s,await DN(()=>l.dispatchEvent(new MouseEvent("click")))}return{modelArtifactsInfo:Qh(e)}}}}Da.URL_SCHEME="downloads://";class E6{constructor(e){if(e==null||e.length<1)throw new Error(`When calling browserFiles, at least 1 file is required, but received ${e}`);this.jsonFile=e[0],this.weightsFiles=e.slice(1)}async load(){return new Promise((e,t)=>{const s=new FileReader;s.onload=r=>{const o=JSON.parse(r.target.result),i=o.modelTopology;if(i==null){t(new Error(`modelTopology field is missing from file ${this.jsonFile.name}`));return}if(o.weightsManifest==null){t(new Error(`weightManifest field is missing from file ${this.jsonFile.name}`));return}if(this.weightsFiles.length===0){e({modelTopology:i});return}const l=A1(o,u=>this.loadWeights(u));e(l)},s.onerror=r=>t(`Failed to read model topology and weights manifest JSON from file '${this.jsonFile.name}'. BrowserFiles supports loading Keras-style tf.Model artifacts only.`),s.readAsText(this.jsonFile)})}loadWeights(e){const t=[],s=[];for(const i of e)t.push(...i.weights),s.push(...i.paths);const r=this.checkManifestAndWeightFiles(e),o=s.map(i=>this.loadWeightsFile(i,r[i]));return Promise.all(o).then(i=>[t,i])}loadWeightsFile(e,t){return new Promise((s,r)=>{const o=new FileReader;o.onload=i=>{const a=i.target.result;s(a)},o.onerror=i=>r(`Failed to weights data from file of path '${e}'.`),o.readAsArrayBuffer(t)})}checkManifestAndWeightFiles(e){const t=[],s=this.weightsFiles.map(o=>wN(o.name)),r={};for(const o of e)o.paths.forEach(i=>{const a=wN(i);if(t.indexOf(a)!==-1)throw new Error(`Duplicate file basename found in weights manifest: '${a}'`);if(t.push(a),s.indexOf(a)===-1)throw new Error(`Weight file with basename '${a}' is not provided.`);r[i]=this.weightsFiles[s.indexOf(a)]});if(t.length!==this.weightsFiles.length)throw new Error(`Mismatch in the number of files in weights manifest (${t.length}) and the number of weight files provided (${this.weightsFiles.length}).`);return r}}const R6=n=>ae().getBool("IS_BROWSER")&&!Array.isArray(n)&&n.startsWith(Da.URL_SCHEME)?D6(n.slice(Da.URL_SCHEME.length)):null;Lt.registerSaveRouter(R6);function D6(n="model"){return new Da(n)}function A6(n){return new E6(n)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function AN(n,e,t,s){i(n),t=t??0,s=s??1,a(t,s);let r=0;const o=l=>(l.then(u=>{const h=t+ ++r/n.length*(s-t);return e(h),u}),l);function i(l){L(l!=null&&Array.isArray(l)&&l.length>0,()=>"promises must be a none empty array")}function a(l,u){L(l>=0&&l<=1,()=>`Progress fraction must be in range [0, 1], but got startFraction ${l}`),L(u>=0&&u<=1,()=>`Progress fraction must be in range [0, 1], but got endFraction ${u}`),L(u>=l,()=>`startFraction must be no more than endFraction, but got startFraction ${l} and endFraction ${u}`)}return Promise.all(n.map(o))}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function GR(n,e){e==null&&(e={});const t=e.fetchFunc==null?ae().platform.fetch:e.fetchFunc,s=n.map(p=>t(p,e.requestInit,{isBinary:!0})),a=(e.onProgress==null?await Promise.all(s):await AN(s,e.onProgress,0,.5)).map(p=>p.arrayBuffer());return e.onProgress==null?await Promise.all(a):await AN(a,e.onProgress,.5,1)}function O6(n,e){var t;const s=e.fetchFunc==null?ae().platform.fetch:e.fetchFunc;let r=0,o;return(t=e.onProgress)===null||t===void 0||t.call(e,0),new ReadableStream({pull:async i=>{for(var a;r<n.length;){o||(o=(await s(n[r],e.requestInit,{isBinary:!0})).body.getReader());const{done:l,value:u}=await o.read();if(l){r++,o=void 0,(a=e.onProgress)===null||a===void 0||a.call(e,r/n.length);continue}i.enqueue(u);return}i.close()}})}async function _6(n,e="",t,s){return jR(i=>GR(i,{requestInit:s}))(n,e,t)}function jR(n){return async(e,t="",s)=>{const r=e.map(()=>!1),o={},i=s!=null?s.map(()=>!1):[],a=[];if(e.forEach((m,y)=>{let x=0;m.weights.forEach(v=>{const w="quantization"in v?v.quantization.dtype:v.dtype,S=Ta[w]*fe(v.shape),k=()=>{r[y]=!0,o[y]==null&&(o[y]=[]),o[y].push({manifestEntry:v,groupOffset:x,sizeBytes:S})};s!=null?s.forEach((T,I)=>{T===v.name&&(k(),i[I]=!0)}):k(),a.push(v.name),x+=S})}),!i.every(m=>m)){const m=s.filter((y,x)=>!i[x]);throw new Error(`Could not find weights in manifest with names: ${m.join(", ")}. 
Manifest JSON has weights with names: ${a.join(", ")}.`)}const l=r.reduce((m,y,x)=>(y&&m.push(x),m),[]),u=[];l.forEach(m=>{e[m].paths.forEach(y=>{const x=t+(t.endsWith("/")?"":"/")+y;u.push(x)})});const h=await n(u),p={};let f=0;return l.forEach(m=>{const y=e[m].paths.length,x=new Br(h.slice(f,f+y));o[m].forEach(w=>{const S=x.slice(w.groupOffset,w.groupOffset+w.sizeBytes),k=xE(S,[w.manifestEntry]);for(const T in k)p[T]=k[T]}),f+=y}),p}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const F6="application/octet-stream",P6="application/json";class xb{constructor(e,t){if(this.DEFAULT_METHOD="POST",t==null&&(t={}),this.weightPathPrefix=t.weightPathPrefix,this.weightUrlConverter=t.weightUrlConverter,t.fetchFunc!=null?(L(typeof t.fetchFunc=="function",()=>"Must pass a function that matches the signature of `fetch` (see https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API)"),this.fetch=t.fetchFunc):this.fetch=ae().platform.fetch,L(e!=null&&e.length>0,()=>"URL path for http must not be null, undefined or empty."),Array.isArray(e)&&L(e.length===2,()=>`URL paths for http must have a length of 2, (actual length is ${e.length}).`),this.path=e,t.requestInit!=null&&t.requestInit.body!=null)throw new Error("requestInit is expected to have no pre-existing body, but has one.");this.requestInit=t.requestInit||{},this.loadOptions=t}async save(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserHTTPRequest.save() does not support saving model topology in binary formats yet.");const t=Object.assign({method:this.DEFAULT_METHOD},this.requestInit);t.body=new FormData;const s=[{paths:["./model.weights.bin"],weights:e.weightSpecs}],r=SE(e,s);if(t.body.append("model.json",new Blob([JSON.stringify(r)],{type:P6}),"model.json"),e.weightData!=null){const i=Br.join(e.weightData);t.body.append("model.weights.bin",new Blob([i],{type:F6}),"model.weights.bin")}const o=await this.fetch(this.path,t);if(o.ok)return{modelArtifactsInfo:Qh(e),responses:[o]};throw new Error(`BrowserHTTPRequest.save() failed due to HTTP response status ${o.status}.`)}async loadModelJSON(){const e=await this.fetch(this.path,this.requestInit);if(!e.ok)throw new Error(`Request to ${this.path} failed with status code ${e.status}. Please verify this URL points to the model JSON of the model to load.`);let t;try{t=await e.json()}catch{let i=`Failed to parse model JSON of response from ${this.path}.`;throw this.path.endsWith(".pb")?i+=" Your path contains a .pb file extension. Support for .pb models have been removed in TensorFlow.js 1.0 in favor of .json models. You can re-convert your Python TensorFlow model using the TensorFlow.js 1.0 conversion scripts or you can convert your.pb models with the 'pb2json'NPM script in the tensorflow/tfjs-converter repository.":i+=" Please make sure the server is serving valid JSON for this request.",new Error(i)}const s=t.modelTopology,r=t.weightsManifest;if(s==null&&r==null)throw new Error(`The JSON from HTTP path ${this.path} contains neither model topology or manifest for weights.`);return t}async load(){if(this.loadOptions.streamWeights)return this.loadStream();const e=await this.loadModelJSON();return A1(e,t=>this.loadWeights(t))}async loadStream(){const e=await this.loadModelJSON(),t=await this.getWeightUrls(e.weightsManifest),s=lv(e.weightsManifest),r=()=>O6(t,this.loadOptions);return Object.assign(Object.assign({},e),{weightSpecs:s,getWeightStream:r})}async getWeightUrls(e){const t=Array.isArray(this.path)?this.path[1]:this.path,[s,r]=L6(t),o=this.weightPathPrefix||s,i=[],a=[];for(const l of e)for(const u of l.paths)this.weightUrlConverter!=null?a.push(this.weightUrlConverter(u)):i.push(o+u+r);return this.weightUrlConverter&&i.push(...await Promise.all(a)),i}async loadWeights(e){const t=await this.getWeightUrls(e),s=lv(e),r=await GR(t,this.loadOptions);return[s,r]}}xb.URL_SCHEME_REGEX=/^https?:\/\//;function L6(n){const e=n.lastIndexOf("/"),t=n.lastIndexOf("?"),s=n.substring(0,e),r=t>e?n.substring(t):"";return[s+"/",r]}function mv(n){return n.match(xb.URL_SCHEME_REGEX)!=null}const HR=(n,e)=>{if(typeof fetch>"u"&&(e==null||e.fetchFunc==null))return null;{let t=!0;if(Array.isArray(n)?t=n.every(s=>mv(s)):t=mv(n),t)return vb(n,e)}return null};Lt.registerSaveRouter(HR);Lt.registerLoadRouter(HR);function vb(n,e){return new xb(n,e)}function M6(n,e){return vb(n,e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class hx{constructor(e){this.modelArtifacts=e}load(){return this.modelArtifacts}}class KR{constructor(e){this.saveHandler=e}save(e){return this.saveHandler(e)}}class z6{constructor(e){e.load&&(this.load=()=>Promise.resolve(e.load())),e.save&&(this.save=t=>Promise.resolve(e.save(t)))}}function V6(n,e,t,s){const r=arguments;return new z6(qR(...r))}function qR(n,e,t,s){return arguments.length===1?n.modelTopology!=null||n.weightSpecs!=null?new hx(n):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new hx({modelTopology:n})):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new hx({modelTopology:n,weightSpecs:e,weightData:t,trainingConfig:s}))}function B6(n){return new KR(n)}function W6(n){return new KR(n)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const XR=Object.freeze(Object.defineProperty({__proto__:null,CompositeArrayBuffer:Br,browserFiles:A6,browserHTTPRequest:M6,concatenateArrayBuffers:bE,copyModel:WB,decodeWeights:xE,decodeWeightsStream:wE,encodeWeights:av,fromMemory:V6,fromMemorySync:qR,getLoadHandlers:$B,getModelArtifactsForJSON:A1,getModelArtifactsForJSONSync:CE,getModelArtifactsInfoForJSON:Qh,getSaveHandlers:kE,getWeightSpecs:lv,http:vb,isHTTPScheme:mv,listModels:VB,loadWeights:_6,moveModel:UB,registerLoadRouter:IB,registerSaveRouter:NB,removeModel:BB,weightsLoaderFactory:jR,withSaveHandler:B6,withSaveHandlerSync:W6},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let oa;function U6(n,e=3){if(e>4)throw new Error("Cannot construct Tensor with more than 4 channels from pixels.");if(n==null)throw new Error("pixels passed to tf.browser.fromPixels() can not be null");let t=!1,s=!1,r=!1,o=!1,i=!1,a=!1;if(n.data instanceof Uint8Array)t=!0;else if(typeof ImageData<"u"&&n instanceof ImageData)s=!0;else if(typeof HTMLVideoElement<"u"&&n instanceof HTMLVideoElement)r=!0;else if(typeof HTMLImageElement<"u"&&n instanceof HTMLImageElement)o=!0;else if(n.getContext!=null)i=!0;else if(typeof ImageBitmap<"u"&&n instanceof ImageBitmap)a=!0;else throw new Error(`pixels passed to tf.browser.fromPixels() must be either an HTMLVideoElement, HTMLImageElement, HTMLCanvasElement, ImageData in browser, or OffscreenCanvas, ImageData in webworker or {data: Uint32Array, width: number, height: number}, but was ${n.constructor.name}`);if(tv(Jx,K.backendName)!=null){const y={pixels:n},x={numChannels:e};return K.runKernel(Jx,y,x)}const[u,h]=r?[n.videoWidth,n.videoHeight]:[n.width,n.height];let p;if(i)p=n.getContext("2d").getImageData(0,0,u,h).data;else if(s||t)p=n.data;else if(o||r||a){if(oa==null)if(typeof document>"u")if(typeof OffscreenCanvas<"u"&&typeof OffscreenCanvasRenderingContext2D<"u")oa=new OffscreenCanvas(1,1).getContext("2d");else throw new Error("Cannot parse input in current context. Reason: OffscreenCanvas Context2D rendering is not supported.");else oa=document.createElement("canvas").getContext("2d",{willReadFrequently:!0});oa.canvas.width=u,oa.canvas.height=h,oa.drawImage(n,0,0,u,h),p=oa.getImageData(0,0,u,h).data}let f;if(e===4)f=new Int32Array(p);else{const y=u*h;f=new Int32Array(y*e);for(let x=0;x<y;x++)for(let v=0;v<e;++v)f[x*e+v]=p[x*4+v]}return SR(f,[h,u,e],"int32")}const G6=j({fromPixels_:U6});function wb(n,e){const t=n.shape.length,s=e.shape.length;if(t<1)throw new Error(`tf.gatherND() expects the input to be rank 1 or higher, but the rank was ${t}.`);if(s<1)throw new Error(`tf.gatherND() expects the indices to be rank 1 or higher, but the rank was ${s}.`);if(e.dtype!=="int32")throw new Error(`tf.gatherND() expects the indices to be int32 type, but the dtype was ${e.dtype}.`);if(e.shape[s-1]>t)throw new Error(`index innermost dimension length must be <= tensor rank; saw: ${e.shape[s-1]} vs. ${t}`);if(fe(n.shape)===0)throw new Error(`Requested more than 0 entries, but input is empty. Input shape: ${n.shape}.`);const r=e.shape,o=r[r.length-1];let i=1;for(let p=0;p<r.length-1;++p)i*=r[p];const a=n.shape,l=r.slice();l.pop();let u=1;for(let p=o;p<t;++p)u*=a[p],l.push(a[p]);const h=[...Be(n.shape).map(p=>p/u),1].slice(0,o);return[l,i,u,h]}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gv=-2,j6=-1;function YR(n,e,t){const s=n.shape.length;L(s===e.length,()=>`Error in slice${s}D: Length of begin ${e} must match the rank of the array (${s}).`),L(s===t.length,()=>`Error in slice${s}D: Length of size ${t} must match the rank of the array (${s}).`);for(let r=0;r<s;++r)L(e[r]+t[r]<=n.shape[r],()=>`Error in slice${s}D: begin[${r}] + size[${r}] (${e[r]+t[r]}) would overflow input.shape[${r}] (${n.shape[r]})`)}function QR(n,e,t){const s=[];for(let r=0;r<n.length;r++)s[r]=Math.ceil((e[r]-n[r])/t[r]);return s}function ZR(n,e,t){let s=t.length;for(let r=0;r<t.length;r++)if(t[r]>1){s=r;break}for(let r=s+1;r<t.length;r++)if(e[r]>0||t[r]!==n[r])return!1;return!0}function JR(n,e){let t=n.length>0?n[n.length-1]:1;for(let s=0;s<n.length-1;s++)t+=n[s]*e[s];return t}function bb(n,e,t){let s;const r=n.shape.length;typeof e=="number"?s=[e,...new Array(r-1).fill(0)]:e.length<r?s=e.concat(new Array(r-e.length).fill(0)):s=e.slice(),s.forEach(i=>{L(i!==-1,()=>"slice() does not support negative begin indexing.")});let o;return t==null?o=new Array(r).fill(-1):typeof t=="number"?o=[t,...new Array(r-1).fill(-1)]:t.length<r?o=t.concat(new Array(r-t.length).fill(-1)):o=t,o=o.map((i,a)=>i>=0?i:(L(i===-1,()=>`Negative size values should be exactly -1 but got ${i} for the slice() size at index ${a}.`),n.shape[a]-s[a])),[s,o]}function eD(n,e,t,s,r,o,i,a,l){let u;if(s==null?(u=new Array(e.length),u.fill(1)):u=s,i!=null&&(i&i-1)!==0)throw new Error("Multiple ellipses in slice is not allowed.");let h=!1;const p={dims:u.length,numAddAxisAfterEllipsis:0,begin:e.slice(),end:t.slice(),strides:u.slice(),beginMask:r,endMask:o,ellipsisMask:i,newAxisMask:a,shrinkAxisMask:l};for(let k=0;k<p.dims;k++)h&&(1<<k&a)!==0&&p.numAddAxisAfterEllipsis++,1<<k&i&&(h=!0);h||(p.ellipsisMask|=1<<p.dims,p.dims++);const f={dims:n.length,beginMask:0,endMask:0,beginValid:!1,endValid:!1};H6(p,f);let m=!0,y=!0,x=!0;const v=[],w=[];for(let k=0;k<n.length;++k){if(f.strides[k]===0)throw Error(`strides[${k}] must be non-zero`);const T=!!(f.shrinkAxisMask&1<<k),I=n[k];if(I===-1){v.push(T?1:-1);continue}const E=[f.beginMask&1<<k,f.endMask&1<<k],D=[f.strides[k]>0?0:-1,f.strides[k]>0?I:I-1];if(T&&f.strides[k]<=0)throw Error("only stride 1 allowed on non-range indexing.");x=x&&f.strides[k]===1;const O=!!(f.beginMask&1<<k&&f.endMask&1<<k);if(f.beginValid&&f.endValid){if(T){const W=f.begin[k]<0?I+f.begin[k]:f.begin[k];if(f.begin[k]=W,f.end[k]=f.begin[k]+1,W<0||W>=I)throw Error(`slice index ${f.begin[k]} of dimension ${k} out of bounds.`)}else f.begin[k]=ON(f.begin[k],0,f.strides[k],I,E,D),f.end[k]=ON(f.end[k],1,f.strides[k],I,E,D);const R=f.strides[k]===1&&f.begin[k]===0&&f.end[k]===I;m=m&&R,y=y&&(k===0&&f.strides[k]===1||R)}else m=m&&f.strides[k]===1&&O,y=y&&(k===0&&f.strides[k]===1||O);let _,P=!1;if(f.beginValid&&f.endValid?(_=f.end[k]-f.begin[k],P=!0):T?(_=1,P=!0):O&&I>=0&&(f.strides[k]<0?_=-I:_=I,P=!0),P){let R;_===0||_<0!=f.strides[k]<0?R=0:R=Math.trunc(_/f.strides[k])+(_%f.strides[k]!==0?1:0),v.push(R)}else v.push(-1)}for(let k=0;k<f.finalShapeGatherIndices.length;++k){const T=f.finalShapeGatherIndices[k];T>=0?w.push(v[T]):T===gv&&w.push(1)}return{finalShapeSparse:w.filter((k,T)=>f.finalShapeGatherIndices[T]!==gv),finalShape:w,isIdentity:m,sliceDim0:y,isSimpleSlice:x,begin:f.begin,end:f.end,strides:f.strides}}function H6(n,e){e.beginMask=0,e.endMask=0,e.shrinkAxisMask=0;let t=0;e.beginValid=n.begin!=null,e.endValid=n.end!=null,e.begin=new Array(e.dims),e.end=new Array(e.dims),e.strides=new Array(e.dims),e.finalShapeGatherIndices=[],e.finalShapeGatherIndicesSparse=[],e.inputShapeGatherIndicesSparse=new Array(e.dims);for(let s=0;s<n.dims;s++)if(1<<s&n.ellipsisMask){const r=Math.min(e.dims-(n.dims-s)+1+n.numAddAxisAfterEllipsis,e.dims);for(;t<r;t++)e.begin[t]=0,e.end[t]=0,e.strides[t]=1,e.beginMask|=1<<t,e.endMask|=1<<t,e.finalShapeGatherIndices.push(t),e.finalShapeGatherIndicesSparse.push(-1),e.inputShapeGatherIndicesSparse[t]=s}else if(1<<s&n.newAxisMask)e.finalShapeGatherIndices.push(gv),e.finalShapeGatherIndicesSparse.push(-1);else{if(t===e.begin.length)throw Error(`Index out of range using input dim ${t}; input has only ${e.dims} dims, ${e.begin.length}.`);n.begin!=null&&(e.begin[t]=n.begin[s]),n.end!=null&&(e.end[t]=n.end[s]),e.strides[t]=n.strides[s],n.beginMask&1<<s&&(e.beginMask|=1<<t),n.endMask&1<<s&&(e.endMask|=1<<t),n.shrinkAxisMask&1<<s?(e.finalShapeGatherIndices.push(j6),e.finalShapeGatherIndicesSparse.push(-1),e.shrinkAxisMask|=1<<t):(e.finalShapeGatherIndices.push(t),e.finalShapeGatherIndicesSparse.push(s)),e.inputShapeGatherIndicesSparse[t]=s,t++}}function ON(n,e,t,s,r,o){if(r[e])return t>0?o[e]:o[e+1&1];{const i=n<0?s+n:n;return i<o[0]?o[0]:i>o[1]?o[1]:i}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class K6{static sgd(e){return new yb(e)}static momentum(e,t,s=!1){return new WR(e,t,s)}static rmsprop(e,t=.9,s=0,r=null,o=!1){return new UR(e,t,s,r,o)}static adam(e=.001,t=.9,s=.999,r=null){return new VR(e,t,s,r)}static adadelta(e=.001,t=.95,s=null){return new MR(e,t,s)}static adamax(e=.002,t=.9,s=.999,r=null,o=0){return new BR(e,t,s,r,o)}static adagrad(e,t=.1){return new zR(e,t)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bl=K6;/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const q6=typeof requestAnimationFrame<"u"?requestAnimationFrame:typeof setImmediate<"u"?setImmediate:n=>n();function tD(){return new Promise(n=>q6(()=>n()))}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Sb(n,e){const t=n[0].length;n.forEach((r,o)=>{L(r.length===t,()=>`Error in concat${t}D: rank of tensors[${o}] must be the same as the rank of the rest (${t})`)}),L(e>=0&&e<t,()=>`Error in concat${t}D: axis must be between 0 and ${t-1}.`);const s=n[0];n.forEach((r,o)=>{for(let i=0;i<t;i++)L(i===e||r[i]===s[i],()=>`Error in concat${t}D: Shape of tensors[${o}] (${r}) does not match the shape of the rest (${s}) along the non-concatenated axis ${o}.`)})}function to(n,e){const t=n[0].slice();for(let s=1;s<n.length;s++)t[e]+=n[s][e];return t}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var Or;(function(n){n[n.FIRST_DIM_SIZE=0]="FIRST_DIM_SIZE",n[n.VALUE_ROWIDS=1]="VALUE_ROWIDS",n[n.ROW_LENGTHS=2]="ROW_LENGTHS",n[n.ROW_SPLITS=3]="ROW_SPLITS",n[n.ROW_LIMITS=4]="ROW_LIMITS",n[n.ROW_STARTS=5]="ROW_STARTS"})(Or||(Or={}));function nD(n,e,t){let s=new Array;if(t==null&&e==null)return s;if(e==null)for(;s.length<n+t.length;)s.push(-1);else s=e.slice();if(t==null)return s;if(n+t.length!==s.length)throw new Error(`rt input.shape and shape=${e} are incompatible: rt input.rank = ${n+t.length}, but shape.rank = ${s.length}`);for(let r=1;r<t.length;++r){const o=t[r],i=s[s.length-t.length+r],a=s[i];if(o>=0)if(a>=0){if(a!==o)throw new Error(`rt input.shape and shape=${e} are incompatible: rt input.shape[${r+n}] = ${o} but shape[${r+n}] = ${a}`)}else s[i]=o}return s}function sD(n){const e={FIRST_DIM_SIZE:Or.FIRST_DIM_SIZE,VALUE_ROWIDS:Or.VALUE_ROWIDS,ROW_LENGTHS:Or.ROW_LENGTHS,ROW_SPLITS:Or.ROW_SPLITS,ROW_LIMITS:Or.ROW_LIMITS,ROW_STARTS:Or.ROW_STARTS},t=[];for(const s of n)if(s in e)t.push(e[s]);else break;return t}function rD(n){return n.length===0?0:n[0]===Or.FIRST_DIM_SIZE?n.length-1:n.length}function oD(n,e){if(n==null||e==null)return;const t=n.length,s=e.length;if(t>=s)throw new Error(`defaultValue.shape=${n} and ragged tensor flatValues.shape=${e}, are incompatible: defaultValue.rank = ${t} must be less than ragged tensor input flatValues.rank = ${s})`);for(let r=0;r<Math.min(t,s-1);++r){const o=n[r],i=e[r+1];if(o>=0&&i>=0&&o!==1&&o!==i)throw new Error(`defaultValue.shape=${n}, and ragged tensor input flatValues.shape=${e} are incompatible: defaultValue.shape[${r-n.length}] = ${o} but ragged tensor input.flatValues.shape[${r-n.length}] = ${i}`)}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Cb=30;function Mg(n){return n<=Cb?n:Yx(n,Math.floor(Math.sqrt(n)))}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kb(n,e,t){const s=t*(typeof n=="number"?n:n[0]),r=e*(typeof n=="number"?n:n[1]);return[s,r]}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function od(n,e,t,s=!0){let r=[];if(s)r=r.concat(e.slice(0)),r.push(n[0]/t),r=r.concat(n.slice(1));else{r=r.concat(n[0]);const o=e.length;for(let i=0;i<o;++i)r=r.concat([n[i+1]/e[i],e[i]]);r=r.concat(n.slice(o+1))}return r}function id(n,e,t=!0){const s=[];if(t){s.push(e);for(let r=e+1;r<n;++r)r<=2*e?(s.push(r),s.push(r-(e+1))):s.push(r)}else{const r=[],o=[];for(let i=1;i<n;++i)i>=e*2+1||i%2===1?o.push(i):r.push(i);s.push(...r),s.push(0),s.push(...o)}return s}function ad(n,e,t,s=!0){const r=[];s?r.push(n[0]/t):r.push(n[0]*t);for(let o=1;o<n.length;++o)o<=e.length?s?r.push(e[o-1]*n[o]):r.push(n[o]/e[o-1]):r.push(n[o]);return r}function Tb(n,e){const t=[0];for(let s=0;s<e;++s)t.push(n[s][0]);return t}function Nb(n,e,t){const s=n.slice(0,1);for(let r=0;r<t;++r)s.push(n[r+1]-e[r][0]-e[r][1]);return s}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zg=1.7580993408473768,Vg=1.0507009873554805;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ib=.3275911,$b=.254829592,Eb=-.284496736,Rb=1.421413741,Db=-1.453152027,Ab=1.061405429;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Oo(n,e){if(n.length!==e.length)throw new Error(`Cannot merge real and imag arrays of different lengths. real:${n.length}, imag: ${e.length}.`);const t=new Float32Array(n.length*2);for(let s=0;s<t.length;s+=2)t[s]=n[s/2],t[s+1]=e[s/2];return t}function iD(n){const e=new Float32Array(n.length/2),t=new Float32Array(n.length/2);for(let s=0;s<n.length;s+=2)e[s/2]=n[s],t[s/2]=n[s+1];return{real:e,imag:t}}function aD(n){const e=Math.ceil(n.length/4),t=new Float32Array(e),s=new Float32Array(e);for(let r=0;r<n.length;r+=4)t[Math.floor(r/4)]=n[r],s[Math.floor(r/4)]=n[r+1];return{real:t,imag:s}}function lD(n){const e=Math.floor(n.length/4),t=new Float32Array(e),s=new Float32Array(e);for(let r=2;r<n.length;r+=4)t[Math.floor(r/4)]=n[r],s[Math.floor(r/4)]=n[r+1];return{real:t,imag:s}}function Ob(n,e){const t=n[e*2],s=n[e*2+1];return{real:t,imag:s}}function uD(n,e,t,s){n[s*2]=e,n[s*2+1]=t}function cD(n,e){const t=new Float32Array(n/2),s=new Float32Array(n/2);for(let r=0;r<Math.ceil(n/2);r++){const o=(e?2:-2)*Math.PI*(r/n);t[r]=Math.cos(o),s[r]=Math.sin(o)}return{real:t,imag:s}}function hD(n,e,t){const s=(t?2:-2)*Math.PI*(n/e),r=Math.cos(s),o=Math.sin(s);return{real:r,imag:o}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dx="->",X6=/->/g,_N=",",FN="...";function _b(n,e){n=n.replace(/\s/g,"");const t=(n.length-n.replace(X6,"").length)/dx.length;if(t<1)throw new Error("Equations without an arrow are not supported.");if(t>1)throw new Error(`Equation must contain exactly one arrow ("${dx}").`);const[s,r]=n.split(dx);L(s.indexOf(FN)===-1,()=>`The ellipsis notation ("${FN}") is not supported yet.`);const o=s.split(_N),i=o.length;if(e!==i)throw new Error(`Expected ${i} input tensors, received ${e}`);if(i>2)throw new Error("Support for more than 2 input tensors is not implemented yet.");const a=[];for(let f=0;f<r.length;++f){const m=r[f];if(!o.some(y=>y.indexOf(m)!==-1))throw new Error(`Output subscripts contain the label ${m} not present in the input subscripts.`);a.indexOf(m)===-1&&a.push(m)}for(let f=0;f<s.length;++f){const m=s[f];a.indexOf(m)===-1&&m!==_N&&a.push(m)}const l=new Array(o.length);for(let f=0;f<i;++f){if(new Set(o[f].split("")).size!==o[f].length)throw new Error(`Found duplicate axes in input component ${o[f]}. Support for duplicate axes in input is not implemented yet.`);l[f]=[];for(let m=0;m<o[f].length;++m)l[f].push(a.indexOf(o[f][m]))}const u=a.length,h=r.length,p=[];for(let f=h;f<u;++f)p.push(f);return{allDims:a,summedDims:p,idDims:l}}function Fb(n,e){let t=new Array(n);t.fill(-1);for(let r=0;r<e.length;++r)t[e[r]]=r;const s=[];for(let r=0;r<n;++r)t[r]===-1&&s.push(r);return t=t.filter(r=>r!==-1),{permutationIndices:t,expandDims:s}}function Pb(n,e,t){const s=new Array(n);for(let r=0;r<t.length;++r){const o=t[r].shape;for(let i=0;i<e[r].length;++i)s[e[r][i]]===void 0?s[e[r][i]]=o[i]:L(s[e[r][i]]===o[i],()=>`Expected dimension ${s[e[r][i]]} at axis ${i} of input shaped ${JSON.stringify(o)}, but got dimension ${o[i]}`)}}function Lb(n,e){const t=n,s=[];let r=0;n.length===0&&t.push(-1),r=n.length+1;for(let i=0;i<r;++i)s.push([]);const o=[];for(let i=0;i<t.length;++i){const a=t[i],l=Y6(e,a);for(const u of l)o.indexOf(u)===-1&&(s[i].push(u),o.push(u))}return{path:t,steps:s}}function Mb(n){return n.every((e,t)=>e===t)}function Y6(n,e){const t=[];for(let s=0;s<n.length;++s)(n[s].length===0||n[s].indexOf(e)!==-1||e===-1)&&t.push(s);return t}function zb(n,e,t=0){let s=[];if(typeof e=="number")L(n.shape[t]%e===0,()=>"Number of splits must evenly divide the axis."),s=new Array(e).fill(n.shape[t]/e);else{const r=e.reduce((i,a)=>(a===-1&&(i+=1),i),0);L(r<=1,()=>"There should be only one negative value in split array.");const o=e.indexOf(-1);if(o!==-1){const i=e.reduce((a,l)=>l>0?a+l:a);e[o]=n.shape[t]-i}L(n.shape[t]===e.reduce((i,a)=>i+a),()=>"The sum of sizes must match the size of the axis dimension."),s=e}return s}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dD(n){return`Received SparseTensor with denseShape[0] = 0 but
  indices.shape[0] = ${n}`}function pD(n,e){return`indices(${n}, 0) is invalid: ${e} < 0`}function fD(n,e,t){return`indices(${n}, 0) is invalid: ${e} >= ${t}`}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mD(n,e){return`only one output dimension may be -1, not both ${n} and ${e}`}function gD(n,e){return`size ${n} must be non-negative, not ${e}`}function yD(){return"reshape cannot infer the missing input size for an empty tensor unless all specified input sizes are non-zero"}function xD(n,e){const t=fe(n),s=fe(e);return`Input to reshape is a SparseTensor with ${t}
  dense values, but the requested shape requires a multiple of ${s}. inputShape=${n} outputShape= ${e}`}function vD(n,e){const t=fe(n),s=fe(e);return`Input to reshape is a tensor with ${t} dense values, but the requested shape has ${s}. inputShape=${n} outputShape=${e}`}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yv(){return"segment ids must be >= 0"}function wD(){return"segment ids are not increasing"}function bD(n,e){return`Segment id ${n} out of range [0, ${e}), possibly because segmentIds input is not sorted.`}function SD(n,e,t){return`Bad: indices[${n}] == ${e} out of range [0, ${t})`}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Q6(n,e){let t=!1,s;for(n<=Cb?(s=n,t=!0):s=Yx(n,Math.floor(Math.sqrt(n)));!t;)s>e||s===n?t=!0:s=Yx(n,s+1);return s}function Z6(n,e,t){const s=[],r=n.length;for(let o=0;o<r;o++)o!==e?s.push(n[o]):s.push(t);return s}function CD(n,e,t,s){const r=e.shape.length,o=n.shape.length;if(s!==0&&(s<-r||s>r))throw new Error(`Expect batchDims in the range of [-${r}, ${r}], but got ${s}`);if(s<0&&(s+=r),s>o)throw new Error(`batchDims (${s}) must be less than rank(x) (
    ${o}).`);if(t<s)throw new Error(`batchDims (${s}) must be less than or equal to axis (${t}).`);for(let p=0;p<s;++p)if(n.shape[p]!==e.shape[p])throw new Error(`x.shape[${p}]: ${n.shape[p]} should be equal to indices.shape[${p}]: ${e.shape[p]}.`);const i=n.shape[t],a=[];let l=1,u=1,h=1;for(let p=0;p<s;++p)a.push(n.shape[p]),l*=n.shape[p];for(let p=s;p<t;p++)a.push(n.shape[p]),u*=n.shape[p];for(let p=s;p<r;p++)a.push(e.shape[p]);for(let p=t+1;p<o;p++)a.push(n.shape[p]),h*=n.shape[p];return{batchSize:l,sliceSize:h,outerSize:u,dimSize:i,outputShape:a}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _o(n){try{return n.map(e=>vi(e))}catch(e){throw new Error(`Failed to decode encoded string bytes into utf-8, error: ${e}`)}}function kD(n){return n.map(e=>gi(e))}const J6=Object.freeze(Object.defineProperty({__proto__:null,ERF_A1:$b,ERF_A2:Eb,ERF_A3:Rb,ERF_A4:Db,ERF_A5:Ab,ERF_P:Ib,PARALLELIZE_THRESHOLD:Cb,get RowPartitionType(){return Or},SELU_SCALE:Vg,SELU_SCALEALPHA:zg,applyActivation:Pg,assertAndGetBroadcastShape:Ze,assertAxesAreInnerMostDims:Mn,assertParamsConsistent:Sb,assignToTypedArray:uD,axesAreInnerMostDims:U1,calculateShapes:Ua,checkEinsumDimSizes:Pb,checkPadOnDimRoundingMode:os,combineLocations:sR,combineRaggedTensorToTensorShapes:nD,complexWithEvenIndex:aD,complexWithOddIndex:lD,computeConv2DInfo:Nn,computeConv3DInfo:Li,computeDefaultPad:F1,computeDilation2DInfo:Zh,computeOptimalWindowSize:Mg,computeOutAndReduceShapes:In,computeOutShape:to,computePool2DInfo:yr,computePool3DInfo:Lo,convertConv2DDataFormat:Mo,decodeEinsumEquation:_b,eitherStridesOrDilationsAreOne:Ln,expandShapeToKeepDim:Zt,exponent:hD,exponents:cD,fromStringArrayToUint8:kD,fromUint8ToStringArray:_o,getAxesPermutation:zt,getBroadcastDims:Xl,getComplexWithIndex:Ob,getEinsumComputePath:Lb,getEinsumPermutation:Fb,getFusedBiasGradient:Fg,getFusedDyActivation:_g,getImageCenter:kb,getInnerMostAxes:Jt,getPermuted:id,getRaggedRank:rD,getReductionAxes:xn,getReshaped:od,getReshapedPermuted:ad,getRowPartitionTypesHelper:sD,getSliceBeginCoords:Tb,getSliceSize:Nb,getSparseFillEmptyRowsIndicesDenseShapeMismatch:dD,getSparseFillEmptyRowsNegativeIndexErrorMessage:pD,getSparseFillEmptyRowsOutOfRangeIndexErrorMessage:fD,getSparseReshapeEmptyTensorZeroOutputDimErrorMessage:yD,getSparseReshapeInputOutputMismatchErrorMessage:vD,getSparseReshapeInputOutputMultipleErrorMessage:xD,getSparseReshapeMultipleNegativeOneOutputDimErrorMessage:mD,getSparseReshapeNegativeOutputDimErrorMessage:gD,getSparseSegmentReductionIndicesOutOfRangeErrorMessage:SD,getSparseSegmentReductionNegativeSegmentIdsErrorMessage:yv,getSparseSegmentReductionNonIncreasingSegmentIdsErrorMessage:wD,getSparseSegmentReductionSegmentIdOutOfRangeErrorMessage:bD,getUndoAxesPermutation:Mi,isIdentityPermutation:Mb,mergeRealAndImagArrays:Oo,prepareAndValidate:wb,prepareSplitSize:zb,shouldFuse:Lg,splitRealAndImagArrays:iD,stridesOrDilationsArePositive:$a,tupleValuesAreOne:Si,upcastType:Ds,validateDefaultValueShape:oD,validateInput:ab,validateUpdateShape:CR,warn:Us},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */T6();/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const TD={kernelName:dm,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>H(n,pu(Ne(t,"float32"),-1))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const e5={kernelName:nh,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>{const s=Ct(Ne(t,"float32")),r=Pn(Ee(We(1),s));return Rt(Ae(n,r))}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const t5={kernelName:sh,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>{const s=Pn(Ee(Ct(Ne(t,"float32")),1));return Ae(n,s)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const n5={kernelName:cu,inputsToSave:["a","b"],gradFunc:(n,e)=>{const[t,s]=e,r=Ze(t.shape,s.shape);return{a:()=>{let a=n;const l=xn(t.shape,r);return l.length>0&&(a=_e(a,l)),X(a,t.shape)},b:()=>{let a=n;const l=xn(s.shape,r);return l.length>0&&(a=_e(a,l)),X(a,s.shape)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const s5={kernelName:pm,saveAllInputs:!0,gradFunc:(n,e)=>{const t={};return e.forEach((s,r)=>{t[r]=()=>n.clone()}),t}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const r5={kernelName:fm,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>dt(t)}}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const o5={kernelName:mm,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>dt(t)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const i5={kernelName:rh,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>Ae(n,Pn(Ee(We(1),Ct(Ne(t,"float32")))))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const a5={kernelName:oh,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>{const s=Pn(ye(We(1),Ct(Ne(t,"float32"))));return Ae(n,s)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const l5={kernelName:lh,inputsToSave:["a","b"],gradFunc:(n,e)=>{const[t,s]=e,r=Ze(t.shape,s.shape);return{a:()=>{const a=ye(Ct(t),Ct(s));let l=H(n,Ae(s,a));const u=xn(t.shape,r);return u.length>0&&(l=_e(l,u)),X(l,t.shape)},b:()=>{const a=ye(Ct(t),Ct(s));let l=Rt(H(n,Ae(t,a)));const u=xn(s.shape,r);return u.length>0&&(l=_e(l,u)),X(l,s.shape)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const u5={kernelName:ih,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>Ae(n,ye(Ct(Ne(t,"float32")),1))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const c5={kernelName:ah,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>Ae(n,Ee(We(1),Ct(Ne(t,"float32"))))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function h5(n,e,t,s,r,o){const i=M(n,"dy","avgPool3dGrad"),a=M(e,"input","avgPool3dGrad");let l=i,u=a,h=!1;a.rank===4&&(h=!0,l=X(i,[1,i.shape[0],i.shape[1],i.shape[2],i.shape[3]]),u=X(a,[1,a.shape[0],a.shape[1],a.shape[2],a.shape[3]])),L(l.rank===5,()=>`Error in avgPool3dGrad: dy must be rank 5 but got rank ${l.rank}.`),L(u.rank===5,()=>`Error in avgPool3dGrad: input must be rank 5 but got rank ${u.rank}.`),os("avgPool3dGrad",r,o);const p={dy:l,input:u},f={filterSize:t,strides:s,pad:r,dimRoundingMode:o},m=K.runKernel($w,p,f);return h?X(m,[m.shape[1],m.shape[2],m.shape[3],m.shape[4]]):m}const d5=j({avgPool3dGrad_:h5});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const p5={kernelName:ym,inputsToSave:["x"],gradFunc:(n,e,t)=>{const[s]=e,{filterSize:r,strides:o,pad:i,dimRoundingMode:a}=t;return{x:()=>d5(n,s,r,o,i,a)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function f5(n,e,t,s,r){const o=M(n,"dy","avgPoolGrad"),i=M(e,"input","avgPoolGrad");L(i.rank===o.rank,()=>`Rank of input (${i.rank}) does not match rank of dy (${o.rank})`);let a=i,l=o,u=!1;i.rank===3&&(u=!0,a=X(i,[1,i.shape[0],i.shape[1],i.shape[2]]),l=X(o,[1,o.shape[0],o.shape[1],o.shape[2]])),L(l.rank===4,()=>`Error in avgPoolGrad: dy must be rank 4 but got rank ${l.rank}.`),L(a.rank===4,()=>`Error in avgPoolGrad: input must be rank 4 but got rank ${a.rank}.`);const h={dy:l,input:a},p={filterSize:t,strides:s,pad:r},f=K.runKernel(Iw,h,p);return u?X(f,[f.shape[1],f.shape[2],f.shape[3]]):f}const m5=j({avgPoolGrad_:f5});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const g5={kernelName:gm,inputsToSave:["x"],gradFunc:(n,e,t)=>{const[s]=e,{filterSize:r,strides:o,pad:i}=t;return{x:()=>m5(n,s,r,o,i)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const y5={kernelName:xm,inputsToSave:["a","b"],gradFunc:(n,e,t)=>{const[s,r]=e,{transposeA:o,transposeB:i}=t;return!o&&!i?{a:()=>lt(n,r,!1,!0),b:()=>lt(s,n,!0,!1)}:!o&&i?{a:()=>lt(n,r,!1,!1),b:()=>lt(n,s,!0,!1)}:o&&!i?{a:()=>lt(r,n,!1,!0),b:()=>lt(s,n,!1,!1)}:{a:()=>lt(r,n,!0,!0),b:()=>lt(n,s,!0,!0)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const x5={kernelName:vm,gradFunc:(n,e,t)=>{const{blockShape:s,crops:r}=t;return{x:()=>Ng(n,s,r)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const v5={kernelName:VV,gradFunc:(n,e,t)=>{const s=t,r=s.inputShape,o=s.shape,i=Array.from(o);for(let l=r.length-1;l>=0;l--)if(r[l]===o[l])i[l]=1;else if(r[l]!==1)throw new Error(`broadcastTo(): [${r}] cannot be broadcast to [${o}].`);const a=[];for(let l=0;l<i.length;l++)i[l]>1&&a.push(l);return{x:()=>_e(n,a,!0)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const w5={kernelName:uh,gradFunc:n=>({x:()=>n.clone()})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const b5={kernelName:ch,gradFunc:n=>({x:()=>dt(n)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const S5={kernelName:hh,inputsToSave:["x"],gradFunc:(n,e,t)=>{const[s]=e,{clipValueMin:r,clipValueMax:o}=t;return{x:()=>Hn(ao(zi(s,r),Ba(s,o)),n,dt(n))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const C5={kernelName:bm,inputsToSave:["x"],gradFunc:TD.gradFunc};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const k5={kernelName:Sm,saveAllInputs:!0,gradFunc:(n,e,t)=>{const s=e.map(l=>l.shape),{axis:r}=t,o=it(r,e[0].shape)[0],i=s.map(l=>l[o]);return Rs(n,i,o).map(l=>()=>l)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const T5={kernelName:Cm,inputsToSave:["x","filter"],gradFunc:(n,e,t)=>{const[s,r]=e,{dilations:o,strides:i,pad:a,dataFormat:l}=t;return L(Si(o),()=>`Error in gradient of conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${o}'`),{x:()=>M1(s.shape,n,r,i,a,l),filter:()=>db(s,n,r.shape,i,a,l)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const N5={kernelName:km,inputsToSave:["dy","filter"],gradFunc:(n,e,t)=>{const[s,r]=e,{strides:o,pad:i,dataFormat:a,dimRoundingMode:l}=t;return{dy:()=>Ci(n,r,o,i,a,1,l),filter:()=>db(n,s,r.shape,o,i,a,l)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function I5(n,e,t,s,r){let o=n;n.rank===4&&(o=X(n,[1,n.shape[0],n.shape[1],n.shape[2],n.shape[3]]));let i=e;i.rank===4&&(i=X(e,[1,e.shape[0],e.shape[1],e.shape[2],e.shape[3]])),L(o.rank===5,()=>`Error in conv3dDerFilter: input must be rank 5, but got shape ${o.shape}.`),L(i.rank===5,()=>`Error in conv3dDerFilter: dy must be rank 5, but got shape ${i.shape}.`),L(t.length===5,()=>`Error in conv3dDerFilter: filterShape must be length 5, but got ${t}.`),L(o.shape[4]===t[3],()=>`Error in conv3dDerFilter: depth of input ${o.shape[4]}) must match input depth in filter (${t[3]}.`),L(i.shape[4]===t[4],()=>`Error in conv3dDerFilter: depth of dy (${i.shape[4]}) must match output depth for filter (${t[4]}).`);const a={x:o,dy:i},l={strides:s,pad:r,filterShape:t};return K.runKernel(Ow,a,l)}const $5=j({conv3DBackpropFilter_:I5});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const E5={kernelName:Tm,inputsToSave:["x","filter"],gradFunc:(n,e,t)=>{const{dilations:s,strides:r,pad:o}=t;L(Si(s),()=>`Error in gradient of conv3D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${s}'`);const[i,a]=e;return{x:()=>QE(i.shape,n,a,r,o),filter:()=>$5(i,n,a.shape,r,o)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const R5={kernelName:dh,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>H(Rt(nb(Ne(t,"float32"))),n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const D5={kernelName:ph,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>H(sb(Ne(t,"float32")),n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const A5={kernelName:Nm,inputsToSave:["x"],gradFunc:(n,e,t)=>{const[s]=e,{axis:r,exclusive:o,reverse:i}=t;return{x:()=>{const a=zt([r],s.rank);let l=B1(n,r,o,!i);return a!=null&&(l=ht(l,a)),l}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const O5={kernelName:Im,inputsToSave:["x","filter"],gradFunc:(n,e,t)=>{const{dilations:s,strides:r,pad:o,dimRoundingMode:i}=t,a=s??[1,1];L(Si(a),()=>`Error in gradient of depthwiseConv2dNative: dilation rates greater than 1 are not yet supported. Got dilations '${a}'`);const[l,u]=e;return L(l.rank===4,()=>`Error in gradient of depthwiseConv2dNative: input must be rank 4, but got rank ${l.rank}.`),L(u.rank===4,()=>`Error in gradient of depthwiseConv2dNative: filter must be rank 4, but got rank ${u.rank}.`),L(l.shape[3]===u.shape[2],()=>`Error in gradient of depthwiseConv2d: number of input channels (${l.shape[3]}) must match the inChannels dimension in filter ${u.shape[2]}.`),L(Ln(r,a),()=>`Error in gradient of depthwiseConv2d: Either strides or dilations must be  1. Got strides ${r} and dilations '${a}'.`),os("depthwiseConv2d",o,i),{x:()=>AR(l.shape,n,u,r,o,a,i),filter:()=>DR(l,n,u.shape,r,o,a,i)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _5={kernelName:$m,inputsToSave:["x","filter"],gradFunc:(n,e,t)=>{const[s,r]=e,o={x:s,filter:r,dy:n},i={x:s,filter:r,dy:n};return{x:()=>K.runKernel(Qx,o,t),filter:()=>K.runKernel(Zx,i,t)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const F5={kernelName:mh,outputsToSave:[!0],gradFunc:(n,e)=>{const[t]=e,s={dy:n,y:t};return{x:()=>K.runKernel(Uw,s)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const P5={kernelName:gh,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e,s=H(Os(Rt(Ct(t))),2/Math.sqrt(Math.PI));return{x:()=>H(n,s)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const L5={kernelName:yh,outputsToSave:[!0],gradFunc:(n,e)=>{const[t]=e;return{x:()=>H(n,t)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const M5={kernelName:Rm,inputsToSave:["input"],gradFunc:(n,e)=>{const[t]=e;return{input:()=>X(n,t.shape)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const z5={kernelName:xh,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>H(n,Os(t))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const V5={kernelName:vh,gradFunc:n=>({x:()=>dt(n)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const B5={kernelName:wh,inputsToSave:["a","b"],gradFunc:(n,e)=>{const[t,s]=e,r=Ze(t.shape,s.shape);return{a:()=>{const a=Ae(n,Ne(s,"float32")),l=xn(t.shape,r);return l.length>0?X(_e(a,l),t.shape):a},b:()=>{let a=H(n,Ne(t,"float32"));const l=xn(s.shape,r);l.length>0&&(a=X(_e(a,l),s.shape));const u=Ct(s);return Rt(Ae(a,Ne(u,"float32")))}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const W5={kernelName:Dm,inputsToSave:["x","mean","variance","scale"],gradFunc:(n,e,t)=>{const{varianceEpsilon:s}=t,[r,o,i,a]=e,l=a??We(1),u=xn(o.shape,r.shape),h=[];if(o.rank===1){for(let T=0;T<r.shape.length-1;++T)h.push(r.shape[T]);h.push(1)}const p=Ee(r,o),f=H(n,l),m=J1(ye(i,We(s))),y=H(H(H(m,m),m),We(-.5));return{x:()=>o.rank===1?X(H(H(n,ir(X(m,[1,1,1,o.shape[0]]),h)),l),r.shape):X(H(H(n,m),l),r.shape),mean:()=>{let T=H(H(m,We(-1)),f);return o.rank===1&&(T=_e(T,u)),X(T,o.shape)},variance:()=>{let T=H(H(y,p),f);return o.rank===1&&(T=_e(T,u)),X(T,o.shape)},scale:()=>{const T=H(p,m);let I=H(n,T);return o.rank===1&&(I=_e(I,u)),X(I,o.shape)},offset:()=>{let T=n;return o.rank===1&&(T=_e(T,u)),X(T,o.shape)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const U5={kernelName:Am,inputsToSave:["x","indices"],gradFunc:(n,e,t)=>{const[s,r]=e,{axis:o,batchDims:i}=t,a=it(o,s.shape)[0],l=(u,h,p)=>()=>{const f=u.shape,m=h.size,y=f.slice(0,a),x=y.length,v=f.slice(o,f.length).slice(1),w=v.length,S=PN(0,x),k=PN(x+1,x+1+w),T=LN([y,[m],v]),I=X(p,T),E=X(h,[m]),D=LN([[x],S,k]),O=ht(I,D);let _=ub(O,E,u.shape[a]);const P=Mi(D);return _=ht(_,P),_};if(i===1){const u=s.shape[0],h=s.split(u,0);return{x:()=>_s(h.map((m,y)=>l(m,r.slice(y,1),n.slice(y,1))())).reshape(s.shape),indices:()=>r}}else return{x:l(s,r,n),indices:()=>r}}};function PN(n,e){const t=[];for(let s=n;s<e;++s)t.push(s);return t}function LN(n){const e=[];for(let t=0;t<n.length;++t)for(let s=0;s<n[t].length;++s)e.push(n[t][s]);return e}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const G5={kernelName:bh,inputsToSave:["a","b"],gradFunc:(n,e)=>{const[t,s]=e;return{a:()=>dt(t),b:()=>dt(s)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const j5={kernelName:Sh,gradFunc:n=>({x:()=>Ne(n,"float32")})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const H5={kernelName:Ch,gradFunc:n=>({x:()=>dt(n)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const K5={kernelName:kh,gradFunc:n=>({x:()=>dt(n)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const q5={kernelName:Th,gradFunc:n=>({x:()=>dt(n)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const X5={kernelName:_m,inputsToSave:["x"],gradFunc:(n,e,t)=>{const[s]=e,{alpha:r}=t,o=Ms(s,0);return{x:()=>Hn(o,n,H(n,r))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Y5={kernelName:Ih,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>Ae(n,ye(t,1))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Q5={kernelName:Nh,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>Ae(n,Ne(t,"float32"))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Z5={kernelName:WV,inputsToSave:[],outputsToSave:[!0],gradFunc:(n,e,t)=>{const[s]=e,{axis:r}=t;return{logits:()=>{const i=Os(s);return Ee(n,H(_e(n,r,!0),i))}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function J5(n,e,t,s=5,r=1,o=1,i=.5){const a={x:n,y:e,dy:t},l={depthRadius:s,bias:r,alpha:o,beta:i};return K.runKernel(Qw,a,l)}const eK=j({localResponseNormalizationBackprop_:J5});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tK={kernelName:Vm,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(n,e,t)=>{const[s,r]=e,{depthRadius:o,bias:i,alpha:a,beta:l}=t;return{x:()=>eK(s,r,n,o,i,a,l)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ND(n,e,t,s){return e.rank<t.rank&&(e=X(e,Zt(e.shape,s))),n.rank<t.rank&&(n=X(n,Zt(n.shape,s))),{x:()=>H(n,Ne(Lr(t,e),n.dtype))}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const MN={kernelName:Bm,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(n,e,t)=>{const s=t,{reductionIndices:r}=s,o=e[0],i=e[1],a=it(r,o.shape),l=ND(n,i,o,a);return{x:()=>l.x()}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nK={kernelName:$h,inputsToSave:["a","b"],gradFunc:(n,e)=>{const[t,s]=e;return{a:()=>H(n,Ne(zi(t,s),"float32")),b:()=>H(n,Ne(_c(t,s),"float32"))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sK(n,e,t,s,r,o,i){const a=M(n,"dy","maxPool3dGrad"),l=M(e,"input","maxPool3dGrad"),u=M(t,"output","maxPool3dGrad");let h=a,p=l,f=u,m=!1;l.rank===4&&(m=!0,h=X(a,[1,a.shape[0],a.shape[1],a.shape[2],a.shape[3]]),p=X(l,[1,l.shape[0],l.shape[1],l.shape[2],l.shape[3]]),f=X(u,[1,u.shape[0],u.shape[1],u.shape[2],u.shape[3]])),L(h.rank===5,()=>`Error in maxPool3dGrad: dy must be rank 5 but got rank ${h.rank}.`),L(p.rank===5,()=>`Error in maxPool3dGrad: input must be rank 5 but got rank ${p.rank}.`),L(f.rank===5,()=>`Error in maxPool3dGrad: output must be rank 5 but got rank ${f.rank}.`),os("maxPool3dGrad",o,i);const y={dy:h,input:p,output:f},x={filterSize:s,strides:r,pad:o,dimRoundingMode:i},v=K.runKernel(Jw,y,x);return m?X(v,[v.shape[1],v.shape[2],v.shape[3],v.shape[4]]):v}const rK=j({maxPool3dGrad_:sK});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const oK={kernelName:Um,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(n,e,t)=>{const[s,r]=e,{filterSize:o,strides:i,pad:a,dimRoundingMode:l}=t;return{x:()=>rK(n,s,r,o,i,a,l)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iK(n,e,t,s,r,o,i){const a=M(n,"dy","maxPoolGrad"),l=M(e,"input","maxPoolGrad"),u=M(t,"output","maxPoolGrad");L(l.rank===a.rank,()=>`Rank of input (${l.rank}) does not match rank of dy (${a.rank})`),L(a.rank===4,()=>`Error in maxPoolGrad: dy must be rank 4 but got rank ${a.rank}.`),L(l.rank===4,()=>`Error in maxPoolGrad: input must be rank 4 but got rank ${l.rank}.`),os("maxPoolGrad",o,i);const h={dy:a,input:l,output:u},p={filterSize:s,strides:r,pad:o,dimRoundingMode:i};return K.runKernel(Zw,h,p)}const aK=j({maxPoolGrad_:iK});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lK={kernelName:Wm,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(n,e,t)=>{const[s,r]=e,{filterSize:o,strides:i,pad:a}=t;return{x:()=>aK(n,s,r,o,i,a)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const uK={kernelName:Gm,inputsToSave:["x"],gradFunc:(n,e,t)=>{const[s]=e,{axis:r}=t,o=it(r,s.shape),a=In(s.shape,o)[1],l=fe(a);return{x:()=>{const h=s.shape.slice();o.forEach(m=>{h[m]=1});const p=X(n,h);return Ae(H(p,$s(s.shape,"float32")),l)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cK={kernelName:jm,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(n,e,t)=>{const s=t,{axis:r}=s,[o,i]=e,a=it(r,o.shape),l=ND(n,i,o,a);return{x:()=>l.x()}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hK={kernelName:Eh,inputsToSave:["a","b"],gradFunc:(n,e)=>{const[t,s]=e;return{a:()=>H(n,Ne(Ba(t,s),"float32")),b:()=>H(n,Ne(Ms(t,s),"float32"))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dK={kernelName:Hm,inputsToSave:["x"],gradFunc:(n,e,t)=>{const s=e[0],{paddings:r}=t,o=r.map(i=>i[0]);return{x:()=>et(n,o,s.shape)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pK={kernelName:Rh,inputsToSave:["a","b"],gradFunc:(n,e)=>{const[t,s]=e,r=Ze(t.shape,s.shape);return{a:()=>{const a=xn(t.shape,r);return a.length>0?X(_e(n,a),t.shape):n},b:()=>{const a=H(n,Rt(sd(Ae(t,s)))),l=xn(s.shape,r);return l.length>0?X(_e(a,l),s.shape):a}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fK={kernelName:Dh,inputsToSave:["a","b"],gradFunc:(n,e)=>{const[t,s]=e,r=Ze(t.shape,s.shape);return{a:()=>{const a=H(n,Ne(s,"float32")),l=xn(t.shape,r);return l.length>0?X(_e(a,l),t.shape):a},b:()=>{const a=H(n,Ne(t,"float32")),l=xn(s.shape,r);return l.length>0?X(_e(a,l),s.shape):a}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mK={kernelName:Km,gradFunc:n=>({x:()=>Rt(n)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gK={kernelName:Ym,inputsToSave:["indices"],gradFunc:(n,e)=>{const t=e[0];return{indices:()=>dn(t.shape,"float32")}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yK={kernelName:Xm,gradFunc:n=>({x:()=>dt(n)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xK={kernelName:Qm,saveAllInputs:!0,gradFunc:(n,e,t)=>{const{axis:s}=t;return mr(n,s).map(o=>()=>o)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zN={kernelName:Zm,inputsToSave:["x"],gradFunc:(n,e,t)=>{const s=e[0],{paddings:r}=t,o=r.map(i=>i[0]);return{x:()=>et(n,o,s.shape)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vK={kernelName:Ah,inputsToSave:["a","b"],outputsToSave:[!0],gradFunc:(n,e)=>{const[t,s,r]=e,o=t,i=s,a=Ze(o.shape,i.shape);return{a:()=>{const h=Ne(i,"float32");let p=H(n,H(h,Ro(o,Ee(h,We(1)))));const f=xn(o.shape,a);return f.length>0&&(p=_e(p,f)),X(p,o.shape)},b:()=>{const h=Ms(o,0),p=Hn(h,js(o),dt(o));let f=H(n,H(r,p));const m=xn(i.shape,a);return m.length>0&&(f=_e(f,m)),X(f,i.shape)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wK={kernelName:Jm,inputsToSave:["x","alpha"],gradFunc:(n,e)=>{const[t,s]=e,r=Ms(t,0);return{x:()=>Hn(r,n,H(n,s)),alpha:()=>{let o=Hn(r,dt(n),H(n,t));const i=xn(s.shape,n.shape);return i.length>0&&(o=_e(o,i)),X(o,s.shape)}}}};/**
 * @license
 * Copyright 2022 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bK(n,e,t){const s=n.shape.slice();s[t]=1;const r=X(e,s),o=Af(n,t,!0,!1),i=Af(n,t,!0,!0),a=H(o,i);return H(r,a)}function SK(n,e,t){const s=n.shape.length,r=s-t.length,o=zt(t,s);let i=n;o!=null&&(i=ht(n,o));const a=i.shape.slice(),u=a.splice(s-t.length,t.length).reduce((f,m)=>f*m,1);a.push(u);const h=i.reshape(a);let p=bK(h,e,r);if(p=p.reshape(i.shape),o!=null){const f=Mi(o);p=ht(p,f)}return p}const CK={kernelName:eg,inputsToSave:["x"],gradFunc:(n,e,t)=>{const[s]=e,{axis:r}=t;let o=[];return r==null?o=s.shape.map((i,a)=>a):typeof r=="number"?o=[r]:o=r,{x:()=>SK(s,n,o)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kK={kernelName:fh,inputsToSave:["a","b"],gradFunc:(n,e)=>{const[t,s]=e,r=Ze(t.shape,s.shape);return{a:()=>{const a=Ae(n,Ne(s,"float32")),l=xn(t.shape,r);return l.length>0?X(_e(a,l),t.shape):a},b:()=>{let a=H(n,Ne(t,"float32"));const l=xn(s.shape,r);l.length>0&&(a=X(_e(a,l),s.shape));const u=Ct(s);return Rt(Ae(a,Ne(u,"float32")))}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const TK={kernelName:Oh,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>Ae(n,Rt(Ct(t)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const NK={kernelName:Fh,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e,s=H(Ba(t,6),pu(t));return{x:()=>H(n,Ne(s,"float32"))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const IK={kernelName:_h,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>H(n,Ne(pu(t),"float32"))}}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $K={kernelName:tg,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>X(n,t.shape)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const EK={kernelName:sg,inputsToSave:["images"],gradFunc:(n,e,t)=>{const[s]=e,r={dy:n,images:s};return{images:()=>K.runKernel(h1,r,t)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const RK={kernelName:ng,inputsToSave:["images"],gradFunc:(n,e,t)=>{const[s]=e,r={dy:n,images:s};return{images:()=>K.runKernel(c1,r,t)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const DK={kernelName:rg,gradFunc:(n,e,t)=>{const{dims:s}=t,r=it(s,n.shape);return{x:()=>fr(n,r)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const AK={kernelName:Ph,gradFunc:n=>({x:()=>dt(n)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const OK={kernelName:Lh,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>Rt(Ae(n,H(Ro(t,1.5),2)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _K={kernelName:og,inputsToSave:["condition"],gradFunc:(n,e)=>{const[t]=e;return{condition:()=>Ne(dt(t),"float32"),t:()=>H(n,Ne(t,n.dtype)),e:()=>H(n,Ne(Cg(t),n.dtype))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const FK={kernelName:Mh,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>{const s=Ms(t,We(0)),r=We(zg),o=We(Vg),i=H(n,o),a=H(H(n,r),Os(Ne(t,"float32")));return Hn(s,i,a)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const PK={kernelName:Wh,outputsToSave:[!0],gradFunc:(n,e)=>{const[t]=e;return{x:()=>H(n,H(t,Ee(We(1),t)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const LK={kernelName:Bh,gradFunc:n=>({x:()=>dt(n)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const MK={kernelName:zh,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>H(xg(Ne(t,"float32")),n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zK={kernelName:Vh,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>H(V1(Ne(t,"float32")),n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const VK={kernelName:ig,inputsToSave:["x"],gradFunc:(n,e,t)=>{const[s]=e,{begin:r,size:o}=t,i=s.shape,[a,l]=bb(s,r,o),u=[];for(let h=0;h<n.rank;h++)u.push([a[h],i[h]-a[h]-l[h]]);return{x:()=>Vi(n,u)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const BK={kernelName:cg,outputsToSave:[!0],gradFunc:(n,e,t)=>{const[s]=e,{dim:r}=t,o=!0,i=H(n,s);return{logits:()=>Ee(i,H(_e(i,[r],o),s))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const WK={kernelName:Uh,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>H(n,Fr(t))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const VN={kernelName:lg,gradFunc:(n,e,t)=>{const{blockShape:s,paddings:r}=t;return{x:()=>yg(n,s,r)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const BN={kernelName:ug,gradFunc:(n,e,t)=>{const{axis:s}=t;return{x:()=>on(n,s)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const UK={kernelName:Gh,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>Ae(n,H(Pn(Ne(t,"float32")),2))}}};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const GK={kernelName:w1,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>H(n,H(Ne(t,"float32"),2))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jK={kernelName:jh,inputsToSave:["a","b"],gradFunc:(n,e)=>{const[t,s]=e,r=We(2);return{a:()=>H(n,H(r,Ee(t,s))),b:()=>H(n,H(r,Ee(s,t)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const HK={kernelName:Yh,gradFunc:n=>({x:()=>dt(n)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const KK={kernelName:Hh,inputsToSave:["a","b"],gradFunc:(n,e)=>{const[t,s]=e,r=Ze(t.shape,s.shape);return{a:()=>{let a=n;const l=xn(t.shape,r);return l.length>0&&(a=_e(a,l)),X(a,t.shape)},b:()=>{let a=n;const l=xn(s.shape,r);return l.length>0&&(a=_e(a,l)),X(Rt(a),s.shape)}}}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qK={kernelName:ag,inputsToSave:["x"],gradFunc:(n,e,t)=>{const[s]=e,r=s.shape.slice(),{axis:o}=t;it(o,s.shape).forEach(u=>{r[u]=1});const a=X(n,r),l=H(a,$s(s.shape,"float32"));return{x:()=>l}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const XK={kernelName:Kh,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>Ae(n,Ct(xg(t)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const YK={kernelName:qh,outputsToSave:[!0],gradFunc:(n,e)=>{const[t]=e;return{x:()=>H(Ee(We(1),Ct(t)),n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const QK={kernelName:Xh,inputsToSave:["x"],gradFunc:(n,e,t)=>{const[s]=e,{reps:r}=t;return{x:()=>{let i=dt(s);if(s.rank===1)for(let a=0;a<r[0];++a)i=ye(i,et(n,[a*s.shape[0]],[s.shape[0]]));else if(s.rank===2)for(let a=0;a<r[0];++a)for(let l=0;l<r[1];++l)i=ye(i,et(n,[a*s.shape[0],l*s.shape[1]],[s.shape[0],s.shape[1]]));else if(s.rank===3)for(let a=0;a<r[0];++a)for(let l=0;l<r[1];++l)for(let u=0;u<r[2];++u)i=ye(i,et(n,[a*s.shape[0],l*s.shape[1],u*s.shape[2]],[s.shape[0],s.shape[1],s.shape[2]]));else if(s.rank===4)for(let a=0;a<r[0];++a)for(let l=0;l<r[1];++l)for(let u=0;u<r[2];++u)for(let h=0;h<r[3];++h)i=ye(i,et(n,[a*s.shape[0],l*s.shape[1],u*s.shape[2],h*s.shape[3]],[s.shape[0],s.shape[1],s.shape[2],s.shape[3]]));else throw new Error(`Gradient for tile operation is not implemented for rank-${s.rank} tensors yet.`);return i}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ZK={kernelName:Ll,gradFunc:(n,e,t)=>{const s=t,{perm:r}=s,o=Mi(r);return{x:()=>ht(n,o)}}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const JK={kernelName:dg,gradFunc:(n,e,t)=>{const s=t,{axis:r}=s;return{value:()=>_s(n,r)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const eq={kernelName:pg,inputsToSave:["segmentIds"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>tq(n,t)}}};function tq(n,e){const t=zo(e,dt(e)),s=rd(n,t);let r=zi(e,We(0,"int32"));const o=s.rank-r.rank;for(let a=0;a<o;++a)r=jn(r,a+1);r=ao(r,$s(s.shape,"bool"));const i=dt(s);return Hn(r,s,i)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nq={kernelName:fg,gradFunc:n=>({x:()=>dt(n)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sq=[TD,e5,t5,n5,s5,r5,o5,i5,a5,l5,u5,c5,p5,g5,y5,x5,v5,w5,b5,S5,C5,k5,N5,T5,E5,R5,D5,A5,O5,_5,kK,F5,P5,L5,M5,z5,B5,V5,W5,U5,G5,j5,H5,K5,q5,X5,Y5,Q5,Z5,tK,MN,MN,nK,oK,lK,uK,cK,hK,dK,pK,fK,mK,gK,yK,xK,zN,zN,vK,wK,CK,TK,NK,IK,$K,EK,RK,DK,AK,OK,_K,FK,PK,LK,MK,zK,VK,BK,WK,VN,VN,BN,BN,UK,jK,GK,HK,KK,qK,XK,YK,QK,ZK,JK,eq,nq];for(const n of sq)UV(n);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */me().prototype.abs=function(){return this.throwIfDisposed(),hn(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */me().prototype.acos=function(){return this.throwIfDisposed(),OE(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */me().prototype.acosh=function(){return this.throwIfDisposed(),_E(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */me().prototype.add=function(n){return this.throwIfDisposed(),ye(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */me().prototype.all=function(n,e){return this.throwIfDisposed(),_1(this,n,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */me().prototype.any=function(n,e){return this.throwIfDisposed(),Df(this,n,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */me().prototype.argMax=function(n){return this.throwIfDisposed(),ql(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */me().prototype.argMin=function(n){return this.throwIfDisposed(),FE(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */me().prototype.asScalar=function(){return this.throwIfDisposed(),L(this.size===1,()=>"The array must have only 1 element."),X(this,[])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */me().prototype.asType=function(n){return this.throwIfDisposed(),Ne(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */me().prototype.as1D=function(){return this.throwIfDisposed(),X(this,[this.size])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */me().prototype.as2D=function(n,e){return this.throwIfDisposed(),X(this,[n,e])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */me().prototype.as3D=function(n,e,t){return this.throwIfDisposed(),X(this,[n,e,t])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */me().prototype.as4D=function(n,e,t,s){return this.throwIfDisposed(),X(this,[n,e,t,s])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */me().prototype.as5D=function(n,e,t,s,r){return this.throwIfDisposed(),X(this,[n,e,t,s,r])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */me().prototype.asin=function(){return this.throwIfDisposed(),PE(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */me().prototype.asinh=function(){return this.throwIfDisposed(),LE(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */me().prototype.atan=function(){return this.throwIfDisposed(),ME(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */me().prototype.atan2=function(n){return this.throwIfDisposed(),zE(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */me().prototype.atanh=function(){return this.throwIfDisposed(),VE(this)};me().prototype.avgPool=function(n,e,t,s){return this.throwIfDisposed(),gg(this,n,e,t,s)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */me().prototype.batchToSpaceND=function(n,e){return this.throwIfDisposed(),yg(this,n,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */me().prototype.batchNorm=function(n,e,t,s,r){return this.throwIfDisposed(),Jh(this,n,e,t,s,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */me().prototype.broadcastTo=function(n){return this.throwIfDisposed(),Vl(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */me().prototype.cast=function(n){return this.throwIfDisposed(),Ne(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */me().prototype.ceil=function(){return this.throwIfDisposed(),HE(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */me().prototype.clipByValue=function(n,e){return this.throwIfDisposed(),As(this,n,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */me().prototype.concat=function(n,e){return this.throwIfDisposed(),n instanceof $t&&(n=[n]),on([this,...n],e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */me().prototype.conv1d=function(n,e,t,s,r,o){return this.throwIfDisposed(),L1(this,n,e,t,s,r,o)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */me().prototype.conv2dTranspose=function(n,e,t,s,r){return this.throwIfDisposed(),z1(this,n,e,t,s,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */me().prototype.conv2d=function(n,e,t,s,r,o){return this.throwIfDisposed(),Ci(this,n,e,t,s,r,o)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */me().prototype.cos=function(){return this.throwIfDisposed(),xg(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */me().prototype.cosh=function(){return this.throwIfDisposed(),V1(this)};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */me().prototype.cumprod=function(n,e,t){return this.throwIfDisposed(),Af(this,n,e,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */me().prototype.cumsum=function(n,e,t){return this.throwIfDisposed(),B1(this,n,e,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */me().prototype.depthToSpace=function(n,e){return this.throwIfDisposed(),JE(this,n,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */me().prototype.depthwiseConv2d=function(n,e,t,s,r,o){return this.throwIfDisposed(),ed(this,n,e,t,s,r,o)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */me().prototype.dilation2d=function(n,e,t,s,r){return this.throwIfDisposed(),eR(this,n,e,t,s,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */me().prototype.divNoNan=function(n){return this.throwIfDisposed(),tR(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */me().prototype.div=function(n){return this.throwIfDisposed(),Ae(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */me().prototype.dot=function(n){return this.throwIfDisposed(),nR(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */me().prototype.elu=function(){return this.throwIfDisposed(),td(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */me().prototype.equal=function(n){return this.throwIfDisposed(),Lr(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */me().prototype.erf=function(){return this.throwIfDisposed(),W1(this)};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */me().prototype.euclideanNorm=function(n,e){return this.throwIfDisposed(),oR(this,n,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */me().prototype.exp=function(){return this.throwIfDisposed(),Os(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */me().prototype.expandDims=function(n){return this.throwIfDisposed(),jn(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */me().prototype.expm1=function(){return this.throwIfDisposed(),iR(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */me().prototype.fft=function(){return this.throwIfDisposed(),Ag(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */me().prototype.flatten=function(){return this.throwIfDisposed(),X(this,[this.size])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */me().prototype.floor=function(){return this.throwIfDisposed(),sd(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */me().prototype.floorDiv=function(n){return this.throwIfDisposed(),O1(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */me().prototype.gather=function(n,e,t){return this.throwIfDisposed(),rd(this,n,e,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */me().prototype.greaterEqual=function(n){return this.throwIfDisposed(),zi(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */me().prototype.greater=function(n){return this.throwIfDisposed(),Ms(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */me().prototype.ifft=function(){return this.throwIfDisposed(),Lc(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */me().prototype.irfft=function(){return this.throwIfDisposed(),ob(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */me().prototype.isFinite=function(){return this.throwIfDisposed(),aR(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */me().prototype.isInf=function(){return this.throwIfDisposed(),lR(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */me().prototype.isNaN=function(){return this.throwIfDisposed(),uR(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */me().prototype.leakyRelu=function(n){return this.throwIfDisposed(),wg(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */me().prototype.lessEqual=function(n){return this.throwIfDisposed(),Ba(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */me().prototype.less=function(n){return this.throwIfDisposed(),_c(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */me().prototype.localResponseNormalization=function(n,e,t,s){return this.throwIfDisposed(),cR(this,n,e,t,s)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */me().prototype.logSigmoid=function(){return this.throwIfDisposed(),hR(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */me().prototype.logSoftmax=function(n){return this.throwIfDisposed(),j1(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */me().prototype.logSumExp=function(n,e){return this.throwIfDisposed(),Sg(this,n,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */me().prototype.log=function(){return this.throwIfDisposed(),js(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */me().prototype.log1p=function(){return this.throwIfDisposed(),bg(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */me().prototype.logicalAnd=function(n){return this.throwIfDisposed(),ao(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */me().prototype.logicalNot=function(){return this.throwIfDisposed(),Cg(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */me().prototype.logicalOr=function(n){return this.throwIfDisposed(),H1(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */me().prototype.logicalXor=function(n){return this.throwIfDisposed(),dR(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */me().prototype.matMul=function(n,e,t){return this.throwIfDisposed(),lt(this,n,e,t)};me().prototype.maxPool=function(n,e,t,s){return this.throwIfDisposed(),kg(this,n,e,t,s)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */me().prototype.max=function(n,e){return this.throwIfDisposed(),hr(this,n,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */me().prototype.maximum=function(n){return this.throwIfDisposed(),zo(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */me().prototype.mean=function(n,e){return this.throwIfDisposed(),Ut(this,n,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */me().prototype.min=function(n,e){return this.throwIfDisposed(),Oc(this,n,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */me().prototype.minimum=function(n){return this.throwIfDisposed(),Ra(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */me().prototype.mirrorPad=function(n,e){return this.throwIfDisposed(),fR(this,n,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */me().prototype.mod=function(n){return this.throwIfDisposed(),mR(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */me().prototype.mul=function(n){return this.throwIfDisposed(),H(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */me().prototype.neg=function(){return this.throwIfDisposed(),Rt(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */me().prototype.norm=function(n,e,t){return this.throwIfDisposed(),nd(this,n,e,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */me().prototype.notEqual=function(n){return this.throwIfDisposed(),Yl(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */me().prototype.oneHot=function(n,e=1,t=0){return this.throwIfDisposed(),q1(this,n,e,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */me().prototype.onesLike=function(){return this.throwIfDisposed(),Hs(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */me().prototype.pad=function(n,e){return this.throwIfDisposed(),Vi(this,n,e)};me().prototype.pool=function(n,e,t,s,r,o){return this.throwIfDisposed(),gR(this,n,e,t,s,r,o)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */me().prototype.pow=function(n){return this.throwIfDisposed(),Ro(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */me().prototype.prelu=function(n){return this.throwIfDisposed(),Ig(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */me().prototype.prod=function(n,e){return this.throwIfDisposed(),yR(this,n,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */me().prototype.reciprocal=function(){return this.throwIfDisposed(),xR(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */me().prototype.relu=function(){return this.throwIfDisposed(),ho(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */me().prototype.relu6=function(){return this.throwIfDisposed(),Q1(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */me().prototype.reshapeAs=function(n){return this.throwIfDisposed(),X(this,n.shape)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */me().prototype.reshape=function(n){return this.throwIfDisposed(),X(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */me().prototype.resizeBilinear=function(n,e,t){return this.throwIfDisposed(),FR(this,n,e,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */me().prototype.resizeNearestNeighbor=function(n,e,t){return this.throwIfDisposed(),PR(this,n,e,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */me().prototype.reverse=function(n){return this.throwIfDisposed(),fr(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */me().prototype.rfft=function(){return this.throwIfDisposed(),Og(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */me().prototype.round=function(){return this.throwIfDisposed(),Z1(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */me().prototype.rsqrt=function(){return this.throwIfDisposed(),J1(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */me().prototype.selu=function(){return this.throwIfDisposed(),eb(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */me().prototype.separableConv2d=function(n,e,t,s,r,o){return this.throwIfDisposed(),tb(this,n,e,t,s,r,o)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */me().prototype.sigmoid=function(){return this.throwIfDisposed(),Fr(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */me().prototype.sign=function(){return this.throwIfDisposed(),vR(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */me().prototype.sin=function(){return this.throwIfDisposed(),nb(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */me().prototype.sinh=function(){return this.throwIfDisposed(),sb(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */me().prototype.slice=function(n,e){return this.throwIfDisposed(),et(this,n,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */me().prototype.softmax=function(n){return this.throwIfDisposed(),Dg(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */me().prototype.softplus=function(){return this.throwIfDisposed(),du(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */me().prototype.spaceToBatchND=function(n,e){return this.throwIfDisposed(),Ng(this,n,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */me().prototype.split=function(n,e){return this.throwIfDisposed(),Rs(this,n,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */me().prototype.sqrt=function(){return this.throwIfDisposed(),Pn(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */me().prototype.square=function(){return this.throwIfDisposed(),Ct(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */me().prototype.squaredDifference=function(n){return this.throwIfDisposed(),ib(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */me().prototype.squeeze=function(n){return this.throwIfDisposed(),Ao(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */me().prototype.stack=function(n,e){this.throwIfDisposed();const t=n instanceof $t?[this,n]:[this,...n];return _s(t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */me().prototype.step=function(n){return this.throwIfDisposed(),pu(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */me().prototype.stridedSlice=function(n,e,t,s,r,o,i,a){return this.throwIfDisposed(),wR(this,n,e,t,s,r,o,i,a)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */me().prototype.sub=function(n){return this.throwIfDisposed(),Ee(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */me().prototype.sum=function(n,e){return this.throwIfDisposed(),_e(this,n,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */me().prototype.tan=function(){return this.throwIfDisposed(),bR(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */me().prototype.tanh=function(){return this.throwIfDisposed(),Ea(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */me().prototype.tile=function(n){return this.throwIfDisposed(),ir(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */me().prototype.toBool=function(){return this.throwIfDisposed(),Ne(this,"bool")};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */me().prototype.toFloat=function(){return this.throwIfDisposed(),Ne(this,"float32")};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */me().prototype.toInt=function(){return this.throwIfDisposed(),Ne(this,"int32")};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */me().prototype.topk=function(n,e){return this.throwIfDisposed(),kR(this,n,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */me().prototype.transpose=function(n){return this.throwIfDisposed(),ht(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */me().prototype.unique=function(n){return this.throwIfDisposed(),TR(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */me().prototype.unsortedSegmentSum=function(n,e){return this.throwIfDisposed(),ub(this,n,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */me().prototype.unstack=function(n){return this.throwIfDisposed(),mr(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */me().prototype.where=function(n,e){return this.throwIfDisposed(),Hn(n,this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */me().prototype.zerosLike=function(){return this.throwIfDisposed(),dt(this)};/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class Yr extends Error{constructor(e){super(e),Object.setPrototypeOf(this,Yr.prototype)}}class ar extends Error{constructor(e){super(e),Object.setPrototypeOf(this,ar.prototype)}}class Z extends Error{constructor(e){super(e),Object.setPrototypeOf(this,Z.prototype)}}class tt extends Error{constructor(e){super(e),Object.setPrototypeOf(this,tt.prototype)}}class Vb extends Error{constructor(e){super(e),Object.setPrototypeOf(this,Vb.prototype)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class ID{constructor(e){this.maxEntries=e||100,this.cache=new Map}get(e){let t;return this.cache.has(e)&&(t=this.cache.get(e),this.cache.delete(e),this.cache.set(e,t)),t}put(e,t){if(this.cache.has(e))this.cache.delete(e);else if(this.cache.size>=this.maxEntries){const s=this.cache.keys().next().value;this.cache.delete(s)}this.cache.set(e,t)}getMaxEntries(){return this.maxEntries}setMaxEntries(e){if(e<0)throw new Error(`The maxEntries of LRU caches must be at least 0, but got ${e}.`);if(this.maxEntries>e)for(let t=0;t<this.maxEntries-e;t++){const s=this.cache.keys().next().value;this.cache.delete(s)}this.maxEntries=e}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Aa(n,e){if(Array.isArray(n)){let t=[];for(let s=0;s<e;s++)t=t.concat(n);return t}else{const t=new Array(e);return t.fill(n),t}}function Qr(n,e){if(!n)throw new Vb(e)}function WN(n,e){let t=0;for(const s of n)s===e&&t++;return t}function cs(n){return n.length===1?n[0]:n}function vt(n){return Array.isArray(n)?n:[n]}function So(n){const t=n.replace(/(.)([A-Z][a-z0-9]+)/g,"$1_$2").replace(/([a-z])([A-Z])/g,"$1_$2").toLowerCase();return t[0]!=="_"?t:"private"+t}function da(n){return n.length<=1||n.indexOf("_")===-1?n:n.replace(/[_]+(\w|$)/g,(e,t)=>t.toUpperCase())}let tr={};function Bb(n){if(n==null)return null;const e={};return e.className=n.getClassName(),e.config=n.getConfig(),e}function xv(n){if(!(n==null||typeof n!="object"))if(Array.isArray(n))n.forEach(e=>xv(e));else{const e=Object.keys(n);for(const t of e){const s=n[t];s!=null&&typeof s=="object"&&(!Array.isArray(s)&&s.type==="ndarray"&&typeof s.value=="number"?n[t]=s.value:xv(s))}}}function ld(n,e={},t={},s="object",r=!1){if(typeof n=="string"){const o=n;let i;if(o in t)i=t[o];else if(o in tr)i=tr[o];else if(i=e[o],i==null)throw new Z(`Unknown ${s}: ${n}. This may be due to one of the following reasons:
1. The ${s} is defined in Python, in which case it needs to be ported to TensorFlow.js or your JavaScript code.
2. The custom ${s} is defined in JavaScript, but is not registered properly with tf.serialization.registerClass().`);return i}else{const o=n;if(o.className==null||o.config==null)throw new Z(`${s}: Improper config format: ${JSON.stringify(o)}.
'className' and 'config' must set.`);const i=o.className;let a,l;if(i in t?[a,l]=t[i]:i in tr?[a,l]=tr.className:i in e&&([a,l]=e[i]),a==null)throw new Z(`Unknown ${s}: ${i}. This may be due to one of the following reasons:
1. The ${s} is defined in Python, in which case it needs to be ported to TensorFlow.js or your JavaScript code.
2. The custom ${s} is defined in JavaScript, but is not registered properly with tf.serialization.registerClass().`);if(l!=null){const u={};for(const m of Object.keys(tr))u[m]=tr[m];for(const m of Object.keys(t))u[m]=t[m];const h=o.config;h.customObjects=u;const p=Object.assign({},tr);for(const m of Object.keys(t))tr[m]=t[m];xv(o.config);const f=l(a,o.config,t,r);return tr=Object.assign({},p),f}else{const u=Object.assign({},tr);for(const p of Object.keys(t))tr[p]=t[p];const h=new a(o.config);return tr=Object.assign({},u),h}}}function rq(n,e){return n<e?-1:n>e?1:0}function Lp(n,e){return-1*rq(n,e)}function yi(n){if(n==null)return n;const e=[];for(const t of n)e.indexOf(t)===-1&&e.push(t);return e}function oq(n){if(n==null)throw new Z(`Invalid value in obj: ${JSON.stringify(n)}`);for(const e in n)if(n.hasOwnProperty(e))return!1;return!0}function Ga(n,e,t){if(t!=null&&n.indexOf(t)<0)throw new Z(`${t} is not a valid ${e}.  Valid values are ${n} or null/undefined.`)}function Wb(n,e,t=0,s=1/0){return Qr(t>=0),Qr(s>=t),Array.isArray(n)&&n.length>=t&&n.length<=s&&n.every(r=>typeof r===e)}function Tn(n,e){Array.isArray(n)?(L(n.length>0,()=>`${e} is unexpectedly an empty array.`),n.forEach((t,s)=>Tn(t,`element ${s+1} of ${e}`))):L(Number.isInteger(n)&&n>0,()=>`Expected ${e} to be a positive integer, but got ${$D(n)}.`)}function $D(n){return n===null?"null":Array.isArray(n)?"["+n.map(e=>$D(e)).join(",")+"]":typeof n=="string"?`"${n}"`:`${n}`}function iq(n,e,t){let s=t!=null?t():us(),r;return(...i)=>{const a=t!=null?t():us();return a-s<e||(s=a,r=n(...i)),r}}function ED(n){return n==="relu"?"relu":n==="linear"?"linear":n==="elu"?"elu":null}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */let aq=0;function RD(){return aq++}const Mp={};function Bg(n=""){return n in Mp||(Mp[n]=0),Mp[n]+=1,n+Mp[n].toString()}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const lq=["channelsFirst","channelsLast"],uq=["nearest","bilinear"],cq=["valid","same","causal"],hq=["max","avg"],dq=["sum","mul","concat","ave"];/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const Sl=new Map;function en(n){Ga(lq,"DataFormat",n)}function pq(n){Ga(uq,"InterpolationFormat",n)}function qs(n){Ga(cq,"PaddingMode",n)}function DD(n){Ga(hq,"PoolMode",n)}const Tc=[],UN="/";function wa(n,e){Tc.push(n);try{const t=e();return Tc.pop(),t}catch(t){throw Tc.pop(),t}}function fq(){return Tc.length===0?"":Tc.join(UN)+UN}function AD(n){if(!_D(n))throw new Error("Not a valid tensor name: '"+n+"'");return fq()+n}function OD(n){if(!_D(n))throw new Error("Not a valid tensor name: '"+n+"'");Sl.has(n)||Sl.set(n,0);const e=Sl.get(n);if(Sl.set(n,Sl.get(n)+1),e>0){const t=`${n}_${e}`;return Sl.set(t,1),t}else return n}const mq=new RegExp(/^[A-Za-z0-9][-A-Za-z0-9\._\/]*$/);function _D(n){return!!n.match(mq)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function gq(n){return n===parseInt(n.toString(),10)}function xi(n,e,t){e==null&&(e=0),t==null&&(t=n.length);let s=1;for(let r=e;r<t;++r)s*=n[r];return s}function Zl(n){if(n.length===0)return Number.NaN;let e=Number.POSITIVE_INFINITY;for(let t=0;t<n.length;t++){const s=n[t];s<e&&(e=s)}return e}function ki(n){if(n.length===0)return Number.NaN;let e=Number.NEGATIVE_INFINITY;for(let t=0;t<n.length;t++){const s=n[t];s>e&&(e=s)}return e}function Mr(n,e){if(e<n)throw new Z(`end (${e}) < begin (${n}) is forbidden.`);const t=[];for(let s=n;s<e;++s)t.push(s);return t}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */let px;function pn(){return px==null&&(px=yE().epsilon()),px}function zr(){return"channelsLast"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function no(n,e){return Ne(n,e)}function ud(n,e=-1){const t=n.shape.slice();return e<0&&(e=t.length+e+1),t.splice(e,0,1),X(n,t)}function yq(n,e){return ie(()=>{if(n.shape.length!==2)throw new Z(`repeat() expects a rank-2 tensor, but received a rank-${n.shape.length} tensor.`);const t=ud(n,1);return vv(t,[1,e,1])})}function xq(n){const e=[xi(n.shape)];return X(n,e)}function vq(n){if(n.rank<=1)throw new Z(`batchFlatten requires a minimum rank of 2. Got rank: ${n.rank}.`);const e=[n.shape[0],xi(n.shape,1)];return X(n,e)}function ba(n,e,t){return ie(()=>{switch(n.rank){case 1:return Eg(n,e,t);case 2:return rb(n,[e,0],[t,n.shape[1]]);case 3:return Rg(n,[e,0,0],[t,n.shape[1],n.shape[2]]);case 4:return Pc(n,[e,0,0,0],[t,n.shape[1],n.shape[2],n.shape[3]]);case 5:return et(n,[e,0,0,0,0],[t,n.shape[1],n.shape[2],n.shape[3],n.shape[4]]);case 6:return et(n,[e,0,0,0,0,0],[t,n.shape[1],n.shape[2],n.shape[3],n.shape[4],n.shape[5]]);default:throw new Z(`sliceAlongFirstAxis() received an unsupported tensor rank: ${n.rank}`)}})}function fx(n,e,t){return ie(()=>{switch(n.rank){case 1:return Eg(n,e,t);case 2:return rb(n,[0,e],[n.shape[0],t]);case 3:return Rg(n,[0,0,e],[n.shape[0],n.shape[1],t]);case 4:return Pc(n,[0,0,0,e],[n.shape[0],n.shape[1],n.shape[2],t]);default:throw new Z(`sliceAlongLastAxis() received an unsupported tensor rank: ${n.rank}`)}})}function zp(n,e,t,s){return ie(()=>{switch(n.rank){case 1:return Eg(n,e,t);case 2:switch(s){case 1:return ba(n,e,t);case 2:return fx(n,e,t);default:throw new Z(`The axis is not within the rank of the tensor ${s}`)}case 3:switch(s){case 1:return ba(n,e,t);case 2:return Rg(n,[0,e,0],[n.shape[0],t,n.shape[2]]);case 3:return fx(n,e,t);default:throw new Z(`The axis is not within the rank of the tensor ${s}`)}case 4:switch(s){case 1:return ba(n,e,t);case 2:return Pc(n,[0,e,0,0],[n.shape[0],t,n.shape[2],n.shape[3]]);case 3:return Pc(n,[0,0,e,0],[n.shape[0],n.shape[1],t,n.shape[3]]);case 4:return fx(n,e,t);default:throw new Z(`The axis is not within the rank of the tensor ${s}`)}default:throw new Z(`sliceAlongLastAxis() received an unsupported tensor rank: ${n.rank}`)}})}function Ub(n,e=-1){let t;return e<0&&(t=n[0].rank,t!==0?e=t:e=0),e===n[0].rank&&(e=-1),on(n,e)}function GN(n,e){switch(n.rank){case 1:return KE([n,e]);case 2:return P1([n,e],0);case 3:return qE([n,e],0);case 4:return XE([n,e],0);default:throw new Z(`concatAlongFirstAxis() received an unsupported tensor rank: ${n.rank}`)}}function vv(n,e){if(Array.isArray(e)||(e=[e]),n.rank!==e.length)throw new Z(`The length of input n (${e.length}) does not match the number of dimensions in input x (${n.rank})`);return ir(n,e)}function Wg(n,e=0,t=1,s,r){return Y1(n,e,t,s,r)}function so(n,e,t,s){if(n.rank<2||e.rank<2)throw new tt(`dot requires both inputs to be rank >= 2 but got x shape = ${n.shape} and y shape = ${e.shape}`);if(e.rank>=3){const r=n.shape.slice(-1)[0],o=e.shape.slice(-2)[0];if(r!==o)throw new tt(`If rank y >= 3, then the second last dim of y must equal the last dim of x but got x shape = ${n.shape} and  y shape = ${e.shape}`)}if(n.rank===2&&e.rank===2)return fv({a:n,b:e,transposeA:!1,transposeB:!1,bias:s?wv(n.rank,s,zr()):null,activation:t});{const r=n.shape.slice(),o=r.pop();n=X(n,[-1,o]);const i=e.shape.slice(),a=i.pop(),l=i.pop(),u=[...i,a],h=Array.from({length:e.rank},(y,x)=>x===0?e.rank-2:x<=e.rank-2?x-1:x);e=X(ht(e,h),[l,-1]);const p=[...r,...u];return X(fv({a:n,b:e,transposeA:!1,transposeB:!1,bias:s?wv(n.rank,s,zr()):null,activation:t}),p)}}function FD(n,e,t){return ie(()=>(Array.isArray(e)?e=_n(e,"int32"):e=Ne(e,"int32"),rd(n,e,t)))}function cd(n){return H(n,n)}function wv(n,e,t){const s=e.shape;if(e.rank!==1&&e.rank!==n)throw new Z(`Unexpected bias dimensions: ${e.rank}; expected it to be 1 or ${n}`);if(n===5){if(t==="channelsFirst")return s.length===1?X(e,[1,s[0],1,1,1]):X(e,[1,s[3],s[0],s[1],s[2]]);if(t==="channelsLast")return s.length===1?X(e,[1,1,1,1,s[0]]):X(e,[1].concat(s))}else if(n===4){if(t==="channelsFirst")return s.length===1?X(e,[1,s[0],1,1]):X(e,[1,s[2],s[0],s[1]]);if(t==="channelsLast")return s.length===1?X(e,[1,1,1,s[0]]):X(e,[1].concat(s))}else if(n===3){if(t==="channelsFirst")return s.length===1?X(e,[1,s[0],1]):X(e,[1,s[1],s[0]]);if(t==="channelsLast")return s.length===1?X(e,[1,1,s[0]]):X(e,[1].concat(s))}else if(n<3)return e;throw new Z(`Unsupported input rank by biasAdd: ${e.rank}`)}function Wr(n,e,t){return ie(()=>(t==null&&(t=zr()),en(t),ye(n,wv(n.rank,e,t))))}function wq(n,e=1){if(e!==1)throw new tt(`Support for alpha values other than 1 (${e}) is not implemented yet.`);return td(n)}function bq(n){return ie(()=>Ae(n,ye(hn(n),1)))}function PD(n,e,t,s){return ie(()=>$R(n,e,t,s))}function Sq(n){return ie(()=>{const e=ye(.5,H(.2,n));return As(e,0,1)})}function hd(n,e,t=!1){return t?n():e()}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const Cq=["fanIn","fanOut","fanAvg"],kq=["normal","uniform","truncatedNormal"];/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Tq(n){Ga(Cq,"FanMode",n)}function Nq(n){Ga(kq,"Distribution",n)}class xr extends mu{fromConfigUsesCustomObjects(){return!1}getConfig(){return{}}}class LD extends xr{apply(e,t){return dn(e,t)}}LD.className="Zeros";ve(LD);class Gb extends xr{apply(e,t){return $s(e,t)}}Gb.className="Ones";ve(Gb);class MD extends xr{constructor(e){if(super(),typeof e!="object")throw new Z(`Expected argument of type ConstantConfig but got ${e}`);if(e.value===void 0)throw new Z(`config must have value set but got ${e}`);this.value=e.value}apply(e,t){return ie(()=>H(We(this.value),$s(e,t)))}getConfig(){return{value:this.value}}}MD.className="Constant";ve(MD);class zD extends xr{constructor(e){super(),this.DEFAULT_MINVAL=-.05,this.DEFAULT_MAXVAL=.05,this.minval=e.minval||this.DEFAULT_MINVAL,this.maxval=e.maxval||this.DEFAULT_MAXVAL,this.seed=e.seed}apply(e,t){return Wa(e,this.minval,this.maxval,t,this.seed)}getConfig(){return{minval:this.minval,maxval:this.maxval,seed:this.seed}}}zD.className="RandomUniform";ve(zD);class VD extends xr{constructor(e){super(),this.DEFAULT_MEAN=0,this.DEFAULT_STDDEV=.05,this.mean=e.mean||this.DEFAULT_MEAN,this.stddev=e.stddev||this.DEFAULT_STDDEV,this.seed=e.seed}apply(e,t){if(t=t||"float32",t!=="float32"&&t!=="int32")throw new tt(`randomNormal does not support dType ${t}.`);return Wg(e,this.mean,this.stddev,t,this.seed)}getConfig(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}}}VD.className="RandomNormal";ve(VD);class BD extends xr{constructor(e){super(),this.DEFAULT_MEAN=0,this.DEFAULT_STDDEV=.05,this.mean=e.mean||this.DEFAULT_MEAN,this.stddev=e.stddev||this.DEFAULT_STDDEV,this.seed=e.seed}apply(e,t){if(t=t||"float32",t!=="float32"&&t!=="int32")throw new tt(`truncatedNormal does not support dType ${t}.`);return lb(e,this.mean,this.stddev,t,this.seed)}getConfig(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}}}BD.className="TruncatedNormal";ve(BD);class WD extends xr{constructor(e){super(),this.gain=e.gain!=null?e.gain:1}apply(e,t){return ie(()=>{if(e.length!==2||e[0]!==e[1])throw new Z("Identity matrix initializer can only be used for 2D square matrices.");return H(this.gain,G1(e[0]))})}getConfig(){return{gain:this.gain}}}WD.className="Identity";ve(WD);function Iq(n,e="channelsLast"){let t,s;if(en(e),n.length===2)t=n[0],s=n[1];else if([3,4,5].indexOf(n.length)!==-1){if(e==="channelsFirst"){const r=xi(n,2);t=n[1]*r,s=n[0]*r}else if(e==="channelsLast"){const r=xi(n,0,n.length-2);t=n[n.length-2]*r,s=n[n.length-1]*r}}else{const r=xi(n);t=Math.sqrt(r),s=Math.sqrt(r)}return[t,s]}class Fs extends xr{constructor(e){if(super(),e.scale<0)throw new Z(`scale must be a positive float. Got: ${e.scale}`);this.scale=e.scale==null?1:e.scale,this.mode=e.mode==null?"fanIn":e.mode,Tq(this.mode),this.distribution=e.distribution==null?"normal":e.distribution,Nq(this.distribution),this.seed=e.seed}apply(e,t){const s=Iq(e),r=s[0],o=s[1];let i=this.scale;if(this.mode==="fanIn"?i/=Math.max(1,r):this.mode==="fanOut"?i/=Math.max(1,o):i/=Math.max(1,(r+o)/2),this.distribution==="normal"){const a=Math.sqrt(i);if(t=t||"float32",t!=="float32"&&t!=="int32")throw new tt(`${this.getClassName()} does not support dType ${t}.`);return lb(e,0,a,t,this.seed)}else{const a=Math.sqrt(3*i);return Wa(e,-a,a,t,this.seed)}}getConfig(){return{scale:this.scale,mode:this.mode,distribution:this.distribution,seed:this.seed}}}Fs.className="VarianceScaling";ve(Fs);class jb extends Fs{constructor(e){super({scale:1,mode:"fanAvg",distribution:"uniform",seed:e==null?null:e.seed})}getClassName(){return Fs.className}}jb.className="GlorotUniform";ve(jb);class Hb extends Fs{constructor(e){super({scale:1,mode:"fanAvg",distribution:"normal",seed:e==null?null:e.seed})}getClassName(){return Fs.className}}Hb.className="GlorotNormal";ve(Hb);class Kb extends Fs{constructor(e){super({scale:2,mode:"fanIn",distribution:"normal",seed:e==null?null:e.seed})}getClassName(){return Fs.className}}Kb.className="HeNormal";ve(Kb);class qb extends Fs{constructor(e){super({scale:2,mode:"fanIn",distribution:"uniform",seed:e==null?null:e.seed})}getClassName(){return Fs.className}}qb.className="HeUniform";ve(qb);class Xb extends Fs{constructor(e){super({scale:1,mode:"fanIn",distribution:"normal",seed:e==null?null:e.seed})}getClassName(){return Fs.className}}Xb.className="LeCunNormal";ve(Xb);class Yb extends Fs{constructor(e){super({scale:1,mode:"fanIn",distribution:"uniform",seed:e==null?null:e.seed})}getClassName(){return Fs.className}}Yb.className="LeCunUniform";ve(Yb);class UD extends xr{constructor(e){super(),this.DEFAULT_GAIN=1,this.ELEMENTS_WARN_SLOW=2e3,this.gain=e.gain==null?this.DEFAULT_GAIN:e.gain,this.seed=e.seed}apply(e,t){return ie(()=>{if(e.length<2)throw new tt("Shape must be at least 2D.");if(t!=="int32"&&t!=="float32"&&t!==void 0)throw new TypeError(`Unsupported data type ${t}.`);t=t;const s=fe(e.slice(0,-1)),r=e[e.length-1],o=s*r;o>this.ELEMENTS_WARN_SLOW&&console.warn(`Orthogonal initializer is being called on a matrix with more than ${this.ELEMENTS_WARN_SLOW} (${o}) elements: Slowness may result.`);const i=[Math.max(r,s),Math.min(r,s)],a=Wg(i,0,1,t,this.seed),l=LR.qr(a,!1);let u=l[0];const p=l[1].flatten().stridedSlice([0],[Math.min(r,s)*Math.min(r,s)],[Math.min(r,s)+1]);return u=H(u,p.sign()),s<r&&(u=u.transpose()),H(We(this.gain),u.reshape(e))})}getConfig(){return{gain:this.gain,seed:this.seed}}}UD.className="Orthogonal";ve(UD);const jN={constant:"Constant",glorotNormal:"GlorotNormal",glorotUniform:"GlorotUniform",heNormal:"HeNormal",heUniform:"HeUniform",identity:"Identity",leCunNormal:"LeCunNormal",leCunUniform:"LeCunUniform",ones:"Ones",orthogonal:"Orthogonal",randomNormal:"RandomNormal",randomUniform:"RandomUniform",truncatedNormal:"TruncatedNormal",varianceScaling:"VarianceScaling",zeros:"Zeros"};function HN(n,e={}){return ld(n,or.getMap().classNameMap,e,"initializer")}function Mt(n){return Bb(n)}function _t(n){if(typeof n=="string"){const e=n in jN?jN[n]:n;if(e==="GlorotNormal")return new Hb;if(e==="GlorotUniform")return new jb;if(e==="HeNormal")return new Kb;if(e==="HeUniform")return new qb;if(e==="LeCunNormal")return new Xb;if(e==="LeCunUniform")return new Yb;{const t={};return t.className=e,t.config={},HN(t)}}else return n instanceof xr?n:HN(n)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function bv(n){return Array.isArray(n)&&Array.isArray(n[0])}function Of(n){return n.length===0?[]:Array.isArray(n[0])?n:[n]}function He(n){let e;if(Array.isArray(n)){if(n.length!==1)throw new Z(`Expected Tensor length to be 1; got ${n.length}`);e=n[0]}else e=n;return e}function ft(n){if(Array.isArray(n)&&Array.isArray(n[0])){if(n.length===1)return n=n,n[0];throw new Z(`Expected exactly 1 Shape; got ${n.length}`)}else return n}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function _f(n){let e=0;for(const t of n)t.shape.length===0?e+=1:e+=t.shape.reduce((s,r)=>s*r);return e}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const KN="Variable";class $q{constructor(e,t="float32",s=KN,r=!0,o=null){this.dtype=t??"float32",this.shape=e.shape,this.id=RD(),s=s??KN,this.originalName=AD(s),this.name=OD(this.originalName),this.trainable_=r,this.constraint=o,this.val=NR(e,this.trainable_,this.name,this.dtype)}read(){return this.assertNotDisposed(),this.val}write(e){return this.assertNotDisposed(),Eq(this.val,e),this.val.id!==e.id&&(this.val.assign(e),this.constraint!=null&&this.val.assign(this.constraint.apply(this.val))),this}dispose(){this.assertNotDisposed(),this.val.dispose()}assertNotDisposed(){if(this.val.isDisposed)throw new Error(`LayersVariable ${this.name} is already disposed.`)}get trainable(){return this.trainable_}set trainable(e){this.trainable_=e,this.val.trainable=e}}function Eq(n,e){if(n.shape.toString()!==e.shape.toString())throw new Error("Shape mismatch: "+JSON.stringify(n.shape)+" vs. "+JSON.stringify(e.shape))}function Sv(n){return n.map(e=>e.read())}function Qb(n){n.forEach(e=>{e[0].write(e[1])})}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class fn{constructor(e){this.dtype=e.dtype,this.shape=e.shape,e.shape!=null?this.ndim=e.shape.length:this.ndim=e.ndim,this.maxNDim=e.maxNDim,this.minNDim=e.minNDim,this.axes=e.axes||{}}}class lo{constructor(e,t,s,r,o,i,a){this.dtype=e,this.shape=t,this.sourceLayer=s,this.inputs=r,this.callArgs=o,this.outputTensorIndex=a,this.id=RD(),i!=null&&(this.originalName=AD(i),this.name=OD(this.originalName)),this.rank=t.length}}let Rq=0;class Ug{constructor(e,t){this.callArgs=t,this.id=Rq++,this.outboundLayer=e.outboundLayer,this.inboundLayers=e.inboundLayers,this.nodeIndices=e.nodeIndices,this.tensorIndices=e.tensorIndices,this.inputTensors=e.inputTensors,this.outputTensors=e.outputTensors,this.inputMasks=e.inputMasks,this.outputMasks=e.outputMasks,this.inputShapes=e.inputShapes,this.outputShapes=e.outputShapes;for(const s of e.inboundLayers)s!=null&&s.outboundNodes.push(this);e.outboundLayer.inboundNodes.push(this)}getConfig(){const e=[];for(const t of this.inboundLayers)t!=null?e.push(t.name):e.push(null);return{outboundLayer:this.outboundLayer?this.outboundLayer.name:null,inboundLayers:e,nodeIndices:this.nodeIndices,tensorIndices:this.tensorIndices}}}let Dq=0;class at extends mu{constructor(e={}){super(),this._callHook=null,this._addedWeightNames=[],this._stateful=!1,this.id=Dq++,this.activityRegularizer=null,this.inputSpec=null,this.supportsMasking=!1,this._trainableWeights=[],this._nonTrainableWeights=[],this._losses=[],this._updates=[],this._built=!1,this.inboundNodes=[],this.outboundNodes=[];let t=e.name;if(!t){const s=this.getClassName();t=So(s)+"_"+Bg(s)}if(this.name=t,this.trainable_=e.trainable==null?!0:e.trainable,e.inputShape!=null||e.batchInputShape!=null){let s;if(e.batchInputShape!=null)s=e.batchInputShape;else if(e.inputShape!=null){let o=null;e.batchSize!=null&&(o=e.batchSize),s=[o].concat(e.inputShape)}this.batchInputShape=s;let r=e.dtype;r==null&&(r=e.inputDType),r==null&&(r="float32"),this.dtype=r}e.weights!=null?this.initialWeights=e.weights:this.initialWeights=null,this._refCount=null,this.fastWeightInitDuringBuild=!1}static nodeKey(e,t){return e.name+"_ib-"+t.toString()}getNodeAtIndex(e,t){if(this.inboundNodes.length===0)throw new ar(`The layer has never been called and thus has no defined ${t}.`);if(this.inboundNodes.length<=e)throw new Z(`Asked to get ${t} at node ${e}, but the layer has only ${this.inboundNodes.length} inbound nodes.`);return this.inboundNodes[e]}getInputAt(e){return cs(this.getNodeAtIndex(e,"input").inputTensors)}getOutputAt(e){return cs(this.getNodeAtIndex(e,"output").outputTensors)}get input(){if(this.inboundNodes.length>1)throw new Yr(`Layer ${this.name} has multiple inbound nodes, hence the notion of "layer input" is ill-defined. Use \`getInputAt(nodeIndex)\` instead.`);if(this.inboundNodes.length===0)throw new Yr(`Layer ${this.name} is not connected, no input to return.`);return cs(this.getNodeAtIndex(0,"input").inputTensors)}get output(){if(this.inboundNodes.length===0)throw new Yr(`Layer ${this.name} has no inbound nodes.`);if(this.inboundNodes.length>1)throw new Yr(`Layer ${this.name} has multiple inbound nodes, hence the notion of "layer output" is ill-defined. Use \`getOutputAt(nodeIndex)\` instead.`);return cs(this.getNodeAtIndex(0,"output").outputTensors)}get losses(){return this._losses}calculateLosses(){return this.losses.map(e=>e())}get updates(){return this._updates}get built(){return this._built}set built(e){this._built=e}get trainable(){return this.trainable_}set trainable(e){this._trainableWeights.forEach(t=>t.trainable=e),this.trainable_=e}get trainableWeights(){return this.trainable_?this._trainableWeights.filter(e=>e.trainable):[]}set trainableWeights(e){this._trainableWeights=e}get nonTrainableWeights(){return this.trainable?this._trainableWeights.filter(e=>!e.trainable).concat(this._nonTrainableWeights):this._trainableWeights.concat(this._nonTrainableWeights)}set nonTrainableWeights(e){this._nonTrainableWeights=e}get weights(){return this.trainableWeights.concat(this.nonTrainableWeights)}get stateful(){return this._stateful}resetStates(){if(!this.stateful)throw new Error("Cannot call the resetStates() method of a non-stateful Layer object.")}assertInputCompatibility(e){const t=vt(e);if(this.inputSpec==null||this.inputSpec.length===0)return;const s=vt(this.inputSpec);if(t.length!==s.length)throw new Z(`Layer ${this.name} expects ${s.length} inputs, but it received ${t.length} input tensors. Input received: ${e}`);for(let r=0;r<t.length;r++){const o=t[r],i=s[r];if(i==null)continue;const a=o.rank;if(i.ndim!=null&&a!==i.ndim)throw new Z(`Input ${r} is incompatible with layer ${this.name}: expected ndim=${i.ndim}, found ndim=${a}`);if(i.maxNDim!=null&&a>i.maxNDim)throw new Z(`Input ${r} is incompatible with layer ${this.name}: expected max_ndim=${i.maxNDim}, found ndim=${a}`);if(i.minNDim!=null&&a<i.minNDim)throw new Z(`Input ${r} is incompatible with layer ${this.name}: expected min_ndim=${i.minNDim}, found ndim=${a}.`);if(i.dtype!=null&&o.dtype!==i.dtype)throw new Z(`Input ${r} is incompatible with layer ${this.name} : expected dtype=${i.dtype}, found dtype=${o.dtype}.`);if(i.axes){const l=o.shape;for(const u in i.axes){const h=Number(u),p=i.axes[u],f=h>=0?l[h]:l[l.length+h];if(p!=null&&[p,null].indexOf(f)===-1)throw new Z(`Input ${r} is incompatible with layer ${this.name}: expected axis ${h} of input shape to have value ${p} but got shape ${l}.`)}}if(i.shape!=null)for(let l=0;l<i.shape.length;++l){const u=i.shape[l],h=o.shape[l];if(u!=null&&h!=null&&u!==h)throw new Z(`Input ${r} is incompatible with layer ${this.name}: expected shape=${i.shape}, found shape=${o.shape}.`)}}}call(e,t){return e}invokeCallHook(e,t){this._callHook!=null&&this._callHook(e,t)}setCallHook(e){this._callHook=e}clearCallHook(){this._callHook=null}apply(e,t){t=t||{},this.assertNotDisposed();const s=vt(e),r=_q(e),o=Fq(e);if(r===o)throw new Z("Arguments to apply() must be all SymbolicTensors or all Tensors");return wa(this.name,()=>{if(!this.built){this.assertInputCompatibility(e);const i=[];for(const a of vt(e))i.push(a.shape);this.build(cs(i)),this.built=!0,this.initialWeights&&this.setWeights(this.initialWeights),this._refCount===null&&o&&(this._refCount=1)}if(this.assertInputCompatibility(e),o){let i=this.call(e,t);this.supportsMasking&&this.setMaskMetadata(e,i);const a=vt(i),l=[];for(let u of a)s.indexOf(u)!==-1&&(u=u.clone()),l.push(u);if(i=cs(l),this.activityRegularizer!=null)throw new tt("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return i}else{const i=Aq(e),a=this.computeOutputShape(i);let l;const u=Oq(e);if(this.warnOnIncompatibleInputShape(Array.isArray(e)?i[0]:i),a!=null&&a.length>0&&Array.isArray(a[0])?l=a.map((h,p)=>new lo(u,h,this,vt(e),t,this.name,p)):l=new lo(u,a,this,vt(e),t,this.name),this.addInboundNode(e,l,null,null,i,a,t),this._refCount++,this.activityRegularizer!=null)throw new tt("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return l}})}warnOnIncompatibleInputShape(e){if(this.batchInputShape!=null)if(e.length!==this.batchInputShape.length)console.warn(`The rank of the input tensor provided (shape: ${JSON.stringify(e)}) does not match that of the batchInputShape (${JSON.stringify(this.batchInputShape)}) of the layer ${this.name}`);else{let t=!1;this.batchInputShape.forEach((s,r)=>{s!=null&&e[r]!=null&&e[r]!==s&&(t=!0)}),t&&console.warn(`The shape of the input tensor (${JSON.stringify(e)}) does not match the expectation of layer ${this.name}: ${JSON.stringify(this.batchInputShape)}`)}}get outputShape(){if(this.inboundNodes==null||this.inboundNodes.length===0)throw new Yr(`The layer ${this.name} has never been called and thus has no defined output shape.`);const e=[];for(const t of this.inboundNodes){const s=JSON.stringify(t.outputShapes);e.indexOf(s)===-1&&e.push(s)}if(e.length===1){const t=this.inboundNodes[0].outputShapes;return Array.isArray(t)&&Array.isArray(t[0])&&t.length===1?t[0]:t}else throw new Yr(`The layer ${this.name} has multiple inbound nodes with different output shapes. Hence the notion of "output shape" is ill-defined for the layer.`)}countParams(){if(!this.built)throw new ar(`You tried to call countParams() on ${this.name}, but the layer is not built yet. Build it first by calling build(batchInputShape).`);return _f(this.weights)}build(e){this.built=!0}getWeights(e=!1){return Sv(e?this.trainableWeights:this.weights)}setWeights(e){ie(()=>{const t=this.weights;if(t.length!==e.length)throw new Z(`You called setWeights(weights) on layer "${this.name}" with a weight list of length ${e.length}, but the layer was expecting ${t.length} weights. Provided weights: ${e}...`);if(t.length===0)return;const s=[],r=Sv(t);for(let o=0;o<r.length;++o){const i=r[o],a=t[o],l=e[o];if(!ct(i.shape,l.shape))throw new Z(`Layer weight shape ${i.shape} not compatible with provided weight shape ${l.shape}`);s.push([a,l])}Qb(s)})}addWeight(e,t,s,r,o,i,a,l){if(this._addedWeightNames.indexOf(e)!==-1)throw new Z(`Duplicate weight name ${e} for layer ${this.name}`);this._addedWeightNames.push(e),s==null&&(s="float32"),this.fastWeightInitDuringBuild&&(r=l!=null?l():_t("zeros"));const u=r.apply(t,s),h=new $q(u,s,e,i,a);return u.dispose(),o!=null&&this.addLoss(()=>o.apply(h.read())),i==null&&(i=!0),i?this._trainableWeights.push(h):this._nonTrainableWeights.push(h),h}setFastWeightInitDuringBuild(e){this.fastWeightInitDuringBuild=e}addLoss(e){e==null||Array.isArray(e)&&e.length===0||(e=vt(e),this._losses!==void 0&&this._losses!==null&&this.losses.push(...e))}computeOutputShape(e){return e}computeMask(e,t){if(!this.supportsMasking){if(t!=null)if(Array.isArray(t))t.forEach(s=>{if(s!=null)throw new TypeError(`Layer ${this.name} does not support masking, but was passed an inputMask.`)});else throw new TypeError(`Layer ${this.name} does not support masking, but was passed an inputMask.`);return null}return t}setMaskMetadata(e,t,s){if(!this.supportsMasking)return;const r=this.computeMask(e,s),o=vt(t),i=vt(r);if(o.length!==i.length)throw new Error(`${this.name} outputs ${o.length} tensors but ${o.length} masks for those tensors`);for(let a=0;a<o.length;a++)o[a].kerasMask=i[a]}addInboundNode(e,t,s,r,o,i,a=null){const l=vt(e);t=vt(t),s=vt(s),r=vt(r),o=Of(o),i=Of(i);const u=[],h=[],p=[];for(const f of l)u.push(f.sourceLayer),h.push(f.nodeIndex),p.push(f.tensorIndex);new Ug({outboundLayer:this,inboundLayers:u,nodeIndices:h,tensorIndices:p,inputTensors:l,outputTensors:t,inputMasks:s,outputMasks:r,inputShapes:o,outputShapes:i},a);for(let f=0;f<t.length;f++)t[f].sourceLayer=this,t[f].nodeIndex=this.inboundNodes.length-1,t[f].tensorIndex=f}getConfig(){const e={name:this.name,trainable:this.trainable};return this.batchInputShape!=null&&(e.batchInputShape=this.batchInputShape),this.dtype!=null&&(e.dtype=this.dtype),e}disposeWeights(){return this.weights.forEach(e=>e.dispose()),this.weights.length}assertNotDisposed(){if(this._refCount===0)throw new Error(`Layer '${this.name}' is already disposed.`)}dispose(){if(!this.built)throw new Error(`Cannot dispose Layer ${this.name} because it has not been built yet.`);if(this._refCount===null)throw new Error(`Cannot dispose Layer ${this.name} because it has not been used yet.`);this.assertNotDisposed();let e=0;return--this._refCount===0&&(e=this.disposeWeights()),{refCountAfterDispose:this._refCount,numDisposedVariables:e}}}function Aq(n){n=vt(n);const e=[];for(const t of n)e.push(t.shape);return cs(e)}function Oq(n){return"float32"}function GD(n,e,t){if((e==null||t!=null&&t>0)&&(e=n.sourceLayer,t=n.nodeIndex),e.inboundNodes.length===0)return[n];{const s=e.inboundNodes[t];if(s.inboundLayers.length===0)return s.inputTensors;{const r=[];for(let o=0;o<s.inboundLayers.length;o++){const i=s.inputTensors[o],a=s.inboundLayers[o],l=s.nodeIndices[o],u=GD(i,a,l);for(const h of u)r.indexOf(h)===-1&&r.push(h)}return r}}}function _q(n){let e=!0;for(const t of vt(n))if(!(t instanceof lo)){e=!1;break}return e}function Fq(n){let e=!0;for(const t of vt(n))if(t instanceof lo){e=!1;break}return e}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class dd extends at{constructor(e){if(super({dtype:e.dtype,name:e.name!=null?e.name:Bg("input").toString()}),e.batchSize==null&&(e.batchSize=null),e.sparse==null&&(e.sparse=!1),this.trainable=!1,this.built=!0,this.sparse=e.sparse,e.inputShape!=null&&e.batchInputShape!=null)throw new Z("Only provide the inputShape OR batchInputShape argument to inputLayer, not both at the same time.");let t=e.batchInputShape;if(t==null){if(e.inputShape==null)throw new Z("An InputLayer should be passed either a `batchInputShape` or an `inputShape`.");t=[e.batchSize].concat(e.inputShape)}else if(e.batchSize!=null)throw new Z("Cannot specify batchSize if batchInputShape is specified when creating an InputLayer.");const s=e.dtype||"float32";this.batchInputShape=t,this.dtype=s,this.inputSpec=[{shape:t}];const r=new lo(this.dtype,this.batchInputShape,this,[],{},this.name);r.nodeIndex=0,r.tensorIndex=0,new Ug({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:[r],outputTensors:[r],inputMasks:[null],outputMasks:[null],inputShapes:[t],outputShapes:[t]})}apply(e,t){throw new Z(`Cannot pass any input to an InputLayer's apply() method. InputLayer name: ${this.name}`)}dispose(){return{refCountAfterDispose:this._refCount,numDisposedVariables:0}}getConfig(){return{batchInputShape:this.batchInputShape,dtype:this.dtype,sparse:this.sparse,name:this.name}}}dd.className="InputLayer";ve(dd);function Pq(n){if(n.batchShape==null&&n.shape==null)throw new Error("Please provide to Input either a `shape` or a `batchShape` argument. Note that `shape` does not include the batch dimension.");if(n.batchShape!=null&&n.shape!=null)throw new Z("Please provide either a `shape` or `batchShape` argument to Input, but not both.");let e=n.batchShape;n.shape!=null&&e==null&&(e=[null].concat(n.shape));let t=n.dtype;return t==null&&(t="float32"),new dd({batchInputShape:e,name:n.name,dtype:t,sparse:n.sparse}).inboundNodes[0].outputTensors[0]}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Lq(n,e){if(n.dtype==null||n.dtype===e.dtype)return e;try{return Ne(e,n.dtype)}catch{throw new Z(`The dtype of the feed (${e.dtype}) can not be cast to the dtype of the key '${n.name}' (${n.dtype}).`)}}class hi{constructor(e){if(this.id2Value={},this.id2Mask={},this.name2Id={},e instanceof hi)for(const t in e.id2Value)this.id2Value[t]=e.id2Value[t],t in e.id2Mask&&(this.id2Mask[t]=e.id2Mask[t]);else{if(e==null)return;for(const t of e)this.add(t.key,t.value)}}add(e,t,s){if(this.id2Value[e.id]==null)this.id2Value[e.id]=Lq(e,t),this.name2Id[e.name]=e.id,s!=null&&(this.id2Mask[e.id]=s);else throw new Z(`Duplicate key: name=${e.name}, id=${e.id}`);return this}addFeed(e){this.add(e.key,e.value)}hasKey(e){return this.id2Value[e.id]!=null}names(){return Object.keys(this.name2Id)}getValue(e){if(e instanceof lo){if(this.id2Value[e.id]==null)throw new Z(`Nonexistent key: ${e.name}`);return this.id2Value[e.id]}else{const t=this.name2Id[e];if(t==null)throw new Z(`Feed dict has no SymbolicTensor name: ${e}`);return this.id2Value[t]}}getMask(e){if(e instanceof lo){if(this.id2Value[e.id]==null)throw new Z(`Nonexistent key: ${e.name}`);return this.id2Mask[e.id]}else{const t=this.name2Id[e];if(t==null)throw new Z(`Feed dict has no SymbolicTensor name: ${e}`);return this.id2Mask[t]}}disposeMasks(){this.id2Mask!=null&&ot(this.id2Mask)}}const Ff=new ID,Pf=new ID;function Mq(n){Ff!=null&&Ff.setMaxEntries(n),Pf!=null&&Pf.setMaxEntries(n)}function wc(n,e,t,s){const r=t==null?!1:t.training,o=Array.isArray(n),i=o?n:[n],a=i.map(y=>y.name),l=[],u=e.names();for(const y of a)u.indexOf(y)!==-1?l.push(e.getValue(y)):l.push(null);const h=a.join(",")+"|"+e.names().sort().join(",");let p=Ff.get(h),f;if(p==null){const y=zq(i,e);p=y.sorted,f=y.recipientCounts,Ff.put(h,p),Pf.put(h,f)}f={},r||Object.assign(f,Pf.get(h));const m=new hi(e);for(let y=0;y<p.length;++y){const x=p[y],v=x.sourceLayer;if(v instanceof dd)continue;const w=[],S=[],k=[];let T=!1;for(const _ of x.inputs){const P=m.getValue(_),R=m.getMask(_);w.push(P),S.push(R),R!=null&&(T=!0),r||(f[_.name]--,f[_.name]===0&&!e.hasKey(_)&&a.indexOf(_.name)===-1&&!P.isDisposed&&_.sourceLayer.stateful!==!0&&k.push(P))}T&&(t=t||{},t.mask=S[0]);const I=vt(v.apply(w,t));let E=null;v.supportsMasking&&(E=v.computeMask(w,S));const D=Bq(x),O=Array.isArray(D)?D:[D];for(let _=0;_<O.length;++_){m.hasKey(O[_])||m.add(O[_],I[_],Array.isArray(E)?E[0]:E);const P=a.indexOf(O[_].name);P!==-1&&(l[P]=I[_])}r||ot(k)}return m.disposeMasks(),o?l:l[0]}function zq(n,e){L(n!=null&&n.length>0,()=>"Expected at least one fetch, got none");let t=[],s={};if(n.length===1){const r=qN(n[0],e);t=r.sorted,s=r.recipientMap}else{const r=new Set;for(const o of n){const{sorted:i,recipientMap:a}=qN(o,e);for(const l of i)r.has(l.name)||(t.push(l),r.add(l.name));for(const l in a)s[l]==null&&(s[l]=new Set),a[l].forEach(u=>s[l].add(u))}}return{sorted:t,recipientCounts:Vq(s)}}function Vq(n){const e={};for(const t in n)e[t]=n[t].size;return e}function qN(n,e){const t=new Set,s=[],r={};for(const a of e.names())t.add(a);const o=[],i=[];for(o.push(n);o.length>0;){const a=o[o.length-1];if(t.has(a.name)){o.pop();continue}const l=i[i.length-1]===o.length-1;if(a.inputs.length===0||l)o.pop(),s.push(a),t.add(a.name),l&&i.pop();else{i.push(o.length-1);for(const u of a.inputs)r[u.name]==null&&(r[u.name]=new Set),r[u.name].add(a.name),!t.has(u.name)&&o.push(u)}}return{sorted:s,recipientMap:r}}function Bq(n){let e;if(n.sourceLayer.inboundNodes.length===1)e=n.sourceLayer.output;else{let t=null;for(let s=0;s<n.sourceLayer.inboundNodes.length;++s)for(const r of n.sourceLayer.inboundNodes[s].outputTensors)if(r.id===n.id){t=s;break}e=n.sourceLayer.getOutputAt(t)}return e}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Wq=ae();Wq.registerFlag("TOPOLOGICAL_SORT_CACHE_MAX_ENTRIES",()=>100,Mq);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Zb(n,e){return ie(()=>Pn(_e(H(n,n),e,!0)))}class pd extends mu{getConfig(){return{}}}class jD extends pd{constructor(e){super(),this.defaultMaxValue=2,this.defaultAxis=0,this.maxValue=e.maxValue!=null?e.maxValue:this.defaultMaxValue,this.axis=e.axis!=null?e.axis:this.defaultAxis}apply(e){return ie(()=>{const t=Zb(e,this.axis),s=As(t,0,this.maxValue);return H(e,Ae(s,ye(pn(),t)))})}getConfig(){return{maxValue:this.maxValue,axis:this.axis}}}jD.className="MaxNorm";ve(jD);class HD extends pd{constructor(e){super(),this.defaultAxis=0,this.axis=e.axis!=null?e.axis:this.defaultAxis}apply(e){return ie(()=>Ae(e,ye(pn(),Zb(e,this.axis))))}getConfig(){return{axis:this.axis}}}HD.className="UnitNorm";ve(HD);class KD extends pd{apply(e){return ho(e)}}KD.className="NonNeg";ve(KD);class qD extends pd{constructor(e){super(),this.defaultMinValue=0,this.defaultMaxValue=1,this.defaultRate=1,this.defaultAxis=0,this.minValue=e.minValue!=null?e.minValue:this.defaultMinValue,this.maxValue=e.maxValue!=null?e.maxValue:this.defaultMaxValue,this.rate=e.rate!=null?e.rate:this.defaultRate,this.axis=e.axis!=null?e.axis:this.defaultAxis}apply(e){return ie(()=>{const t=Zb(e,this.axis),s=ye(H(this.rate,As(t,this.minValue,this.maxValue)),H(1-this.rate,t));return H(e,Ae(s,ye(pn(),t)))})}getConfig(){return{minValue:this.minValue,maxValue:this.maxValue,rate:this.rate,axis:this.axis}}}qD.className="MinMaxNorm";ve(qD);const XN={maxNorm:"MaxNorm",minMaxNorm:"MinMaxNorm",nonNeg:"NonNeg",unitNorm:"UnitNorm"};function gn(n){return Bb(n)}function YN(n,e={}){return ld(n,or.getMap().classNameMap,e,"constraint")}function yn(n){if(n==null)return null;if(typeof n=="string"){const t={className:n in XN?XN[n]:n,config:{}};return YN(t)}else return n instanceof pd?n:YN(n)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */async function ia(n){if(n==null)return;const e=[],t=[],s=[];for(const r in n){const o=n[r];if(typeof o!="number"){const i=o;e.push(i.data()),t.push(r),s.push(i)}}if(e.length>0){const r=await Promise.all(e);for(let o=0;o<r.length;++o)n[t[o]]=r[o][0];ot(s)}}function XD(n){if(n!=null)for(const e in n){const t=n[e];typeof t!="number"&&t.dispose()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */var QN;(function(n){n[n.SILENT=0]="SILENT",n[n.VERBOSE=1]="VERBOSE"})(QN||(QN={}));const Uq=125;class Mc{constructor(){this.validationData=null}setParams(e){this.params=e}async onEpochBegin(e,t){}async onEpochEnd(e,t){}async onBatchBegin(e,t){}async onBatchEnd(e,t){}async onTrainBegin(e){}async onTrainEnd(e){}setModel(e){}}class Gq{constructor(e,t=10){e==null&&(e=[]),this.callbacks=e,this.queueLength=t}append(e){this.callbacks.push(e)}setParams(e){for(const t of this.callbacks)t.setParams(e)}setModel(e){for(const t of this.callbacks)t.setModel(e)}async onEpochBegin(e,t){t==null&&(t={});for(const s of this.callbacks)await s.onEpochBegin(e,t)}async onEpochEnd(e,t){t==null&&(t={});for(const s of this.callbacks)await s.onEpochEnd(e,t)}async onBatchBegin(e,t){t==null&&(t={});for(const s of this.callbacks)await s.onBatchBegin(e,t)}async onBatchEnd(e,t){t==null&&(t={});for(const s of this.callbacks)await s.onBatchEnd(e,t)}async onTrainBegin(e){e==null&&(e={});for(const t of this.callbacks)await t.onTrainBegin(e)}async onTrainEnd(e){e==null&&(e={});for(const t of this.callbacks)await t.onTrainEnd(e)}}class jq extends Mc{constructor(){super()}async onEpochBegin(e){this.seen=0,this.totals={}}async onBatchEnd(e,t){t==null&&(t={});const s=t.size==null?0:t.size;this.seen+=s;for(const r in t){const o=t[r];if(typeof o=="number")this.totals.hasOwnProperty(r)||(this.totals[r]=0),this.totals[r]=this.totals[r]+o*s;else{let i;r in this.totals?i=this.totals[r]:this.totals[r]=0;const a=ie(()=>ye(this.totals[r],H(o,s)));this.totals[r]=a,i!=null&&i.dispose()}}}async onEpochEnd(e,t){if(t!=null)for(const s of this.params.metrics)this.totals[s]!=null&&(typeof this.totals[s]=="number"?t[s]=this.totals[s]/this.seen:ie(()=>{const r=H(Ae(1,this.seen),this.totals[s]);t[s]=r,this.totals[s].dispose(),kn(t[s])}))}}class Hq extends Mc{async onTrainBegin(e){this.epoch=[],this.history={}}async onEpochEnd(e,t){t==null&&(t={}),this.epoch.push(e);for(const s in t)this.history[s]==null&&(this.history[s]=[]),this.history[s].push(t[s])}async syncData(){const e=[],t=[],s=[];for(const o in this.history){const i=this.history[o];for(let a=0;a<i.length;++a)if(typeof i[a]!="number"){const l=i[a];e.push(l.data()),t.push(o),s.push(a)}}const r=await Promise.all(e);for(let o=0;o<r.length;++o)this.history[t[o]][s[o]].dispose(),this.history[t[o]][s[o]]=r[o][0]}}class Kq extends Mc{constructor(e,t){if(super(),this.currentEpoch=0,this.nowFunc=e.nowFunc,this.nextFrameFunc=e.nextFrameFunc||tD,this.yieldEvery=t||"auto",this.yieldEvery==="auto"&&(this.yieldEvery=Uq),this.yieldEvery==="never"&&e.onYield!=null)throw new Error("yieldEvery is `never` but you provided an `onYield` callback. Either change `yieldEvery` or remove the callback");qx(this.yieldEvery)&&(this.maybeWait=iq(this.maybeWait.bind(this),this.yieldEvery,this.nowFunc)),this.trainBegin=e.onTrainBegin,this.trainEnd=e.onTrainEnd,this.epochBegin=e.onEpochBegin,this.epochEnd=e.onEpochEnd,this.batchBegin=e.onBatchBegin,this.batchEnd=e.onBatchEnd,this.yield=e.onYield}async maybeWait(e,t,s){const r=[];this.yield!=null&&(await ia(s),r.push(this.yield(e,t,s))),r.push(this.nextFrameFunc()),await Promise.all(r)}async onEpochBegin(e,t){this.currentEpoch=e,this.epochBegin!=null&&(await ia(t),await this.epochBegin(e,t))}async onEpochEnd(e,t){const s=[];this.epochEnd!=null&&(await ia(t),s.push(this.epochEnd(e,t))),this.yieldEvery==="epoch"&&s.push(this.nextFrameFunc()),await Promise.all(s)}async onBatchBegin(e,t){this.batchBegin!=null&&(await ia(t),await this.batchBegin(e,t))}async onBatchEnd(e,t){const s=[];this.batchEnd!=null&&(await ia(t),s.push(this.batchEnd(e,t))),this.yieldEvery==="batch"?s.push(this.nextFrameFunc()):qx(this.yieldEvery)&&s.push(this.maybeWait(this.currentEpoch,e,t)),await Promise.all(s)}async onTrainBegin(e){this.trainBegin!=null&&(await ia(e),await this.trainBegin(e))}async onTrainEnd(e){this.trainEnd!=null&&(await ia(e),await this.trainEnd(e))}}function YD(n,e){return n==null&&(n={}),n instanceof Mc?[n]:Array.isArray(n)&&n[0]instanceof Mc?n:vt(n).map(s=>new Kq(s,e))}class sr{constructor(){}static registerCallbackConstructor(e,t){L(e>=0&&Number.isInteger(e),()=>`Verbosity level is expected to be an integer >= 0, but got ${e}`),sr.checkForDuplicate(t),sr.constructors[e]==null&&(sr.constructors[e]=[]),sr.constructors[e].push(t)}static checkForDuplicate(e){for(const t in sr.constructors)sr.constructors[+t].forEach(r=>{if(r===e)throw new Z("Duplicate callback constructor.")})}static clear(){sr.constructors={}}static createCallbacks(e){const t=[];for(const s in sr.constructors){const r=+s;e>=r&&t.push(...sr.constructors[r])}return t.map(s=>new s)}}sr.constructors={};function QD(n,e,t,s,r,o,i,a,l){const u=new Hq,h=[new jq,...sr.createCallbacks(e)];n!=null&&h.push(...n),h.push(u);const p=new Gq(h);return p.setParams({epochs:t,initialEpoch:s,samples:r,steps:o,batchSize:i,verbose:e,doValidation:a,metrics:l}),{callbackList:p,history:u}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function $o(n,e={},t=!1){return ld(n,or.getMap().classNameMap,e,"layer",t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Lf(n,e){return ie(()=>{n.dtype!=="float32"&&(n=Ne(n,"float32"));const t=_e(cd(n),e,!0),s=hu(t.shape,pn()),r=Pn(zo(t,s));return Ae(n,r)})}function Gg(n,e){return ie(()=>Ut(cd(Ee(e,n)),-1))}function Jb(n,e){return ie(()=>Ut(hn(Ee(e,n)),-1))}function eS(n,e){return ie(()=>{const t=Ee(n,e),s=As(hn(n),pn(),Number.MAX_VALUE),r=hn(Ae(t,s));return H(100,Ut(r,-1))})}function qq(n,e){return ie(()=>{const t=As(e,pn(),Number.MAX_VALUE),s=js(ye(1,t)),r=As(n,pn(),Number.MAX_VALUE),o=js(ye(1,r));return Ut(cd(Ee(s,o)),-1)})}function Xq(n,e){return ie(()=>{const t=zo(0,Ee(1,H(n,e)));return Ut(cd(t),-1)})}function Yq(n,e){return ie(()=>{const t=zo(0,Ee(1,H(n,e)));return Ut(t,-1)})}function Qq(n,e){return ie(()=>{const t=_e(H(n,e),-1),s=hr(H(Ee(1,n),e),-1);return zo(0,ye(1,Ee(s,t)))})}function Zq(n,e){return ie(()=>{const t=Math.log(2),s=Ee(e,n),r=Ee(ye(s,du(H(-2,s))),t);return Ut(r,-1)})}function zc(n,e,t=!1){return ie(()=>{if(t)e=Dg(e);else{const s=_e(e,e.shape.length-1,!0);e=Ae(e,s)}return e=As(e,pn(),1-pn()),Rt(_e(H(Ne(n,"float32"),js(e)),e.shape.length-1))})}function Mf(n,e,t=!1){return ie(()=>{const s=Ne(sd(xq(n)),"int32");e=As(e,pn(),1-pn());const r=e.shape,o=X(q1(s,r[r.length-1]),r);return zc(o,e,t)})}function Jq(n,e){if(!ct(n.shape,e.shape))throw new Z(`logits and labels must have the same shape, but got shapes ${JSON.stringify(n.shape)} and ${JSON.stringify(e.shape)}`);return ie(()=>{const t=ho(e),s=Rt(hn(e));return ye(Ee(t,H(e,n)),bg(Os(s)))})}function jg(n,e){return ie(()=>{let t;return t=As(e,pn(),1-pn()),t=js(Ae(t,Ee(1,t))),Ut(Jq(n,t),-1)})}function e8(n,e){return ie(()=>{const t=As(n,pn(),1),s=As(e,pn(),1);return _e(H(n,js(Ae(t,s))),-1)})}function t8(n,e){return ie(()=>{const t=js(ye(pn(),e));return Ut(Ee(e,H(n,t)),-1)})}function ZD(n,e){return ie(()=>{const t=Lf(n,-1),s=Lf(e,-1),r=H(t,s);return Rt(_e(r,-1))})}const zf={meanSquaredError:Gg,meanAbsoluteError:Jb,meanAbsolutePercentageError:eS,meanSquaredLogarithmicError:qq,squaredHinge:Xq,hinge:Yq,categoricalHinge:Qq,logcosh:Zq,categoricalCrossentropy:zc,sparseCategoricalCrossentropy:Mf,binaryCrossentropy:jg,kullbackLeiblerDivergence:e8,poisson:t8,cosineProximity:ZD};function mx(n){if(typeof n=="string"){if(n in zf)return zf[n];let e=`Unknown loss ${n}`;throw n.toLowerCase().includes("softmaxcrossentropy")&&(e=`Unknown loss ${n}. Use "categoricalCrossentropy" as the string name for tf.losses.softmaxCrossEntropy`),new Z(e)}else return n}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function JD(n,e){return ie(()=>{const t=H(.5,Hs(e)),s=no(Ms(e,t),n.dtype);return Ut(Lr(n,s),-1)})}function eA(n,e){return ie(()=>no(Lr(ql(n,-1),ql(e,-1)),"float32"))}function n8(n,e){return ie(()=>Ne(_e(ao(Lr(n,1),Lr(e,1))),"float32"))}function s8(n,e){return ie(()=>Ne(_e(ao(Lr(n,0),Lr(e,1))),"float32"))}function r8(n,e){return ie(()=>{const t=n8(n,e),s=s8(n,e),r=ye(t,s);return Ne(Hn(Ms(r,0),Ae(t,r),0),"float32")})}function o8(n,e){return jg(n,e)}function i8(n,e){return n.rank===e.rank&&(n=Ao(n,[n.rank-1])),e=ql(e,-1),e.dtype!==n.dtype&&(e=Ne(e,n.dtype)),Ne(Lr(n,e),"float32")}const a8=Gg,l8=Gg,u8=Jb,c8=Jb,h8=eS,d8=eS,tA=zc,p8=ZD,nA=Mf,Vf={binaryAccuracy:JD,categoricalAccuracy:eA,precision:r8,categoricalCrossentropy:tA,sparseCategoricalCrossentropy:nA,mse:a8,MSE:l8,mae:u8,MAE:c8,mape:h8,MAPE:d8,cosine:p8};function f8(n){if(typeof n=="string"&&n in Vf)return Vf[n];if(typeof n!="string"&&n!=null)return n;throw new Z(`Unknown metric ${n}`)}function Vp(n){if(Qr(n!==null,`Unknown LossOrMetricFn ${n}`),typeof n=="string")return n;{let e;for(const t of Object.keys(zf))if(zf[t]===n){e=t;break}if(e!==void 0)return e;for(const t of Object.keys(Vf))if(Vf[t]===n){e=t;break}return e!==void 0?e:n.name}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function m8(n){const e={Adagrad:()=>bl.adagrad(.01),Adadelta:()=>bl.adadelta(1,.95,pn()),Adam:()=>bl.adam(.001,.9,.999,pn()),Adamax:()=>bl.adamax(.002,.9,.999,pn(),0),RMSProp:()=>bl.rmsprop(.001,.9,0,pn()),SGD:()=>bl.sgd(.01)};if(e.adagrad=e.Adagrad,e.adadelta=e.Adadelta,e.adam=e.Adam,e.adamax=e.Adamax,e.rmsprop=e.RMSProp,e.sgd=e.SGD,n in e)return e[n]();throw new Z(`Unknown Optimizer ${n}`)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const ZN=1*1024*1024;function JN(n,e,t=!1){if(n==null||typeof n!="object"||Object.getPrototypeOf(n)!==Object.prototype||!Cv(n))throw new Error("User-defined metadata is expected to be a JSON object, but is not.");if(t){const s=JSON.stringify(n);s.length>ZN&&console.warn(`User-defined metadata of model "${e}" is too large in size (length=${s.length} when serialized). It is not recommended to store such large objects in user-defined metadata. Please make sure its serialized length is <= ${ZN}.`)}}function Cv(n){if(n===null)return!0;if(typeof n=="object")if(Object.getPrototypeOf(n)===Object.prototype){const e=Object.keys(n);for(const t of e)if(typeof t!="string"||!Cv(n[t]))return!1;return!0}else if(Array.isArray(n)){for(const e of n)if(!Cv(e))return!1;return!0}else return!1;else{const e=typeof n;return e==="string"||e==="number"||e==="boolean"}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function g8(n,e,t,s=console.log){const r=x8(n),o=["Layer (type)","Input Shape","Output shape","Param #"];r?(e=e||90,t=t||[.32,.61,.89,1]):(e=e||115,t=t||[.24,.48,.7,.8,1]),t[t.length-1]<=1&&(t=t.map(h=>Math.floor(e*h)));let i;if(!r){o.push("Receives inputs"),i=[];for(const h in n.nodesByDepth)i.push(...n.nodesByDepth[h])}s("_".repeat(e)),Bf(o,t,s),s("=".repeat(e));const a=n.layers;for(let h=0;h<a.length;++h)r?v8(a[h],t,s):w8(a[h],t,i,s),s((h===a.length-1?"=":"_").repeat(e));n.checkTrainableWeightsConsistency();const l=y8(n),u=_f(n.nonTrainableWeights);s(`Total params: ${l+u}`),s(`Trainable params: ${l}`),s(`Non-trainable params: ${u}`),s("_".repeat(e))}function y8(n){let e;return n.collectedTrainableWeights!=null?e=_f(n.collectedTrainableWeights):e=_f(n.trainableWeights),e}function x8(n){let e=!0;const t=[],s=[];for(const r in n.nodesByDepth)t.push(n.nodesByDepth[r]);for(const r of t){if(r.length>1||r.length===1&&r[0].inboundLayers.length>1){e=!1;break}s.push(...r)}if(e)for(const r of n.layers){let o=!1;for(const i of r.inboundNodes)if(s.indexOf(i)!==-1)if(o){e=!1;break}else o=!0;if(!e)break}return e}function Bf(n,e,t=console.log){let s="";for(let r=0;r<n.length;++r)r>0&&(s=s.slice(0,s.length-1)+" "),s+=n[r],s=s.slice(0,e[r]),s+=" ".repeat(e[r]-s.length);t(s)}function v8(n,e,t){let s,r;try{r=n.inboundNodes.map(l=>JSON.stringify(l.inputShapes)).join(",")}catch{r="multiple"}try{s=JSON.stringify(n.outputShape)}catch{s="multiple"}const o=n.name,i=n.getClassName(),a=[`${o} (${i})`,r,s,n.countParams().toString()];Bf(a,e,t)}function w8(n,e,t,s){let r,o;try{o=n.inboundNodes.map(p=>JSON.stringify(p.inputShapes)).join(",")}catch{o="multiple"}try{r=JSON.stringify(n.outputShape)}catch{r="multiple"}const i=[];for(const p of n.inboundNodes)if(!(t!=null&&t.length>0&&t.indexOf(p)===-1))for(let f=0;f<p.inboundLayers.length;++f){const m=p.inboundLayers[f].name,y=p.nodeIndices[f],x=p.tensorIndices[f];i.push(`${m}[${y}][${x}]`)}const a=n.name,l=n.getClassName(),u=i.length===0?"":i[0],h=[`${a} (${l})`,o,r,n.countParams().toString(),u];Bf(h,e,s);for(let p=1;p<i.length;++p)Bf(["","","","",i[p]],e,s)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function sA(n,e,t){return(n==="inboundNodes"||n==="outputLayers"||n==="inputLayers")&&e===0&&typeof t=="string"}function kv(n,e){if(n===null)return null;if(typeof n=="string")return da(n);if(typeof n=="number"||typeof n=="boolean")return n;if(n instanceof Array){const t=[],s=n.length;for(let r=0;r<s;++r){const o=n[r];sA(e,r,o)?t.push(o):t.push(kv(o,e))}return t}else{const t={};for(const s of Object.keys(n)){const r=n[s];if(s==="name"&&typeof r=="string")t[s]=r;else{const o=da(s);t[o]=kv(r,o)}}return t}}function Tv(n,e){if(n==null)return null;if(typeof n=="string")return So(n);if(typeof n=="number"||typeof n=="boolean")return n;if(n instanceof Array){const t=[],s=n.length;for(let r=0;r<s;++r){const o=n[r];sA(e,r,o)?t.push(o):t.push(Tv(o,e))}return t}else{const t={};for(const s of Object.keys(n)){const r=n[s],o=So(s);(s==="name"||s==="className")&&typeof r=="string"?t[o]=r:t[o]=Tv(r,s)}return t}}/** @license See the LICENSE file. */const rA="4.22.0";/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const b8=n=>{const e=Object.keys(n);if(e.length===0)return!1;const t=e[0].split("/");return!isNaN(parseInt(t[t.length-1],10))};class Rr extends at{constructor(e){if(super({}),this.containerNodes=new Set,this.name=e.name,this.name==null){const S=this.getClassName().toLowerCase();this.name=Bg(S)}if(this.supportsMasking=!1,this.trainable_=!0,Array.isArray(e.inputs)?this.inputs=e.inputs.slice():this.inputs=[e.inputs],Array.isArray(e.outputs)?this.outputs=e.outputs.slice():this.outputs=[e.outputs],yi(this.inputs).length!==this.inputs.length)throw new Z(`The list of inputs passed to the model is redundant. All inputs should only appear once. Found: ${this.inputs.map(S=>S.name)}`);yi(this.outputs).length!==this.outputs.length&&console.warn(`The list of outputs passed to the model is redundant. All outputs should only appear once. Found: ${this.outputs.map(S=>S.name)}`),this.inputLayers=[],this.inputLayersNodeIndices=[],this.inputLayersTensorIndices=[],this.outputLayers=[],this.outputLayersNodeIndices=[],this.outputLayersTensorIndices=[],this.layers=[],this.internalContainerRefs=[];for(const S of this.outputs){const k=S.sourceLayer,T=S.nodeIndex,I=S.tensorIndex;this.outputLayers.push(k),this.outputLayersNodeIndices.push(T),this.outputLayersTensorIndices.push(I)}for(const S of this.inputs){const k=S.sourceLayer,T=S.nodeIndex,I=S.tensorIndex;Qr(T===0,"input layer has >1 nodes"),Qr(I===0,"input layer has >1 tensors"),this.inputLayers.push(k),this.inputLayersNodeIndices.push(T),this.inputLayersTensorIndices.push(I)}this.inputNames=[],this.outputNames=[],this.feedInputShapes=[],this.feedInputNames=[],this.feedOutputNames=[];for(let S=0;S<this.inputLayers.length;S++){const k=this.inputLayers[S];if(!(k instanceof dd))throw new TypeError(`Input layers to a LayersModel must be InputLayer objects. Received inputs: ${e.inputs}. Input ${S} (0-based) originates from layer type ${k.getClassName()}.`);this.inputNames.push(k.name),this.feedInputShapes.push(k.batchInputShape),this.feedInputNames.push(k.name)}for(const S of this.outputLayers)this.outputNames.push(S.name);this.internalInputShapes=this.inputs.map(S=>S.shape),this.internalOutputShapes=this.outputs.map(S=>S.shape);const t={},s={},r={},o={},i={},a=[],l=(S,k,T,I,E,D)=>{(I==null||E==null||D==null)&&(I=S.sourceLayer,E=S.nodeIndex,D=S.tensorIndex);const O=I.inboundNodes[E];if(T.indexOf(O)!==-1)throw new ar(`The tensor ${S.name} at layer "${I.name}" is part of a cycle.`);if(k.indexOf(O)!==-1)return;this.containerNodes.add(Rr.nodeKey(I,E)),I.id in i||(i[I.id]=Object.keys(i).length),T.indexOf(O)===-1&&T.push(O);const _=O.inboundLayers.length;for(let P=0;P<_;P++){const R=O.inputTensors[P],W=O.inboundLayers[P],Q=O.nodeIndices[P],ee=O.tensorIndices[P];l(R,k,T,W,Q,ee)}for(k.push(O);T.indexOf(O)>=0;)T.splice(T.indexOf(O),1);a.push(O)},u=[],h=[];for(const S of this.outputs)l(S,u,h);const p=a.slice().reverse();for(const S of p){s[S.id]=S,S.id in t||(t[S.id]=0);let k=t[S.id];const T=r[S.outboundLayer.id]==null?0:r[S.outboundLayer.id];k=Math.max(k,T),r[S.outboundLayer.id]=k,o[S.outboundLayer.id]=S.outboundLayer,t[S.id]=k;for(let I=0;I<S.inboundLayers.length;I++){const E=S.inboundLayers[I],D=S.nodeIndices[I],O=E.inboundNodes[D],_=t[O.id]==null?0:t[O.id];t[O.id]=Math.max(k+1,_),s[O.id]=O}}const f={};for(const S in t){const k=t[S];k in f||(f[k]=[]),f[k].push(s[S])}const m={};for(const S in r){const k=r[S];k in m||(m[k]=[]),m[k].push(o[S])}let y=Object.keys(m).map(S=>parseInt(S,10)).sort(Lp);this.layers=[];for(const S of y){const k=m[S];k.sort((T,I)=>{const E=i[T.id],D=i[I.id];return E<D?-1:E>D?1:0});for(const T of k)T instanceof Rr&&this.internalContainerRefs.push(T),this.layers.push(T)}this.layersByDepth=m,y=Object.keys(f).map(S=>parseInt(S,10)).sort(Lp);const x=this.inputs.slice(),v=[];for(const S of y)for(const k of f[S]){const T=k.outboundLayer;if(T!=null){for(const I of k.inputTensors)if(x.indexOf(I)===-1)throw new ar(`Graph disconnected: cannot obtain value for tensor ${I} at layer "${T.name}". The following previous layers were accessed without issue: ${v}`);for(const I of k.outputTensors)x.push(I);v.push(T.name)}}this.nodesByDepth=f;const w=this.layers.map(S=>S.name);for(const S of w){const k=w.filter(T=>T===S).length;if(k!==1)throw new ar(`The name "${S}" is used ${k} times in the model. All layer names should be unique. Layer names: `+JSON.stringify(w))}this.outboundNodes=[],this.inboundNodes=[],new Ug({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:this.inputs,outputTensors:this.outputs,inputMasks:this.inputs.map(S=>null),outputMasks:this.outputs.map(S=>null),inputShapes:this.inputs.map(S=>S.shape),outputShapes:this.outputs.map(S=>S.shape)}),this.built=!0,this._refCount=1}assertNotDisposed(){if(this._refCount===0)throw new Error(`Container '${this.name}' is already disposed.`)}dispose(){this.assertNotDisposed();const e={refCountAfterDispose:null,numDisposedVariables:0};if(--this._refCount===0){for(const t of this.layers)e.numDisposedVariables+=t.dispose().numDisposedVariables;for(const t of this.internalContainerRefs)e.numDisposedVariables+=t.dispose().numDisposedVariables}return e.refCountAfterDispose=this._refCount,e}get trainable(){return this.trainable_}set trainable(e){this.layers.forEach(t=>{t._trainableWeights.forEach(s=>s.trainable=e)}),this.trainable_=e}get trainableWeights(){if(this._trainableWeights.length>0)throw new Z("Container instance unexpectedly contains _trainableWeights.The trainable weights of a Container are a union of the trainable weights of its consituent Layers. Its own _trainableWeights must remain an empty Array.");if(!this.trainable)return[];let e=[];for(const t of this.layers)e=e.concat(t.trainableWeights);return e}get nonTrainableWeights(){const e=[];for(const t of this.layers)e.push(...t.nonTrainableWeights);if(!this.trainable){const t=[];for(const s of this.layers)t.push(...s.trainableWeights);return t.concat(e)}return e}get weights(){return this.trainableWeights.concat(this.nonTrainableWeights)}loadWeights(e,t=!0){const s={};let r=0;const o=b8(e);o&&this.parseWeights(e);for(const a of this.layers)for(const[l,u]of a.weights.entries()){const h=o?`${u.name.split("/").slice(0,-1).join("/")+"/"}${l}`:u.originalName;if(s[h]!=null)throw new Z(`Duplicate weight name: ${h}`);s[h]=u,r++}const i=[];for(const a in e){let l=a;if(s[a]==null){const u=a.split("/");l=u.slice(0,-2).concat([u[u.length-1]]).join("/")}if(s[l]!=null)i.push([s[l],e[a]]);else if(t)throw new Z(`Provided weight data has no target variable: ${a}`);delete s[l]}if(t){const a=[];for(const l in s)a.push(l);if(a.length>0)throw new Z(`${a.length} of ${r} weights are not set: ${a}`)}Qb(i)}parseWeights(e){for(const t in Object.keys(e)){const s=t.split("/"),r=["vars","layer_checkpoint_dependencies"],o=s.map(i=>i.startsWith("_")?i.slice(1):i).filter(i=>!r.includes(i)).join("/");o!==t&&(e[o]=e[t],delete e[t])}}updatedConfig(){const e=this.getConfig(),t={};return t.className=this.getClassName(),t.config=e,t.kerasVersion=`tfjs-layers ${rA}`,t.backend="TensorFlow.js",t}toJSON(e,t=!0){const s=Tv(this.updatedConfig());return t?JSON.stringify(s):s}call(e,t){return ie(()=>{e=vt(e);const s=new hi;for(let r=0;r<this.inputs.length;++r)s.add(this.inputs[r],e[r]);return wc(this.outputs,s,t)})}computeMask(e,t){return ie(()=>{e=vt(e);let s;return t==null?s=Aa(null,e.length):s=vt(t),this.runInternalGraph(e,s)[1]})}computeOutputShape(e){const t=Of(e);if(t.length!==this.inputLayers.length)throw new Z(`Invalid inputShape argument ${e}: model has ${this.inputLayers.length} tensor inputs.`);const s={};for(let a=0;a<t.length;a++){const l=this.inputLayers[a],u=t[a],h=l.name+"_0_0";s[h]=u}const r=Object.keys(this.nodesByDepth).map(a=>parseInt(a,10)).sort(Lp);if(r.length>1)for(const a of r){const l=this.nodesByDepth[a];for(const u of l){const h=u.outboundLayer;if(this.inputLayers.map(x=>x.id).indexOf(h.id)!==-1)continue;const p=[];for(let x=0;x<u.inboundLayers.length;x++){const v=u.inboundLayers[x],w=u.nodeIndices[x],S=u.tensorIndices[x],k=`${v.name}_${w}_${S}`,T=s[k];p.push(T)}const f=h.computeOutputShape(cs(p)),m=Of(f),y=h.inboundNodes.indexOf(u);for(let x=0;x<m.length;x++){const v=`${h.name}_${y}_${x}`;s[v]=m[x]}}}const o=[],i=[];for(let a=0;a<this.outputLayers.length;a++){const l=this.outputLayers[a],u=this.outputLayersNodeIndices[a],h=this.outputLayersTensorIndices[a],p=`${l.name}_${u}_${h}`;i.push(p)}for(let a=0;a<i.length;a++){const l=i[a];Qr(l in s),o.push(s[l])}return cs(o)}runInternalGraph(e,t){t==null&&(t=Aa(null,e.length));const s={};for(let l=0;l<this.inputs.length;++l){const u=this.inputs[l],h=e[l],p=t[l];s[u.id]=[h,p]}const r=Object.keys(this.nodesByDepth).map(l=>parseInt(l,10)).sort(Lp);for(const l of r){const u=this.nodesByDepth[l];for(const h of u){const p=h.outboundLayer,f=h.inputTensors,m=h.outputTensors,y=new Array;for(const x of f)x.id in s&&y.push(s[x.id]);if(y.length===f.length){let x={},v,w,S,k;if(h.callArgs!=null&&(x=h.callArgs),y.length===1){const[T,I]=y[0];x.mask==null&&(x.mask=I),S=vt(p.call(T,x)),k=vt(p.computeMask(T,I)),v=[T],w=[I]}else v=y.map(T=>T[0]),w=y.map(T=>T[1]),x.mask==null&&(x.mask=w),S=vt(p.call(v,x)),k=vt(p.computeMask(v,w));if(p.activityRegularizer)throw new tt("LayersModel invocation with concrete Tensor value(s) in the presence of activity regularizer(s) is not supported yet.");for(let T=0;T<m.length;++T){const I=m[T],E=S[T],D=k[T];s[I.id]=[E,D]}}}}const o=[],i=[],a=[];for(const l of this.outputs){Qr(l.id in s,`Could not compute output ${l.name} : ${l.id}`);const[u,h]=s[l.id];a.push(u.shape),o.push(u),i.push(h)}return[o,i,a]}buildNodeConversionMap(e){const t={};let s;for(const r of this.layers){s=r instanceof Rr?1:0;for(let o=0;o<r.inboundNodes.length;o++){const i=Rr.nodeKey(r,o);this.containerNodes.has(i)&&(t[i]=s,s+=1)}}return t}getLayer(e,t){if(t!=null)return this.findLayer(t);if(e==null)throw new Z("Provide either a layer name or layer index");if(typeof e=="number")return this.findLayer(e);for(const s of this.layers)if(s.name===e)return s;throw new Z(`No such layer: ${e}`)}findLayer(e){if(this.layers.length<=e)throw new Z(`Was asked to retrieve layer at index ${e}, but model only has ${this.layers.length} layer(s).`);return this.layers[e]}calculateLosses(){return ie(()=>{const e=[];for(const t of this.layers)for(let s=0;s<t.inboundNodes.length;++s){const r=Rr.nodeKey(t,s);this.containerNodes.has(r)&&e.push(...t.calculateLosses())}return e})}getConfig(){const e={name:this.name},t=this.buildNodeConversionMap(this.layers),s=[];for(const i of this.layers){const a=i.getClassName(),l=i.getConfig(),u=[];for(let p=0;p<i.inboundNodes.length;p++){const f=i.inboundNodes[p],m=Rr.nodeKey(i,p);let y={};if(this.containerNodes.has(m)){if(f.callArgs)try{JSON.stringify(f.callArgs),y=f.callArgs}catch{console.warn(`Layer ${i.name} was passed non-serializable keyword arguments: ${f.callArgs}. They will not be included in the serialized model (and thus will be missing at deserialization time).`),y={}}if(f.inboundLayers.length>0){const x=[];for(let v=0;v<f.inboundLayers.length;v++){const w=f.inboundLayers[v],S=f.nodeIndices[v],k=f.tensorIndices[v],T=Rr.nodeKey(w,S);let I=t[T];I==null&&(I=0),x.push([w.name,I,k,y])}u.push(x)}}}const h={};h.name=i.name,h.className=a,h.config=l,h.inboundNodes=u,s.push(h)}e.layers=s;const r=[];for(let i=0;i<this.inputLayers.length;i++){const a=this.inputLayers[i],l=this.inputLayersNodeIndices[i],u=Rr.nodeKey(a,l);if(!this.containerNodes.has(u))continue;let h=t[u];h==null&&(h=0);const p=this.inputLayersTensorIndices[i];r.push([a.name,h,p])}e.inputLayers=r;const o=[];for(let i=0;i<this.outputLayers.length;i++){const a=this.outputLayers[i],l=this.outputLayersNodeIndices[i],u=Rr.nodeKey(a,l);if(!this.containerNodes.has(u))continue;let h=t[u];h==null&&(h=0);const p=this.outputLayersTensorIndices[i];o.push([a.name,h,p])}return e.outputLayers=o,e}static fromConfig(e,t,s={},r=!1){const o={},i={};function a(v,w){v.name in i?i[v.name].push(w):i[v.name]=[w]}function l(v,w){const S=[];let k;for(const T of w){const I=T[0],E=T[1],D=T[2];if(k=T[3]==null?{}:T[3],!(I in o)){a(v,w);return}const O=o[I];if(O.inboundNodes.length<=E){a(v,w);return}const _=O.inboundNodes[E];S.push(_.outputTensors[D])}S.length>0&&v.apply(cs(S),k)}function u(v){const w=v.name,S=$o(v,t.customObjects!=null?t.customObjects:{});S.setFastWeightInitDuringBuild(r),o[w]=S,v.inboundNodes.forEach(T=>{if(!(T instanceof Array))throw new Z(`Corrupted configuration, expected array for nodeData: ${T}`);a(S,T)})}const h=t.name,p=t.layers;for(const v of p)u(v);for(;!oq(i);)for(const v of p){const w=o[v.name];if(w.name in i){const S=i[w.name];delete i[w.name];for(const k of S)l(w,k)}}const f=[],m=[],y=t.inputLayers;for(const v of y){const w=v[0],S=v[1],k=v[2];Qr(w in o);const I=o[w].inboundNodes[S].outputTensors;f.push(I[k])}const x=t.outputLayers;for(const v of x){const w=v[0],S=v[1],k=v[2];Qr(w in o);const I=o[w].inboundNodes[S].outputTensors;m.push(I[k])}return new e({inputs:f,outputs:m,name:h})}get stateful(){if(this._stateful)throw new Z("Container instance unexpectedly has _stateful = true. The statefulness of a Container is determined by the Layers it contains. Its _stateful property must remain the default false.");for(const e of this.layers)if(e.stateful)return!0;return!1}resetStates(){ie(()=>{this.layers.forEach(e=>{e.stateful&&e.resetStates()})})}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function S8(n,e,t){const s=e.length;if(n==null||Array.isArray(n)&&n.length===0)return e.map(r=>null);if(s===1)return Array.isArray(n)&&n.length===1?n:typeof n=="object"&&e[0]in n?[n[e[0]]]:[n];if(Array.isArray(n)){if(n.length!==s)throw new Error(`Provided ${t} is an array of ${n.length} element(s), but the model has ${s} outputs. Make sure a set of weights is provided for each model output.`);return n}else if(typeof n=="object"&&Object.keys(n).length>0&&typeof n[Object.keys(n)[0]]=="object"){const r=[];return e.forEach(o=>{o in n?r.push(n[o]):r.push(null)}),r}else throw new Error(`The model has multiple (${s}) outputs, so ${t} must be either an array with ${s} elements or an object with ${e} keys. Provided ${t} not understood: ${JSON.stringify(n)}`)}function oA(n,e){return S8(n,e,"classWeight")}async function iA(n,e,t,s){if(t!=null){const r=ie(()=>{if(n.shape.length===1)return Io(n);if(n.shape.length===2){if(n.shape[1]>1)return ql(n,1);if(n.shape[1]===1)return X(n,[n.shape[0]]);throw new Error(`Encountered unexpected last-dimension size (${n.shape[1]}) during handling of class weights. The size is expected to be >= 1.`)}else throw new Error(`Unexpected rank of target (y) tensor (${n.rank}) during handling of class weights. The rank is expected to be 1 or 2.`)}),o=Array.from(await r.data());ot(r);const i=[];return o.forEach(a=>{if(t[a]==null)throw new Error(`classWeight must contain all classes in the training data. The class ${a} exists in the data but not in classWeight`);i.push(t[a])}),_n(i,"float32")}else return null}function C8(n,e){return H(n,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const k8=32;function aA(n,e){let t,s;const r=e;t=r.xs,s=r.ys,L(t!=null&&s!=null,()=>`A Dataset iterator for fitDataset() is expected to generate objects of the form \`{xs: xVal, ys: yVal}\`, where the two values may be \`tf.Tensor\`, an array of Tensors, or a map of string to Tensor.  The provided Dataset instead generates ${e}`);const o=eI("input",n.inputNames,t),i=eI("output",n.outputNames,s),a=o[0].shape[0];L(o.length===n.inputs.length,()=>`LayersModel has ${n.inputs.length} inputs, but the dataset provides ${o.length} inputs.  (Expected input keys: ${JSON.stringify(n.inputNames)})`),L(i.length===n.outputs.length,()=>`LayersModel has ${n.outputs.length} outputs, but the dataset provides ${i.length} outputs.  (Expected output keys: ${JSON.stringify(n.outputNames)})`);for(let l=0;l<o.length;l++)L(o[l].shape[0]===a,()=>`Batch size mismatch: input ${n.inputNames[l]} has ${o[l].shape[0]}; expected  ${a} based on input ${n.inputNames[0]}.`);for(let l=0;l<i.length;l++)L(i[l].shape[0]===a,()=>`Batch size mismatch: output ${n.outputNames[l]} has ${i[l].shape[0]}; expected  ${a} based on input ${n.inputNames[0]}.`);return{xs:o,ys:i}}function eI(n,e,t){if(t instanceof $t)return[t];if(Array.isArray(t))return L(t.length===e.length,()=>`Received an array of ${t.length} Tensors, but expected ${e.length} to match the ${n} keys ${e}.`),t;{const s=[];for(const r of e){if(t[r]==null)throw new Z(`The feature data generated by the dataset lacks the required ${n} key '${r}'.`);s.push(t[r])}return s}}function T8(n){if(n.length===3)throw new tt("Validation with sample weights is not implemented yet.");return{xs:n[0],ys:n[1]}}async function N8(n,e,t){const s=t.batchesPerEpoch!=null;if(L(n.optimizer!=null,()=>"You must compile a model before training/testing. Use LayersModel.compile(modelCompileConfig)."),L(t!=null,()=>"For fitDataset(), the 2nd argument (config) is required, but it is not provided in this call."),L(t.epochs!=null&&t.epochs>0&&Number.isInteger(t.epochs),()=>`For fitDataset(), config.epochs is expected to be a positive integer, but got ${t.epochs}`),L(!s||t.batchesPerEpoch>0&&Number.isInteger(t.batchesPerEpoch),()=>`For fitDataset(), config.batchesPerEpoch is expected to be a positive integer if specified, but got ${t.batchesPerEpoch}`),L(t.validationSplit==null,()=>"`validationSplit` is not supported by `fitDataset()`. Use validationData instead."),n.isTraining)throw new Error("Cannot start training because another fit() call is ongoing.");n.isTraining=!0;try{const r=t.validationData!=null;let o,i;if(r)if(tI(t.validationData))L(t.validationBatches==null||t.validationBatches>0&&Number.isInteger(t.validationBatches),()=>`For fitDataset() with dataset-based validation, config.validationBatches is expected not to be provided, or to be a positive integer, but got ${t.validationBatches}`);else{const v=T8(t.validationData);o=v.xs,i=v.ys}const a=n.makeTrainFunction(),l=n.getDedupedMetricsNames();let u;r?u=l.slice().concat(l.map(v=>"val_"+v)):u=l.slice();const h=YD(t.callbacks,t.yieldEvery),p=t.verbose==null?1:t.verbose,{callbackList:f,history:m}=QD(h,p,t.epochs,null,null,I8(e,t),null,r,u);f.setModel(n),n.history=m,await f.onTrainBegin(),n.stopTraining_=!1;let y=t.initialEpoch==null?0:t.initialEpoch,x=await e.iterator();for(;y<t.epochs;){const v={};await f.onEpochBegin(y);let w=0,S=0;for(s||(x=await e.iterator());!s||w<t.batchesPerEpoch;){const k=await x.next();if(s&&k.done){console.warn(`You provided \`batchesPerEpoch\` as ${t.batchesPerEpoch}, but your dataset iterator ran out of data after ${w} batches; interrupting training. Make sure that your dataset can generate at least \`batchesPerEpoch * epochs\` batches (in this case, ${t.batchesPerEpoch*t.epochs} batches). You may need to use the repeat() function when building your dataset.`);break}if(k.value!=null){const{xs:T,ys:I}=aA(n,k.value),E={};E.batch=S,E.size=T[0].shape[0],await f.onBatchBegin(S,E);const D=[];if(t.classWeight!=null){const P=oA(t.classWeight,n.outputNames);for(let R=0;R<P.length;++R)D.push(await iA(I[R],null,P[R]))}const O=T.concat(I).concat(D),_=a(O);ot(O);for(let P=0;P<l.length;++P){const R=l[P],W=_[P];E[R]=W,kn(W)}await f.onBatchEnd(S,E),XD(E),S++,w++}if(s?w>=t.batchesPerEpoch:k.done){if(r){let T;tI(t.validationData)?T=vt(await n.evaluateDataset(t.validationData,{batches:t.validationBatches})):T=vt(n.evaluate(o,i,{batchSize:t.validationBatchSize==null?k8:t.validationBatchSize,verbose:0}));for(let I=0;I<n.metricsNames.length;++I)v[`val_${n.metricsNames[I]}`]=T[I]}break}if(n.stopTraining_)break}if(await f.onEpochEnd(y,v),y++,n.stopTraining_)break}return await f.onTrainEnd(),await n.history.syncData(),n.history}finally{n.isTraining=!1}}function I8(n,e){let t=null;return e.batchesPerEpoch!=null?t=e.batchesPerEpoch:Number.isFinite(n.size)&&(t=n.size),t}function tI(n){return typeof n.iterator=="function"}function $8(n){return typeof n.next=="function"}async function E8(n,e,t){t=t||{};const s=t.batches!=null,r=n.testFunction;let o=[];if(t.verbose>0)throw new tt("Verbose mode is not implemented yet.");L(!s||t.batches>0&&Number.isInteger(t.batches),()=>`Test loop expects \`batches\` to be a positive integer, but received ${JSON.stringify(t.batches)}`);const i=$8(e)?e:await e.iterator();let a=0,l=0;for(;!s||l<t.batches;){const u=await i.next();if(o=ie(()=>{if(u.value){const{xs:h,ys:p}=aA(n,u.value),f=h.concat(p),m=ie(()=>r(f));if(ot(f),l===0)for(let x=0;x<m.length;++x)o.push(We(0));const y=f[0].shape[0];for(let x=0;x<m.length;++x){const v=m[x],w=o[x];o[x]=ie(()=>ye(o[x],H(y,v))),l>0&&ot(w)}ot(m),a+=y,++l}return o}),u.done){s&&console.warn(`Your dataset iterator ran out of data during evaluateDataset(). Interrupting evalution. Make sure that your dataset can generate at least \`batches\` batches (in this case, ${t.batches} batches). You may need to use the repeat() function when building your dataset.`);break}}for(let u=0;u<o.length;++u){const h=o[u];o[u]=Ae(o[u],a),ot(h)}return cs(o)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function gx(n){L(n>0&&Number.isInteger(n),()=>`batchSize is required to be a positive integer, but got ${n}`)}function fc(n,e,t){return n==null?[null]:Array.isArray(n)?n.map(s=>ba(s,e,t-e)):ba(n,e,t-e)}function Nv(n,e){return ie(()=>n==null?null:Array.isArray(n)?n.map(t=>Nv(t,e)):FD(n,e.dtype==="int32"?e:Ne(e,"int32")))}function yx(n,e){const t=[];let s=0,r=null;for(;s<n;)r=s+e,r>=n&&(r=n),t.push([s,r]),s=r;return t}function lA(n){const e=[];n instanceof $t&&(n=[n]);for(let t=0;t<n.length;++t){const s=n[t];if(s.rank===1)e.push(ud(s,1));else{if(s.rank===0)throw new Error("Expected tensor to be at least 1D, but received a 0D tensor (scalar).");e.push(s)}}return e}function $r(n,e){if(n==null)return;const t=[];if(e instanceof $t)t.push(e.id);else if(Array.isArray(e))e.forEach(r=>t.push(r.id));else if(e!=null)for(const r in e){const o=e[r];t.push(o.id)}const s=[];if(n instanceof $t)t.indexOf(n.id)===-1&&s.push(n);else if(Array.isArray(n))n.forEach(r=>{t.indexOf(r.id)===-1&&s.push(r)});else if(n!=null)for(const r in n){const o=n[r];t.indexOf(o.id)===-1&&s.push(o)}s.forEach(r=>{r.isDisposed||r.dispose()})}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function R8(n){return n instanceof $t}function Iv(n){return Array.isArray(n)}function nI(n){return!R8(n)&&!Iv(n)}function sI(n,e,t,s=!0,r=""){if(e==null||e.length===0){if(n!=null){let i=!1;if(Iv(n)&&n.length>0)i=!0;else if(nI(n)){for(const a in n)if(n.hasOwnProperty(a)){i=!0;break}}else i=!0;if(i)throw new Z(`Error when checking model ${r} expected no data, but got ${n}`)}return[]}if(n==null)return e.map(i=>null);let o;if(nI(n)){n=n,o=[];for(const i of e){if(n[i]==null)throw new Z(`No data provided for "${i}". Need data for each key in: ${e}`);o.push(n[i])}}else if(Iv(n)){if(n=n,n.length!==e.length)throw new Z(`Error when checking model ${r}: the Array of Tensors that you are passing to your model is not the size the model expected. Expected to see ${e.length} Tensor(s), but instead got the following list of Tensor(s): ${n}`);o=n}else{if(n=n,e.length>1)throw new Z(`The model ${r} expects ${e.length} Tensor(s), but only received one Tensor. Found: Tensor with shape ${n.shape}`);o=[n]}if(o=lA(o),t!=null)for(let i=0;i<e.length;++i){if(t[i]==null)continue;const a=o[i];if(a.shape.length!==t[i].length)throw new Z(`Error when checking ${r}: expected ${e[i]} to have ${t[i].length} dimension(s). but got array with shape ${a.shape}`);for(let l=0;l<t[i].length;++l){if(l===0&&!s)continue;const u=a.shape[l],h=t[i][l];if(h!=null&&h>=0&&u!==h)throw new Z(`${r} expected a batch of elements where each example has shape [${t[i].slice(1,t[i].length)}] (i.e.,tensor shape [*,${t[i].slice(1,t[i].length)}]) but the ${r} received an input with ${a.shape[0]} examples, each with shape [${a.shape.slice(1,a.shape.length)}] (tensor shape [${a.shape}])`)}}return o}function D8(n,e,t){const s=yi(n.map(o=>o.shape[0]));s.sort();const r=yi(e.map(o=>o.shape[0]));if(r.sort(),s.length>1)throw new Z(`All input Tensors (x) should have the same number of samples. Got array shapes: ${JSON.stringify(n.map(o=>o.shape))}`);if(r.length>1)throw new Z(`All target Tensors (y) should have the same number of samples. Got array shapes: ${JSON.stringify(e.map(o=>o.shape))}`);if(s.length>0&&r.length>0&&!ct(s,r))throw new Z(`Input Tensors should have the same number of samples as target Tensors. Found ${s[0]} input sample(s) and ${r[0]} target sample(s).`)}function A8(n,e,t){const s=[Gg,jg,zc];for(let r=0;r<n.length;++r){const o=n[r],i=e[r],a=t[r];if(i!=null){if(i===zc&&o.shape[o.shape.length-1]===1)throw new Z(`You are passing a target array of shape ${o.shape} while using a loss 'categorical_crossentropy'. 'categorical_crossentropy'expects targets to be binary matrices (1s and 0s) of shape [samples, classes].`);if(s.indexOf(i)!==-1){const l=o.shape.slice(1),u=a.slice(1);for(let h=0;h<l.length;++h){const p=l[h],f=u[h];if(f!=null&&p!==f)throw new Z(`A target Tensor with shape ${o.shape} was passed for an output of shape ${a}, while using a loss function that expects targets to have the same shape as the output.`)}}}}}function rI(n,e,t,s=!0,r=""){let o;if(Array.isArray(n)){if(n.length!==e.length)throw new Z(`Error when checking model ${r}: the Array of Tensors that you are passing to your model is not the size the the model expected. Expected to see ${e.length} Tensor(s), but instead got ${n.length} Tensors(s).`);o=n}else{if(e.length>1)throw new Z(`The model expects ${e.length} ${r} Tensors, but only received one Tensor. Found: array with shape ${JSON.stringify(n.shape)}.`);o=[n]}if(t!=null)for(let i=0;i<e.length;++i){if(t[i]==null)continue;const a=o[i];if(a.shape.length!==t[i].length)throw new Z(`Error when checking ${r}: expected ${e[i]} to have ${t[i].length} dimension(s), but got array with shape ${JSON.stringify(a.shape)}`);for(let l=0;l<t[i].length;++l){if(l===0&&!s)continue;const u=a.shape[l],h=t[i][l];if(h!=null&&h!==u)throw new Z(`Error when checking ${r}: expected ${e[i]} to have shape ${JSON.stringify(t[i])} but got array with shape ${JSON.stringify(a.shape)}.`)}}}function O8(n,e){if(n==null||Array.isArray(n)&&n.length===0)return e.map(s=>[]);let t;if(typeof n=="string"||typeof n=="function")t=[n];else if(Array.isArray(n)||typeof n=="object")t=n;else throw new TypeError(`Type of metrics argument not understood. Expected an string,function, Array, or Object, found: ${n}`);if(Array.isArray(t))return e.map(s=>t);{const s=[];for(const r of e){let o=t.hasOwnProperty(r)?t[r]:[];Array.isArray(o)||(o=[o]),s.push(o)}return s}}const _8="layers-model";class Wl extends Rr{constructor(e){super(e),this.isTraining=!1}summary(e,t,s=console.log){if(!this.built)throw new Z("This model has never been called, thus its weights have not been created yet. So no summary can be displayed. Build the model first (e.g., by calling it on some test data).");g8(this,e,t,s)}compile(e){if(e.loss==null&&(e.loss=[]),this.loss=e.loss,typeof e.optimizer=="string")this.optimizer_=m8(e.optimizer),this.isOptimizerOwned=!0;else{if(!(e.optimizer instanceof Bi))throw new Z("User-defined optimizer must be an instance of tf.Optimizer.");this.optimizer_=e.optimizer,this.isOptimizerOwned=!1}let t=[];if(!Array.isArray(e.loss)&&typeof e.loss!="string"&&typeof e.loss!="function"){e.loss=e.loss;for(const i in e.loss)if(this.outputNames.indexOf(i)===-1)throw new Z(`Unknown entry in loss dictionary: "${i}". Only expected the following keys: ${this.outputNames}`);for(const i of this.outputNames)e.loss[i]==null&&console.warn(`Output "${i}" is missing from loss dictionary. We assume this was done on purpose, and we will not be expecting data to be passed to ${i} during training`),t.push(mx(e.loss[i]))}else if(Array.isArray(e.loss)){if(e.loss.length!==this.outputs.length)throw new Z(`When passing an Array as loss, it should have one entry per model output. The model has ${this.outputs.length} output(s), but you passed loss=${e.loss}.`);t=e.loss.map(a=>mx(a))}else{const i=mx(e.loss);this.outputs.forEach(a=>{t.push(i)})}this.lossFunctions=t,this.feedOutputNames=[],this.feedOutputShapes=[],this.feedLossFns=[];for(let i=0;i<this.outputs.length;++i){const a=this.internalOutputShapes[i],l=this.outputNames[i];this.feedOutputNames.push(l),this.feedOutputShapes.push(a),this.feedLossFns.push(this.lossFunctions[i])}const s=[];this.metrics=e.metrics,this.metricsNames=["loss"],this.metricsTensors=[],wa("loss",()=>{for(let i=0;i<this.outputs.length;++i){if(s.indexOf(i)!==-1)continue;const a=this.lossFunctions[i];this.outputs.length>1&&(this.metricsTensors.push([a,i]),this.metricsNames.push(this.outputNames[i]+"_loss"))}});const r=O8(e.metrics,this.outputNames),o=(i,a,l)=>{this.outputNames.length>1&&(a=this.outputNames[i]+"_"+a),this.metricsNames.push(a),this.metricsTensors.push([l,i])};wa("metric",()=>{for(let i=0;i<this.outputs.length;++i){if(s.indexOf(i)!==-1)continue;const a=r[i];(u=>{let p,f,m;for(const y of u){if(typeof y=="string"&&["accuracy","acc","crossentropy","ce"].indexOf(y)!==-1){const v=this.internalOutputShapes[i];v[v.length-1]===1||this.lossFunctions[i]===jg?["accuracy","acc"].indexOf(y)!==-1?f=JD:["crossentropy","ce"].indexOf(y)!==-1&&(f=o8):this.lossFunctions[i]===Mf?["accuracy","acc"].indexOf(y)!==-1?f=i8:["crossentropy","ce"].indexOf(y)!==-1&&(f=nA):["accuracy","acc"].indexOf(y)!==-1?f=eA:["crossentropy","ce"].indexOf(y)!==-1&&(f=tA);let w;["accuracy","acc"].indexOf(y)!==-1?w="acc":["crossentropy","ce"].indexOf(y)!==-1&&(w="ce"),m=f,p=""+w}else m=f8(y),p=""+Vp(y);let x;wa(p,()=>{x=m}),o(i,p,x)}})(a)}}),this.collectedTrainableWeights=this.trainableWeights}checkTrainableWeightsConsistency(){this.collectedTrainableWeights!=null&&this.trainableWeights.length!==this.collectedTrainableWeights.length&&console.warn("Discrepancy between trainableweights and collected trainable weights. Did you set `model.trainable` without calling `model.compile()` afterwards?")}evaluate(e,t,s={}){const r=s.batchSize==null?32:s.batchSize;gx(r);const i=this.standardizeUserDataXY(e,t,!0,r);try{const a=i[0].concat(i[1]);this.makeTestFunction();const l=this.testFunction,u=this.testLoop(l,a,r,s.verbose,s.steps);return cs(u)}finally{$r(i[0],e),$r(i[1],t)}}async evaluateDataset(e,t){return this.makeTestFunction(),E8(this,e,t)}checkNumSamples(e,t,s,r="steps"){let o;if(s!=null){if(o=null,t!=null)throw new Z(`If ${r} is set, batchSize must be null or undefined.Got batchSize = ${t}`)}else if(e!=null)Array.isArray(e)?o=e[0].shape[0]:o=e.shape[0];else throw new Z(`Either the input data should have a defined shape, or ${r} shoud be specified.`);return o}execute(e,t){if(Array.isArray(t)&&t.length===0)throw new Z("`outputs` is an empty Array, which is not allowed.");const s=Array.isArray(t),r=s?t:[t],o=this.retrieveSymbolicTensors(r),i=new hi;if(e instanceof $t&&(e=[e]),Array.isArray(e)){if(e.length!==this.inputs.length)throw new Z(`The number of inputs provided (${e.length}) does not match the number of inputs of this model (${this.inputs.length}).`);for(let l=0;l<this.inputs.length;++l)i.add(this.inputs[l],e[l])}else for(const l of this.inputs){const u=e[l.name];if(u==null)throw new Z(`No value is provided for the model's input ${l.name}`);i.add(l,u)}const a=wc(o,i);return s?a:a[0]}retrieveSymbolicTensors(e){const t=Aa(null,e.length);let s=e.length;for(const r of this.layers){const o=Array.isArray(r.output)?r.output:[r.output],i=o.map(a=>a.name);for(let a=0;a<e.length;++a){const l=i.indexOf(e[a]);if(l!==-1&&(t[a]=o[l],s--),s===0)break}if(s===0)break}if(s>0){const r=[];throw t.forEach((o,i)=>{o==null&&r.push(e[i])}),new Z(`Cannot find SymbolicTensors for output name(s): ${JSON.stringify(r)}`)}return t}predictLoop(e,t=32,s=!1){return ie(()=>{const r=this.checkNumSamples(e);if(s)throw new tt("Verbose predictLoop() is not implemented yet.");const o=yx(r,t),i=this.outputs.map(a=>[]);for(let a=0;a<o.length;++a)ie(()=>{const u=o[a][0],h=o[a][1],p=fc(e,u,h),f=[];if(Array.isArray(p))for(let y=0;y<p.length;++y)f.push({key:this.inputs[y],value:p[y]});else f.push({key:this.inputs[0],value:p});const m=new hi(f);return wc(this.outputs,m)}).forEach((u,h)=>i[h].push(u));return cs(i.map(a=>on(a,0)))})}predict(e,t={}){const s=lA(e);rI(s,this.inputNames,this.feedInputShapes,!1);try{const r=t.batchSize==null?32:t.batchSize;return gx(r),this.predictLoop(s,r)}finally{$r(s,e)}}predictOnBatch(e){rI(e,this.inputNames,this.feedInputShapes,!0);const t=(Array.isArray(e)?e[0]:e).shape[0];return this.predictLoop(e,t)}standardizeUserDataXY(e,t,s=!0,r){if(this.optimizer_==null)throw new ar("You must compile a model before training/testing. Use LayersModel.compile(modelCompileArgs).");const o=[];for(let i=0;i<this.feedOutputShapes.length;++i){const a=this.feedOutputShapes[i];this.feedLossFns[i]===Mf?o.push(a.slice(0,a.length-1).concat([1])):o.push(a)}if(e=sI(e,this.feedInputNames,this.feedInputShapes,!1,"input"),t=sI(t,this.feedOutputNames,o,!1,"target"),D8(e,t),A8(t,this.feedLossFns,this.feedOutputShapes),this.stateful&&r!=null&&r>0&&e[0].shape[0]%r!==0)throw new Z(`In a stateful network, you should only pass inputs with a number of samples that is divisible by the batch size ${r}. Found: ${e[0].shape[0]} sample(s).`);return[e,t]}async standardizeUserData(e,t,s,r,o=!0,i){const[a,l]=this.standardizeUserDataXY(e,t,o,i);if(s!=null)throw new Error("sample weight is not supported yet.");let u=null;if(r!=null){const h=oA(r,this.outputNames);u=[];for(let p=0;p<h.length;++p)u.push(await iA(l[p],null,h[p]))}return[a,l,u]}testLoop(e,t,s,r=0,o){return ie(()=>{const i=this.checkNumSamples(t,s,o,"steps"),a=[];if(r>0)throw new tt("Verbose mode is not implemented yet.");if(o!=null)throw new tt("steps mode in testLoop() is not implemented yet");{const l=yx(i,s),u=_n(Mr(0,i));for(let h=0;h<l.length;++h){const p=l[h][0],f=l[h][1],m=ba(u,p,f-p),y=Nv(t,m),x=e(y);if(h===0)for(let v=0;v<x.length;++v)a.push(We(0));for(let v=0;v<x.length;++v){const w=x[v];a[v]=ye(a[v],H(f-p,w))}}for(let h=0;h<a.length;++h)a[h]=Ae(a[h],i)}return a})}getDedupedMetricsNames(){const e=this.metricsNames,t=[];for(let s=0;s<e.length;++s){const r=e[s];let o=r;if(WN(e,r)>1){const i=WN(e.slice(0,s),r);o+=`_${i}`}t.push(o)}return t}makeTrainFunction(){return e=>{const t=[],s=e.slice(0,this.inputs.length),r=e.slice(this.inputs.length,this.inputs.length+this.outputs.length),o=e.slice(this.inputs.length+this.outputs.length,this.inputs.length+this.outputs.length*2),i=[],a=()=>{const p=[];for(let x=0;x<this.inputs.length;++x)p.push({key:this.inputs[x],value:s[x]});const f=new hi(p),m=wc(this.outputs,f,{training:!0});let y;for(let x=0;x<this.lossFunctions.length;++x){const v=this.lossFunctions[x];let w=v(r[x],m[x]);o[x]!=null&&(w=C8(w,o[x]));const S=Ut(w);t.push(S),x===0?y=w:y=ye(y,w)}for(let x=0;x<this.metricsTensors.length;++x){let v;if(this.outputs.length>1&&x<this.outputs.length)v=t[x];else{const w=this.metricsTensors[x][0],S=this.metricsTensors[x][1];v=Ut(w(r[S],m[S]))}kn(v),i.push(v)}return y=Ut(y),this.calculateLosses().forEach(x=>{y=ye(y,x)}),y},l=this.collectedTrainableWeights.map(p=>p.read());return[this.optimizer_.minimize(a,!0,l)].concat(i)}}makeTestFunction(){this.testFunction=e=>ie(()=>{const t=[];let s;const r=e.slice(0,this.inputs.length),o=e.slice(this.inputs.length,this.inputs.length+this.outputs.length),i=[];for(let u=0;u<this.inputs.length;++u)i.push({key:this.inputs[u],value:r[u]});const a=new hi(i),l=wc(this.outputs,a);for(let u=0;u<this.lossFunctions.length;++u){const h=this.lossFunctions[u],p=Ut(h(o[u],l[u]));u===0?s=p:s=ye(s,p),t.push(s)}for(let u=0;u<this.metricsTensors.length;++u){const h=this.metricsTensors[u][0],p=this.metricsTensors[u][1],f=Ut(h(o[p],l[p]));t.push(f)}return t})}async fit(e,t,s={}){if(this.isTraining)throw new Error("Cannot start training because another fit() call is ongoing.");this.isTraining=!0;let r,o,i,a,l,u,h,p,f;try{const m=s.batchSize==null?32:s.batchSize;gx(m);const x=await this.standardizeUserData(e,t,s.sampleWeight,s.classWeight,!1,m);r=x[0],o=x[1],f=x[2];let v=!1,w;if(s.validationData!=null&&s.validationData.length>0){if(v=!0,s.validationData.length===2)l=s.validationData[0],u=s.validationData[1];else throw s.validationData.length===3?new tt("validationData including sample weights is not supported yet."):new Z(`When passing validation data, it must contain 2 (valX, valY) or 3 (valX, valY, valSampleWeight) items; ${s.validationData} is invalid.`);const P=await this.standardizeUserData(l,u,null,null,!0,m);h=P[0],p=P[1],w=h.concat(p)}else if(s.validationSplit!=null&&s.validationSplit>0&&s.validationSplit<1){v=!0;const _=Math.floor(r[0].shape[0]*(1-s.validationSplit)),P=r[0].shape[0];h=fc(r,_,P),i=r,r=fc(r,0,_),p=fc(o,_,P),a=o,o=fc(o,0,_),w=h.concat(p)}else s.validationSteps!=null&&(v=!0);const S=r.concat(o).concat(f);this.checkTrainableWeightsConsistency();const k=this.makeTrainFunction(),T=this.getDedupedMetricsNames();let I,E;v?(this.makeTestFunction(),I=this.testFunction,E=T.slice().concat(T.map(_=>"val_"+_))):(I=null,w=[],E=T.slice());const D=YD(s.callbacks,s.yieldEvery);return await this.fitLoop(k,S,T,m,s.epochs,s.verbose,D,I,w,s.shuffle,E,s.initialEpoch,null,null)}finally{this.isTraining=!1,$r(r,e),$r(o,t),$r(i,e),$r(a,t),$r(h,l),$r(p,u),f!=null&&ot(f)}}async fitLoop(e,t,s,r,o,i,a,l,u,h,p,f,m,y){r==null&&(r=32),o==null&&(o=1),h==null&&(h=!0),f==null&&(f=0);let x=!1;if(l!=null&&u!=null&&(x=!0),y!=null&&(x=!0,m==null))throw new Z("Can only use `validationSteps` when doing step-wise training, i.e., `stepsPerEpoch` must be set.");const v=this.checkNumSamples(t,r,m,"steps_per_epoch");let w;v!=null&&(w=Mr(0,v)),i==null&&(i=1);const{callbackList:S,history:k}=QD(a,i,o,f,v,m,r,x,p);S.setModel(this),this.history=k,await S.onTrainBegin(),this.stopTraining_=!1;for(let T=f;T<o;++T){await S.onEpochBegin(T);const I={};if(m!=null)throw new tt("stepsPerEpoch mode is not implemented yet.");{if(h==="batch")throw new tt("batch shuffling is not implemneted yet");h&&NV(w);const E=_n(w),D=yx(v,r);for(let O=0;O<D.length;++O){const _={};if(await S.onBatchBegin(O,_),ie(()=>{const P=D[O][0],R=D[O][1],W=ba(E,P,R-P);_.batch=O,_.size=R-P;const Q=Nv(t,W),ee=e(Q);for(let te=0;te<s.length;++te){const oe=s[te],se=ee[te];_[oe]=se,kn(se)}if(O===D.length-1&&x){const te=this.testLoop(l,u,r);for(let oe=0;oe<s.length;++oe){const se=s[oe],G=te[oe];kn(G),I["val_"+se]=G}}}),await S.onBatchEnd(O,_),XD(_),this.stopTraining_)break}E.dispose()}if(await S.onEpochEnd(T,I),this.stopTraining_)break}return await S.onTrainEnd(),await this.history.syncData(),this.history}async fitDataset(e,t){return N8(this,e,t)}async trainOnBatch(e,t){const s=await this.standardizeUserData(e,t),r=s[0],o=s[1],a=this.makeTrainFunction()(r.concat(o)),l=[];for(const u of a){const h=await u.data();l.push(h[0])}return ot(a),$r(s[0],e),$r(s[1],t),cs(l)}getNamedWeights(e){const t=[],s=e!=null&&e.trainableOnly,r=s?this.trainableWeights:this.weights,o=this.getWeights(s);for(let i=0;i<r.length;++i)s&&!r[i].trainable||t.push({name:r[i].originalName,tensor:o[i]});return t}set stopTraining(e){this.stopTraining_=e}get stopTraining(){return this.stopTraining_}get optimizer(){return this.optimizer_}set optimizer(e){this.optimizer_!==e&&(this.optimizer_=e,this.isOptimizerOwned=!1)}dispose(){const e=super.dispose();if(e.refCountAfterDispose===0&&this.optimizer!=null&&this.isOptimizerOwned){const t=yN().numTensors;this.optimizer_.dispose(),e.numDisposedVariables+=t-yN().numTensors}return e}getLossIdentifiers(){let e;if(typeof this.loss=="string")e=So(this.loss);else if(Array.isArray(this.loss)){for(const t of this.loss)if(typeof t!="string")throw new Error("Serialization of non-string loss is not supported.");e=this.loss.map(t=>So(t))}else{const t=Object.keys(this.loss);e={};const s=this.loss;for(const r of t)if(typeof s[r]=="string")e[r]=So(s[r]);else throw new Error("Serialization of non-string loss is not supported.")}return e}getMetricIdentifiers(){if(typeof this.metrics=="string"||typeof this.metrics=="function")return[So(Vp(this.metrics))];if(Array.isArray(this.metrics))return this.metrics.map(e=>So(Vp(e)));{const e={};for(const t in this.metrics)e[t]=So(Vp(this.metrics[t]));return e}}getTrainingConfig(){return{loss:this.getLossIdentifiers(),metrics:this.getMetricIdentifiers(),optimizer_config:{class_name:this.optimizer.getClassName(),config:this.optimizer.getConfig()}}}loadTrainingConfig(e){if(e.weighted_metrics!=null)throw new Error("Loading weight_metrics is not supported yet.");if(e.loss_weights!=null)throw new Error("Loading loss_weights is not supported yet.");if(e.sample_weight_mode!=null)throw new Error("Loading sample_weight_mode is not supported yet.");const t=kv(e.optimizer_config),s=$o(t);let r;if(typeof e.loss=="string")r=da(e.loss);else if(Array.isArray(e.loss))r=e.loss.map(i=>da(i));else if(e.loss!=null){r={};for(const i in e.loss)r[i]=da(e.loss[i])}let o;if(Array.isArray(e.metrics))o=e.metrics.map(i=>da(i));else if(e.metrics!=null){o={};for(const i in e.metrics)o[i]=da(e.metrics[i])}this.compile({loss:r,metrics:o,optimizer:s})}async save(e,t){if(typeof e=="string"){const u=kE(e);if(u.length===0)throw new Z(`Cannot find any save handlers for URL '${e}'`);if(u.length>1)throw new Z(`Found more than one (${u.length}) save handlers for URL '${e}'`);e=u[0]}if(e.save==null)throw new Z("LayersModel.save() cannot proceed because the IOHandler provided does not have the `save` attribute defined.");const s=await av(this.getNamedWeights(t)),a={modelTopology:this.toJSON(null,!1),format:_8,generatedBy:`TensorFlow.js tfjs-layers v${rA}`,convertedBy:null};if((t==null?!1:t.includeOptimizer)&&this.optimizer!=null){a.trainingConfig=this.getTrainingConfig();const u="optimizer",{data:h,specs:p}=await av(await this.optimizer.getWeights(),u);s.specs.push(...p),s.data=bE([s.data,h])}return this.userDefinedMetadata!=null&&(JN(this.userDefinedMetadata,this.name,!0),a.userDefinedMetadata=this.userDefinedMetadata),a.weightData=s.data,a.weightSpecs=s.specs,e.save(a)}setUserDefinedMetadata(e){JN(e,this.name),this.userDefinedMetadata=e}getUserDefinedMetadata(){return this.userDefinedMetadata}}Wl.className="Model";ve(Wl);class uA extends Wl{}uA.className="Functional";ve(uA);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class Vc extends Wl{constructor(e){if(super({inputs:[],outputs:[]}),e=e||{},this.trainable=!0,this.built=!1,this.name=e.name!=null?e.name:Bg("sequential_"),e.layers!=null)for(const t of e.layers)this.add(t)}checkShape(e){if(e.inboundNodes[0].outputTensors[0].shape.some(s=>s<0))throw new Z(`Negative dimension size caused by adding layer ${e.name} with input shape [${e.inboundNodes[0].inputTensors[0].shape}]`)}add(e){const t=e instanceof Vc||e instanceof Wl;let s;if(t){if(s=e,s.outputs.length!==1)throw new Z("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");if(s.inputs.length!==1)throw new Z("All layers in a Sequential model should have a single input tensor. For multi-input layers, use the functional API.")}if(this.outputs.length===0){if(e.inboundNodes.length===0){if(e.batchInputShape==null)throw new Z("The first layer in a Sequential model must get an `inputShape` or `batchInputShape` argument.");const r=Pq({batchShape:e.batchInputShape,dtype:e.dtype,name:e.name+"_input"});e.apply(r)}if(t)this.outputs=s.outputs,this.inputs=s.inputs;else{if(e.inboundNodes.length!==1)throw new Z(`A layer added to a Sequential model must not already be connected somewhere else. LayersModel received layer ${e.name} which has ${e.inboundNodes.length} pre-existing inbound connections.`);if(e.inboundNodes[0].outputTensors.length!==1)throw new Z("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.checkShape(e),this.outputs=[e.inboundNodes[0].outputTensors[0]],this.inputs=GD(this.outputs[0])}this.inboundNodes=[],new Ug({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:this.inputs,outputTensors:this.outputs,inputMasks:Aa(null,this.inputs.length),outputMasks:[null],inputShapes:this.inputs.map(r=>r.shape),outputShapes:this.outputs[0].shape})}else{const r=e.apply(this.outputs[0]);if(Array.isArray(r))throw new TypeError("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.checkShape(e),this.outputs=[r],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}this.layers.push(e),this.built=!1}pop(){if(this.layers.length===0)throw new TypeError("There are no layers in the model.");if(this.layers.pop(),this.layers.length===0)this.outputs=[],this.inboundNodes=[],this.outboundNodes=[];else{const e=this.layers.length-1;this.layers[e].outboundNodes=[],this.outputs=[this.layers[e].output],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}}call(e,t){return this.model==null&&this.build(),this.model.call(e,t)}build(e){if(ft(e),this.inputs.length===0||this.outputs.length===0)throw new TypeError("Sequential model cannot be built: model is empty. Add some layers first.");this.model=new Wl({inputs:this.inputs,outputs:this.outputs[0],name:this.name+"_model"}),this.model.trainable=this.trainable,this.supportsMasking=this.model.supportsMasking,this.inputLayers=this.model.inputLayers,this.inputLayersNodeIndices=this.model.inputLayersNodeIndices,this.inputLayersTensorIndices=this.model.inputLayersTensorIndices,this.outputLayers=this.model.outputLayers,this.outputLayersNodeIndices=this.model.outputLayersNodeIndices,this.outputLayersTensorIndices=this.model.outputLayersTensorIndices,this.nodesByDepth=this.model.nodesByDepth,this.containerNodes=this.model.containerNodes,this.outputNames=this.model.outputNames,this.inputNames=this.model.inputNames,this.built=!0}countParams(){return this.built||this.build(),super.countParams()}summary(e,t,s=console.log){this.built||this.build(),super.summary(e,t,s)}setWeights(e){this.model==null&&this.build(),this.model.setWeights(e)}evaluate(e,t,s={}){if(!this.built)throw new ar("The model needs to be compiled before being used.");return this.model.evaluate(e,t,s)}async evaluateDataset(e,t){if(!this.built)throw new ar("The model needs to be compiled before being used.");return this.model.evaluateDataset(e,t)}predict(e,t={}){return this.model==null&&this.build(),this.model.predict(e,t)}predictOnBatch(e){return this.model==null&&this.build(),this.model.predictOnBatch(e)}compile(e){this.build(),this.model.compile(e),this.optimizer_=this.model.optimizer,this.isOptimizerOwned=this.model.isOptimizerOwned,this.loss=this.model.loss,this.metrics=this.model.metrics,this.metricsTensors=this.model.metricsTensors,this.metricsNames=this.model.metricsNames}get optimizer(){return this.model==null?void 0:this.model.optimizer}set optimizer(e){this.model.optimizer=e}async fit(e,t,s={}){if(!this.built)throw new ar("The model needs to be compiled before being used.");return this.model.fit(e,t,s)}async fitDataset(e,t){if(!this.built)throw new ar("The model needs to be compiled before being used.");return this.model.fitDataset(e,t)}async trainOnBatch(e,t){return this.model.trainOnBatch(e,t)}static fromConfig(e,t,s={},r=!1){let o,i={};if(t instanceof Array){if(t[0].className==null||t[0].className==="Merge")throw new Z("Legacy serialization format not supported yet.");o=t}else L(t.layers!=null,()=>"When the config data for a Sequential model is not an Array, it must be an Object that contains the 'layers' field."),o=t.layers,delete t.layers,i=t;const a=new e(i);if(!(a instanceof Vc))throw new tt(`Sequential.fromConfig called on non-Sequential input: ${a}`);for(const l of o){const h=$o(l,void 0,r);r&&h.setFastWeightInitDuringBuild(!0),a.add(h)}return a}set stopTraining(e){if(this.model==null)throw new Z("Cannot set the stopTraining property of a sequential model before it is compiled.");this.model.stopTraining=e}get stopTraining(){if(this.model==null)throw new Z("Cannot get the stopTraining property of a sequential model before it is compiled.");return this.model.stopTraining}getConfig(){const e=[];for(const t of this.layers){const s={};s.className=t.getClassName(),s.config=t.getConfig(),e.push(s)}return{name:this.name,layers:e}}}Vc.className="Sequential";ve(Vc);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */let qn=class extends mu{getConfig(){return{}}};class cA extends qn{apply(e,t=1){return wq(e,t)}}cA.className="elu";ve(cA);class hA extends qn{apply(e){return eb(e)}}hA.className="selu";ve(hA);class dA extends qn{apply(e){return ho(e)}}dA.className="relu";ve(dA);class pA extends qn{apply(e){return ie(()=>Ra(6,ho(e)))}}pA.className="relu6";ve(pA);class fA extends qn{apply(e){return e}}fA.className="linear";ve(fA);class mA extends qn{apply(e){return Fr(e)}}mA.className="sigmoid";ve(mA);class gA extends qn{apply(e){return Sq(e)}}gA.className="hardSigmoid";ve(gA);class yA extends qn{apply(e){return du(e)}}yA.className="softplus";ve(yA);class xA extends qn{apply(e){return bq(e)}}xA.className="softsign";ve(xA);class vA extends qn{apply(e){return Ea(e)}}vA.className="tanh";ve(vA);let tS=class extends qn{apply(e,t=-1){return Dg(e,t)}};tS.className="softmax";ve(tS);class wA extends qn{apply(e,t=-1){return j1(e,t)}}wA.className="logSoftmax";ve(wA);class bA extends qn{apply(e){return ie(()=>ie(()=>{const t=Math.sqrt(2),s=H(.5,ye(1,W1(Ae(e,t))));return H(e,s)}))}}bA.className="gelu";ve(bA);class SA extends qn{apply(e){return ie(()=>H(.5,H(e,ye(1,Ea(H(Pn(Ae(2,Math.PI)),ye(e,H(.044715,Ro(e,3)))))))))}}SA.className="gelu_new";ve(SA);class CA extends qn{apply(e){return ie(()=>H(e,Ea(du(e))))}}CA.className="mish";ve(CA);class kA extends qn{apply(e,t=1){return ie(()=>H(Fr(H(e,t)),e))}}kA.className="swish";ve(kA);function Ti(n){return n.getClassName()}function xx(n,e={}){return ld(n,or.getMap().classNameMap,e,"activation")}function Ni(n){if(n==null){const e={};return e.className="linear",e.config={},xx(e)}if(typeof n=="string"){const e={};return e.className=n,e.config={},xx(e)}else return n instanceof qn?n:xx(n)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function F8(n){if(n!=null&&typeof n!="object")throw new Error(`Argument to L1L2 regularizer's constructor is expected to be an object, but received: ${n}`)}class TA extends mu{}class NA extends TA{constructor(e){super(),F8(e),this.l1=e==null||e.l1==null?.01:e.l1,this.l2=e==null||e.l2==null?.01:e.l2,this.hasL1=this.l1!==0,this.hasL2=this.l2!==0}apply(e){return ie(()=>{let t=dn([1]);return this.hasL1&&(t=ye(t,_e(H(this.l1,hn(e))))),this.hasL2&&(t=ye(t,_e(H(this.l2,cd(e))))),X(t,[])})}getConfig(){return{l1:this.l1,l2:this.l2}}static fromConfig(e,t){return new e({l1:t.l1,l2:t.l2})}}NA.className="L1L2";ve(NA);const oI={l1l2:"L1L2"};function kt(n){return Bb(n)}function iI(n,e={}){return ld(n,or.getMap().classNameMap,e,"regularizer")}function Ft(n){if(n==null)return null;if(typeof n=="string"){const t={className:n in oI?oI[n]:n,config:{}};return iI(t)}else return n instanceof TA?n:iI(n)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class IA extends at{constructor(e){super(e??{}),this.supportsMasking=!0,e!=null&&(this.maxValue=e.maxValue)}call(e,t){e=He(e);let s=ho(e);return this.maxValue!=null&&(s=As(s,0,this.maxValue)),s}computeOutputShape(e){return e}getConfig(){const e={maxValue:this.maxValue},t=super.getConfig();return Object.assign(e,t),e}}IA.className="ReLU";ve(IA);class $A extends at{constructor(e){super(e??{}),this.DEFAULT_ALPHA=.3,e==null&&(e={}),this.alpha=e.alpha==null?this.DEFAULT_ALPHA:e.alpha}call(e,t){const s=He(e);return wg(s,this.alpha)}computeOutputShape(e){return e}getConfig(){const e={alpha:this.alpha},t=super.getConfig();return Object.assign(e,t),e}}$A.className="LeakyReLU";ve($A);class EA extends at{constructor(e){if(super(e??{}),this.DEFAULT_ALPHA_INITIALIZER="zeros",e==null&&(e={}),this.supportsMasking=!0,this.alphaInitializer=_t(e.alphaInitializer||this.DEFAULT_ALPHA_INITIALIZER),this.alphaRegularizer=Ft(e.alphaRegularizer),this.alphaConstraint=yn(e.alphaConstraint),e.sharedAxes==null)this.sharedAxes=null;else if(Array.isArray(e.sharedAxes))this.sharedAxes=e.sharedAxes;else if(typeof e.sharedAxes=="number")this.sharedAxes=[e.sharedAxes];else throw new Z(`Expected sharedAxes to be a number or an array of numbers, but got ${e.sharedAxes}`)}build(e){e=ft(e);const t=e.slice(1);if(this.sharedAxes!=null)for(const r of this.sharedAxes)t[r-1]=1;this.alpha=this.addWeight("alpha",t,"float32",this.alphaInitializer,this.alphaRegularizer,!0,this.alphaConstraint);const s={};if(this.sharedAxes!=null)for(let r=1;r<e.length;++r)s[r]=e[r];this.inputSpec=[new fn({ndim:e.length,axes:s})],this.built=!0}call(e,t){return e=He(e),Ig(e,this.alpha.read())}getConfig(){const e={alphaInitializer:Mt(this.alphaInitializer),alphaRegularizer:kt(this.alphaRegularizer),alphaConstraint:gn(this.alphaConstraint),sharedAxes:this.sharedAxes},t=super.getConfig();return Object.assign(e,t),e}}EA.className="PReLU";ve(EA);let RA=class extends at{constructor(e){if(super(e??{}),this.DEFAULT_ALPHA=1,e==null&&(e={}),e.alpha!=null&&e.alpha!==this.DEFAULT_ALPHA)throw new tt(`Non-default alpha value (${e.alpha}) is not supported by the ELU layer yet.`);this.alpha=e.alpha==null?this.DEFAULT_ALPHA:e.alpha}call(e,t){const s=He(e);return td(s)}computeOutputShape(e){return e}getConfig(){const e={alpha:this.alpha},t=super.getConfig();return Object.assign(e,t),e}};RA.className="ELU";ve(RA);class DA extends at{constructor(e){super(e??{}),this.DEFAULT_THETA=1,e==null&&(e={}),this.theta=e.theta==null?this.DEFAULT_THETA:e.theta}call(e,t){const s=He(e);return H(s,Ne(Ms(s,this.theta),"float32"))}computeOutputShape(e){return e}getConfig(){const e={theta:this.theta},t=super.getConfig();return Object.assign(e,t),e}}DA.className="ThresholdedReLU";ve(DA);class AA extends at{constructor(e){super(e??{}),this.DEFAULT_AXIS=1,e==null&&(e={}),this.softmax=new tS().apply,this.axis=e.axis==null?this.DEFAULT_AXIS:e.axis}call(e,t){return ie(()=>{let s=He(e);const r=t.mask;if(r!=null){const o=H(Ee($s(s.shape),Ne(r,s.dtype)),We(-1e9));s=ye(s,o)}return this.axis instanceof Array?this.axis.length>1?Os(Ee(s,Sg(s,this.axis,!0))):this.softmax(s,this.axis[0]):this.softmax(s,this.axis)})}computeOutputShape(e){return e}getConfig(){const e={axis:this.axis},t=super.getConfig();return Object.assign(e,t),e}}AA.className="Softmax";ve(AA);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Ul(n,e,t){if(typeof n=="number")return Aa(n,e);if(n.length!==e)throw new Z(`The ${t} argument must be an integer or tuple of ${e} integers. Received: ${n.length} elements.`);for(let s=0;s<e;++s){const r=n[s];if(!gq(r))throw new Z(`The ${t} argument must be an integer or tuple of ${e} integers. Received: ${JSON.stringify(n)} including a non-integer number ${r}`)}return n}function Pr(n,e,t,s,r=1){if(n==null)return n;const o=e+(e-1)*(r-1);let i;return t==="same"?i=n:i=n-o+1,Math.floor((i+s-1)/s)}function Zr(n,e,t,s){if(n==null)return null;if(s==="valid")n=n*e+ki([t-e,0]);else if(s==="same")n=n*e;else throw new Z(`Unsupport padding mode: ${s}.`);return n}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function nS(n,e){return ie(()=>(en(e),e==="channelsFirst"?ht(n,[0,2,3,1]):n))}function OA(n,e){return ie(()=>(en(e),e==="channelsFirst"?ht(n,[0,2,3,4,1]):n))}function P8(n,e,t,s=1,r="valid",o,i=1){return ie(()=>{if(o==null&&(o=zr()),en(o),n.shape.length!==3)throw new Z(`The input of a conv1dWithBias operation should be 3, but is ${n.shape.length} instead.`);if(e.shape.length!==3)throw new Z(`The kernel for a conv1dWithBias operation should be 3, but is ${e.shape.length} instead`);if(t!=null&&t.shape.length!==1)throw new Z(`The bias for a conv1dWithBias operation should be 1, but is ${t.shape.length} instead`);if(o==="channelsFirst"&&(n=ht(n,[0,2,1])),r==="causal")throw new tt("The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.");let a=L1(n,e,s,r==="same"?"same":"valid","NWC",i);return t!=null&&(a=Wr(a,t)),a})}function aI(n,e,t,s=[1,1],r="valid",o,i,a=null){return ie(()=>{if(o==null&&(o=zr()),en(o),n.rank!==3&&n.rank!==4)throw new Z(`conv2dWithBiasActivation expects input to be of rank 3 or 4, but received ${n.rank}.`);if(e.rank!==3&&e.rank!==4)throw new Z(`conv2dWithBiasActivation expects kernel to be of rank 3 or 4, but received ${n.rank}.`);let l=nS(n,o);if(r==="causal")throw new tt("The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.");return l=RR({x:l,filter:e,strides:s,pad:r==="same"?"same":"valid",dilations:i,dataFormat:"NHWC",bias:t,activation:a}),o==="channelsFirst"&&(l=ht(l,[0,3,1,2])),l})}function L8(n,e,t,s=[1,1,1],r="valid",o,i){return ie(()=>{if(o==null&&(o=zr()),en(o),n.rank!==4&&n.rank!==5)throw new Z(`conv3dWithBias expects input to be of rank 4 or 5, but received ${n.rank}.`);if(e.rank!==4&&e.rank!==5)throw new Z(`conv3dWithBias expects kernel to be of rank 4 or 5, but received ${n.rank}.`);let a=OA(n,o);if(r==="causal")throw new tt("The support for CAUSAL padding mode in conv3dWithBias is not implemented yet.");return a=YE(a,e,s,r==="same"?"same":"valid","NDHWC",i),t!=null&&(a=Wr(a,t)),o==="channelsFirst"&&(a=ht(a,[0,4,1,2,3])),a})}class Hg extends at{constructor(e,t){if(super(t),this.bias=null,this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_BIAS_INITIALIZER="zeros",Hg.verifyArgs(t),this.rank=e,Tn(this.rank,"rank"),this.rank!==1&&this.rank!==2&&this.rank!==3)throw new tt(`Convolution layer for rank other than 1, 2, or 3 (${this.rank}) is not implemented yet.`);if(this.kernelSize=Ul(t.kernelSize,e,"kernelSize"),this.strides=Ul(t.strides==null?1:t.strides,e,"strides"),this.padding=t.padding==null?"valid":t.padding,qs(this.padding),this.dataFormat=t.dataFormat==null?"channelsLast":t.dataFormat,en(this.dataFormat),this.activation=Ni(t.activation),this.useBias=t.useBias==null?!0:t.useBias,this.biasInitializer=_t(t.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.biasConstraint=yn(t.biasConstraint),this.biasRegularizer=Ft(t.biasRegularizer),this.activityRegularizer=Ft(t.activityRegularizer),this.dilationRate=Ul(t.dilationRate==null?1:t.dilationRate,e,"dilationRate"),this.rank===1&&Array.isArray(this.dilationRate)&&this.dilationRate.length!==1)throw new Z(`dilationRate must be a number or an array of a single number for 1D convolution, but received ${JSON.stringify(this.dilationRate)}`);if(this.rank===2){if(typeof this.dilationRate=="number")this.dilationRate=[this.dilationRate,this.dilationRate];else if(this.dilationRate.length!==2)throw new Z(`dilationRate must be a number or array of two numbers for 2D convolution, but received ${JSON.stringify(this.dilationRate)}`)}else if(this.rank===3){if(typeof this.dilationRate=="number")this.dilationRate=[this.dilationRate,this.dilationRate,this.dilationRate];else if(this.dilationRate.length!==3)throw new Z(`dilationRate must be a number or array of three numbers for 3D convolution, but received ${JSON.stringify(this.dilationRate)}`)}}static verifyArgs(e){if(Qr("kernelSize"in e,"required key 'kernelSize' not in config"),typeof e.kernelSize!="number"&&!Wb(e.kernelSize,"number",1,3))throw new Z(`BaseConv expects config.kernelSize to be number or number[] with length 1, 2, or 3, but received ${JSON.stringify(e.kernelSize)}.`)}getConfig(){const e={kernelSize:this.kernelSize,strides:this.strides,padding:this.padding,dataFormat:this.dataFormat,dilationRate:this.dilationRate,activation:Ti(this.activation),useBias:this.useBias,biasInitializer:Mt(this.biasInitializer),biasRegularizer:kt(this.biasRegularizer),activityRegularizer:kt(this.activityRegularizer),biasConstraint:gn(this.biasConstraint)},t=super.getConfig();return Object.assign(e,t),e}}class gu extends Hg{constructor(e,t){super(e,t),this.kernel=null,gu.verifyArgs(t),this.filters=t.filters,Tn(this.filters,"filters"),this.kernelInitializer=_t(t.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.kernelConstraint=yn(t.kernelConstraint),this.kernelRegularizer=Ft(t.kernelRegularizer)}build(e){e=ft(e);const t=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[t]==null)throw new Z(`The channel dimension of the input should be defined. Found ${e[t]}`);const s=e[t],r=this.kernelSize.concat([s,this.filters]);this.kernel=this.addWeight("kernel",r,null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[{ndim:this.rank+2,axes:{[t]:s}}],this.built=!0}call(e,t){return ie(()=>{e=He(e);let s;const r=this.bias==null?null:this.bias.read(),o=ED(this.activation.getClassName());if(o!=null&&this.rank===2)s=aI(e,this.kernel.read(),r,this.strides,this.padding,this.dataFormat,this.dilationRate,o);else{if(this.rank===1)s=P8(e,this.kernel.read(),r,this.strides[0],this.padding,this.dataFormat,this.dilationRate[0]);else if(this.rank===2)s=aI(e,this.kernel.read(),r,this.strides,this.padding,this.dataFormat,this.dilationRate);else if(this.rank===3)s=L8(e,this.kernel.read(),r,this.strides,this.padding,this.dataFormat,this.dilationRate);else throw new tt("convolutions greater than 3D are not implemented yet.");this.activation!=null&&(s=this.activation.apply(s))}return s})}computeOutputShape(e){e=ft(e);const t=[],s=this.dataFormat==="channelsLast"?e.slice(1,e.length-1):e.slice(2);for(let o=0;o<s.length;++o){const i=Pr(s[o],this.kernelSize[o],this.padding,this.strides[o],typeof this.dilationRate=="number"?this.dilationRate:this.dilationRate[o]);t.push(i)}let r=[e[0]];return this.dataFormat==="channelsLast"?(r=r.concat(t),r.push(this.filters)):(r.push(this.filters),r=r.concat(t)),r}getConfig(){const e={filters:this.filters,kernelInitializer:Mt(this.kernelInitializer),kernelRegularizer:kt(this.kernelRegularizer),kernelConstraint:gn(this.kernelConstraint)},t=super.getConfig();return Object.assign(e,t),e}static verifyArgs(e){if(!("filters"in e)||typeof e.filters!="number"||e.filters<1)throw new Z(`Convolution layer expected config.filters to be a 'number' > 0 but got ${JSON.stringify(e.filters)}`)}}class fd extends gu{constructor(e){super(2,e),fd.verifyArgs(e)}getConfig(){const e=super.getConfig();return delete e.rank,e}static verifyArgs(e){if(typeof e.kernelSize!="number"&&!Wb(e.kernelSize,"number",1,2))throw new Z(`Conv2D expects config.kernelSize to be number or number[] with length 1 or 2, but received ${JSON.stringify(e.kernelSize)}.`)}}fd.className="Conv2D";ve(fd);class md extends gu{constructor(e){super(3,e),md.verifyArgs(e)}getConfig(){const e=super.getConfig();return delete e.rank,e}static verifyArgs(e){if(typeof e.kernelSize!="number"&&!(Array.isArray(e.kernelSize)&&(e.kernelSize.length===1||e.kernelSize.length===3)))throw new Z(`Conv3D expects config.kernelSize to be number or [number, number, number], but received ${JSON.stringify(e.kernelSize)}.`)}}md.className="Conv3D";ve(md);class _A extends fd{constructor(e){if(super(e),this.inputSpec=[new fn({ndim:4})],this.padding!=="same"&&this.padding!=="valid")throw new Z(`Conv2DTranspose currently supports only padding modes 'same' and 'valid', but received padding mode ${this.padding}`)}build(e){if(e=ft(e),e.length!==4)throw new Z("Input should have rank 4; Received input shape: "+JSON.stringify(e));const t=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[t]==null)throw new Z("The channel dimension of the inputs should be defined. Found `None`.");const s=e[t],r=this.kernelSize.concat([this.filters,s]);this.kernel=this.addWeight("kernel",r,"float32",this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[new fn({ndim:4,axes:{[t]:s}})],this.built=!0}call(e,t){return ie(()=>{let s=He(e);if(s.shape.length!==4)throw new Z(`Conv2DTranspose.call() expects input tensor to be rank-4, but received a tensor of rank-${s.shape.length}`);const r=s.shape,o=r[0];let i,a;this.dataFormat==="channelsFirst"?(i=2,a=3):(i=1,a=2);const l=r[i],u=r[a],h=this.kernelSize[0],p=this.kernelSize[1],f=this.strides[0],m=this.strides[1],y=Zr(l,f,h,this.padding),x=Zr(u,m,p,this.padding),v=[o,y,x,this.filters];this.dataFormat!=="channelsLast"&&(s=ht(s,[0,2,3,1]));let w=z1(s,this.kernel.read(),v,this.strides,this.padding);return this.dataFormat!=="channelsLast"&&(w=ht(w,[0,3,1,2])),this.bias!=null&&(w=Wr(w,this.bias.read(),this.dataFormat)),this.activation!=null&&(w=this.activation.apply(w)),w})}computeOutputShape(e){e=ft(e);const t=e.slice();let s,r,o;this.dataFormat==="channelsFirst"?(s=1,r=2,o=3):(s=3,r=1,o=2);const i=this.kernelSize[0],a=this.kernelSize[1],l=this.strides[0],u=this.strides[1];return t[s]=this.filters,t[r]=Zr(t[r],l,i,this.padding),t[o]=Zr(t[o],u,a,this.padding),t}getConfig(){const e=super.getConfig();return delete e.dilationRate,e}}_A.className="Conv2DTranspose";ve(_A);class FA extends md{constructor(e){if(super(e),this.inputSpec=[new fn({ndim:5})],this.padding!=="same"&&this.padding!=="valid")throw new Z(`Conv3DTranspose currently supports only padding modes 'same' and 'valid', but received padding mode ${this.padding}`)}build(e){if(e=ft(e),e.length!==5)throw new Z("Input should have rank 5; Received input shape: "+JSON.stringify(e));const t=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[t]==null)throw new Z("The channel dimension of the inputs should be defined. Found `None`.");const s=e[t],r=this.kernelSize.concat([this.filters,s]);this.kernel=this.addWeight("kernel",r,"float32",this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[new fn({ndim:5,axes:{[t]:s}})],this.built=!0}call(e,t){return ie(()=>{let s=He(e);if(s.shape.length!==5)throw new Z(`Conv3DTranspose.call() expects input tensor to be rank-4, but received a tensor of rank-${s.shape.length}`);const r=s.shape,o=r[0];let i,a,l;this.dataFormat==="channelsFirst"?(l=2,i=3,a=4):(l=1,i=2,a=3);const u=r[l],h=r[i],p=r[a],f=this.kernelSize[0],m=this.kernelSize[1],y=this.kernelSize[2],x=this.strides[0],v=this.strides[1],w=this.strides[2],S=Zr(u,x,f,this.padding),k=Zr(h,v,m,this.padding),T=Zr(p,w,y,this.padding),I=[o,S,k,T,this.filters];this.dataFormat!=="channelsLast"&&(s=ht(s,[0,2,3,4,1]));let E=ZE(s,this.kernel.read(),I,this.strides,this.padding);return this.dataFormat!=="channelsLast"&&(E=ht(E,[0,4,1,2,3])),this.bias!==null&&(E=Wr(E,this.bias.read(),this.dataFormat)),this.activation!==null&&(E=this.activation.apply(E)),E})}computeOutputShape(e){e=ft(e);const t=e.slice();let s,r,o,i;this.dataFormat==="channelsFirst"?(s=1,r=2,o=3,i=4):(s=4,r=1,o=2,i=3);const a=this.kernelSize[0],l=this.kernelSize[1],u=this.kernelSize[2],h=this.strides[0],p=this.strides[1],f=this.strides[2];return t[s]=this.filters,t[r]=Zr(t[r],h,a,this.padding),t[o]=Zr(t[o],p,l,this.padding),t[i]=Zr(t[i],f,u,this.padding),t}getConfig(){const e=super.getConfig();return delete e.dilationRate,e}}FA.className="Conv3DTranspose";ve(FA);class PA extends gu{constructor(e,t){if(super(e,t),this.DEFAULT_DEPTHWISE_INITIALIZER="glorotUniform",this.DEFAULT_POINTWISE_INITIALIZER="glorotUniform",this.depthwiseKernel=null,this.pointwiseKernel=null,t.filters==null)throw new Z("The `filters` configuration field is required by SeparableConv, but is unspecified.");if(t.kernelInitializer!=null||t.kernelRegularizer!=null||t.kernelConstraint!=null)throw new Z("Fields kernelInitializer, kernelRegularizer and kernelConstraint are invalid for SeparableConv2D. Use depthwiseInitializer, depthwiseRegularizer, depthwiseConstraint, pointwiseInitializer, pointwiseRegularizer and pointwiseConstraint instead.");if(t.padding!=null&&t.padding!=="same"&&t.padding!=="valid")throw new Z(`SeparableConv${this.rank}D supports only padding modes: 'same' and 'valid', but received ${JSON.stringify(t.padding)}`);this.depthMultiplier=t.depthMultiplier==null?1:t.depthMultiplier,this.depthwiseInitializer=_t(t.depthwiseInitializer||this.DEFAULT_DEPTHWISE_INITIALIZER),this.depthwiseRegularizer=Ft(t.depthwiseRegularizer),this.depthwiseConstraint=yn(t.depthwiseConstraint),this.pointwiseInitializer=_t(t.depthwiseInitializer||this.DEFAULT_POINTWISE_INITIALIZER),this.pointwiseRegularizer=Ft(t.pointwiseRegularizer),this.pointwiseConstraint=yn(t.pointwiseConstraint)}build(e){if(e=ft(e),e.length<this.rank+2)throw new Z(`Inputs to SeparableConv${this.rank}D should have rank ${this.rank+2}, but received input shape: ${JSON.stringify(e)}`);const t=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[t]==null||e[t]<0)throw new Z(`The channel dimension of the inputs should be defined, but found ${JSON.stringify(e[t])}`);const s=e[t],r=this.kernelSize.concat([s,this.depthMultiplier]),o=[];for(let a=0;a<this.rank;++a)o.push(1);o.push(s*this.depthMultiplier,this.filters);const i=!0;this.depthwiseKernel=this.addWeight("depthwise_kernel",r,"float32",this.depthwiseInitializer,this.depthwiseRegularizer,i,this.depthwiseConstraint),this.pointwiseKernel=this.addWeight("pointwise_kernel",o,"float32",this.pointwiseInitializer,this.pointwiseRegularizer,i,this.pointwiseConstraint),this.useBias?this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,i,this.biasConstraint):this.bias=null,this.inputSpec=[new fn({ndim:this.rank+2,axes:{[t]:s}})],this.built=!0}call(e,t){return ie(()=>{e=He(e);let s;if(this.rank===1)throw new tt("1D separable convolution is not implemented yet.");return this.rank===2&&(this.dataFormat==="channelsFirst"&&(e=ht(e,[0,2,3,1])),s=tb(e,this.depthwiseKernel.read(),this.pointwiseKernel.read(),this.strides,this.padding,this.dilationRate,"NHWC")),this.useBias&&(s=Wr(s,this.bias.read(),this.dataFormat)),this.activation!=null&&(s=this.activation.apply(s)),this.dataFormat==="channelsFirst"&&(s=ht(s,[0,3,1,2])),s})}getConfig(){const e=super.getConfig();return delete e.rank,delete e.kernelInitializer,delete e.kernelRegularizer,delete e.kernelConstraint,e.depthwiseInitializer=Mt(this.depthwiseInitializer),e.pointwiseInitializer=Mt(this.pointwiseInitializer),e.depthwiseRegularizer=kt(this.depthwiseRegularizer),e.pointwiseRegularizer=kt(this.pointwiseRegularizer),e.depthwiseConstraint=gn(this.depthwiseConstraint),e.pointwiseConstraint=gn(this.pointwiseConstraint),e}}PA.className="SeparableConv";class LA extends PA{constructor(e){super(2,e)}}LA.className="SeparableConv2D";ve(LA);class Kg extends gu{constructor(e){super(1,e),Kg.verifyArgs(e),this.inputSpec=[{ndim:3}]}getConfig(){const e=super.getConfig();return delete e.rank,delete e.dataFormat,e}static verifyArgs(e){if(typeof e.kernelSize!="number"&&!Wb(e.kernelSize,"number",1,1))throw new Z(`Conv1D expects config.kernelSize to be number or number[] with length 1, but received ${JSON.stringify(e.kernelSize)}.`)}}Kg.className="Conv1D";ve(Kg);class MA extends at{constructor(e){super(e),typeof e.cropping=="number"?this.cropping=[[e.cropping,e.cropping],[e.cropping,e.cropping]]:typeof e.cropping[0]=="number"?this.cropping=[[e.cropping[0],e.cropping[0]],[e.cropping[1],e.cropping[1]]]:this.cropping=e.cropping,this.dataFormat=e.dataFormat===void 0?"channelsLast":e.dataFormat,this.inputSpec=[{ndim:4}]}computeOutputShape(e){return this.dataFormat==="channelsFirst"?[e[0],e[1],e[2]-this.cropping[0][0]-this.cropping[0][1],e[3]-this.cropping[1][0]-this.cropping[1][1]]:[e[0],e[1]-this.cropping[0][0]-this.cropping[0][1],e[2]-this.cropping[1][0]-this.cropping[1][1],e[3]]}call(e,t){return ie(()=>{if(e=He(e),this.dataFormat==="channelsLast"){const s=zp(e,this.cropping[0][0],e.shape[1]-this.cropping[0][0]-this.cropping[0][1],2);return zp(s,this.cropping[1][0],e.shape[2]-this.cropping[1][1]-this.cropping[1][0],3)}else{const s=zp(e,this.cropping[0][0],e.shape[2]-this.cropping[0][0]-this.cropping[0][1],3);return zp(s,this.cropping[1][0],e.shape[3]-this.cropping[1][1]-this.cropping[1][0],4)}})}getConfig(){const e={cropping:this.cropping,dataFormat:this.dataFormat},t=super.getConfig();return Object.assign(e,t),e}}MA.className="Cropping2D";ve(MA);class zA extends at{constructor(e){super(e),this.DEFAULT_SIZE=[2,2],this.inputSpec=[{ndim:4}],this.size=e.size==null?this.DEFAULT_SIZE:e.size,this.dataFormat=e.dataFormat==null?"channelsLast":e.dataFormat,en(this.dataFormat),this.interpolation=e.interpolation==null?"nearest":e.interpolation,pq(this.interpolation)}computeOutputShape(e){if(this.dataFormat==="channelsFirst"){const t=e[2]==null?null:this.size[0]*e[2],s=e[3]==null?null:this.size[1]*e[3];return[e[0],e[1],t,s]}else{const t=e[1]==null?null:this.size[0]*e[1],s=e[2]==null?null:this.size[1]*e[2];return[e[0],t,s,e[3]]}}call(e,t){return ie(()=>{let s=He(e);const r=s.shape;if(this.dataFormat==="channelsFirst"){s=ht(s,[0,2,3,1]);const o=this.size[0]*r[2],i=this.size[1]*r[3],a=this.interpolation==="nearest"?Es.resizeNearestNeighbor(s,[o,i]):Es.resizeBilinear(s,[o,i]);return ht(a,[0,3,1,2])}else{const o=this.size[0]*r[1],i=this.size[1]*r[2];return this.interpolation==="nearest"?Es.resizeNearestNeighbor(s,[o,i]):Es.resizeBilinear(s,[o,i])}})}getConfig(){const e={size:this.size,dataFormat:this.dataFormat,interpolation:this.interpolation},t=super.getConfig();return Object.assign(e,t),e}}zA.className="UpSampling2D";ve(zA);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function M8(n,e,t=[1,1],s="valid",r,o){return ie(()=>{r==null&&(r=zr()),en(r);let i=nS(n,r);if(n.rank!==4)throw new Z(`Input for depthwiseConv2d is required to be 4-D, but is instead ${n.rank}-D`);if(e.rank!==4)throw new Z(`depthwiseKernel is required to be 4-D, but is instead ${e.rank}-D`);return i=ed(i,e,t,s==="same"?"same":"valid","NHWC",o),r==="channelsFirst"&&(i=ht(i,[0,3,1,2])),i})}class VA extends Hg{constructor(e){super(2,e),this.depthwiseKernel=null,this.depthMultiplier=e.depthMultiplier==null?1:e.depthMultiplier,this.depthwiseInitializer=_t(e.depthwiseInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.depthwiseConstraint=yn(e.depthwiseConstraint),this.depthwiseRegularizer=Ft(e.depthwiseRegularizer)}build(e){if(e=ft(e),e.length<4)throw new Z(`Inputs to DepthwiseConv2D should have rank 4. Received input shape: ${JSON.stringify(e)}.`);const t=this.dataFormat==="channelsFirst"?1:3;if(e[t]==null||e[t]<0)throw new Z(`The channel dimension of the inputs to DepthwiseConv2D should be defined, but is not (${e[t]}).`);const s=e[t],r=[this.kernelSize[0],this.kernelSize[1],s,this.depthMultiplier];this.depthwiseKernel=this.addWeight("depthwise_kernel",r,null,this.depthwiseInitializer,this.depthwiseRegularizer,!0,this.depthwiseConstraint),this.useBias?this.bias=this.addWeight("bias",[s*this.depthMultiplier],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(e,t){return ie(()=>{e=He(e);let s=M8(e,this.depthwiseKernel.read(),this.strides,this.padding,this.dataFormat,null);return this.useBias&&(s=Wr(s,this.bias.read(),this.dataFormat)),this.activation!=null&&(s=this.activation.apply(s)),s})}computeOutputShape(e){e=ft(e);const t=this.dataFormat==="channelsFirst"?e[2]:e[1],s=this.dataFormat==="channelsFirst"?e[3]:e[2],r=this.dataFormat==="channelsFirst"?e[1]*this.depthMultiplier:e[3]*this.depthMultiplier,o=Pr(t,this.kernelSize[0],this.padding,this.strides[0]),i=Pr(s,this.kernelSize[1],this.padding,this.strides[1]);return this.dataFormat==="channelsFirst"?[e[0],r,o,i]:[e[0],o,i,r]}getConfig(){const e=super.getConfig();return e.depthMultiplier=this.depthMultiplier,e.depthwiseInitializer=Mt(this.depthwiseInitializer),e.depthwiseRegularizer=kt(this.depthwiseRegularizer),e.depthwiseConstraint=gn(this.depthwiseRegularizer),e}}VA.className="DepthwiseConv2D";ve(VA);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function BA(n,e,t,s){if(Array.isArray(n)){if(e!=null||t!=null)throw new Z("When inputs is an array, neither initialState or constants should be provided");s!=null&&(t=n.slice(n.length-s,n.length),n=n.slice(0,n.length-s)),n.length>1&&(e=n.slice(1,n.length)),n=n[0]}function r(o){return o==null||Array.isArray(o)?o:[o]}return e=r(e),t=r(t),{inputs:n,initialState:e,constants:t}}function WA(n,e,t,s=!1,r,o,i=!1,a=!1){return ie(()=>{const l=e.shape.length;if(l<3)throw new Z(`Input should be at least 3D, but is ${l}D.`);const u=[1,0].concat(Mr(2,l));e=ht(e,u),i&&console.warn("Backend rnn(): the unroll = true option is not applicable to the imperative deeplearn.js backend."),r!=null&&(r=Ne(Ne(r,"bool"),"float32"),r.rank===l-1&&(r=jn(r,-1)),r=ht(r,u)),s&&(e=fr(e,0),r!=null&&(r=fr(r,0)));const h=[];let p,f=t;const m=e.shape[0],y=mr(e);let x;r!=null&&(x=mr(r));for(let w=0;w<m;++w){const S=y[w],k=ie(()=>n(S,f));if(r==null)p=k[0],f=k[1];else{const T=ie(()=>{const I=x[w],E=Ee(Hs(I),I),D=ye(H(k[0],I),H(f[0],E)),O=f.map((_,P)=>ye(H(k[1][P],I),H(_,E)));return{output:D,newStates:O}});p=T.output,f=T.newStates}a&&h.push(p)}let v;return a&&(v=_s(h,1)),[p,v,f]})}class Wi extends at{constructor(e){super(e);let t;if(e.cell==null)throw new Z("cell property is missing for the constructor of RNN.");if(Array.isArray(e.cell)?t=new oS({cells:e.cell}):t=e.cell,t.stateSize==null)throw new Z("The RNN cell should have an attribute `stateSize` (tuple of integers, one integer per RNN state).");this.cell=t,this.returnSequences=e.returnSequences==null?!1:e.returnSequences,this.returnState=e.returnState==null?!1:e.returnState,this.goBackwards=e.goBackwards==null?!1:e.goBackwards,this._stateful=e.stateful==null?!1:e.stateful,this.unroll=e.unroll==null?!1:e.unroll,this.supportsMasking=!0,this.inputSpec=[new fn({ndim:3})],this.stateSpec=null,this.states_=null,this.numConstants=null,this.keptStates=[]}getStates(){if(this.states_==null){const e=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1;return Mr(0,e).map(t=>null)}else return this.states_}setStates(e){this.states_=e}computeOutputShape(e){bv(e)&&(e=e[0]),e=e;let t=this.cell.stateSize;Array.isArray(t)||(t=[t]);const s=t[0];let r;if(this.returnSequences?r=[e[0],e[1],s]:r=[e[0],s],this.returnState){const o=[];for(const i of t)o.push([e[0],i]);return[r].concat(o)}else return r}computeMask(e,t){return ie(()=>{Array.isArray(t)&&(t=t[0]);const s=this.returnSequences?t:null;if(this.returnState){const r=this.states.map(o=>null);return[s].concat(r)}else return s})}get states(){if(this.states_==null){const e=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1,t=[];for(let s=0;s<e;++s)t.push(null);return t}else return this.states_}set states(e){this.states_=e}build(e){if(this.numConstants!=null)throw new tt("Constants support is not implemented in RNN yet.");bv(e)&&(e=e[0]),e=e;const t=this.stateful?e[0]:null,s=e.slice(2);this.inputSpec[0]=new fn({shape:[t,null,...s]});const r=[e[0]].concat(e.slice(2));this.cell.build(r);let o;if(Array.isArray(this.cell.stateSize)?o=this.cell.stateSize:o=[this.cell.stateSize],this.stateSpec!=null){if(!ct(this.stateSpec.map(i=>i.shape[i.shape.length-1]),o))throw new Z(`An initialState was passed that is not compatible with cell.stateSize. Received stateSpec=${this.stateSpec}; However cell.stateSize is ${this.cell.stateSize}`)}else this.stateSpec=o.map(i=>new fn({shape:[null,i]}));this.stateful&&this.resetStates()}resetStates(e,t=!1){ie(()=>{if(!this.stateful)throw new Yr("Cannot call resetStates() on an RNN Layer that is not stateful.");const s=this.inputSpec[0].shape[0];if(s==null)throw new Z("If an RNN is stateful, it needs to know its batch size. Specify the batch size of your input tensors: \n- If using a Sequential model, specify the batch size by passing a `batchInputShape` option to your first layer.\n- If using the functional API, specify the batch size by passing a `batchShape` option to your Input layer.");if(this.states_==null)Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(r=>dn([s,r])):this.states_=[dn([s,this.cell.stateSize])];else if(e==null)ot(this.states_),this.keptStates!=null&&(ot(this.keptStates),this.keptStates=[]),Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(r=>dn([s,r])):this.states_[0]=dn([s,this.cell.stateSize]);else{if(Array.isArray(e)||(e=[e]),e.length!==this.states_.length)throw new Z(`Layer ${this.name} expects ${this.states_.length} state(s), but it received ${e.length} state value(s). Input received: ${e}`);t===!0?this.keptStates.push(this.states_.slice()):ot(this.states_);for(let r=0;r<this.states_.length;++r){const o=e[r],i=Array.isArray(this.cell.stateSize)?this.cell.stateSize[r]:this.cell.stateSize,a=[s,i];if(!ct(o.shape,a))throw new Z(`State ${r} is incompatible with layer ${this.name}: expected shape=${a}, received shape=${o.shape}`);this.states_[r]=o}}this.states_=this.states_.map(r=>kn(r.clone()))})}apply(e,t){let s=t==null?null:t.initialState,r=t==null?null:t.constants;t==null&&(t={});const o=BA(e,s,r,this.numConstants);e=o.inputs,s=o.initialState,r=o.constants;let i=[],a=[];if(s!=null){t.initialState=s,i=i.concat(s),this.stateSpec=[];for(const u of s)this.stateSpec.push(new fn({shape:u.shape}));a=a.concat(this.stateSpec)}if(r!=null&&(t.constants=r,i=i.concat(r),this.numConstants=r.length),i[0]instanceof lo){const u=[e].concat(i),h=this.inputSpec.concat(a),p=this.inputSpec;this.inputSpec=h;const f=super.apply(u,t);return this.inputSpec=p,f}else return super.apply(e,t)}call(e,t){return ie(()=>{const s=t==null?null:t.mask,r=t==null?null:t.training;let o=t==null?null:t.initialState;e=He(e),o==null&&(this.stateful?o=this.states_:o=this.getInitialState(e));const i=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1;if(o.length!==i)throw new Z(`RNN Layer has ${i} state(s) but was passed ${o.length} initial state(s).`);this.unroll&&console.warn("Ignoring unroll = true for RNN layer, due to imperative backend.");const a={training:r},u=WA((y,x)=>{const v=this.cell.call([y].concat(x),a);return[v[0],v.slice(1)]},e,o,this.goBackwards,s,null,this.unroll,this.returnSequences),h=u[0],p=u[1],f=u[2];this.stateful&&this.resetStates(f,r);const m=this.returnSequences?p:h;return this.returnState?[m].concat(f):m})}getInitialState(e){return ie(()=>{let t=dn(e.shape);return t=_e(t,[1,2]),t=ud(t),Array.isArray(this.cell.stateSize)?this.cell.stateSize.map(s=>s>1?vv(t,[1,s]):t):this.cell.stateSize>1?[vv(t,[1,this.cell.stateSize])]:[t]})}get trainableWeights(){return this.trainable?this.cell.trainableWeights:[]}get nonTrainableWeights(){return this.trainable?this.cell.nonTrainableWeights:this.cell.weights}setFastWeightInitDuringBuild(e){super.setFastWeightInitDuringBuild(e),this.cell!=null&&this.cell.setFastWeightInitDuringBuild(e)}getConfig(){const e=super.getConfig(),t={returnSequences:this.returnSequences,returnState:this.returnState,goBackwards:this.goBackwards,stateful:this.stateful,unroll:this.unroll};this.numConstants!=null&&(t.numConstants=this.numConstants);const s=this.cell.getConfig();return this.getClassName()===Wi.className&&(t.cell={className:this.cell.getClassName(),config:s}),Object.assign(Object.assign(Object.assign({},s),e),t)}static fromConfig(e,t,s={}){const r=t.cell,o=$o(r,s);return new e(Object.assign(t,{cell:o}))}}Wi.className="RNN";ve(Wi);class qg extends at{}class sS extends qg{constructor(e){super(e),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",this.units=e.units,Tn(this.units,"units"),this.activation=Ni(e.activation==null?this.DEFAULT_ACTIVATION:e.activation),this.useBias=e.useBias==null?!0:e.useBias,this.kernelInitializer=_t(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=_t(e.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=_t(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelRegularizer=Ft(e.kernelRegularizer),this.recurrentRegularizer=Ft(e.recurrentRegularizer),this.biasRegularizer=Ft(e.biasRegularizer),this.kernelConstraint=yn(e.kernelConstraint),this.recurrentConstraint=yn(e.recurrentConstraint),this.biasConstraint=yn(e.biasConstraint),this.dropout=Zl([1,ki([0,e.dropout==null?0:e.dropout])]),this.recurrentDropout=Zl([1,ki([0,e.recurrentDropout==null?0:e.recurrentDropout])]),this.dropoutFunc=e.dropoutFunc,this.stateSize=this.units,this.dropoutMask=null,this.recurrentDropoutMask=null}build(e){e=ft(e),this.kernel=this.addWeight("kernel",[e[e.length-1],this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias?this.bias=this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(e,t){return ie(()=>{if(e=e,e.length!==2)throw new Z(`SimpleRNNCell expects 2 input Tensors, got ${e.length}.`);let s=e[1];e=e[0];const r=t.training==null?!1:t.training;0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=Ii({ones:()=>Hs(e),rate:this.dropout,training:r,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=Ii({ones:()=>Hs(s),rate:this.recurrentDropout,training:r,dropoutFunc:this.dropoutFunc}));let o;const i=this.dropoutMask,a=this.recurrentDropoutMask;i!=null?o=so(H(e,i),this.kernel.read()):o=so(e,this.kernel.read()),this.bias!=null&&(o=Wr(o,this.bias.read())),a!=null&&(s=H(s,a));let l=ye(o,so(s,this.recurrentKernel.read()));return this.activation!=null&&(l=this.activation.apply(l)),[l,l]})}getConfig(){const e=super.getConfig(),t={units:this.units,activation:Ti(this.activation),useBias:this.useBias,kernelInitializer:Mt(this.kernelInitializer),recurrentInitializer:Mt(this.recurrentInitializer),biasInitializer:Mt(this.biasInitializer),kernelRegularizer:kt(this.kernelRegularizer),recurrentRegularizer:kt(this.recurrentRegularizer),biasRegularizer:kt(this.biasRegularizer),activityRegularizer:kt(this.activityRegularizer),kernelConstraint:gn(this.kernelConstraint),recurrentConstraint:gn(this.recurrentConstraint),biasConstraint:gn(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout};return Object.assign(Object.assign({},e),t)}}sS.className="SimpleRNNCell";ve(sS);class UA extends Wi{constructor(e){e.cell=new sS(e),super(e)}call(e,t){return ie(()=>{this.cell.dropoutMask!=null&&(ot(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(ot(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);const s=t==null?null:t.mask,r=t==null?null:t.training,o=t==null?null:t.initialState;return super.call(e,{mask:s,training:r,initialState:o})})}static fromConfig(e,t){return new e(t)}}UA.className="SimpleRNN";ve(UA);class rS extends qg{constructor(e){if(super(e),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",e.resetAfter)throw new Z("GRUCell does not support reset_after parameter set to true.");this.units=e.units,Tn(this.units,"units"),this.activation=Ni(e.activation===void 0?this.DEFAULT_ACTIVATION:e.activation),this.recurrentActivation=Ni(e.recurrentActivation===void 0?this.DEFAULT_RECURRENT_ACTIVATION:e.recurrentActivation),this.useBias=e.useBias==null?!0:e.useBias,this.kernelInitializer=_t(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=_t(e.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=_t(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelRegularizer=Ft(e.kernelRegularizer),this.recurrentRegularizer=Ft(e.recurrentRegularizer),this.biasRegularizer=Ft(e.biasRegularizer),this.kernelConstraint=yn(e.kernelConstraint),this.recurrentConstraint=yn(e.recurrentConstraint),this.biasConstraint=yn(e.biasConstraint),this.dropout=Zl([1,ki([0,e.dropout==null?0:e.dropout])]),this.recurrentDropout=Zl([1,ki([0,e.recurrentDropout==null?0:e.recurrentDropout])]),this.dropoutFunc=e.dropoutFunc,this.implementation=e.implementation,this.stateSize=this.units,this.dropoutMask=null,this.recurrentDropoutMask=null}build(e){e=ft(e);const t=e[e.length-1];this.kernel=this.addWeight("kernel",[t,this.units*3],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units*3],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias?this.bias=this.addWeight("bias",[this.units*3],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(e,t){return ie(()=>{if(e=e,e.length!==2)throw new Z(`GRUCell expects 2 input Tensors (inputs, h, c), got ${e.length}.`);const s=t.training==null?!1:t.training;let r=e[1];e=e[0],0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=Ii({ones:()=>Hs(e),rate:this.dropout,training:s,count:3,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=Ii({ones:()=>Hs(r),rate:this.recurrentDropout,training:s,count:3,dropoutFunc:this.dropoutFunc}));const o=this.dropoutMask,i=this.recurrentDropoutMask;let a,l,u;0<this.dropout&&this.dropout<1&&(e=H(e,o[0]));let h=so(e,this.kernel.read());this.useBias&&(h=Wr(h,this.bias.read())),0<this.recurrentDropout&&this.recurrentDropout<1&&(r=H(r,i[0]));const p=this.recurrentKernel.read(),[f,m]=Rs(p,[2*this.units,this.units],p.rank-1),y=so(r,f),[x,v,w]=Rs(h,3,h.rank-1),[S,k]=Rs(y,2,y.rank-1);a=this.recurrentActivation.apply(ye(x,S)),l=this.recurrentActivation.apply(ye(v,k));const T=so(H(l,r),m);u=this.activation.apply(ye(w,T));const I=ye(H(a,r),H(ye(1,Rt(a)),u));return[I,I]})}getConfig(){const e=super.getConfig(),t={units:this.units,activation:Ti(this.activation),recurrentActivation:Ti(this.recurrentActivation),useBias:this.useBias,kernelInitializer:Mt(this.kernelInitializer),recurrentInitializer:Mt(this.recurrentInitializer),biasInitializer:Mt(this.biasInitializer),kernelRegularizer:kt(this.kernelRegularizer),recurrentRegularizer:kt(this.recurrentRegularizer),biasRegularizer:kt(this.biasRegularizer),activityRegularizer:kt(this.activityRegularizer),kernelConstraint:gn(this.kernelConstraint),recurrentConstraint:gn(this.recurrentConstraint),biasConstraint:gn(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation,resetAfter:!1};return Object.assign(Object.assign({},e),t)}}rS.className="GRUCell";ve(rS);class GA extends Wi{constructor(e){e.implementation===0&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),e.cell=new rS(e),super(e)}call(e,t){return ie(()=>{this.cell.dropoutMask!=null&&(ot(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(ot(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);const s=t==null?null:t.mask,r=t==null?null:t.training,o=t==null?null:t.initialState;return super.call(e,{mask:s,training:r,initialState:o})})}static fromConfig(e,t){return t.implmentation===0&&(t.implementation=1),new e(t)}}GA.className="GRU";ve(GA);class Xg extends qg{constructor(e){super(e),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",this.units=e.units,Tn(this.units,"units"),this.activation=Ni(e.activation===void 0?this.DEFAULT_ACTIVATION:e.activation),this.recurrentActivation=Ni(e.recurrentActivation===void 0?this.DEFAULT_RECURRENT_ACTIVATION:e.recurrentActivation),this.useBias=e.useBias==null?!0:e.useBias,this.kernelInitializer=_t(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=_t(e.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=_t(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.unitForgetBias=e.unitForgetBias,this.kernelRegularizer=Ft(e.kernelRegularizer),this.recurrentRegularizer=Ft(e.recurrentRegularizer),this.biasRegularizer=Ft(e.biasRegularizer),this.kernelConstraint=yn(e.kernelConstraint),this.recurrentConstraint=yn(e.recurrentConstraint),this.biasConstraint=yn(e.biasConstraint),this.dropout=Zl([1,ki([0,e.dropout==null?0:e.dropout])]),this.recurrentDropout=Zl([1,ki([0,e.recurrentDropout==null?0:e.recurrentDropout])]),this.dropoutFunc=e.dropoutFunc,this.implementation=e.implementation,this.stateSize=[this.units,this.units],this.dropoutMask=null,this.recurrentDropoutMask=null}build(e){var t;e=ft(e);const s=e[e.length-1];this.kernel=this.addWeight("kernel",[s,this.units*4],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units*4],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint);let r;if(this.useBias){if(this.unitForgetBias){const o=this.biasInitializer,i=this.units;r=new(t=class extends xr{apply(l,u){const h=o.apply([i]),p=new Gb().apply([i]),f=o.apply([i*2]);return GN(GN(h,p),f)}},t.className="CustomInit",t)}else r=this.biasInitializer;this.bias=this.addWeight("bias",[this.units*4],null,r,this.biasRegularizer,!0,this.biasConstraint)}else this.bias=null;this.built=!0}call(e,t){return ie(()=>{const s=t.training==null?!1:t.training;if(e=e,e.length!==3)throw new Z(`LSTMCell expects 3 input Tensors (inputs, h, c), got ${e.length}.`);let r=e[1];const o=e[2];e=e[0],0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=Ii({ones:()=>Hs(e),rate:this.dropout,training:s,count:4,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=Ii({ones:()=>Hs(r),rate:this.recurrentDropout,training:s,count:4,dropoutFunc:this.dropoutFunc}));const i=this.dropoutMask,a=this.recurrentDropoutMask;let l,u,h,p;0<this.dropout&&this.dropout<1&&(e=H(e,i[0]));let f=so(e,this.kernel.read());0<this.recurrentDropout&&this.recurrentDropout<1&&(r=H(r,a[0])),f=ye(f,so(r,this.recurrentKernel.read())),this.useBias&&(f=Wr(f,this.bias.read()));const[m,y,x,v]=Rs(f,4,f.rank-1);l=this.recurrentActivation.apply(m),u=this.recurrentActivation.apply(y),h=ye(H(u,o),H(l,this.activation.apply(x))),p=this.recurrentActivation.apply(v);const w=H(p,this.activation.apply(h));return[w,w,h]})}getConfig(){const e=super.getConfig(),t={units:this.units,activation:Ti(this.activation),recurrentActivation:Ti(this.recurrentActivation),useBias:this.useBias,kernelInitializer:Mt(this.kernelInitializer),recurrentInitializer:Mt(this.recurrentInitializer),biasInitializer:Mt(this.biasInitializer),unitForgetBias:this.unitForgetBias,kernelRegularizer:kt(this.kernelRegularizer),recurrentRegularizer:kt(this.recurrentRegularizer),biasRegularizer:kt(this.biasRegularizer),activityRegularizer:kt(this.activityRegularizer),kernelConstraint:gn(this.kernelConstraint),recurrentConstraint:gn(this.recurrentConstraint),biasConstraint:gn(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation};return Object.assign(Object.assign({},e),t)}}Xg.className="LSTMCell";ve(Xg);class jA extends Wi{constructor(e){e.implementation===0&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),e.cell=new Xg(e),super(e)}call(e,t){return ie(()=>{this.cell.dropoutMask!=null&&(ot(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(ot(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);const s=t==null?null:t.mask,r=t==null?null:t.training,o=t==null?null:t.initialState;return super.call(e,{mask:s,training:r,initialState:o})})}static fromConfig(e,t){return t.implmentation===0&&(t.implementation=1),new e(t)}}jA.className="LSTM";ve(jA);class oS extends qg{constructor(e){super(e),this.cells=e.cells}get stateSize(){const e=[];for(const t of this.cells.slice().reverse())Array.isArray(t.stateSize)?e.push(...t.stateSize):e.push(t.stateSize);return e}call(e,t){return ie(()=>{e=e;let s=e.slice(1);const r=[];for(const a of this.cells.slice().reverse())Array.isArray(a.stateSize)?r.push(s.splice(0,a.stateSize.length)):r.push(s.splice(0,1));r.reverse();const o=[];let i;for(let a=0;a<this.cells.length;++a){const l=this.cells[a];s=r[a],a===0?i=[e[0]].concat(s):i=[i[0]].concat(s),i=l.call(i,t),o.push(i.slice(1))}s=[];for(const a of o.slice().reverse())s.push(...a);return[i[0]].concat(s)})}build(e){bv(e)&&(e=e[0]),e=e;let t;this.cells.forEach((s,r)=>{wa(`RNNCell_${r}`,()=>{s.build(e),Array.isArray(s.stateSize)?t=s.stateSize[0]:t=s.stateSize,e=[e[0],t]})}),this.built=!0}getConfig(){const e=super.getConfig(),t=o=>({className:o.getClassName(),config:o.getConfig()}),r={cells:this.cells.map(t)};return Object.assign(Object.assign({},e),r)}static fromConfig(e,t,s={}){const r=[];for(const o of t.cells)r.push($o(o,s));return new e({cells:r})}get trainableWeights(){if(!this.trainable)return[];const e=[];for(const t of this.cells)e.push(...t.trainableWeights);return e}get nonTrainableWeights(){const e=[];for(const t of this.cells)e.push(...t.nonTrainableWeights);if(!this.trainable){const t=[];for(const s of this.cells)t.push(...s.trainableWeights);return t.concat(e)}return e}getWeights(){const e=[];for(const t of this.cells)e.push(...t.weights);return Sv(e)}setWeights(e){const t=[];for(const s of this.cells){const r=s.weights.length,o=e.splice(r);for(let i=0;i<s.weights.length;++i)t.push([s.weights[i],o[i]])}Qb(t)}}oS.className="StackedRNNCells";ve(oS);function Ii(n){const{ones:e,rate:t,training:s=!1,count:r=1,dropoutFunc:o}=n,i=()=>o!=null?o(e(),t):PD(e(),t),a=()=>hd(i,e,s);return!r||r<=1?kn(a().clone()):Array(r).fill(void 0).map(a).map(u=>kn(u.clone()))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */var z8=function(n,e){var t={};for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&e.indexOf(s)<0&&(t[s]=n[s]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,s=Object.getOwnPropertySymbols(n);r<s.length;r++)e.indexOf(s[r])<0&&Object.prototype.propertyIsEnumerable.call(n,s[r])&&(t[s[r]]=n[s[r]]);return t};class HA extends Wi{constructor(e){if(e.unroll)throw new tt("Unrolling is not possible with convolutional RNNs.");if(Array.isArray(e.cell))throw new tt("It is not possible at the moment to stack convolutional cells.");super(e),this.inputSpec=[new fn({ndim:5})]}call(e,t){return ie(()=>{if(this.cell.dropoutMask!=null&&(ot(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(ot(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null),t&&t.constants)throw new Z("ConvRNN2D cell does not support constants");const s=t==null?null:t.mask,r=t==null?null:t.training,o=t==null?null:t.initialState;return super.call(e,{mask:s,training:r,initialState:o})})}computeOutputShape(e){let t=this.computeSingleOutputShape(e);return this.returnSequences||(t=[t[0],...t.slice(2)]),this.returnState&&(t=[t,...Array(2).fill([e[0],...t.slice(-3)])]),t}getInitialState(e){return ie(()=>{const{stateSize:t}=this.cell,s=e.shape,r=this.computeSingleOutputShape(s),o=[r[0],...r.slice(2)],i=dn(o);return Array.isArray(t)?Array(t.length).fill(i):[i]})}resetStates(e,t=!1){ie(()=>{if(!this.stateful)throw new Yr("Cannot call resetStates() on an RNN Layer that is not stateful.");const s=this.inputSpec[0].shape,r=this.computeSingleOutputShape(s),o=[r[0],...r.slice(2)];if(s[0]==null)throw new Z("If an RNN is stateful, it needs to know its batch size. Specify the batch size of your input tensors: \n- If using a Sequential model, specify the batch size by passing a `batchInputShape` option to your first layer.\n- If using the functional API, specify the batch size by passing a `batchShape` option to your Input layer.");if(this.getStates()==null)Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(()=>dn(o)):this.states_=[dn(o)];else if(e==null)ot(this.states_),this.keptStates!=null&&(ot(this.keptStates),this.keptStates=[]),Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(()=>dn(o)):this.states_[0]=dn(o);else{if(Array.isArray(e)||(e=[e]),e.length!==this.states_.length)throw new Z(`Layer ${this.name} expects ${this.states_.length} state(s), but it received ${e.length} state value(s). Input received: ${e}`);t?this.keptStates.push(this.states_.slice()):ot(this.states_);for(let a=0;a<this.states_.length;++a){const l=e[a],u=o;if(!ct(l.shape,u))throw new Z(`State ${a} is incompatible with layer ${this.name}: expected shape=${u}, received shape=${l.shape}`);this.states_[a]=l}}this.states_=this.states_.map(a=>kn(a.clone()))})}computeSingleOutputShape(e){const{dataFormat:t,filters:s,kernelSize:r,padding:o,strides:i,dilationRate:a}=this.cell,l=t==="channelsFirst",u=e[l?3:2],h=e[l?4:3],p=Pr(u,r[0],o,i[0],a[0]),f=Pr(h,r[1],o,i[1],a[1]);return[...e.slice(0,2),...l?[s,p,f]:[p,f,s]]}}HA.className="ConvRNN2D";class iS extends Xg{constructor(e){const{filters:t,kernelSize:s,strides:r,padding:o,dataFormat:i,dilationRate:a}=e;super(Object.assign(Object.assign({},e),{units:t})),this.filters=t,Tn(this.filters,"filters"),this.kernelSize=Ul(s,2,"kernelSize"),this.kernelSize.forEach(l=>Tn(l,"kernelSize")),this.strides=Ul(r||1,2,"strides"),this.strides.forEach(l=>Tn(l,"strides")),this.padding=o||"valid",qs(this.padding),this.dataFormat=i||"channelsLast",en(this.dataFormat),this.dilationRate=Ul(a||1,2,"dilationRate"),this.dilationRate.forEach(l=>Tn(l,"dilationRate"))}build(e){var t;e=ft(e);const s=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[s]==null)throw new Z(`The channel dimension of the input should be defined. Found ${e[s]}`);const r=e[s],o=4,i=this.kernelSize.concat([r,this.filters*o]);this.kernel=this.addWeight("kernel",i,null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint);const a=this.kernelSize.concat([this.filters,this.filters*o]);if(this.recurrentKernel=this.addWeight("recurrent_kernel",a,null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias){let l;if(this.unitForgetBias){const u=this.biasInitializer,h=this.filters;l=new(t=class extends xr{apply(f,m){const y=u.apply([h]),x=$s([h]),v=u.apply([h*2]);return Ub([y,x,v])}},t.className="CustomInit",t)}else l=this.biasInitializer;this.bias=this.addWeight("bias",[this.filters*o],null,l,this.biasRegularizer,!0,this.biasConstraint)}this.built=!0}call(e,t){return ie(()=>{if(e.length!==3)throw new Z(`ConvLSTM2DCell expects 3 input Tensors (inputs, h, c), got ${e.length}.`);const s=t.training||!1,r=e[0],o=e[1],i=e[2],a=4;0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=Ii({ones:()=>Hs(r),rate:this.dropout,training:s,count:a,dropoutFunc:this.dropoutFunc}));const l=this.dropoutMask,u=(B,F,z)=>!F||!F[z]?B:H(F[z],B);let h=u(r,l,0),p=u(r,l,1),f=u(r,l,2),m=u(r,l,3);0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=Ii({ones:()=>Hs(o),rate:this.recurrentDropout,training:s,count:a,dropoutFunc:this.dropoutFunc}));const y=this.recurrentDropoutMask;let x=u(o,y,0),v=u(o,y,1),w=u(o,y,2),S=u(o,y,3);const k=3,[T,I,E,D]=Rs(this.kernel.read(),a,k),[O,_,P,R]=this.useBias?Rs(this.bias.read(),a):[null,null,null,null];h=this.inputConv(h,T,O,this.padding),p=this.inputConv(p,I,_,this.padding),f=this.inputConv(f,E,P,this.padding),m=this.inputConv(m,D,R,this.padding);const[W,Q,ee,te]=Rs(this.recurrentKernel.read(),a,k);x=this.recurrentConv(x,W),v=this.recurrentConv(v,Q),w=this.recurrentConv(w,ee),S=this.recurrentConv(S,te);const oe=this.recurrentActivation.apply(ye(h,x)),se=this.recurrentActivation.apply(ye(p,v)),G=ye(H(se,i),H(oe,this.activation.apply(ye(f,w)))),V=H(this.recurrentActivation.apply(ye(m,S)),this.activation.apply(G));return[V,V,G]})}getConfig(){const e=super.getConfig(),{units:t}=e,s=z8(e,["units"]),r={filters:this.filters,kernelSize:this.kernelSize,padding:this.padding,dataFormat:this.dataFormat,dilationRate:this.dilationRate,strides:this.strides};return Object.assign(Object.assign({},s),r)}inputConv(e,t,s,r){const o=Ci(e,t,this.strides,r||"valid",this.dataFormat==="channelsFirst"?"NCHW":"NHWC",this.dilationRate);return s?Wr(o,s,this.dataFormat):o}recurrentConv(e,t){return Ci(e,t,1,"same",this.dataFormat==="channelsFirst"?"NCHW":"NHWC")}}iS.className="ConvLSTM2DCell";ve(iS);class KA extends HA{constructor(e){const t=new iS(e);super(Object.assign(Object.assign({},e),{cell:t}))}static fromConfig(e,t){return new e(t)}}KA.className="ConvLSTM2D";ve(KA);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class aS extends at{constructor(e){super(e),this.rate=Math.max(Math.min(e.rate,1),0),this.noiseShape=e.noiseShape,this.seed=e.seed,this.supportsMasking=!0}getNoiseShape(e){if(this.noiseShape==null)return this.noiseShape;const t=e.shape,s=[];for(let r=0;r<this.noiseShape.length;++r)s.push(this.noiseShape[r]==null?t[r]:this.noiseShape[r]);return s}call(e,t){return ie(()=>{this.invokeCallHook(e,t);const s=He(e);if(0<this.rate&&this.rate<1){const r=t.training==null?!1:t.training,o=this.getNoiseShape(s);return hd(()=>PD(s,this.rate,o,this.seed),()=>s,r)}return e})}getConfig(){const e={rate:this.rate,noiseShape:this.noiseShape,seed:this.seed},t=super.getConfig();return Object.assign(e,t),e}dispose(){return super.dispose()}}aS.className="Dropout";ve(aS);class qA extends aS{constructor(e){super(e),this.inputSpec=[{ndim:3}]}getNoiseShape(e){const t=e.shape;return[t[0],1,t[2]]}}qA.className="SpatialDropout1D";ve(qA);class XA extends at{constructor(e){if(super(e),this.activation=null,this.useBias=!0,this.kernel=null,this.bias=null,this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_BIAS_INITIALIZER="zeros",e.batchInputShape==null&&e.inputShape==null&&e.inputDim!=null){let t=null;e.batchSize!=null&&(t=e.batchSize),this.batchInputShape=[t,e.inputDim]}this.units=e.units,Tn(this.units,"units"),this.activation=Ni(e.activation),e.useBias!=null&&(this.useBias=e.useBias),this.kernelInitializer=_t(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.biasInitializer=_t(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelConstraint=yn(e.kernelConstraint),this.biasConstraint=yn(e.biasConstraint),this.kernelRegularizer=Ft(e.kernelRegularizer),this.biasRegularizer=Ft(e.biasRegularizer),this.activityRegularizer=Ft(e.activityRegularizer),this.supportsMasking=!0,this.inputSpec=[{minNDim:2}]}build(e){e=ft(e);const t=e[e.length-1];this.kernel==null&&(this.kernel=this.addWeight("kernel",[t,this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint))),this.inputSpec=[{minNDim:2,axes:{[-1]:t}}],this.built=!0}computeOutputShape(e){e=ft(e);const t=e.slice();return t[t.length-1]=this.units,t}call(e,t){return ie(()=>{this.invokeCallHook(e,t);const s=He(e),r=ED(this.activation.getClassName());let o;return r!=null?o=so(s,this.kernel.read(),r,this.bias?this.bias.read():null):(o=so(s,this.kernel.read()),this.bias!=null&&(o=Wr(o,this.bias.read())),this.activation!=null&&(o=this.activation.apply(o))),o})}getConfig(){const e={units:this.units,activation:Ti(this.activation),useBias:this.useBias,kernelInitializer:Mt(this.kernelInitializer),biasInitializer:Mt(this.biasInitializer),kernelRegularizer:kt(this.kernelRegularizer),biasRegularizer:kt(this.biasRegularizer),activityRegularizer:kt(this.activityRegularizer),kernelConstraint:gn(this.kernelConstraint),biasConstraint:gn(this.biasConstraint)},t=super.getConfig();return Object.assign(e,t),e}}XA.className="Dense";ve(XA);class YA extends at{constructor(e){e=e||{},super(e),this.inputSpec=[{minNDim:3}],this.dataFormat=e.dataFormat}computeOutputShape(e){e=ft(e);for(const t of e.slice(1))if(t==null)throw new Z(`The shape of the input to "Flatten" is not fully defined (got ${e.slice(1)}). Make sure to pass a complete "input_shape" or "batch_input_shape" argument to the first layer in your model.`);return[e[0],xi(e,1)]}call(e,t){return ie(()=>{this.invokeCallHook(e,t);let s=He(e);if(this.dataFormat==="channelsFirst"&&s.rank>1){const r=[0];for(let o=2;o<s.rank;++o)r.push(o);r.push(1),s=ht(s,r)}return vq(s)})}getConfig(){const e={};this.dataFormat!=null&&(e.dataFormat=this.dataFormat);const t=super.getConfig();return Object.assign(e,t),e}}YA.className="Flatten";ve(YA);class QA extends at{constructor(e){super(e),this.supportsMasking=!0,this.activation=Ni(e.activation)}call(e,t){return ie(()=>{this.invokeCallHook(e,t);const s=He(e);return this.activation.apply(s)})}getConfig(){const e={activation:Ti(this.activation)},t=super.getConfig();return Object.assign(e,t),e}}QA.className="Activation";ve(QA);class ZA extends at{constructor(e){super(e),this.n=e.n,this.inputSpec=[{ndim:2}]}computeOutputShape(e){return[e[0],this.n,e[1]]}call(e,t){return ie(()=>(e=He(e),yq(e,this.n)))}getConfig(){const e={n:this.n},t=super.getConfig();return Object.assign(e,t),e}}ZA.className="RepeatVector";ve(ZA);class JA extends at{constructor(e){super(e),this.targetShape=e.targetShape;for(let t=0;t<this.targetShape.length;++t)this.isUnknown(this.targetShape[t])&&(this.targetShape[t]=null)}isUnknown(e){return e<0||e==null}fixUnknownDimension(e,t){const s="Total size of new array must be unchanged.",r=t.slice();let o=1,i=null;for(let l=0;l<r.length;++l){const u=r[l];if(this.isUnknown(u))if(i===null)i=l;else throw new Z("Can only specifiy one unknown dimension.");else o*=u}const a=xi(e);if(i!==null){if(o===0||a%o!==0)throw new Z(s);r[i]=a/o}else if(a!==o)throw new Z(s);return r}computeOutputShape(e){let t=!1;for(let s=0;s<e.length;++s)if(this.isUnknown(e[s])){t=!0;break}return t?e.slice(0,1).concat(this.targetShape):e.slice(0,1).concat(this.fixUnknownDimension(e.slice(1),this.targetShape))}call(e,t){return ie(()=>{this.invokeCallHook(e,t);const s=He(e),r=s.shape,o=r.slice(0,1).concat(this.fixUnknownDimension(r.slice(1),this.targetShape));return X(s,o)})}getConfig(){const e={targetShape:this.targetShape},t=super.getConfig();return Object.assign(e,t),e}}JA.className="Reshape";ve(JA);class eO extends at{constructor(e){if(super(e),e.dims==null)throw new Error("Required configuration field `dims` is missing during Permute constructor call.");if(!Array.isArray(e.dims))throw new Error(`Permute constructor requires \`dims\` to be an Array, but received ${e.dims} instead.`);const t=Mr(1,e.dims.length+1);if(!ct(e.dims.slice().sort(),t))throw new Error("Invalid permutation `dims`: "+JSON.stringify(e.dims)+" `dims` must contain consecutive integers starting from 1.");this.dims=e.dims,this.dimsIncludingBatch=[0].concat(this.dims),this.inputSpec=[new fn({ndim:this.dims.length+1})]}computeOutputShape(e){e=ft(e);const t=e.slice();return this.dims.forEach((s,r)=>{t[r+1]=e[s]}),t}call(e,t){return ht(He(e),this.dimsIncludingBatch)}getConfig(){const e={dims:this.dims},t=super.getConfig();return Object.assign(e,t),e}}eO.className="Permute";ve(eO);class tO extends at{constructor(e){super(e??{}),this.supportsMasking=!0,e!=null?this.maskValue=e.maskValue==null?0:e.maskValue:this.maskValue=0}computeOutputShape(e){return e}getConfig(){const e=super.getConfig(),t={maskValue:this.maskValue};return Object.assign(t,e),t}computeMask(e,t){const s=He(e);return Df(Yl(s,this.maskValue),-1)}call(e,t){return ie(()=>{this.invokeCallHook(e,t);const s=He(e),i=Df(Yl(s,this.maskValue),-1,!0);return H(s,Ne(i,s.dtype))})}}tO.className="Masking";ve(tO);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class nO extends at{constructor(e){if(super(e),this.embeddings=null,this.DEFAULT_EMBEDDINGS_INITIALIZER="randomUniform",e.batchInputShape==null&&e.inputShape==null){let t=null;e.batchSize!=null&&(t=e.batchSize),e.inputLength==null?this.batchInputShape=[t,null]:this.batchInputShape=[t].concat(vt(e.inputLength))}this.inputDim=e.inputDim,Tn(this.inputDim,"inputDim"),this.outputDim=e.outputDim,Tn(this.outputDim,"outputDim"),this.embeddingsInitializer=_t(e.embeddingsInitializer||this.DEFAULT_EMBEDDINGS_INITIALIZER),this.embeddingsRegularizer=Ft(e.embeddingsRegularizer),this.activityRegularizer=Ft(e.activityRegularizer),this.embeddingsConstraint=yn(e.embeddingsConstraint),this.maskZero=e.maskZero,this.supportsMasking=e.maskZero,this.inputLength=e.inputLength}build(e){this.embeddings=this.addWeight("embeddings",[this.inputDim,this.outputDim],this.dtype,this.embeddingsInitializer,this.embeddingsRegularizer,!0,this.embeddingsConstraint),this.built=!0}warnOnIncompatibleInputShape(e){}computeMask(e,t){return ie(()=>this.maskZero?(e=He(e),Yl(e,dt(e))):null)}computeOutputShape(e){if(e=ft(e),this.inputLength==null)return[...e,this.outputDim];const t=vt(this.inputLength);if(t.length!==e.length-1)throw new Z(`"inputLength" is ${this.inputLength}, but received input shape has shape ${e}`);{let s=0;for(let r=0;r<t.length;++r){const o=t[r],i=e[r+1];if(o!=null&&i!=null&&o!==i)throw new Z(`"inputLength" is ${this.inputLength}, but received input shape has shape ${e}`);o==null&&(t[s]=i),s++}}return[e[0],...t,this.outputDim]}call(e,t){return ie(()=>{this.invokeCallHook(e,t);let s=He(e);s.dtype!=="int32"&&(s=no(s,"int32"));const r=FD(this.embeddings.read(),X(s,[s.size]));return X(r,ft(this.computeOutputShape(s.shape)))})}getConfig(){const e={inputDim:this.inputDim,outputDim:this.outputDim,embeddingsInitializer:Mt(this.embeddingsInitializer),embeddingsRegularizer:kt(this.embeddingsRegularizer),activityRegularizer:kt(this.activityRegularizer),embeddingsConstraint:gn(this.embeddingsConstraint),maskZero:this.maskZero,inputLength:this.inputLength},t=super.getConfig();return Object.assign(e,t),e}}nO.className="Embedding";ve(nO);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class ja extends at{constructor(e){super(e||{}),this.supportsMasking=!0}mergeFunction(e){throw new tt}computeElementwiseOpOutputShape(e,t){if(e==null||t==null)return null;if(e.length<t.length)return this.computeElementwiseOpOutputShape(t,e);if(t.length===0)return e;const s=e.slice(0,e.length-t.length);for(let r=0;r<t.length;++r){const o=e[e.length-t.length+r],i=t[r];if(o==null||i==null||o<0||i<0)s.push(null);else if(o===1)s.push(i);else if(i===1)s.push(o);else{if(o!==i)throw new Z("Operands could not be broadcast together with shapes "+JSON.stringify(e)+" "+JSON.stringify(t));s.push(o)}}return s}build(e){if(Array.isArray(e)&&!Array.isArray(e[0])&&(e=[ft(e)]),e=e,e.length<2)throw new Z(`A merge layer should be called on an Array of at least 2 inputs. Got ${e.length} input(s).`);let t=[];for(const o of e)o!=null&&o[0]!==null&&t.push(o[0]);if(t=yi(t),t.length>1)throw new Z(`Can not merge tensors with different batch sizes. Got tensors with shapes: ${JSON.stringify(e)}.`);let s=e[0]==null?null:e[0].slice(1);for(let o=1;o<e.length;++o){const i=e[o]==null?null:e[o].slice(1);s=this.computeElementwiseOpOutputShape(s,i)}const r=e.map(o=>o.length);e.indexOf(null)===-1&&yi(r).length===1?this.reshapeRequired=!1:this.reshapeRequired=!0}call(e,t){return ie(()=>{if(e=e,this.reshapeRequired){const s=[],r=e.map(o=>o.rank);if(r.indexOf(null)===-1){const o=ki(r);for(let i of e){const a=i.rank;for(let l=0;l<o-a;++l)i=ud(i,1);s.push(i)}return this.mergeFunction(s)}else{let o=!1;for(const l of e){const u=l.rank;if(u==null){const h=l.shape,p=h[0],f=h.slice(1).concat([p]);let m=X(l,[p].concat(xi(h.slice(1))));m=ht(m,[1,0]),m=X(m,f),s.push(m),o=!0}else if(u>1){const h=Mr(1,u).concat([0]);s.push(ht(l,h)),o=!0}else s.push(l)}let i=this.mergeFunction(s);const a=i.rank;if(o){if(a==null){const l=i.shape,u=l.length,h=l[u-1],p=[h].concat(l.slice(0,l.length-1));i=X(ht(X(i,[-1,h]),[1,0]),p)}else if(a>1){const l=[a-1].concat(Mr(0,a-1));i=ht(i,l)}}return i}}else return this.mergeFunction(e)})}computeOutputShape(e){e=e;let t;e[0]==null?t=null:t=e[0].slice(1);for(let r=1;r<e.length;++r){const o=e[r]==null?null:e[r].slice(1);t=this.computeElementwiseOpOutputShape(t,o)}let s=[];for(const r of e)r!=null&&r[0]!==null&&s.push(r[0]);return s=yi(s),s.length===1?t=s.concat(t):t=[null].concat(t),t}computeMask(e,t){return ie(()=>{if(t==null)return null;if(!Array.isArray(t))throw new Z("`mask` should be an Array");if(!Array.isArray(e))throw new Z("`inputs` should be an Array");if(t.length!==e.length)throw new Z(`The Array 'inputs' and 'mask' are expected to have the same length, but have different lengths (${e.length} vs ${t.length})`);if(t.every(r=>r==null))return null;t=t.map(r=>r==null?r:jn(r,0));let s=t[0];for(let r=1;r<t.length-1;++r)s=ao(s,t[r]);return s})}}class sO extends ja{constructor(e){super(e)}mergeFunction(e){return ie(()=>{let t=e[0].clone();for(let s=1;s<e.length;++s)t=ye(t,e[s]);return t})}}sO.className="Add";ve(sO);class rO extends ja{constructor(e){super(e)}mergeFunction(e){return ie(()=>{let t=e[0].clone();for(let s=1;s<e.length;++s)t=H(t,e[s]);return t})}}rO.className="Multiply";ve(rO);class oO extends ja{constructor(e){super(e)}mergeFunction(e){return ie(()=>{let t=e[0].clone();for(let s=1;s<e.length;++s)t=ye(t,e[s]);return H(1/e.length,t)})}}oO.className="Average";ve(oO);class iO extends ja{constructor(e){super(e)}mergeFunction(e){return ie(()=>{let t=e[0];for(let s=1;s<e.length;++s)t=zo(t,e[s]);return t})}}iO.className="Maximum";ve(iO);class aO extends ja{constructor(e){super(e)}mergeFunction(e){return ie(()=>{let t=e[0];for(let s=1;s<e.length;++s)t=Ra(t,e[s]);return t})}}aO.className="Minimum";ve(aO);class lO extends ja{constructor(e){super(e),this.DEFAULT_AXIS=-1,e==null&&(e={}),this.axis=e.axis==null?this.DEFAULT_AXIS:e.axis,this.supportsMasking=!0,this.reshapeRequired=!1}build(e){if(!(Array.isArray(e)&&Array.isArray(e[0]))||e.length===1)throw new Z("A `Concatenate` layer should be called on a list of at least 2 inputs");e=e;let t=!0;for(const r of e)if(r!=null){t=!1;break}if(t)return;const s=[];for(let r=0;r<e.length;++r){const o=e[r].slice();o.splice(this.axis,1);let i=!1;for(const a of s)if(ct(a,o)){i=!0;break}i||s.push(o)}if(s.length>1)throw new Z("A `Concatenate` layer requires inputs with matching shapes except for the concat axis. Got input shapes: "+JSON.stringify(e))}mergeFunction(e){return ie(()=>Ub(e,this.axis))}computeOutputShape(e){if(!(Array.isArray(e)&&Array.isArray(e[0])))throw new Z("A `Concatenate` layer should be called on a list of inputs.");const t=e,s=t[0].slice(),r=this.axis<0?s.length+this.axis:this.axis;for(const o of t.slice(1)){if(s[r]==null||o[r]==null){s[r]=null;break}s[r]+=o[r]}return s}computeMask(e,t){if(t==null)return null;if(!Array.isArray(t))throw new Z("`mask` should be an array for Concatenate");if(!Array.isArray(e))throw new Z("`inputs` should be an array for Concatenate");if(t.length!==e.length)throw new Z(`Mismatch in the length of mask (${t.length}) and the legnth of inputs (${e.length})`);return ie(()=>{let s=!0;if(t.forEach(i=>{if(i!=null){s=!1;return}}),s)return null;const r=[];for(let i=0;i<e.length;++i)t[i]==null?r.push(Ne(Hs(e[i]),"bool")):t[i].rank<e[i].rank?r.push(jn(t[i],-1)):r.push(t[i]);const o=on(r,this.axis);return _1(o,-1,!1)})}getConfig(){const e={axis:this.axis},t=super.getConfig();return Object.assign(e,t),e}}lO.className="Concatenate";ve(lO);function mc(n,e){for(;n<0;)n+=e;return n}function V8(n,e,t){if(n.shape.length>3||e.shape.length>3)throw new tt("batchDot is not implemented for tensors of 4D or higher rank yet");if(L(n.shape.length>=2,()=>`batchDot requires the rank of x to be >= 2, but got ${n.shape.length}`),L(n.shape.length>=2,()=>`batchDot requires the rank of y to be >= 2, but got ${e.shape.length}`),typeof t=="number"&&(t=[t,t]),n.dtype==="complex64"||e.dtype==="complex64")throw new tt("batchDot is not implemented for complex64-type Tensors yet.");const s=n.shape.length,r=e.shape.length;t==null&&(t=[s-1,r-2]);const o=t;return ie(()=>{let i;if(s>r){i=s-r;const l=[];for(let u=0;u<i;++u)l.push(1);e=X(e,e.shape.concat(l))}else if(r>s){i=r-s;const l=[];for(let u=0;u<i;++u)l.push(1);n=X(n,n.shape.concat(l))}else i=0;let a;if(n.shape.length===2&&e.shape.length===2)o[0]===o[1]?a=_e(H(n,e),o[0]):a=_e(H(ht(n,[1,0]),e),o[1]);else{const l=o[0]!==n.shape.length-1,u=o[1]===e.shape.length-1;a=lt(n,e,l,u)}if(i>0){let l;s>r?l=s+r-3:l=s-1;const u=[];for(let h=l;h<l+i;++h)u.push(h);a=Ao(a,u)}return a.shape.length===1&&(a=jn(a,1)),a})}class uO extends ja{constructor(e){super(e),this.axes=e.axes,this.normalize=e.normalize==null?!1:e.normalize,this.supportsMasking=!0,this.reshapeRequired=!1}build(e){L(Array.isArray(e)&&e.length===2&&Array.isArray(e[0])&&Array.isArray(e[1]),()=>"A `Dot` layer should be called on a list of exactly 2 inputs.");const t=e[0],s=e[1];if(t.length>3||s.length>3)throw new tt("Dot layer does not support tensors of 4D or higher rank yet.");const r=this.interpretAxes(t,s);if(t[r[0]]!==s[r[1]])throw new Z(`Dimension incompatibility: ${t[r[0]]} !== ${s[r[1]]}`)}mergeFunction(e){if(e.length!==2)throw new Z(`A \`Dot\` layer must be called on exactly 2 inputs, but received ${e.length} input(s).`);let t=e[0],s=e[1],r;return Array.isArray(this.axes)?r=this.axes.map((o,i)=>mc(o,e[i].shape.length)):r=[mc(this.axes,t.shape.length),mc(this.axes,s.shape.length)],this.normalize&&(t=Lf(t,r[0]),s=Lf(s,r[1])),V8(t,s,r)}interpretAxes(e,t){let s;return Array.isArray(this.axes)?s=this.axes:s=[mc(this.axes,e.length),mc(this.axes,t.length)],s}computeOutputShape(e){L(Array.isArray(e)&&e.length===2&&Array.isArray(e[0])&&Array.isArray(e[1]),()=>"A `Dot` layer should be called on a list of exactly 2 inputs.");const t=e[0].slice(),s=e[1].slice();if(t.length>3||s.length>3)throw new tt("Dot layer does not support tensors of 4D or higher rank yet.");const r=this.interpretAxes(t,s);t.splice(r[0],1),s.splice(r[1],1),s.splice(0,1);const o=t.concat(s);return o.length===1&&o.push(1),o}computeMask(e,t){return null}getConfig(){const e={axes:this.axes,normalize:this.normalize},t=super.getConfig();return Object.assign(e,t),e}}uO.className="Dot";ve(uO);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class cO extends at{constructor(e){super(e),this.supportsMasking=!0,this.stddev=e.stddev}computeOutputShape(e){return e}getConfig(){const e=super.getConfig(),t={stddev:this.stddev};return Object.assign(t,e),t}call(e,t){return ie(()=>{this.invokeCallHook(e,t);const s=He(e);return hd(()=>ye(Wg(s.shape,0,this.stddev),s),()=>s,t.training||!1)})}}cO.className="GaussianNoise";ve(cO);class hO extends at{constructor(e){super(e),this.supportsMasking=!0,this.rate=e.rate}computeOutputShape(e){return e}getConfig(){const e=super.getConfig(),t={rate:this.rate};return Object.assign(t,e),t}call(e,t){return ie(()=>{this.invokeCallHook(e,t);const s=He(e);return this.rate>0&&this.rate<1?hd(()=>{const o=Math.sqrt(this.rate/(1-this.rate));return H(s,Wg(s.shape,1,o))},()=>s,t.training||!1):s})}}hO.className="GaussianDropout";ve(hO);class dO extends at{constructor(e){super(e),this.supportsMasking=!0,this.rate=e.rate,this.noiseShape=e.noiseShape}_getNoiseShape(e){return this.noiseShape||He(e).shape}computeOutputShape(e){return e}getConfig(){const e=super.getConfig(),t={rate:this.rate};return Object.assign(t,e),t}call(e,t){return ie(()=>{if(this.rate<1&&this.rate>0){const s=this._getNoiseShape(e);return hd(()=>{const o=He(e),a=-1.6732632423543772*1.0507009873554805;let l=zi(Wa(s),this.rate);l=no(l,"float32");const u=((1-this.rate)*(1+this.rate*a**2))**-.5,h=-u*a*this.rate,p=ye(H(o,l),H(ye(l,-1),a));return ye(H(p,u),h)},()=>He(e),t.training||!1)}return e})}}dO.className="AlphaDropout";ve(dO);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Bc(n,e,t,s,r,o=.001){let i;if(n.rank===2)i=WE(n,e,t,s,r,o);else if(n.rank===3)i=UE(n,e,t,s,r,o);else if(n.rank===4)i=GE(n,e,t,s,r,o);else throw new tt(`batchNormalization is not implemented for array of rank ${n.rank} yet`);return i}function B8(n,e,t,s,r=.001){return ie(()=>{const o=Tg(n,s),i=o.mean,a=o.variance;return[Bc(n,i,a,t,e,r),i,a]})}function W8(n,e,t,s,r=.001){return ie(()=>{const o=Tg(n,s),i=o.mean,a=o.variance,l=[];for(const y of Mr(0,n.rank))s.indexOf(y)!==-1?l.push(1):l.push(n.shape[y]);const u=X(i,l),h=X(a,l),p=e==null?null:X(e,l),f=t==null?null:X(t,l);return[Bc(n,u,h,f,p,r),i,a]})}function U8(n,e,t,s,r=.001){return ct(s.slice().sort(),Mr(0,n.rank-1))?B8(n,e,t,s,r):W8(n,e,t,s,r)}class pO extends at{constructor(e){e==null&&(e={}),super(e),this.supportsMasking=!0,this.axis=e.axis==null?-1:e.axis,this.momentum=e.momentum==null?.99:e.momentum,this.epsilon=e.epsilon==null?.001:e.epsilon,this.center=e.center==null?!0:e.center,this.scale=e.scale==null?!0:e.scale,this.betaInitializer=_t(e.betaInitializer||"zeros"),this.gammaInitializer=_t(e.gammaInitializer||"ones"),this.movingMeanInitializer=_t(e.movingMeanInitializer||"zeros"),this.movingVarianceInitializer=_t(e.movingVarianceInitializer||"ones"),this.betaConstraint=yn(e.betaConstraint),this.gammaConstraint=yn(e.gammaConstraint),this.betaRegularizer=Ft(e.betaRegularizer),this.gammaRegularizer=Ft(e.gammaRegularizer)}build(e){e=ft(e);const t=this.axis>=0?this.axis:this.axis+e.length,s=e[t];if(s==null)throw new Z(`Axis ${t} of input tensor should have a defined dimension but the layer received an input with shape ${JSON.stringify(e)}.`);this.inputSpec=[new fn({ndim:e.length,axes:{[t]:s}})];const r=[s];this.scale&&(this.gamma=this.addWeight("gamma",r,null,this.gammaInitializer,this.gammaRegularizer,!0,this.gammaConstraint)),this.center&&(this.beta=this.addWeight("beta",r,null,this.betaInitializer,this.betaRegularizer,!0,this.betaConstraint)),this.movingMean=this.addWeight("moving_mean",r,null,this.movingMeanInitializer,null,!1),this.movingVariance=this.addWeight("moving_variance",r,null,this.movingVarianceInitializer,null,!1),this.built=!0}call(e,t){return ie(()=>{const s=t.training==null?!1:t.training,r=He(e),o=r.shape,i=o.length,a=Mr(0,i),l=this.axis>=0?this.axis:this.axis+i;a.splice(l,1);const u=Aa(1,i);u[l]=o[l];const h=a.slice();h.sort();const p=!ct(h,Mr(0,i).slice(0,i-1)),f=()=>{if(p){const S=X(this.movingMean.read(),u),k=X(this.movingVariance.read(),u),T=this.center?X(this.beta.read(),u):null,I=this.scale?X(this.gamma.read(),u):null;return Bc(r,S,k,T,I,this.epsilon)}else return Bc(r,this.movingMean.read(),this.movingVariance.read(),this.beta==null?null:this.beta.read(),this.gamma==null?null:this.gamma.read(),this.epsilon)};if(!s)return f();const[m,y,x]=U8(r,this.gamma.read(),this.beta.read(),a,this.epsilon),v=(S,k,T)=>{ie(()=>{const I=1-T,E=S.read(),D=H(Ee(E,k),I);S.write(Ee(E,D))})};return(()=>{v(this.movingMean,y,this.momentum),v(this.movingVariance,x,this.momentum)})(),m})}getConfig(){const e={axis:this.axis,momentum:this.momentum,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:Mt(this.betaInitializer),gammaInitializer:Mt(this.gammaInitializer),movingMeanInitializer:Mt(this.movingMeanInitializer),movingVarianceInitializer:Mt(this.movingVarianceInitializer),betaRegularizer:kt(this.betaRegularizer),gammaRegularizer:kt(this.gammaRegularizer),betaConstraint:gn(this.betaConstraint),gammaConstraint:gn(this.gammaConstraint)},t=super.getConfig();return Object.assign(e,t),e}}pO.className="BatchNormalization";ve(pO);class fO extends at{constructor(e){if(e==null&&(e={}),super(e),this.axis=e.axis==null?-1:e.axis,typeof this.axis=="number"){if(!Number.isInteger(this.axis))throw new Error(`Expected axis to be an integer, but received ${this.axis}`)}else if(Array.isArray(this.axis)){for(const t of this.axis)if(!Number.isInteger(t))throw new Error(`Expected axis to be an array of integers, but received ${JSON.stringify(this.axis)}`)}else throw new Error(`Expected axis to be an integer or an array of integers, but received ${JSON.stringify(this.axis)}`);this.epsilon=e.epsilon==null?.001:e.epsilon,this.center=e.center==null?!0:e.center,this.scale=e.scale==null?!0:e.scale,this.betaInitializer=_t(e.betaInitializer||"zeros"),this.gammaInitializer=_t(e.gammaInitializer||"ones"),this.betaRegularizer=Ft(e.betaRegularizer),this.gammaRegularizer=Ft(e.gammaRegularizer),this.supportsMasking=!0}build(e){e=ft(e);const t=e.length;typeof this.axis=="number"&&(this.axis=[this.axis]);for(let o=0;o<this.axis.length;++o)this.axis[o]<0&&(this.axis[o]+=t);for(const o of this.axis)if(o<0||o>=t)throw new Error(`Invalid axis: ${o}`);if(this.axis.length!==yi(this.axis).length)throw new Error(`Found duplicate axes in: ${this.axis}`);const s=this.axis.map(o=>e[o]),r=!0;this.scale?this.gamma=this.addWeight("gamma",s,"float32",this.gammaInitializer,this.gammaRegularizer,r):this.gamma=null,this.center?this.beta=this.addWeight("beta",s,"float32",this.betaInitializer,this.betaRegularizer,r):this.beta=null,this.built=!0}call(e,t){const s=He(e),r=s.shape,o=r.length;return ie(()=>{let{mean:a,variance:l}=Tg(s,this.axis,!0);const u=Aa(1,o);for(const x of this.axis)u[x]=r[x];const h=x=>x!=null&&x.shape.length!==o?X(x,u):x;let p=this.scale?h(this.gamma.read()):null,f=this.center?h(this.beta.read()):null;const m=[],y=[];for(let x=0;x<o;++x)this.axis.indexOf(x)!==-1?(m.push(r[x]),y.push(1)):(m.push(1),y.push(r[x]));return a=ir(a,m),l=ir(l,m),p!=null&&(p=ir(p,y)),f!=null&&(f=ir(f,y)),Bc(s,a,l,f,p,this.epsilon)})}getConfig(){const e={axis:this.axis,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:Mt(this.betaInitializer),gammaInitializer:Mt(this.gammaInitializer),betaRegularizer:kt(this.betaRegularizer),gammaRegularizer:kt(this.gammaRegularizer)},t=super.getConfig();return Object.assign(e,t),e}}fO.className="LayerNormalization";ve(fO);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function G8(n,e,t){return ie(()=>{if(n.rank!==4)throw new Z(`temporalPadding expects input tensor to be 4-D, but received a ${n.rank}-D tensor.`);if(e==null&&(e=[[1,1],[1,1]]),e.length!==2||e[0].length!==2||e[1].length!==2)throw new Z("spatial2dPadding expects `padding` to be an Array of two Arrays, each of which is an Array of two integers.");if(t==null&&(t=zr()),t!=="channelsLast"&&t!=="channelsFirst")throw new Z(`Unknown data format: ${t}. Supported data formats are 'channelsLast' and 'channelsFirst.`);let s;return t==="channelsFirst"?s=[[0,0],[0,0],e[0],e[1]]:s=[[0,0],e[0],e[1],[0,0]],Vi(n,s)})}class mO extends at{constructor(e){if(e==null&&(e={}),super(e),this.dataFormat=e.dataFormat==null?zr():e.dataFormat,e.padding==null)this.padding=[[1,1],[1,1]];else if(typeof e.padding=="number")this.padding=[[e.padding,e.padding],[e.padding,e.padding]];else{if(e.padding=e.padding,e.padding.length!==2)throw new Z(`ZeroPadding2D expects padding to be a length-2 array, but received a length-${e.padding.length} array.`);let t,s;if(typeof e.padding[0]=="number")t=[e.padding[0],e.padding[0]],s=[e.padding[1],e.padding[1]];else{if(e.padding=e.padding,e.padding[0].length!==2)throw new Z(`ZeroPadding2D expects height padding to be a length-2 array, but received a length-${e.padding[0].length} array.`);if(t=e.padding[0],e.padding[1].length!==2)throw new Z(`ZeroPadding2D expects width padding to be a length-2 array, but received a length-${e.padding[1].length} array.`);s=e.padding[1]}this.padding=[t,s]}this.inputSpec=[new fn({ndim:4})]}computeOutputShape(e){e=ft(e);let t,s;return this.dataFormat==="channelsFirst"?(e[2]!=null&&e[2]>=0?t=e[2]+this.padding[0][0]+this.padding[0][1]:t=null,e[3]!=null&&e[3]>=0?s=e[3]+this.padding[1][0]+this.padding[1][1]:s=null,[e[0],e[1],t,s]):(e[1]!=null&&e[1]>=0?t=e[1]+this.padding[0][0]+this.padding[0][1]:t=null,e[2]!=null&&e[2]>=0?s=e[2]+this.padding[1][0]+this.padding[1][1]:s=null,[e[0],t,s,e[3]])}call(e,t){return ie(()=>G8(He(e),this.padding,this.dataFormat))}getConfig(){const e={padding:this.padding,dataFormat:this.dataFormat},t=super.getConfig();return Object.assign(e,t),e}}mO.className="ZeroPadding2D";ve(mO);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Yg(n,e,t,s,r,o){return ie(()=>{en(r),DD(o),qs(s),t==null&&(t=[1,1]),s==null&&(s="valid"),r==null&&(r=zr()),o==null&&(o="max"),n=nS(n,r);let i;const a=s==="same"?"same":"valid";return o==="max"?i=kg(n,e,t,a):i=gg(n,e,t,a),r==="channelsFirst"&&(i=ht(i,[0,3,1,2])),i})}function gO(n,e,t,s,r,o){return ie(()=>{en(r),DD(o),qs(s),t==null&&(t=[1,1,1]),s==null&&(s="valid"),r==null&&(r=zr()),o==null&&(o="max"),n=OA(n,r);let i;const a=s==="same"?"same":"valid";return o==="max"?i=pR(n,e,t,a):i=BE(n,e,t,a),r==="channelsFirst"&&(i=ht(i,[0,4,1,2,3])),i})}class yO extends at{constructor(e){if(e.poolSize==null&&(e.poolSize=2),super(e),typeof e.poolSize=="number")this.poolSize=[e.poolSize];else if(Array.isArray(e.poolSize)&&e.poolSize.length===1&&typeof e.poolSize[0]=="number")this.poolSize=e.poolSize;else throw new Z(`poolSize for 1D convolutional layer must be a number or an Array of a single number, but received ${JSON.stringify(e.poolSize)}`);if(Tn(this.poolSize,"poolSize"),e.strides==null)this.strides=this.poolSize;else if(typeof e.strides=="number")this.strides=[e.strides];else if(Array.isArray(e.strides)&&e.strides.length===1&&typeof e.strides[0]=="number")this.strides=e.strides;else throw new Z(`strides for 1D convolutional layer must be a number or an Array of a single number, but received ${JSON.stringify(e.strides)}`);Tn(this.strides,"strides"),this.padding=e.padding==null?"valid":e.padding,qs(this.padding),this.inputSpec=[new fn({ndim:3})]}computeOutputShape(e){e=ft(e);const t=Pr(e[1],this.poolSize[0],this.padding,this.strides[0]);return[e[0],t,e[2]]}call(e,t){return ie(()=>{this.invokeCallHook(e,t),e=ud(He(e),2);const s=this.poolingFunction(He(e),[this.poolSize[0],1],[this.strides[0],1],this.padding,"channelsLast");return Ao(s,[2])})}getConfig(){const e={poolSize:this.poolSize,padding:this.padding,strides:this.strides},t=super.getConfig();return Object.assign(e,t),e}}class xO extends yO{constructor(e){super(e)}poolingFunction(e,t,s,r,o){return en(o),qs(r),Yg(e,t,s,r,o,"max")}}xO.className="MaxPooling1D";ve(xO);class vO extends yO{constructor(e){super(e)}poolingFunction(e,t,s,r,o){return en(o),qs(r),Yg(e,t,s,r,o,"avg")}}vO.className="AveragePooling1D";ve(vO);class wO extends at{constructor(e){if(e.poolSize==null&&(e.poolSize=[2,2]),super(e),this.poolSize=Array.isArray(e.poolSize)?e.poolSize:[e.poolSize,e.poolSize],e.strides==null)this.strides=this.poolSize;else if(Array.isArray(e.strides)){if(e.strides.length!==2)throw new Z(`If the strides property of a 2D pooling layer is an Array, it is expected to have a length of 2, but received length ${e.strides.length}.`);this.strides=e.strides}else this.strides=[e.strides,e.strides];Tn(this.poolSize,"poolSize"),Tn(this.strides,"strides"),this.padding=e.padding==null?"valid":e.padding,this.dataFormat=e.dataFormat==null?"channelsLast":e.dataFormat,en(this.dataFormat),qs(this.padding),this.inputSpec=[new fn({ndim:4})]}computeOutputShape(e){e=ft(e);let t=this.dataFormat==="channelsFirst"?e[2]:e[1],s=this.dataFormat==="channelsFirst"?e[3]:e[2];return t=Pr(t,this.poolSize[0],this.padding,this.strides[0]),s=Pr(s,this.poolSize[1],this.padding,this.strides[1]),this.dataFormat==="channelsFirst"?[e[0],e[1],t,s]:[e[0],t,s,e[3]]}call(e,t){return ie(()=>(this.invokeCallHook(e,t),this.poolingFunction(He(e),this.poolSize,this.strides,this.padding,this.dataFormat)))}getConfig(){const e={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat},t=super.getConfig();return Object.assign(e,t),e}}class bO extends wO{constructor(e){super(e)}poolingFunction(e,t,s,r,o){return en(o),qs(r),Yg(e,t,s,r,o,"max")}}bO.className="MaxPooling2D";ve(bO);class SO extends wO{constructor(e){super(e)}poolingFunction(e,t,s,r,o){return en(o),qs(r),Yg(e,t,s,r,o,"avg")}}SO.className="AveragePooling2D";ve(SO);class CO extends at{constructor(e){if(e.poolSize==null&&(e.poolSize=[2,2,2]),super(e),this.poolSize=Array.isArray(e.poolSize)?e.poolSize:[e.poolSize,e.poolSize,e.poolSize],e.strides==null)this.strides=this.poolSize;else if(Array.isArray(e.strides)){if(e.strides.length!==3)throw new Z(`If the strides property of a 3D pooling layer is an Array, it is expected to have a length of 3, but received length ${e.strides.length}.`);this.strides=e.strides}else this.strides=[e.strides,e.strides,e.strides];Tn(this.poolSize,"poolSize"),Tn(this.strides,"strides"),this.padding=e.padding==null?"valid":e.padding,this.dataFormat=e.dataFormat==null?"channelsLast":e.dataFormat,en(this.dataFormat),qs(this.padding),this.inputSpec=[new fn({ndim:5})]}computeOutputShape(e){e=ft(e);let t=this.dataFormat==="channelsFirst"?e[2]:e[1],s=this.dataFormat==="channelsFirst"?e[3]:e[2],r=this.dataFormat==="channelsFirst"?e[4]:e[3];return t=Pr(t,this.poolSize[0],this.padding,this.strides[0]),s=Pr(s,this.poolSize[1],this.padding,this.strides[1]),r=Pr(r,this.poolSize[2],this.padding,this.strides[2]),this.dataFormat==="channelsFirst"?[e[0],e[1],t,s,r]:[e[0],t,s,r,e[4]]}call(e,t){return ie(()=>(this.invokeCallHook(e,t),this.poolingFunction(He(e),this.poolSize,this.strides,this.padding,this.dataFormat)))}getConfig(){const e={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat},t=super.getConfig();return Object.assign(e,t),e}}class kO extends CO{constructor(e){super(e)}poolingFunction(e,t,s,r,o){return en(o),qs(r),gO(e,t,s,r,o,"max")}}kO.className="MaxPooling3D";ve(kO);class TO extends CO{constructor(e){super(e)}poolingFunction(e,t,s,r,o){return en(o),qs(r),gO(e,t,s,r,o,"avg")}}TO.className="AveragePooling3D";ve(TO);class NO extends at{constructor(e){super(e),this.inputSpec=[new fn({ndim:3})]}computeOutputShape(e){return[e[0],e[2]]}call(e,t){throw new tt}}class IO extends NO{constructor(e){super(e||{})}call(e,t){return ie(()=>{const s=He(e);return Ut(s,1)})}}IO.className="GlobalAveragePooling1D";ve(IO);class $O extends NO{constructor(e){super(e||{})}call(e,t){return ie(()=>{const s=He(e);return hr(s,1)})}}$O.className="GlobalMaxPooling1D";ve($O);class EO extends at{constructor(e){super(e),this.dataFormat=e.dataFormat==null?"channelsLast":e.dataFormat,en(this.dataFormat),this.inputSpec=[new fn({ndim:4})]}computeOutputShape(e){return e=e,this.dataFormat==="channelsLast"?[e[0],e[3]]:[e[0],e[1]]}call(e,t){throw new tt}getConfig(){const e={dataFormat:this.dataFormat},t=super.getConfig();return Object.assign(e,t),e}}class RO extends EO{call(e,t){return ie(()=>{const s=He(e);return this.dataFormat==="channelsLast"?Ut(s,[1,2]):Ut(s,[2,3])})}}RO.className="GlobalAveragePooling2D";ve(RO);class DO extends EO{call(e,t){return ie(()=>{const s=He(e);return this.dataFormat==="channelsLast"?hr(s,[1,2]):hr(s,[2,3])})}}DO.className="GlobalMaxPooling2D";ve(DO);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class AO extends at{constructor(e){super(e),this.layer=e.layer}build(e){this.built=!0}get trainable(){return this.layer!=null?this.layer.trainable:!1}set trainable(e){this.layer!=null&&(this.layer.trainable=e)}get trainableWeights(){return this.layer.trainableWeights}get nonTrainableWeights(){return this.layer.nonTrainableWeights}get updates(){return this.layer._updates}get losses(){return this.layer.losses}getWeights(){return this.layer.getWeights()}setWeights(e){this.layer.setWeights(e)}getConfig(){const e={layer:{className:this.layer.getClassName(),config:this.layer.getConfig()}},t=super.getConfig();return Object.assign(e,t),e}setFastWeightInitDuringBuild(e){super.setFastWeightInitDuringBuild(e),this.layer!=null&&this.layer.setFastWeightInitDuringBuild(e)}static fromConfig(e,t,s={}){const r=t.layer,o=$o(r,s);delete t.layer;const i={layer:o};return Object.assign(i,t),new e(i)}}class OO extends AO{constructor(e){super(e),this.supportsMasking=!0}build(e){if(e=ft(e),e.length<3)throw new Z(`TimeDistributed layer expects an input shape >= 3D, but received input shape ${JSON.stringify(e)}`);this.inputSpec=[{shape:e}];const t=[e[0]].concat(e.slice(2));this.layer.built||(this.layer.build(t),this.layer.built=!0),super.build(e)}computeOutputShape(e){e=ft(e);const t=[e[0]].concat(e.slice(2)),s=this.layer.computeOutputShape(t),r=e[1];return[s[0],r].concat(s.slice(1))}call(e,t){return ie(()=>(e=He(e),WA((i,a)=>[He(this.layer.call(i,t)),[]],e,[],!1,null,null,!1,!0)[1]))}}OO.className="TimeDistributed";ve(OO);function j8(n){Ga(dq,"BidirectionalMergeMode",n)}const H8="concat";class _O extends AO{constructor(e){super(e);const t=e.layer.getConfig(),s={};s.className=e.layer.getClassName(),s.config=t,this.forwardLayer=$o(s),t.goBackwards=t.goBackwards!==!0;const r={};if(r.className=e.layer.getClassName(),r.config=t,this.backwardLayer=$o(r),this.forwardLayer.name="forward_"+this.forwardLayer.name,this.backwardLayer.name="backward_"+this.backwardLayer.name,this.mergeMode=e.mergeMode===void 0?H8:e.mergeMode,j8(this.mergeMode),e.weights)throw new tt("weights support is not implemented for Bidirectional layer yet.");this._stateful=e.layer.stateful,this.returnSequences=e.layer.returnSequences,this.returnState=e.layer.returnState,this.supportsMasking=!0,this._trainable=!0,this.inputSpec=e.layer.inputSpec,this.numConstants=null}get trainable(){return this._trainable}set trainable(e){this._trainable=e,this.forwardLayer!=null&&(this.forwardLayer.trainable=e),this.backwardLayer!=null&&(this.backwardLayer.trainable=e)}getWeights(){return this.forwardLayer.getWeights().concat(this.backwardLayer.getWeights())}setWeights(e){const t=e.length,s=Math.floor(t/2);this.forwardLayer.setWeights(e.slice(0,s)),this.backwardLayer.setWeights(e.slice(s))}computeOutputShape(e){let t=this.forwardLayer.computeOutputShape(e);Array.isArray(t)&&Array.isArray(t[0])||(t=[t]),t=t;let s,r,o;return this.returnState&&(o=t.slice(1)),s=t[0],s=s,this.mergeMode==="concat"?(s[s.length-1]*=2,r=[s]):this.mergeMode==null?r=[s,s.slice()]:r=[s],this.returnState?this.mergeMode==null?r.concat(o).concat(o.slice()):[s].concat(o).concat(o.slice()):cs(r)}apply(e,t){let s=t==null?null:t.initialState,r=t==null?null:t.constants;t==null&&(t={});const o=BA(e,s,r,this.numConstants);if(e=o.inputs,s=o.initialState,r=o.constants,Array.isArray(e)&&(s=e.slice(1),e=e[0]),(s==null||s.length===0)&&r==null)return super.apply(e,t);const i=[],a=[];if(s!=null){const u=s.length;if(u%2>0)throw new Z("When passing `initialState` to a Bidrectional RNN, the state should be an Array containing the states of the underlying RNNs.");t.initialState=s,i.push(...s);const h=s.map(p=>new fn({shape:p.shape}));this.forwardLayer.stateSpec=h.slice(0,u/2),this.backwardLayer.stateSpec=h.slice(u/2),a.push(...h)}if(r!=null)throw new tt("Support for constants in Bidirectional layers is not implemented yet.");const l=i[0]instanceof lo;for(const u of i)if(u instanceof lo!==l)throw new Z("The initial state of a Bidirectional layer cannot be specified as a mix of symbolic and non-symbolic tensors");if(l){const u=[e].concat(i),h=this.inputSpec.concat(a),p=this.inputSpec;this.inputSpec=h;const f=super.apply(u,t);return this.inputSpec=p,f}else return super.apply(e,t)}call(e,t){return ie(()=>{const s=t.initialState;let r,o;if(s==null)r=this.forwardLayer.call(e,t),o=this.backwardLayer.call(e,t);else{const l=s.slice(0,s.length/2),u=s.slice(s.length/2);r=this.forwardLayer.call(e,Object.assign(t,{initialState:l})),o=this.backwardLayer.call(e,Object.assign(t,{initialState:u}))}let i;this.returnState&&(Array.isArray(r)&&(i=r.slice(1).concat(o.slice(1))),r=r[0],o=o[0]),this.returnSequences&&(o=fr(o,1));let a;return this.mergeMode==="concat"?a=Ub([r,o]):this.mergeMode==="sum"?a=ye(r,o):this.mergeMode==="ave"?a=H(.5,ye(r,o)):this.mergeMode==="mul"?a=H(r,o):this.mergeMode==null&&(a=[r,o]),this.returnState?this.mergeMode==null?a.concat(i):[a].concat(i):a})}resetStates(e){this.forwardLayer.resetStates(),this.backwardLayer.resetStates()}build(e){wa(this.forwardLayer.name,()=>{this.forwardLayer.build(e)}),wa(this.backwardLayer.name,()=>{this.backwardLayer.build(e)}),this.built=!0}computeMask(e,t){Array.isArray(t)&&(t=t[0]);let s;if(this.returnSequences?this.mergeMode==null?s=[t,t]:s=t:this.mergeMode==null?s=[null,null]:s=null,this.returnState){const o=this.forwardLayer.states.map(i=>null);return Array.isArray(s)?s.concat(o).concat(o):[s].concat(o).concat(o)}else return s}get trainableWeights(){return this.forwardLayer.trainableWeights.concat(this.backwardLayer.trainableWeights)}get nonTrainableWeights(){return this.forwardLayer.nonTrainableWeights.concat(this.backwardLayer.nonTrainableWeights)}setFastWeightInitDuringBuild(e){super.setFastWeightInitDuringBuild(e),this.forwardLayer!=null&&this.forwardLayer.setFastWeightInitDuringBuild(e),this.backwardLayer!=null&&this.backwardLayer.setFastWeightInitDuringBuild(e)}getConfig(){const e={mergeMode:this.mergeMode},t=super.getConfig();return Object.assign(e,t),e}static fromConfig(e,t){const s=$o(t.layer);if(delete t.layer,t.numConstants!=null)throw new tt("Deserialization of a Bidirectional layer with numConstants present is not supported yet.");const r=t;return r.layer=s,new e(r)}}_O.className="Bidirectional";ve(_O);/**
 * @license
 * Copyright 2022 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class FO extends at{constructor(e){super(e),this.scale=e.scale,e.offset?this.offset=e.offset:this.offset=0}getConfig(){const e={scale:this.scale,offset:this.offset},t=super.getConfig();return Object.assign(e,t),e}call(e,t){return ie(()=>(e=He(e),e.dtype!=="float32"&&(e=no(e,"float32")),ye(H(e,this.scale),this.offset)))}}FO.className="Rescaling";ve(FO);/**
 * @license
 * Copyright 2022 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const{resizeBilinear:K8,cropAndResize:q8}=Es;class PO extends at{constructor(e){super(e),this.height=e.height,this.width=e.width}centerCrop(e,t,s,r,o,i,a,l){return ie(()=>{let u,h=!1;const p=t/i,f=s/a,m=(r+t)/i,y=(o+s)/a,x=[p,f,m,y],v=[];e.rank===3?(h=!0,u=_s([e])):u=e;for(let I=0;I<u.shape[0];I++)v.push(x);const w=_r(v,[v.length,4]),S=Ql(0,v.length,1,"int32"),T=q8(u,w,S,[r,o],"nearest");return no(h?He(mr(T)):T,l)})}upsize(e,t,s,r){return ie(()=>{const o=K8(e,[t,s]);return no(o,r)})}call(e,t){return ie(()=>{const s=He(e),r=s.dtype,o=s.shape,i=o[o.length-3],a=o[o.length-2];let l=0;i!==this.height&&(l=Math.floor((i-this.height)/2));let u=0;return a!==this.width&&(u=Math.floor((a-this.width)/2),u===0&&(u=1)),l>=0&&u>=0?this.centerCrop(s,l,u,this.height,this.width,i,a,r):this.upsize(e,this.height,this.width,r)})}getConfig(){const e={height:this.height,width:this.width},t=super.getConfig();return Object.assign(e,t),e}computeOutputShape(e){e=ft(e);const t=e.length-3,s=e.length-2;return e[t]=this.height,e[s]=this.width,e}}PO.className="CenterCrop";ve(PO);/**
 * @license
 * Copyright 2022 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function X8(n,e,t,s){let r=He(n);if(r.dtype!=="int32"&&(r=no(r,"int32")),e==="int")return r;const o=r.shape;if(r.rank===0&&(r=jn(r,-1)),e==="oneHot"&&r.shape[r.shape.length-1]!==1&&(r=jn(r,-1)),r.rank>2)throw new Z(`When outputMode is not int, maximum output rank is 2 Received outputMode ${e} and input shape ${o} which would result in output rank ${r.rank}.`);const i=["multiHot","oneHot"].includes(e),a=r;let l;if(typeof s<"u"&&e==="count"?l=pv(a,s,t,i):l=pv(a,[],t,i),e!=="tfIdf")return l;if(s)return H(l,s);throw new Z("When outputMode is 'tfIdf', weights must be provided.")}/**
 * @license
 * Copyright 2022 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class LO extends at{constructor(e){super(e),this.numTokens=e.numTokens,e.outputMode?this.outputMode=e.outputMode:this.outputMode="multiHot"}getConfig(){const e={numTokens:this.numTokens,outputMode:this.outputMode},t=super.getConfig();return Object.assign(e,t),e}computeOutputShape(e){return e=ft(e),e==null?[this.numTokens]:this.outputMode==="oneHot"&&e[e.length-1]!==1?(e.push(this.numTokens),e):(e[e.length-1]=this.numTokens,e)}call(e,t){return ie(()=>{e=He(e),e.dtype!=="int32"&&(e=no(e,"int32"));let s;if(typeof t.countWeights<"u"){if(this.outputMode!=="count")throw new Z(`countWeights is not used when outputMode !== count.
              Received countWeights=${t.countWeights}`);s=He(t.countWeights)}const r=hr(e),o=Oc(e),i=Ms(this.numTokens,r).bufferSync().get(0),a=zi(o,0).bufferSync().get(0);if(!(i&&a))throw new Z(`Input values must be between 0 < values <= numTokens with numTokens=${this.numTokens}`);return X8(e,this.outputMode,this.numTokens,s)})}}LO.className="CategoryEncoding";ve(LO);/**
 * @license
 * Copyright 2022 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const Y8=["bilinear","nearest"],lI=new Set(Y8);class MO extends at{constructor(e){if(super(e),this.height=e.height,this.width=e.width,e.interpolation)if(lI.has(e.interpolation))this.interpolation=e.interpolation;else throw new Z(`Invalid interpolation parameter: ${e.interpolation} is not implemented`);else this.interpolation="bilinear";this.cropToAspectRatio=!!e.cropToAspectRatio}computeOutputShape(e){e=ft(e);const t=e[2];return[this.height,this.width,t]}getConfig(){const e={height:this.height,width:this.width,interpolation:this.interpolation,cropToAspectRatio:this.cropToAspectRatio},t=super.getConfig();return Object.assign(e,t),e}call(e,t){return ie(()=>{const s=[this.height,this.width];if(this.interpolation==="bilinear")return Es.resizeBilinear(e,s,!this.cropToAspectRatio);if(this.interpolation==="nearest")return Es.resizeNearestNeighbor(e,s,!this.cropToAspectRatio);throw new Error(`Interpolation is ${this.interpolation} but only ${[...lI]} are supported`)})}}MO.className="Resizing";ve(MO);/**
 * @license
 * Copyright 2023 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class zO{constructor(e){this.seed=e}next(){if(this.seed!==void 0)return this.seed++}}zO.className="RandomSeed";/**
 * @license
 * Copyright 2023 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class VO extends at{constructor(e){super(e),this.randomGenerator=new zO(e.seed)}getConfig(){const e={seed:this.randomGenerator.seed},t=super.getConfig();return Object.assign(e,t),e}}VO.className="BaseRandomLayer";/**
 * @license
 * Copyright 2023 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const Q8=["bilinear","nearest"],uI=new Set(Q8);class BO extends VO{constructor(e){super(e);const{factor:t,interpolation:s="bilinear"}=e;if(this.factor=t,Array.isArray(this.factor)&&this.factor.length===2)this.widthLower=this.factor[0],this.widthUpper=this.factor[1];else if(!Array.isArray(this.factor)&&this.factor>0)this.widthLower=-this.factor,this.widthUpper=this.factor;else throw new Z(`Invalid factor: ${this.factor}. Must be positive number or tuple of 2 numbers`);if(this.widthLower<-1||this.widthUpper<-1)throw new Z(`factor must have values larger than -1. Got: ${this.factor}`);if(this.widthUpper<this.widthLower)throw new Z(`factor cannot have upper bound less than lower bound.
        Got upper bound: ${this.widthUpper}.
        Got lower bound: ${this.widthLower}
      `);if(s)if(uI.has(s))this.interpolation=s;else throw new Z(`Invalid interpolation parameter: ${s} is not implemented`)}getConfig(){const e={factor:this.factor,interpolation:this.interpolation},t=super.getConfig();return Object.assign(e,t),e}computeOutputShape(e){e=ft(e);const t=e[2];return[this.imgHeight,-1,t]}call(e,t){return ie(()=>{const s=He(e);this.imgHeight=s.shape[s.shape.length-3];const r=s.shape[s.shape.length-2];this.widthFactor=Wa([1],1+this.widthLower,1+this.widthUpper,"float32",this.randomGenerator.next());let o=this.widthFactor.dataSync()[0]*r;o=Math.round(o);const i=[this.imgHeight,o];switch(this.interpolation){case"bilinear":return Es.resizeBilinear(e,i);case"nearest":return Es.resizeNearestNeighbor(e,i);default:throw new Error(`Interpolation is ${this.interpolation}
          but only ${[...uI]} are supported`)}})}}BO.className="RandomWidth";ve(BO);/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Z8=ae();Z8.registerFlag("KEEP_INTERMEDIATE_TENSORS",()=>!1,n=>{n&&console.warn("Keep intermediate tensors is ON. This will print the values of all intermediate tensors during model inference. Not all models support this mode. For details, check e2e/benchmarks/ model_config.js. This significantly impacts performance.")});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */var Ts;(function(n){n[n.DT_INVALID=0]="DT_INVALID",n[n.DT_FLOAT=1]="DT_FLOAT",n[n.DT_DOUBLE=2]="DT_DOUBLE",n[n.DT_INT32=3]="DT_INT32",n[n.DT_UINT8=4]="DT_UINT8",n[n.DT_INT16=5]="DT_INT16",n[n.DT_INT8=6]="DT_INT8",n[n.DT_STRING=7]="DT_STRING",n[n.DT_COMPLEX64=8]="DT_COMPLEX64",n[n.DT_INT64=9]="DT_INT64",n[n.DT_BOOL=10]="DT_BOOL",n[n.DT_QINT8=11]="DT_QINT8",n[n.DT_QUINT8=12]="DT_QUINT8",n[n.DT_QINT32=13]="DT_QINT32",n[n.DT_BFLOAT16=14]="DT_BFLOAT16",n[n.DT_QINT16=15]="DT_QINT16",n[n.DT_QUINT16=16]="DT_QUINT16",n[n.DT_UINT16=17]="DT_UINT16",n[n.DT_COMPLEX128=18]="DT_COMPLEX128",n[n.DT_HALF=19]="DT_HALF",n[n.DT_RESOURCE=20]="DT_RESOURCE",n[n.DT_VARIANT=21]="DT_VARIANT",n[n.DT_UINT32=22]="DT_UINT32",n[n.DT_UINT64=23]="DT_UINT64",n[n.DT_FLOAT_REF=101]="DT_FLOAT_REF",n[n.DT_DOUBLE_REF=102]="DT_DOUBLE_REF",n[n.DT_INT32_REF=103]="DT_INT32_REF",n[n.DT_UINT8_REF=104]="DT_UINT8_REF",n[n.DT_INT16_REF=105]="DT_INT16_REF",n[n.DT_INT8_REF=106]="DT_INT8_REF",n[n.DT_STRING_REF=107]="DT_STRING_REF",n[n.DT_COMPLEX64_REF=108]="DT_COMPLEX64_REF",n[n.DT_INT64_REF=109]="DT_INT64_REF",n[n.DT_BOOL_REF=110]="DT_BOOL_REF",n[n.DT_QINT8_REF=111]="DT_QINT8_REF",n[n.DT_QUINT8_REF=112]="DT_QUINT8_REF",n[n.DT_QINT32_REF=113]="DT_QINT32_REF",n[n.DT_BFLOAT16_REF=114]="DT_BFLOAT16_REF",n[n.DT_QINT16_REF=115]="DT_QINT16_REF",n[n.DT_QUINT16_REF=116]="DT_QUINT16_REF",n[n.DT_UINT16_REF=117]="DT_UINT16_REF",n[n.DT_COMPLEX128_REF=118]="DT_COMPLEX128_REF",n[n.DT_HALF_REF=119]="DT_HALF_REF",n[n.DT_RESOURCE_REF=120]="DT_RESOURCE_REF",n[n.DT_VARIANT_REF=121]="DT_VARIANT_REF",n[n.DT_UINT32_REF=122]="DT_UINT32_REF",n[n.DT_UINT64_REF=123]="DT_UINT64_REF"})(Ts||(Ts={}));var cI;(function(n){(function(e){e[e.LEGACY=0]="LEGACY",e[e.V1=1]="V1",e[e.V2=2]="V2"})(n.CheckpointFormatVersion||(n.CheckpointFormatVersion={}))})(cI||(cI={}));/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const J8={};function WO(n){return J8[n]}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $(n,e,t,s,r){const o=e.inputParams[n];if(o&&o.inputIndexStart!==void 0){const a=o.inputIndexStart,l=o.inputIndexEnd===0?void 0:o.inputIndexEnd===void 0?a+1:o.inputIndexEnd,u=a<0?e.inputNames.length+a:a;if(o.type==="tensor")return An(e.inputNames[u],t,s,r);if(o.type==="tensors"){const f=e.inputs.slice(a,l);return e.inputNames.slice(a,l).filter((y,x)=>{var v;return((v=f[x])===null||v===void 0?void 0:v.op)!=="NoOp"}).map(y=>An(y,t,s,r))}const h=An(e.inputNames[u],t,s,r),p=h.dataSync();return o.type==="number"?p[0]:cr(h.shape,p)}const i=e.attrParams[n];return i&&i.value}function An(n,e,t,s){const[r,o]=Ns(n,t);if(s!=null){const a=s.getHashTableHandleByName(r);if(a!=null)return a}const i=t.currentContextIds.find(a=>!!e[Wf(r,a)]);return i!==void 0?e[Wf(r,i)][o]:void 0}function hI(n,e,t){return e[Wf(n,t.currentContextId)]}function Co(n,e){const[t,s,r]=Ns(n,e);return[Wf(t,e&&e.currentContextId),s,r]}function Wf(n,e){return e?`${n}-${e}`:n}function Ns(n,e){if(n==="")return["",0,void 0];const t=e!=null&&e.parseNodeNameCache!=null;if(t){const o=e.parseNodeNameCache.get(n);if(o!=null)return o}const s=n.split(":");let r;if(s.length===1)r=[n,0,void 0];else{const o=s[0],i=s.length===3?s[1]:void 0,a=Number(s[s.length-1]);r=[o,a,i]}return t&&e.parseNodeNameCache.set(n,r),r}function ff(n,e,t){let s=$("pad",n,e,t);if(s==="explicit"){s=$("explicitPaddings",n,e,t);const r=[[0,0],[0,0],[0,0],[0,0]];for(let o=0;o<4;o++)r[o][0]=s[o*2],r[o][1]=s[o*2+1];return r}return s}function ko(n){return n.kept?n:Io(n)}/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const eX=[{tfOpName:"Add",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AddV2",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AddN",category:"arithmetic",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}]},{tfOpName:"BiasAdd",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"Sub",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"RealDiv",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Div",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"DivNoNan",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"FloorDiv",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Mul",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Maximum",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Minimum",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Pow",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SquaredDifference",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Mod",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"FloorMod",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],tX=Object.freeze(Object.defineProperty({__proto__:null,json:eX},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nX=[{tfOpName:"Abs",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Acos",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Asin",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atan2",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Ceil",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ClipByValue",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"clipValueMin",type:"number"},{start:2,name:"clipValueMax",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Complex",category:"basic_math",inputs:[{start:0,name:"real",type:"tensor"},{start:1,name:"imag",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ComplexAbs",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cos",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cosh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Elu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Exp",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Floor",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Log",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Imag",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"Tout",name:"outputType",type:"dtype",notSupported:!0}]},{tfOpName:"Neg",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Real",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"Tout",name:"outputType",type:"dtype",notSupported:!0}]},{tfOpName:"Prelu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"alpha",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Relu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Relu6",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Selu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sigmoid",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sin",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sinh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sqrt",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Rsqrt",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Square",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Tan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Tanh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sign",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Round",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Expm1",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Log1p",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Reciprocal",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Softplus",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Asinh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Acosh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atanh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Erf",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LeakyRelu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"alpha",name:"alpha",type:"number",defaultValue:.2},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"IsNan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"IsFinite",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"IsInf",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],sX=Object.freeze(Object.defineProperty({__proto__:null,json:nX},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rX=[{tfOpName:"EmptyTensorList",category:"control",inputs:[{start:0,name:"elementShape",type:"shape"},{start:1,name:"maxNumElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"LoopCond",category:"control",inputs:[{start:0,name:"pred",type:"tensor"}]},{tfOpName:"Switch",category:"control",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"pred",type:"tensor"}]},{tfOpName:"Merge",category:"control",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}]},{tfOpName:"Enter",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"frame_name",name:"frameName",type:"string"},{tfName:"is_constant",name:"isConstant",type:"bool"}]},{tfOpName:"Exit",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"NextIteration",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayV3",category:"control",inputs:[{start:0,name:"size",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"dynamic_size",name:"dynamicSize",type:"bool"},{tfName:"clear_after_read",name:"clearAfterRead",type:"bool"},{tfName:"identical_element_shapes",name:"identicalElementShapes",type:"bool"},{tfName:"tensor_array_name",name:"name",type:"string"}]},{tfOpName:"TensorArrayWriteV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"tensor",type:"tensor"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayReadV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayGatherV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape",name:"elementShape",type:"shape"}]},{tfOpName:"TensorArrayScatterV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"tensor",type:"tensor"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"TensorArrayConcatV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape_except0",name:"elementShapeExcept0",type:"shape",notSupported:!0}]},{tfOpName:"TensorArraySplitV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"tensor",type:"tensor"},{start:2,name:"lengths",type:"number[]"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"TensorArraySizeV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"flowIn",type:"number"}]},{tfOpName:"TensorArrayCloseV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"}]},{tfOpName:"StatelessIf",category:"control",inputs:[{start:0,name:"cond",type:"tensor"},{start:1,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"then_branch",name:"thenBranch",type:"func"},{tfName:"else_branch",name:"elseBranch",type:"func"}]},{tfOpName:"If",category:"control",inputs:[{start:0,name:"cond",type:"tensor"},{start:1,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"then_branch",name:"thenBranch",type:"func"},{tfName:"else_branch",name:"elseBranch",type:"func"}]},{tfOpName:"StatelessWhile",category:"control",inputs:[{start:0,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"cond",name:"cond",type:"func"},{tfName:"body",name:"body",type:"func"}]},{tfOpName:"While",category:"control",inputs:[{start:0,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"cond",name:"cond",type:"func"},{tfName:"body",name:"body",type:"func"}]},{tfOpName:"TensorListScatter",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListScatterV2",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"},{start:3,name:"numElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListGather",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListGetItem",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListSetItem",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"tensor",type:"tensor"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListReserve",category:"control",inputs:[{start:0,name:"elementShape",type:"shape"},{start:1,name:"numElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListFromTensor",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListStack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"},{tfName:"num_elements",name:"numElements",type:"dtype"}]},{tfOpName:"TensorListSplit",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"elementShape",type:"shape"},{start:2,name:"lengths",type:"number[]"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListConcat",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"}],attrs:[{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListConcatV2",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"}],attrs:[{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListPopBack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListPushBack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"tensor",type:"tensor"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListLength",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"}]},{tfOpName:"TensorListResize",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"size",type:"number"}]}],oX=Object.freeze(Object.defineProperty({__proto__:null,json:rX},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const iX=[{tfOpName:"AvgPool",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPool",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[],notSupported:!0},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPoolWithArgmax",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"include_batch_in_index",name:"includeBatchInIndex",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AvgPool3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPool3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Conv1D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"stride",name:"stride",type:"number"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NWC"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"dilation",name:"dilation",type:"number",defaultValue:1}]},{tfOpName:"Conv2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"useCudnnOnGpu",name:"useCudnnOnGpu",type:"bool"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"_FusedConv2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"use_cudnn_on_gpu",name:"useCudnnOnGpu",type:"bool",defaultValue:!0},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]",defaultValue:[1,1,1,1]},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:1e-4},{tfName:"leakyrelu_alpha",name:"leakyreluAlpha",type:"number",defaultValue:.2}]},{tfOpName:"Conv2DBackpropInput",category:"convolution",inputs:[{start:2,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:0,name:"outputShape",type:"number[]"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]",notSupported:!0}]},{tfOpName:"DepthwiseConv2d",category:"convolution",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"DepthwiseConv2dNative",category:"convolution",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"FusedDepthwiseConv2dNative",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]",defaultValue:[1,1,1,1]},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]}]},{tfOpName:"Conv3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"Dilation2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"rates",name:"dilations",type:"number[]"},{tfName:"padding",name:"pad",type:"string"}]}],aX=Object.freeze(Object.defineProperty({__proto__:null,json:iX},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lX=[{tfOpName:"Fill",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"},{start:1,name:"value",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"LinSpace",category:"creation",inputs:[{start:0,name:"start",type:"number"},{start:1,name:"stop",type:"number"},{start:2,name:"num",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"OneHot",category:"creation",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"depth",type:"number"},{start:2,name:"onValue",type:"number",defaultValue:1},{start:3,name:"offValue",type:"number",defaultValue:0}],attrs:[{tfName:"axis",name:"axis",type:"number",notSupported:!0},{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"Ones",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"OnesLike",category:"creation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"RandomStandardNormal",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"seed",name:"seed",type:"number",defaultValue:0},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"RandomUniform",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"minval",name:"minval",type:"number",defaultValue:0},{tfName:"maxval",name:"maxval",type:"number",defaultValue:1},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"seed",name:"seed",type:"number",defaultValue:0},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"RandomUniformInt",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"minval",name:"minval",type:"number"},{tfName:"maxval",name:"maxval",type:"number"},{tfName:"seed",name:"seed",type:"number",defaultValue:0},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0}]},{tfOpName:"Range",category:"creation",inputs:[{start:0,name:"start",type:"number"},{start:1,name:"stop",type:"number"},{start:2,name:"step",type:"number",defaultValue:0}],attrs:[{tfName:"Tidx",name:"dtype",type:"dtype"}]},{tfOpName:"TruncatedNormal",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"means",name:"mean",type:"number",defaultValue:0},{tfName:"stddev",name:"stdDev",type:"number",defaultValue:1},{tfName:"seed",name:"seed",type:"number"},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"Zeros",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"ZerosLike",category:"creation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"Multinomial",category:"creation",inputs:[{start:0,name:"logits",type:"tensor"},{start:1,name:"numSamples",type:"number"}],attrs:[{tfName:"seed",name:"seed",type:"number"},{tfName:"seed2",name:"seed2",type:"number"},{tfName:"T",name:"dtype",type:"dtype"},{tfName:"output_dtype",name:"output_dtype",type:"dtype"}]}],uX=Object.freeze(Object.defineProperty({__proto__:null,json:lX},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cX=[{tfOpName:"NonMaxSuppressionV2",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"}]},{tfOpName:"NonMaxSuppressionV3",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"}]},{tfOpName:"NonMaxSuppressionV4",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"T_threshold",name:"threshold",type:"dtype",notSupported:!0},{tfName:"pad_to_max_output_size",name:"padToMaxOutputSize",type:"bool"}]},{tfOpName:"NonMaxSuppressionV5",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"},{start:5,name:"softNmsSigma",type:"number"}]},{tfOpName:"Where",category:"dynamic",inputs:[{start:0,name:"condition",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ListDiff",category:"dynamic",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],hX=Object.freeze(Object.defineProperty({__proto__:null,json:cX},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dX=[{tfOpName:"LowerBound",category:"evaluation",inputs:[{start:0,name:"sortedSequence",type:"tensor"},{start:1,name:"values",type:"tensor"}]},{tfOpName:"TopKV2",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"k",type:"number"}],attrs:[{tfName:"sorted",name:"sorted",type:"bool"}]},{tfOpName:"UpperBound",category:"evaluation",inputs:[{start:0,name:"sortedSequence",type:"tensor"},{start:1,name:"values",type:"tensor"}]},{tfOpName:"Unique",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"UniqueV2",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]}],pX=Object.freeze(Object.defineProperty({__proto__:null,json:dX},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fX=[{tfOpName:"PlaceholderWithDefault",category:"graph",inputs:[{start:0,name:"default",type:"tensor"}],attrs:[{tfName:"shape",name:"shape",type:"shape"},{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"Placeholder",category:"graph",attrs:[{tfName:"shape",name:"shape",type:"shape"},{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"Const",category:"graph"},{tfOpName:"Identity",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"IdentityN",category:"graph",inputs:[{start:0,end:0,name:"x",type:"tensors"}]},{tfOpName:"Snapshot",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Rank",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Size",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Shape",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"ShapeN",category:"graph",inputs:[{start:0,end:0,name:"x",type:"tensors"}]},{tfOpName:"Print",category:"graph",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"data",type:"tensors"}],attrs:[{tfName:"message",name:"message",type:"string"},{tfName:"first_n",name:"firstN",type:"number",notSupported:!0},{tfName:"summarize",name:"summarize",type:"number",defaultValue:3}]},{tfOpName:"NoOp",category:"graph",inputs:[]},{tfOpName:"StopGradient",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"FakeQuantWithMinMaxVars",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"min",name:"min",type:"number"},{tfName:"max",name:"max",type:"number"}]}],mX=Object.freeze(Object.defineProperty({__proto__:null,json:fX},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gX=[{tfOpName:"HashTable",category:"hash_table",inputs:[],attrs:[{tfName:"shared_name",name:"sharedName",type:"string"},{tfName:"use_node_name_sharing",name:"useNodeNameSharing",type:"bool"},{tfName:"key_dtype",name:"keyDType",type:"dtype"},{tfName:"value_dtype",name:"valueDType",type:"dtype"}]},{tfOpName:"HashTableV2",category:"hash_table",inputs:[],attrs:[{tfName:"shared_name",name:"sharedName",type:"string"},{tfName:"use_node_name_sharing",name:"useNodeNameSharing",type:"bool"},{tfName:"key_dtype",name:"keyDType",type:"dtype"},{tfName:"value_dtype",name:"valueDType",type:"dtype"}]},{tfOpName:"LookupTableImport",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableImportV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableFind",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableFindV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableSize",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"}]},{tfOpName:"LookupTableSizeV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"}]},{tfOpName:"InitializeTable",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}]},{tfOpName:"InitializeTableV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}]}],yX=Object.freeze(Object.defineProperty({__proto__:null,json:gX},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xX=[{tfOpName:"ResizeBilinear",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"size",type:"number[]"}],attrs:[{tfName:"align_corners",name:"alignCorners",type:"bool"},{tfName:"half_pixel_centers",name:"halfPixelCenters",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ResizeNearestNeighbor",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"size",type:"number[]"}],attrs:[{tfName:"align_corners",name:"alignCorners",type:"bool"},{tfName:"half_pixel_centers",name:"halfPixelCenters",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"CropAndResize",category:"image",inputs:[{start:0,name:"image",type:"tensor"},{start:1,name:"boxes",type:"tensor"},{start:2,name:"boxInd",type:"tensor"},{start:3,name:"cropSize",type:"number[]"}],attrs:[{tfName:"method",name:"method",type:"string"},{tfName:"extrapolation_value",name:"extrapolationValue",type:"number"}]},{tfOpName:"ImageProjectiveTransformV3",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"transforms",type:"tensor"},{start:2,name:"outputShape",type:"number[]"},{start:3,name:"fillValue",type:"number"}],attrs:[{tfName:"interpolation",name:"interpolation",type:"string"},{tfName:"fill_mode",name:"fillMode",type:"string"}]}],vX=Object.freeze(Object.defineProperty({__proto__:null,json:xX},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wX=[{tfOpName:"Equal",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"NotEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Greater",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"GreaterEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Less",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LessEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalAnd",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalNot",category:"logical",inputs:[{start:0,name:"a",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalOr",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Select",category:"logical",inputs:[{start:0,name:"condition",type:"tensor"},{start:1,name:"a",type:"tensor"},{start:2,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SelectV2",category:"logical",inputs:[{start:0,name:"condition",type:"tensor"},{start:1,name:"a",type:"tensor"},{start:2,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BitwiseAnd",category:"logical",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}]}],bX=Object.freeze(Object.defineProperty({__proto__:null,json:wX},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const SX=[{tfOpName:"_FusedMatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:1e-4},{tfName:"transpose_a",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"transpose_b",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"leakyrelu_alpha",name:"leakyreluAlpha",type:"number",defaultValue:.2},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"transpose_a",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"transpose_b",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BatchMatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"adj_x",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"adj_y",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BatchMatMulV2",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"adj_x",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"adj_y",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Transpose",category:"matrices",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"perm",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Einsum",category:"matrices",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}],attrs:[{tfName:"equation",name:"equation",type:"string"},{tfName:"N",name:"n",type:"number",defaultValue:2},{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"MatrixBandPart",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"numLower",type:"tensor"},{start:1,name:"numUpper",type:"tensor"}]}],CX=Object.freeze(Object.defineProperty({__proto__:null,json:SX},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kX=[{tfOpName:"EuclideanNorm",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool",defaultValue:!1}]},{tfOpName:"FusedBatchNorm",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"FusedBatchNormV2",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"FusedBatchNormV3",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"LRN",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"depth_radius",name:"radius",type:"number",defaultValue:5},{tfName:"bias",name:"bias",type:"number",defaultValue:1},{tfName:"alpha",name:"alpha",type:"number",defaultValue:1},{tfName:"beta",name:"beta",type:"number",defaultValue:.5}]},{tfOpName:"Softmax",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"LogSoftmax",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}]}],TX=Object.freeze(Object.defineProperty({__proto__:null,json:kX},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const NX=[{tfOpName:"Bincount",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"size",type:"number"},{start:2,name:"weights",type:"tensor"}]},{tfOpName:"DenseBincount",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"size",type:"number"},{start:2,name:"weights",type:"tensor"}],attrs:[{tfName:"binary_output",name:"binaryOutput",type:"bool"}]},{tfOpName:"Max",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Mean",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Min",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Sum",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"All",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Any",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"ArgMax",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"ArgMin",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"Prod",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cumprod",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}],attrs:[{tfName:"exclusive",name:"exclusive",type:"bool"},{tfName:"reverse",name:"reverse",type:"bool"}]},{tfOpName:"Cumsum",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}],attrs:[{tfName:"exclusive",name:"exclusive",type:"bool"},{tfName:"reverse",name:"reverse",type:"bool"}]}],IX=Object.freeze(Object.defineProperty({__proto__:null,json:NX},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $X=[{tfOpName:"ConcatV2",category:"slice_join",inputs:[{start:0,end:-1,name:"tensors",type:"tensors"},{start:-1,name:"axis",type:"number"}],attrs:[{tfName:"N",name:"n",type:"number",defaultValue:2}]},{tfOpName:"Concat",category:"slice_join",inputs:[{start:1,end:0,name:"tensors",type:"tensors"},{start:0,name:"axis",type:"number"}],attrs:[{tfName:"N",name:"n",type:"number",defaultValue:2}]},{tfOpName:"GatherV2",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"axis",type:"number",defaultValue:0}],attrs:[{tfName:"batch_dims",name:"batchDims",type:"number",defaultValue:0}]},{tfOpName:"Gather",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",notSupported:!0}]},{tfOpName:"Reverse",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"dims",type:"bool[]"}]},{tfOpName:"ReverseV2",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}]},{tfOpName:"Slice",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"begin",type:"number[]"},{start:2,name:"size",type:"number[]"}]},{tfOpName:"StridedSlice",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"begin",type:"number[]"},{start:2,name:"end",type:"number[]"},{start:3,name:"strides",type:"number[]"}],attrs:[{tfName:"begin_mask",name:"beginMask",type:"number",defaultValue:0},{tfName:"end_mask",name:"endMask",type:"number",defaultValue:0},{tfName:"new_axis_mask",name:"newAxisMask",type:"number",defaultValue:0},{tfName:"ellipsis_mask",name:"ellipsisMask",type:"number",defaultValue:0},{tfName:"shrink_axis_mask",name:"shrinkAxisMask",type:"number",defaultValue:0}]},{tfOpName:"Pack",category:"slice_join",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0}]},{tfOpName:"Unpack",category:"slice_join",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0},{tfName:"num",name:"num",type:"number",defaultValue:0,notSupported:!0}]},{tfOpName:"Tile",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"reps",type:"number[]"}]},{tfOpName:"Split",category:"slice_join",inputs:[{start:0,name:"axis",type:"number",defaultValue:0},{start:1,name:"x",type:"tensor"}],attrs:[{tfName:"num_split",name:"numOrSizeSplits",type:"number",defaultValue:1}]},{tfOpName:"SplitV",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"numOrSizeSplits",type:"number[]"},{start:2,name:"axis",type:"number",defaultValue:0}]},{tfOpName:"ScatterNd",category:"slice_join",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"values",type:"tensor"},{start:2,name:"shape",type:"number[]"}]},{tfOpName:"GatherNd",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"}]},{tfOpName:"SparseToDense",category:"slice_join",inputs:[{start:0,name:"sparseIndices",type:"tensor"},{start:1,name:"outputShape",type:"number[]"},{start:2,name:"sparseValues",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",defaultValue:!1,notSupported:!0}]},{tfOpName:"TensorScatterUpdate",category:"slice_join",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"values",type:"tensor"}]}],EX=Object.freeze(Object.defineProperty({__proto__:null,json:$X},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const RX=[{tfOpName:"SparseFillEmptyRows",category:"sparse",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"values",type:"tensor"},{start:2,name:"denseShape",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}]},{tfOpName:"SparseReshape",category:"sparse",inputs:[{start:0,name:"inputIndices",type:"tensor"},{start:1,name:"inputShape",type:"tensor"},{start:2,name:"newShape",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SparseSegmentMean",category:"sparse",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"segmentIds",type:"tensor"}]},{tfOpName:"SparseSegmentSum",category:"sparse",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"segmentIds",type:"tensor"}]}],DX=Object.freeze(Object.defineProperty({__proto__:null,json:RX},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const AX=[{tfOpName:"FFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"IFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"RFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"fft_length",type:"number",notSupported:!0}]},{tfOpName:"IRFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"fft_length",type:"number",notSupported:!0}]}],OX=Object.freeze(Object.defineProperty({__proto__:null,json:AX},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _X=[{tfOpName:"StaticRegexReplace",category:"string",inputs:[{start:0,name:"input",type:"tensor"}],attrs:[{tfName:"pattern",name:"pattern",type:"string"},{tfName:"rewrite",name:"rewrite",type:"string"},{tfName:"replace_global",name:"replaceGlobal",type:"bool"}]},{tfOpName:"StringNGrams",category:"string",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"dataSplits",type:"tensor"}],attrs:[{tfName:"separator",name:"separator",type:"string"},{tfName:"ngram_widths",name:"nGramWidths",type:"number[]"},{tfName:"left_pad",name:"leftPad",type:"string"},{tfName:"right_pad",name:"rightPad",type:"string"},{tfName:"pad_width",name:"padWidth",type:"number"},{tfName:"preserve_short_sequences",name:"preserveShortSequences",type:"bool"}],outputs:["ngrams","ngrams_splits"]},{tfOpName:"StringSplit",category:"string",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"delimiter",type:"tensor"}],attrs:[{tfName:"skip_empty",name:"skipEmpty",type:"bool"}],outputs:["indices","values","shape"]},{tfOpName:"StringToHashBucketFast",category:"string",inputs:[{start:0,name:"input",type:"tensor"}],attrs:[{tfName:"num_buckets",name:"numBuckets",type:"number"}]}],FX=Object.freeze(Object.defineProperty({__proto__:null,json:_X},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const PX=[{tfOpName:"Cast",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"SrcT",name:"sdtype",type:"dtype",notSupported:!0},{tfName:"DstT",name:"dtype",type:"dtype"}]},{tfOpName:"ExpandDims",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"MirrorPad",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"}],attrs:[{tfName:"mode",name:"mode",type:"string"}]},{tfOpName:"Pad",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"}],attrs:[{tfName:"constant_value",name:"constantValue",type:"number",defaultValue:0}]},{tfOpName:"PadV2",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"},{start:2,name:"constantValue",type:"number",defaultValue:0}]},{tfOpName:"Reshape",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}]},{tfOpName:"EnsureShape",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}]},{tfOpName:"Squeeze",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"axis",tfDeprecatedName:"squeeze_dims",name:"axis",type:"number[]"}]},{tfOpName:"SpaceToBatchND",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"blockShape",type:"number[]"},{start:2,name:"paddings",type:"number[]"}]},{tfOpName:"BatchToSpaceND",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"blockShape",type:"number[]"},{start:2,name:"crops",type:"number[]"}]},{tfOpName:"DepthToSpace",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"block_size",name:"blockSize",type:"number"},{tfName:"data_format",name:"dataFormat",type:"string"}]},{tfOpName:"BroadcastTo",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}],attrs:[]},{tfOpName:"BroadcastArgs",category:"transformation",inputs:[{start:0,name:"s0",type:"tensor"},{start:1,name:"s1",type:"tensor"}],attrs:[]}],LX=Object.freeze(Object.defineProperty({__proto__:null,json:PX},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class dI{static get Instance(){return this._instance||(this._instance=new this)}constructor(){const e=[tX,sX,oX,aX,uX,hX,pX,mX,yX,vX,bX,CX,TX,IX,EX,DX,OX,FX,LX],t=[].concat(...e.map(s=>s.json));this.opMappers=t.reduce((s,r)=>(s[r.tfOpName]=r,s),{})}transformGraph(e,t={}){const s=e.node,r=[],o=[],i=[],a=s.reduce((x,v)=>(x[v.name]=this.mapNode(v),v.op.startsWith("Placeholder")?r.push(x[v.name]):v.op==="Const"?o.push(x[v.name]):(v.input==null||v.input.length===0)&&i.push(x[v.name]),x),{});let l=[];const u=[];let h={},p={};t!=null&&(h=this.mapSignatureEntries(t.inputs),p=this.mapSignatureEntries(t.outputs));const f=Object.keys(a);f.forEach(x=>{const v=a[x];v.inputNames.forEach((w,S)=>{const[k,,T]=Co(w),I=a[k];if(I.outputs!=null){const E=I.outputs.indexOf(T);if(E!==-1){const D=`${k}:${E}`;v.inputNames[S]=D}}v.inputs.push(I),I.children.push(v)})}),Object.keys(p).length===0?f.forEach(x=>{const v=a[x];v.children.length===0&&u.push(v)}):Object.keys(p).forEach(x=>{const[v]=Co(x),w=a[v];w!=null&&(w.signatureKey=p[x],u.push(w))}),Object.keys(h).length>0?Object.keys(h).forEach(x=>{const[v]=Co(x),w=a[v];w&&(w.signatureKey=h[x],l.push(w))}):l=r;let m={};e.library!=null&&e.library.function!=null&&(m=e.library.function.reduce((x,v)=>(x[v.signature.name]=this.mapFunction(v),x),{}));const y={nodes:a,inputs:l,outputs:u,weights:o,placeholders:r,signature:t,functions:m};return i.length>0&&(y.initNodes=i),y}mapSignatureEntries(e){return Object.keys(e||{}).reduce((t,s)=>(t[e[s].name]=s,t),{})}mapNode(e){const t=WO(e.op)||this.opMappers[e.op]||{};e.attr==null&&(e.attr={});const s={name:e.name,op:e.op,category:t.category,inputNames:(e.input||[]).map(r=>r.startsWith("^")?r.slice(1):r),inputs:[],children:[],inputParams:{},attrParams:{},rawAttrs:e.attr,outputs:t.outputs};return t.inputs!=null&&(s.inputParams=t.inputs.reduce((r,o)=>(r[o.name]={type:o.type,inputIndexStart:o.start,inputIndexEnd:o.end},r),{})),t.attrs!=null&&(s.attrParams=t.attrs.reduce((r,o)=>{const i=o.type;let a;switch(o.type){case"string":a=$v(e.attr,o.tfName,o.defaultValue),a===void 0&&o.tfDeprecatedName&&(a=$v(e.attr,o.tfDeprecatedName,o.defaultValue));break;case"string[]":a=Fv(e.attr,o.tfName,o.defaultValue),a===void 0&&o.tfDeprecatedName&&(a=Fv(e.attr,o.tfDeprecatedName,o.defaultValue));break;case"number":a=Rv(e.attr,o.tfName,o.defaultValue||0),a===void 0&&o.tfDeprecatedName&&(a=Rv(e.attr,o.tfDeprecatedName,o.defaultValue));break;case"number[]":a=_v(e.attr,o.tfName,o.defaultValue),a===void 0&&o.tfDeprecatedName&&(a=_v(e.attr,o.tfDeprecatedName,o.defaultValue));break;case"bool":a=Ev(e.attr,o.tfName,o.defaultValue),a===void 0&&o.tfDeprecatedName&&(a=Ev(e.attr,o.tfDeprecatedName,o.defaultValue));break;case"bool[]":a=Lv(e.attr,o.tfName,o.defaultValue),a===void 0&&o.tfDeprecatedName&&(a=Lv(e.attr,o.tfDeprecatedName,o.defaultValue));break;case"shape":a=Ov(e.attr,o.tfName,o.defaultValue),a===void 0&&o.tfDeprecatedName&&(a=Ov(e.attr,o.tfDeprecatedName,o.defaultValue));break;case"shape[]":a=Pv(e.attr,o.tfName,o.defaultValue),a===void 0&&o.tfDeprecatedName&&(a=Pv(e.attr,o.tfDeprecatedName,o.defaultValue));break;case"dtype":a=Dv(e.attr,o.tfName,o.defaultValue),a===void 0&&o.tfDeprecatedName&&(a=Dv(e.attr,o.tfDeprecatedName,o.defaultValue));break;case"dtype[]":a=Av(e.attr,o.tfName,o.defaultValue),a===void 0&&o.tfDeprecatedName&&(a=Av(e.attr,o.tfDeprecatedName,o.defaultValue));break;case"func":a=pI(e.attr,o.tfName,o.defaultValue),a===void 0&&o.tfDeprecatedName&&(a=pI(e.attr,o.tfDeprecatedName,o.defaultValue));break;case"tensor":case"tensors":break;default:throw new Error(`Unsupported param type: ${o.type} for op: ${e.op}`)}return r[o.name]={value:a,type:i},r},{})),s}mapFunction(e){const t=e.nodeDef,s=[],r=[];let o={};t!=null&&(o=t.reduce((p,f)=>(p[f.name]=this.mapNode(f),f.op==="Const"&&r.push(p[f.name]),p),{}));const i=[],a=[];e.signature.inputArg.forEach(p=>{const[f]=Co(p.name),m={name:f,op:"Placeholder",inputs:[],inputNames:[],category:"graph",inputParams:{},attrParams:{dtype:{value:lS(p.type),type:"dtype"}},children:[]};m.signatureKey=p.name,i.push(m),o[f]=m}),Object.keys(o).forEach(p=>{const f=o[p];f.inputNames.forEach((m,y)=>{const[x,,v]=Co(m),w=o[x];if(w.outputs!=null){const S=w.outputs.indexOf(v);if(S!==-1){const k=`${x}:${S}`;f.inputNames[y]=k}}f.inputs.push(w),w.children.push(f)})});const u=e.ret;e.signature.outputArg.forEach(p=>{const[f,m]=Co(u[p.name]),y=o[f];y!=null&&(y.defaultOutput=m,a.push(y))});const h=this.mapArgsToSignature(e);return{nodes:o,inputs:i,outputs:a,weights:r,placeholders:s,signature:h}}mapArgsToSignature(e){return{methodName:e.signature.name,inputs:e.signature.inputArg.reduce((t,s)=>(t[s.name]=this.mapArgToTensorInfo(s),t),{}),outputs:e.signature.outputArg.reduce((t,s)=>(t[s.name]=this.mapArgToTensorInfo(s,e.ret),t),{})}}mapArgToTensorInfo(e,t){let s=e.name;return t!=null&&(s=t[s]),{name:s,dtype:e.type}}}function MX(n){const e=ae().global;if(typeof e.atob<"u")return e.atob(n);if(typeof Buffer<"u")return new Buffer(n,"base64").toString();throw new Error("Unable to decode base64 in this environment. Missing built-in atob() or Buffer()")}function UO(n,e){const t=Array.isArray(n)?String.fromCharCode.apply(null,n):MX(n);return e?t:t.toLowerCase()}function $v(n,e,t,s=!1){const r=n[e];return r!=null?UO(r.s,s):t}function Ev(n,e,t){const s=n[e];return s?s.b:t}function Rv(n,e,t){const s=n[e]||{},r=s.i!=null?s.i:s.f!=null?s.f:t;return typeof r=="number"?r:parseInt(r,10)}function lS(n){switch(typeof n=="string"&&(n=Ts[n]),n){case Ts.DT_FLOAT:case Ts.DT_HALF:return"float32";case Ts.DT_INT32:case Ts.DT_INT64:case Ts.DT_INT8:case Ts.DT_UINT8:return"int32";case Ts.DT_BOOL:return"bool";case Ts.DT_DOUBLE:return"float32";case Ts.DT_STRING:return"string";case Ts.DT_COMPLEX64:case Ts.DT_COMPLEX128:return"complex64";default:return null}}function pI(n,e,t){const s=n[e];return s&&s.func?s.func.name:t}function Dv(n,e,t){const s=n[e];return s&&s.type?lS(s.type):t}function Av(n,e,t){const s=n[e];return s&&s.list&&s.list.type?s.list.type.map(r=>lS(r)):t}function GO(n){if(!n.unknownRank)return n.dim!=null?n.dim.map(e=>typeof e.size=="number"?e.size:parseInt(e.size,10)):[]}function Ov(n,e,t){const s=n[e];return s&&s.shape?GO(s.shape):t}function _v(n,e,t){const s=n[e];return s?((s.list.f&&s.list.f.length?s.list.f:s.list.i)||[]).map(r=>typeof r=="number"?r:parseInt(r,10)):t}function Fv(n,e,t,s=!1){const r=n[e];return r&&r.list&&r.list.s?r.list.s.map(o=>UO(o,s)):t}function Pv(n,e,t){const s=n[e];return s&&s.list&&s.list.shape?s.list.shape.map(r=>GO(r)):t}function Lv(n,e,t){const s=n[e];return s&&s.list&&s.list.b?s.list.b:t}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class zX{constructor(e,t,s){this.node=e,this.tensorMap=t,this.context=s,this.inputs=[],this.attrs={},this.inputs=e.inputNames.map(r=>this.getInput(r)),e.rawAttrs!=null&&(this.attrs=Object.keys(e.rawAttrs).reduce((r,o)=>(r[o]=this.getAttr(o),r),{}))}getInput(e){return An(e,this.tensorMap,this.context)}getAttr(e,t){const s=this.node.rawAttrs[e];if(s.tensor!=null)return An(e,this.tensorMap,this.context);if(s.i!=null||s.f!=null)return Rv(this.node.rawAttrs,e,t);if(s.s!=null)return $v(this.node.rawAttrs,e,t);if(s.b!=null)return Ev(this.node.rawAttrs,e,t);if(s.shape!=null)return Ov(this.node.rawAttrs,e,t);if(s.type!=null)return Dv(this.node.rawAttrs,e,t);if(s.list!=null){if(s.list.i!=null||s.list.f!=null)return _v(this.node.rawAttrs,e,t);if(s.list.s!=null)return Fv(this.node.rawAttrs,e,t);if(s.list.shape!=null)return Pv(this.node.rawAttrs,e,t);if(s.list.b!=null)return Lv(this.node.rawAttrs,e,t);if(s.list.type!=null)return Av(this.node.rawAttrs,e,t)}return t}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zn=Object.freeze(Object.defineProperty({__proto__:null,OP_SCOPE_SUFFIX:mE,abs:hn,acos:OE,acosh:_E,add:ye,addN:r4,all:_1,any:Df,argMax:ql,argMin:FE,asin:PE,asinh:LE,atan:ME,atan2:zE,atanh:VE,avgPool:gg,avgPool3d:BE,basicLSTMCell:I4,batchNorm:Jh,batchNorm2d:WE,batchNorm3d:UE,batchNorm4d:GE,batchToSpaceND:yg,bincount:jE,bitwiseAnd:P4,booleanMaskAsync:wj,broadcastArgs:M4,broadcastTo:Vl,buffer:nt,cast:Ne,ceil:HE,clipByValue:As,clone:Io,complex:wi,concat:on,concat1d:KE,concat2d:P1,concat3d:qE,concat4d:XE,conv1d:L1,conv2d:Ci,conv2dTranspose:z1,conv3d:YE,conv3dTranspose:ZE,cos:xg,cosh:V1,cosineWindow:hb,cumprod:Af,cumsum:B1,denseBincount:pv,depthToSpace:JE,depthwiseConv2d:ed,diag:aW,dilation2d:eR,div:Ae,divNoNan:tR,dot:nR,dropout:$R,einsum:El,elu:td,enclosingPowerOfTwo:ER,ensureShape:yW,equal:Lr,erf:W1,euclideanNorm:oR,exp:Os,expandDims:jn,expm1:iR,eye:G1,fft:Ag,fill:hu,floor:sd,floorDiv:O1,fused:Wj,gather:rd,gatherND:Rj,greater:Ms,greaterEqual:zi,ifft:Lc,imag:vg,image:Es,inTopKAsync:_j,irfft:ob,isFinite:aR,isInf:lR,isNaN:uR,leakyRelu:wg,less:_c,lessEqual:Ba,linalg:LR,linspace:UW,localResponseNormalization:cR,log:js,log1p:bg,logSigmoid:hR,logSoftmax:j1,logSumExp:Sg,logicalAnd:ao,logicalNot:Cg,logicalOr:H1,logicalXor:dR,losses:v6,lowerBound:oU,matMul:lt,max:hr,maxPool:kg,maxPool3d:pR,maxPoolWithArgmax:uU,maximum:zo,mean:Ut,meshgrid:dU,min:Oc,minimum:Ra,mirrorPad:fR,mod:mR,moments:Tg,movingAverage:Cj,mul:H,multiRNNCell:xU,multinomial:wU,neg:Rt,norm:nd,notEqual:Yl,oneHot:q1,ones:$s,onesLike:Hs,op:j,outerProduct:TU,pad:Vi,pad1d:$U,pad2d:RU,pad3d:AU,pad4d:_U,pool:gR,pow:Ro,prelu:Ig,print:AE,prod:yR,raggedGather:WU,raggedRange:GU,raggedTensorToTensor:HU,rand:qU,randomGamma:gG,randomNormal:Y1,randomStandardNormal:vG,randomUniform:Wa,randomUniformInt:SG,range:Ql,real:Fc,reciprocal:xR,relu:ho,relu6:Q1,reshape:X,reverse:fr,reverse1d:EG,reverse2d:DG,reverse3d:OG,reverse4d:FG,rfft:Og,round:Z1,rsqrt:J1,scalar:We,scatterND:Tj,searchSorted:K1,selu:eb,separableConv2d:tb,setdiff1dAsync:BG,sigmoid:Fr,sign:vR,signal:x6,sin:nb,sinh:sb,slice:et,slice1d:Eg,slice2d:rb,slice3d:Rg,slice4d:Pc,softmax:Dg,softplus:du,spaceToBatchND:Ng,sparse:w6,sparseToDense:$j,spectral:y6,split:Rs,sqrt:Pn,square:Ct,squaredDifference:ib,squeeze:Ao,stack:_s,step:pu,stridedSlice:wR,string:b6,sub:Ee,sum:_e,tan:bR,tanh:Ea,tensor:_r,tensor1d:_n,tensor2d:Bl,tensor3d:SR,tensor4d:aj,tensor5d:lj,tensor6d:uj,tensorScatterUpdate:hj,tile:ir,topk:kR,transpose:ht,truncatedNormal:lb,unique:TR,unsortedSegmentSum:ub,unstack:mr,upperBound:yj,variable:NR,where:Hn,whereAsync:IR,zeros:dn,zerosLike:dt},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const VX=(n,e,t,s=zn)=>{switch(n.op){case"BiasAdd":case"AddV2":case"Add":return[s.add($("a",n,e,t),$("b",n,e,t))];case"AddN":return[s.addN($("tensors",n,e,t))];case"FloorMod":case"Mod":return[s.mod($("a",n,e,t),$("b",n,e,t))];case"Mul":return[s.mul($("a",n,e,t),$("b",n,e,t))];case"RealDiv":case"Div":return[s.div($("a",n,e,t),$("b",n,e,t))];case"DivNoNan":return[s.divNoNan($("a",n,e,t),$("b",n,e,t))];case"FloorDiv":return[s.floorDiv($("a",n,e,t),$("b",n,e,t))];case"Sub":return[s.sub($("a",n,e,t),$("b",n,e,t))];case"Minimum":return[s.minimum($("a",n,e,t),$("b",n,e,t))];case"Maximum":return[s.maximum($("a",n,e,t),$("b",n,e,t))];case"Pow":return[s.pow($("a",n,e,t),$("b",n,e,t))];case"SquaredDifference":return[s.squaredDifference($("a",n,e,t),$("b",n,e,t))];default:throw TypeError(`Node type ${n.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const BX=(n,e,t,s=zn)=>{switch(n.op){case"Abs":case"ComplexAbs":return[s.abs($("x",n,e,t))];case"Acos":return[s.acos($("x",n,e,t))];case"Acosh":return[s.acosh($("x",n,e,t))];case"Asin":return[s.asin($("x",n,e,t))];case"Asinh":return[s.asinh($("x",n,e,t))];case"Atan":return[s.atan($("x",n,e,t))];case"Atan2":return[s.atan2($("x",n,e,t),$("y",n,e,t))];case"Atanh":return[s.atanh($("x",n,e,t))];case"Ceil":return[s.ceil($("x",n,e,t))];case"Complex":return[s.complex($("real",n,e,t),$("imag",n,e,t))];case"Cos":return[s.cos($("x",n,e,t))];case"Cosh":return[s.cosh($("x",n,e,t))];case"Elu":return[s.elu($("x",n,e,t))];case"Erf":return[s.erf($("x",n,e,t))];case"Exp":return[s.exp($("x",n,e,t))];case"Expm1":return[s.expm1($("x",n,e,t))];case"Floor":return[s.floor($("x",n,e,t))];case"Log":return[s.log($("x",n,e,t))];case"Log1p":return[s.log1p($("x",n,e,t))];case"Imag":return[s.imag($("x",n,e,t))];case"Neg":return[s.neg($("x",n,e,t))];case"Reciprocal":return[s.reciprocal($("x",n,e,t))];case"Real":return[s.real($("x",n,e,t))];case"Relu":return[s.relu($("x",n,e,t))];case"Round":return[s.round($("x",n,e,t))];case"Selu":return[s.selu($("x",n,e,t))];case"Sigmoid":return[s.sigmoid($("x",n,e,t))];case"Sin":return[s.sin($("x",n,e,t))];case"Sign":return[s.sign($("x",n,e,t))];case"Sinh":return[s.sinh($("x",n,e,t))];case"Softplus":return[s.softplus($("x",n,e,t))];case"Sqrt":return[s.sqrt($("x",n,e,t))];case"Square":return[s.square($("x",n,e,t))];case"Tanh":return[s.tanh($("x",n,e,t))];case"Tan":return[s.tan($("x",n,e,t))];case"ClipByValue":return[s.clipByValue($("x",n,e,t),$("clipValueMin",n,e,t),$("clipValueMax",n,e,t))];case"Relu6":return[s.relu6($("x",n,e,t))];case"Rsqrt":return[s.rsqrt(An(n.inputNames[0],e,t))];case"LeakyRelu":return[s.leakyRelu($("x",n,e,t),$("alpha",n,e,t))];case"Prelu":return[s.prelu($("x",n,e,t),$("alpha",n,e,t))];case"IsNan":return[s.isNaN(An(n.inputNames[0],e,t))];case"IsInf":return[s.isInf(An(n.inputNames[0],e,t))];case"IsFinite":return[s.isFinite(An(n.inputNames[0],e,t))];default:throw TypeError(`Node type ${n.op} is not implemented`)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rr(n,e,t=""){if(!(typeof n=="number"||typeof e=="number")){L(n.length===e.length,()=>t+` Shapes ${n} and ${e} must match`);for(let s=0;s<n.length;s++){const r=n[s],o=e[s];L(r<0||o<0||r===o,()=>t+` Shapes ${n} and ${e} must match`)}}}function fI(n){return!(typeof n=="number"||n.some(e=>e<0))}function gc(n,e,t){let s=Mv(n,t);const r=!fI(s);if(r&&e.length===0)throw new Error(`Tried to calculate elements of an empty list with non-fully-defined elementShape: ${s}`);if(r&&e.forEach(o=>{s=Mv(o.shape,s)}),!fI(s))throw new Error(`Non-fully-defined elementShape: ${s}`);return s}function Mv(n,e){if(typeof n=="number")return e;if(typeof e=="number")return n;if(n.length!==e.length)throw new Error(`Incompatible ranks during merge: ${n} vs. ${e}`);const t=[];for(let s=0;s<n.length;++s){const r=n[s],o=e[s];if(r>=0&&o>=0&&r!==o)throw new Error(`Incompatible shape during merge: ${n} vs. ${e}`);t[s]=r>=0?r:o}return t}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class WX{constructor(e,t,s,r,o,i,a){this.name=e,this.dtype=t,this.maxSize=s,this.elementShape=r,this.identicalElementShapes=o,this.dynamicSize=i,this.clearAfterRead=a,this.tensors=[],this.closed_=!1,this.idTensor=We(0),kn(this.idTensor)}get id(){return this.idTensor.id}get closed(){return this.closed_}clearAndClose(e){this.tensors.forEach(t=>{(e==null||!e.has(t.tensor.id))&&t.tensor.dispose()}),this.tensors=[],this.closed_=!0,this.idTensor.dispose()}size(){return this.tensors.length}read(e){if(this.closed_)throw new Error(`TensorArray ${this.name} has already been closed.`);if(e<0||e>=this.size())throw new Error(`Tried to read from index ${e}, but array size is: ${this.size()}`);const t=this.tensors[e];if(t.cleared)throw new Error(`TensorArray ${this.name}: Could not read index ${e} twice because it was cleared after a previous read (perhaps try setting clear_after_read = false?).`);return this.clearAfterRead&&(t.cleared=!0),t.read=!0,t.tensor}readMany(e){return e.map(t=>this.read(t))}write(e,t){if(this.closed_)throw new Error(`TensorArray ${this.name} has already been closed.`);if(e<0||!this.dynamicSize&&e>=this.maxSize)throw new Error(`Tried to write to index ${e}, but array is not resizeable and size is: ${this.maxSize}`);const s=this.tensors[e]||{};if(t.dtype!==this.dtype)throw new Error(`TensorArray ${this.name}: Could not write to TensorArray index ${e},
          because the value dtype is ${t.dtype}, but TensorArray dtype is ${this.dtype}.`);if(this.size()===0&&(this.elementShape==null||this.elementShape.length===0)&&(this.elementShape=t.shape),rr(this.elementShape,t.shape,`TensorArray ${this.name}: Could not write to TensorArray index ${e}.`),s.read)throw new Error(`TensorArray ${this.name}: Could not write to TensorArray index ${e}, because it has already been read.`);if(s.written)throw new Error(`TensorArray ${this.name}: Could not write to TensorArray index ${e}, because it has already been written.`);s.tensor=t,kn(t),s.written=!0,this.tensors[e]=s}writeMany(e,t){if(e.length!==t.length)throw new Error(`TensorArray ${this.name}: could not write multiple tensors,because the index size: ${e.length} is not the same as tensors size: ${t.length}.`);e.forEach((s,r)=>this.write(s,t[r]))}gather(e,t){if(t&&t!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but gather requested dtype ${t}`);if(e)e=e.slice(0,this.size());else{e=[];for(let r=0;r<this.size();r++)e.push(r)}if(e.length===0)return _r([],[0].concat(this.elementShape));const s=this.readMany(e);return rr(this.elementShape,s[0].shape,"TensorArray shape mismatch: "),_s(s,0)}concat(e){if(e&&e!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but concat requested dtype ${e}`);if(this.size()===0)return _r([],[0].concat(this.elementShape));const t=[];for(let r=0;r<this.size();r++)t.push(r);const s=this.readMany(t);return rr(this.elementShape,s[0].shape,`TensorArray shape mismatch: tensor array shape (${this.elementShape}) vs first tensor shape (${s[0].shape})`),on(s,0)}scatter(e,t){if(t.dtype!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but tensor has dtype ${t.dtype}`);if(e.length!==t.shape[0])throw new Error(`Expected len(indices) == tensor.shape[0], but saw: ${e.length} vs. ${t.shape[0]}`);const s=Math.max(...e);if(!this.dynamicSize&&s>=this.maxSize)throw new Error(`Max index must be < array size (${s}  vs. ${this.maxSize})`);this.writeMany(e,mr(t,0))}split(e,t){if(t.dtype!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but tensor has dtype ${t.dtype}`);let s=0;const r=e.map(l=>(s+=l,s));if(s!==t.shape[0])throw new Error(`Expected sum of lengths to be equal to
          tensor.shape[0], but sum of lengths is
        ${s}, and tensor's shape is: ${t.shape}`);if(!this.dynamicSize&&e.length!==this.maxSize)throw new Error(`TensorArray's size is not equal to the size of lengths (${this.maxSize} vs. ${e.length}), and the TensorArray is not marked as dynamically resizeable`);const o=s===0?0:t.size/s,i=[];ie(()=>{t=X(t,[1,s,o]);for(let l=0;l<e.length;++l){const h=[0,l===0?0:r[l-1],0],p=[1,e[l],o];i[l]=X(et(t,h,p),this.elementShape)}return i});const a=[];for(let l=0;l<e.length;l++)a[l]=l;this.writeMany(a,i)}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Oa{get id(){return this.idTensor.id}constructor(e,t,s,r=-1){this.tensors=e,this.elementShape=t,this.elementDtype=s,e!=null&&e.forEach(o=>{if(s!==o.dtype)throw new Error(`Invalid data types; op elements ${s}, but list elements ${o.dtype}`);rr(t,o.shape,"TensorList shape mismatch: "),kn(o)}),this.idTensor=We(0),this.maxNumElements=r,kn(this.idTensor)}copy(){return new Oa([...this.tensors],this.elementShape,this.elementDtype)}clearAndClose(e){this.tensors.forEach(t=>{(e==null||!e.has(t.id))&&t.dispose()}),this.tensors.length=0,this.idTensor.dispose()}size(){return this.tensors.length}stack(e,t,s=-1){if(t!==this.elementDtype)throw new Error(`Invalid data types; op elements ${t}, but list elements ${this.elementDtype}`);if(s!==-1&&this.tensors.length!==s)throw new Error(`Operation expected a list with ${s} elements but got a list with ${this.tensors.length} elements.`);rr(e,this.elementShape,"TensorList shape mismatch: ");const r=gc(this.elementShape,this.tensors,e);return ie(()=>{const o=this.tensors.map(i=>X(i,r));return _s(o,0)})}popBack(e,t){if(t!==this.elementDtype)throw new Error(`Invalid data types; op elements ${t}, but list elements ${this.elementDtype}`);if(this.size()===0)throw new Error("Trying to pop from an empty list.");const s=gc(this.elementShape,this.tensors,e),r=this.tensors.pop();return r.kept=!1,rr(r.shape,e,"TensorList shape mismatch: "),X(r,s)}pushBack(e){if(e.dtype!==this.elementDtype)throw new Error(`Invalid data types; op elements ${e.dtype}, but list elements ${this.elementDtype}`);if(rr(e.shape,this.elementShape,"TensorList shape mismatch: "),this.maxNumElements===this.size())throw new Error("Trying to push element into a full list.");kn(e),this.tensors.push(e)}resize(e){if(e<0)throw new Error(`TensorListResize expects size to be non-negative. Got: ${e}`);if(this.maxNumElements!==-1&&e>this.maxNumElements)throw new Error(`TensorListResize input size ${e} is greater maxNumElement ${this.maxNumElements}.`);const t=new Oa([],this.elementShape,this.elementDtype,this.maxNumElements);t.tensors.length=e;for(let s=0;s<Math.min(this.tensors.length,e);++s)t.tensors[s]=this.tensors[s];return t}getItem(e,t,s){if(s!==this.elementDtype)throw new Error(`Invalid data types; op elements ${s}, but list elements ${this.elementDtype}`);if(e<0||e>this.tensors.length)throw new Error(`Trying to access element ${e} in a list with ${this.tensors.length} elements.`);if(this.tensors[e]==null)throw new Error(`element at index ${e} is null.`);rr(this.tensors[e].shape,t,"TensorList shape mismatch: ");const r=gc(this.elementShape,this.tensors,t);return X(this.tensors[e],r)}setItem(e,t){if(t.dtype!==this.elementDtype)throw new Error(`Invalid data types; op elements ${t.dtype}, but list elements ${this.elementDtype}`);if(e<0||this.maxNumElements!==-1&&e>=this.maxNumElements)throw new Error(`Trying to set element ${e} in a list with max ${this.maxNumElements} elements.`);rr(this.elementShape,t.shape,"TensorList shape mismatch: "),kn(t),this.tensors[e]!=null&&(this.tensors[e].kept=!1),this.tensors[e]=t}gather(e,t,s){if(t!==this.elementDtype)throw new Error(`Invalid data types; op elements ${t}, but list elements ${this.elementDtype}`);rr(this.elementShape,s,"TensorList shape mismatch: "),e=e.slice(0,this.size());const r=gc(this.elementShape,this.tensors,s);return e.length===0?_r([],[0].concat(r)):ie(()=>{const o=e.map(i=>X(this.tensors[i],r));return _s(o,0)})}concat(e,t){if(e&&e!==this.elementDtype)throw new Error(`TensorList dtype is ${this.elementDtype} but concat requested dtype ${e}`);rr(this.elementShape,t,"TensorList shape mismatch: ");const s=gc(this.elementShape,this.tensors,t);return this.size()===0?_r([],[0].concat(s)):ie(()=>{const r=this.tensors.map(o=>X(o,s));return on(r,0)})}}function UX(n,e,t){const s=n.dtype;if(n.shape.length<1)throw new Error(`Tensor must be at least a vector, but saw shape: ${n.shape}`);if(n.dtype!==t)throw new Error(`Invalid data types; op elements ${n.dtype}, but list elements ${t}`);const r=n.shape.slice(1);rr(r,e,"TensorList shape mismatch: ");const o=mr(n);return new Oa(o,e,s)}function GX(n,e,t,s){return new Oa([],n,e,s)}function jX(n,e,t,s){if(e.length!==n.shape[0])throw new Error(`Expected len(indices) == tensor.shape[0], but saw: ${e.length} vs. ${n.shape[0]}`);const r=Math.max(...e);if(s!=null&&s!==-1&&r>=s)throw new Error(`Max index must be < array size (${r}  vs. ${s})`);const o=new Oa([],t,n.dtype,s),i=mr(n,0);return e.forEach((a,l)=>{o.setItem(a,i[l])}),o}function HX(n,e,t){let s=0;const r=e.map(h=>(s+=h,s));if(s!==n.shape[0])throw new Error(`Expected sum of lengths to be equal to
          tensor.shape[0], but sum of lengths is
        ${s}, and tensor's shape is: ${n.shape}`);const o=n.shape.slice(1),i=Mv(o,t),a=s===0?0:n.size/s,l=ie(()=>{const h=[];n=X(n,[1,s,a]);for(let p=0;p<e.length;++p){const m=[0,p===0?0:r[p-1],0],y=[1,e[p],a];h[p]=X(et(n,m,y),i)}return n.dispose(),h}),u=new Oa([],t,n.dtype,e.length);for(let h=0;h<l.length;h++)u.setItem(h,l[h]);return u}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const KX=async(n,e,t)=>{switch(n.op){case"If":case"StatelessIf":{const s=$("thenBranch",n,e,t),r=$("elseBranch",n,e,t),o=$("cond",n,e,t),i=$("args",n,e,t);return(await o.data())[0]?t.functionMap[s].executeFunctionAsync(i,t.tensorArrayMap,t.tensorListMap):t.functionMap[r].executeFunctionAsync(i,t.tensorArrayMap,t.tensorListMap)}case"While":case"StatelessWhile":{const s=$("body",n,e,t),r=$("cond",n,e,t),o=$("args",n,e,t),i=await t.functionMap[r].executeFunctionAsync(o,t.tensorArrayMap,t.tensorListMap),a=o.map(h=>h.id);let l=await i[0].data();i.forEach(h=>{!h.kept&&a.indexOf(h.id)===-1&&h.dispose()});let u=o;for(;l[0];){const h=u;u=await t.functionMap[s].executeFunctionAsync(u,t.tensorArrayMap,t.tensorListMap);const p=u.map(m=>m.id);h.forEach(m=>{!m.kept&&a.indexOf(m.id)===-1&&p.indexOf(m.id)===-1&&m.dispose()});const f=await t.functionMap[r].executeFunctionAsync(u,t.tensorArrayMap,t.tensorListMap);l=await f[0].data(),f.forEach(m=>{!m.kept&&a.indexOf(m.id)===-1&&p.indexOf(m.id)===-1&&m.dispose()})}return u}case"LoopCond":{const s=$("pred",n,e,t);return[ko(s)]}case"Switch":{const s=$("pred",n,e,t);let r=$("data",n,e,t);return r.kept||(r=ko(r)),(await s.data())[0]?[void 0,r]:[r,void 0]}case"Merge":{const s=n.inputNames.find(r=>An(r,e,t)!==void 0);if(s){const r=An(s,e,t);return[ko(r)]}return}case"Enter":{const s=$("frameName",n,e,t),r=$("tensor",n,e,t);return t.enterFrame(s),[ko(r)]}case"Exit":{const s=$("tensor",n,e,t);return t.exitFrame(),[ko(s)]}case"NextIteration":{const s=$("tensor",n,e,t);return t.nextIteration(),[ko(s)]}case"TensorArrayV3":{const s=$("size",n,e,t),r=$("dtype",n,e,t),o=$("elementShape",n,e,t),i=$("dynamicSize",n,e,t),a=$("clearAfterRead",n,e,t),l=$("identicalElementShapes",n,e,t),u=$("name",n,e,t),h=new WX(u,r,s,o,l,i,a);return t.addTensorArray(h),[h.idTensor,We(1)]}case"TensorArrayWriteV3":{const s=$("tensorArrayId",n,e,t),r=$("index",n,e,t),o=$("tensor",n,e,t),i=t.getTensorArray(s.id);return i.write(r,o),[i.idTensor]}case"TensorArrayReadV3":{const s=$("tensorArrayId",n,e,t),r=$("index",n,e,t);return[t.getTensorArray(s.id).read(r)]}case"TensorArrayGatherV3":{const s=$("tensorArrayId",n,e,t),r=$("indices",n,e,t),o=$("dtype",n,e,t);return[t.getTensorArray(s.id).gather(r,o)]}case"TensorArrayScatterV3":{const s=$("tensorArrayId",n,e,t),r=$("indices",n,e,t),o=$("tensor",n,e,t),i=t.getTensorArray(s.id);return i.scatter(r,o),[i.idTensor]}case"TensorArrayConcatV3":{const s=$("tensorArrayId",n,e,t),r=t.getTensorArray(s.id),o=$("dtype",n,e,t);return[r.concat(o)]}case"TensorArraySplitV3":{const s=$("tensorArrayId",n,e,t),r=$("tensor",n,e,t),o=$("lengths",n,e,t),i=t.getTensorArray(s.id);return i.split(o,r),[i.idTensor]}case"TensorArraySizeV3":{const s=$("tensorArrayId",n,e,t),r=t.getTensorArray(s.id);return[We(r.size(),"int32")]}case"TensorArrayCloseV3":{const s=$("tensorArrayId",n,e,t),r=t.getTensorArray(s.id);return r.clearAndClose(),[r.idTensor]}case"TensorListSetItem":{const s=$("tensorListId",n,e,t),r=$("index",n,e,t),o=$("tensor",n,e,t),i=t.getTensorList(s.id);return i.setItem(r,o),[i.idTensor]}case"TensorListGetItem":{const s=$("tensorListId",n,e,t),r=$("index",n,e,t),o=$("elementShape",n,e,t),i=$("elementDType",n,e,t);return[t.getTensorList(s.id).getItem(r,o,i)]}case"TensorListScatterV2":case"TensorListScatter":{const s=$("indices",n,e,t),r=$("tensor",n,e,t),o=$("elementShape",n,e,t),i=$("numElements",n,e,t),a=jX(r,s,o,i);return t.addTensorList(a),[a.idTensor]}case"TensorListReserve":case"EmptyTensorList":{const s=$("elementShape",n,e,t),r=$("elementDType",n,e,t);let o;n.op==="TensorListReserve"?o="numElements":o="maxNumElements";const i=$(o,n,e,t),a=n.op==="TensorListReserve"?-1:i,l=GX(s,r,i,a);return t.addTensorList(l),[l.idTensor]}case"TensorListGather":{const s=$("tensorListId",n,e,t),r=$("indices",n,e,t),o=$("elementShape",n,e,t),i=$("elementDType",n,e,t);return[t.getTensorList(s.id).gather(r,i,o)]}case"TensorListStack":{const s=$("tensorListId",n,e,t),r=$("elementShape",n,e,t),o=$("elementDType",n,e,t),i=$("numElements",n,e,t);return[t.getTensorList(s.id).stack(r,o,i)]}case"TensorListFromTensor":{const s=$("tensor",n,e,t),r=$("elementShape",n,e,t),o=$("elementDType",n,e,t),i=UX(s,r,o);return t.addTensorList(i),[i.idTensor]}case"TensorListConcat":case"TensorListConcatV2":{const s=$("tensorListId",n,e,t),r=t.getTensorList(s.id),o=$("dtype",n,e,t),i=$("elementShape",n,e,t);return[r.concat(o,i)]}case"TensorListPushBack":{const s=$("tensorListId",n,e,t),r=$("tensor",n,e,t),o=t.getTensorList(s.id);return o.pushBack(r),[o.idTensor]}case"TensorListPopBack":{const s=$("tensorListId",n,e,t),r=$("elementShape",n,e,t),o=$("elementDType",n,e,t);return[t.getTensorList(s.id).popBack(r,o)]}case"TensorListSplit":{const s=$("tensor",n,e,t),r=$("elementShape",n,e,t),o=$("lengths",n,e,t),i=HX(s,o,r);return t.addTensorList(i),[i.idTensor]}case"TensorListLength":{const s=$("tensorListId",n,e,t),r=t.getTensorList(s.id);return[We(r.size(),"int32")]}case"TensorListResize":{const s=$("tensorListId",n,e,t),r=$("size",n,e,t),i=t.getTensorList(s.id).resize(r);return t.addTensorList(i),[i.idTensor]}default:throw TypeError(`Node type ${n.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mI(n,e,t){const[s,r]=$("fusedOps",n,e,t),o=s==="biasadd",i=!o,a=r==="prelu",l=s==="fusedbatchnorm",u=$("numArgs",n,e,t);if(o){if(a&&u!==2)throw new Error("FusedConv2d and DepthwiseConv2d with BiasAdd and Prelu must have two extra arguments: bias and alpha.");if(!a&&o&&u!==1)throw new Error("FusedConv2d and DepthwiseConv2d with BiasAdd must have one extra argument: bias.")}if(l)throw new Error("FusedConv2d and DepthwiseConv2d with FusedBatchNorm is not supported");const h=$("strides",n,e,t),p=ff(n,e,t),f=$("dataFormat",n,e,t).toUpperCase(),m=$("dilations",n,e,t);let[y,x]=$("args",n,e,t);i&&(x=y,y=void 0);const v=$("leakyreluAlpha",n,e,t);return{stride:h,pad:p,dataFormat:f,dilations:m,biasArg:y,preluArg:x,activationFunc:r,leakyreluAlpha:v}}const qX=(n,e,t,s=zn)=>{switch(n.op){case"Conv1D":{const r=$("stride",n,e,t),o=$("pad",n,e,t),i=$("dataFormat",n,e,t).toUpperCase(),a=$("dilation",n,e,t);return[s.conv1d($("x",n,e,t),$("filter",n,e,t),r,o,i,a)]}case"Conv2D":{const r=$("strides",n,e,t),o=ff(n,e,t),i=$("dataFormat",n,e,t).toUpperCase(),a=$("dilations",n,e,t);return[s.conv2d($("x",n,e,t),$("filter",n,e,t),[r[1],r[2]],o,i,[a[1],a[2]])]}case"_FusedConv2D":{const{stride:r,pad:o,dataFormat:i,dilations:a,biasArg:l,preluArg:u,activationFunc:h,leakyreluAlpha:p}=mI(n,e,t);return[s.fused.conv2d({x:$("x",n,e,t),filter:$("filter",n,e,t),strides:[r[1],r[2]],pad:o,dataFormat:i,dilations:[a[1],a[2]],bias:l,activation:h,preluActivationWeights:u,leakyreluAlpha:p})]}case"FusedDepthwiseConv2dNative":{const{stride:r,pad:o,dataFormat:i,dilations:a,biasArg:l,preluArg:u,activationFunc:h,leakyreluAlpha:p}=mI(n,e,t);return[s.fused.depthwiseConv2d({x:$("x",n,e,t),filter:$("filter",n,e,t),strides:[r[1],r[2]],pad:o,dataFormat:i,dilations:[a[1],a[2]],bias:l,activation:h,preluActivationWeights:u,leakyreluAlpha:p})]}case"Conv2DBackpropInput":case"Conv2dTranspose":{const r=$("outputShape",n,e,t),o=$("strides",n,e,t),i=ff(n,e,t);return[s.conv2dTranspose($("x",n,e,t),$("filter",n,e,t),r,[o[1],o[2]],i)]}case"DepthwiseConv2dNative":case"DepthwiseConv2d":{const r=$("strides",n,e,t),o=ff(n,e,t),i=$("dilations",n,e,t),a=$("dataFormat",n,e,t).toUpperCase();return[s.depthwiseConv2d($("input",n,e,t),$("filter",n,e,t),[r[1],r[2]],o,a,[i[1],i[2]])]}case"Conv3D":{const r=$("strides",n,e,t),o=$("pad",n,e,t),i=$("dataFormat",n,e,t).toUpperCase(),a=$("dilations",n,e,t);return[s.conv3d($("x",n,e,t),$("filter",n,e,t),[r[1],r[2],r[3]],o,i,[a[1],a[2],a[3]])]}case"AvgPool":{const r=$("strides",n,e,t),o=$("pad",n,e,t),i=$("kernelSize",n,e,t);return[s.avgPool($("x",n,e,t),[i[1],i[2]],[r[1],r[2]],o)]}case"MaxPool":{const r=$("strides",n,e,t),o=$("pad",n,e,t),i=$("kernelSize",n,e,t);return[s.maxPool($("x",n,e,t),[i[1],i[2]],[r[1],r[2]],o)]}case"MaxPoolWithArgmax":{const r=$("strides",n,e,t),o=$("pad",n,e,t),i=$("kernelSize",n,e,t),a=$("includeBatchInIndex",n,e,t),{result:l,indexes:u}=s.maxPoolWithArgmax($("x",n,e,t),[i[1],i[2]],[r[1],r[2]],o,a);return[l,u]}case"AvgPool3D":{const r=$("strides",n,e,t),o=$("pad",n,e,t),i=$("kernelSize",n,e,t);return[s.avgPool3d($("x",n,e,t),[i[1],i[2],i[3]],[r[1],r[2],r[3]],o)]}case"MaxPool3D":{const r=$("strides",n,e,t),o=$("pad",n,e,t),i=$("kernelSize",n,e,t);return[s.maxPool3d($("x",n,e,t),[i[1],i[2],i[3]],[r[1],r[2],r[3]],o)]}case"Dilation2D":{const r=$("strides",n,e,t),o=$("pad",n,e,t),i=$("dilations",n,e,t),a=r[1],l=r[2],u=i[1],h=i[2];return[s.dilation2d($("x",n,e,t),$("filter",n,e,t),[a,l],o,[u,h],"NHWC")]}default:throw TypeError(`Node type ${n.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const XX=(n,e,t,s=zn)=>{switch(n.op){case"Fill":{const r=$("shape",n,e,t),o=$("dtype",n,e,t),i=$("value",n,e,t);return[s.fill(r,i,o)]}case"LinSpace":{const r=$("start",n,e,t),o=$("stop",n,e,t),i=$("num",n,e,t);return[s.linspace(r,o,i)]}case"Multinomial":{const r=$("logits",n,e,t),o=$("numSamples",n,e,t),i=$("seed",n,e,t);return[s.multinomial(r,o,i)]}case"OneHot":{const r=$("indices",n,e,t),o=$("depth",n,e,t),i=$("onValue",n,e,t),a=$("offValue",n,e,t),l=$("dtype",n,e,t);return[s.oneHot(r,o,i,a,l)]}case"Ones":return[s.ones($("shape",n,e,t),$("dtype",n,e,t))];case"OnesLike":return[s.onesLike($("x",n,e,t))];case"RandomStandardNormal":return[s.randomStandardNormal($("shape",n,e,t),$("dtype",n,e,t),$("seed",n,e,t))];case"RandomUniform":return[s.randomUniform($("shape",n,e,t),$("minval",n,e,t),$("maxval",n,e,t),$("dtype",n,e,t))];case"RandomUniformInt":return[s.randomUniformInt($("shape",n,e,t),$("minval",n,e,t),$("maxval",n,e,t),$("seed",n,e,t))];case"Range":{const r=$("start",n,e,t),o=$("stop",n,e,t),i=$("step",n,e,t);return[s.range(r,o,i,$("dtype",n,e,t))]}case"TruncatedNormal":{const r=$("shape",n,e,t),o=$("mean",n,e,t),i=$("stdDev",n,e,t),a=$("seed",n,e,t);return[s.truncatedNormal(r,o,i,$("dtype",n,e,t),a)]}case"Zeros":return[s.zeros($("shape",n,e,t),$("dtype",n,e,t))];case"ZerosLike":return[s.zerosLike($("x",n,e,t))];default:throw TypeError(`Node type ${n.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vx(n,e,t){const s=$("boxes",n,e,t),r=$("scores",n,e,t),o=$("maxOutputSize",n,e,t),i=$("iouThreshold",n,e,t),a=$("scoreThreshold",n,e,t),l=$("softNmsSigma",n,e,t);return{boxes:s,scores:r,maxOutputSize:o,iouThreshold:i,scoreThreshold:a,softNmsSigma:l}}const YX=async(n,e,t,s,r=zn)=>{switch(n.op){case"NonMaxSuppressionV5":{const{boxes:o,scores:i,maxOutputSize:a,iouThreshold:l,scoreThreshold:u,softNmsSigma:h}=vx(n,e,t),p=await r.image.nonMaxSuppressionWithScoreAsync(o,i,a,l,u,h);return[p.selectedIndices,p.selectedScores]}case"NonMaxSuppressionV4":{const{boxes:o,scores:i,maxOutputSize:a,iouThreshold:l,scoreThreshold:u}=vx(n,e,t),h=$("padToMaxOutputSize",n,e,t),p=await r.image.nonMaxSuppressionPaddedAsync(o,i,a,l,u,h);return[p.selectedIndices,p.validOutputs]}case"NonMaxSuppressionV3":case"NonMaxSuppressionV2":{const{boxes:o,scores:i,maxOutputSize:a,iouThreshold:l,scoreThreshold:u}=vx(n,e,t);return[await r.image.nonMaxSuppressionAsync(o,i,a,l,u)]}case"Where":{const o=r.cast($("condition",n,e,t),"bool"),i=[await r.whereAsync(o)];return o.dispose(),i}case"ListDiff":return r.setdiff1dAsync($("x",n,e,t),$("y",n,e,t));default:throw TypeError(`Node type ${n.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const QX=(n,e,t,s=zn)=>{switch(n.op){case"LowerBound":{const r=$("sortedSequence",n,e,t),o=$("values",n,e,t);return[s.lowerBound(r,o)]}case"TopKV2":{const r=$("x",n,e,t),o=$("k",n,e,t),i=$("sorted",n,e,t),a=s.topk(r,o,i);return[a.values,a.indices]}case"UpperBound":{const r=$("sortedSequence",n,e,t),o=$("values",n,e,t);return[s.upperBound(r,o)]}case"Unique":{const r=$("x",n,e,t),o=s.unique(r);return[o.values,o.indices]}case"UniqueV2":{const r=$("x",n,e,t),o=$("axis",n,e,t),i=s.unique(r,o);return[i.values,i.indices]}default:throw TypeError(`Node type ${n.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ZX=(n,e,t,s=zn)=>{switch(n.op){case"Const":return e[n.name];case"PlaceholderWithDefault":const r=$("default",n,e,t);return[An(n.name,e,t)||r];case"Placeholder":return[An(n.name,e,t)];case"Identity":case"StopGradient":case"FakeQuantWithMinMaxVars":{const h=$("x",n,e,t);return[ko(h)]}case"IdentityN":return $("x",n,e,t).map(h=>ko(h));case"Snapshot":const o=$("x",n,e,t);return[ko(o)];case"Shape":return[s.tensor1d($("x",n,e,t).shape,"int32")];case"ShapeN":return $("x",n,e,t).map(h=>s.tensor1d(h.shape));case"Size":return[s.scalar($("x",n,e,t).size,"int32")];case"Rank":return[s.scalar($("x",n,e,t).rank,"int32")];case"NoOp":return[s.scalar(1)];case"Print":const i=$("x",n,e,t),a=$("data",n,e,t),l=$("message",n,e,t),u=$("summarize",n,e,t);console.warn("The graph has a tf.print() operation,usually used for debugging, which slows down performance."),console.log(l);for(let h=0;h<a.length;h++)console.log(Array.prototype.slice.call(a[h].dataSync()).slice(0,u));return[i];default:throw TypeError(`Node type ${n.op} is not implemented`)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class JX{get id(){return this.handle.id}constructor(e,t){this.keyDType=e,this.valueDType=t,this.handle=We(0),this.tensorMap=new Map,kn(this.handle)}clearAndClose(){this.tensorMap.forEach(e=>e.dispose()),this.tensorMap.clear(),this.handle.dispose()}size(){return this.tensorMap.size}tensorSize(){return We(this.size(),"int32")}async import(e,t){this.checkKeyAndValueTensor(e,t);const s=await e.data();return this.tensorMap.forEach(r=>r.dispose()),this.tensorMap.clear(),ie(()=>{const r=mr(t),o=s.length,i=r.length;L(o===i,()=>`The number of elements doesn't match, keys has ${o} elements, the values has ${i} elements.`);for(let a=0;a<o;a++){const l=s[a],u=r[a];kn(u),this.tensorMap.set(l,u)}return this.handle})}async find(e,t){this.checkKeyAndValueTensor(e,t);const s=await e.data();return ie(()=>{const r=[];for(let o=0;o<s.length;o++){const i=s[o],a=this.findWithDefault(i,t);r.push(a)}return _s(r)})}findWithDefault(e,t){const s=this.tensorMap.get(e);return s??t}checkKeyAndValueTensor(e,t){if(e.dtype!==this.keyDType)throw new Error(`Expect key dtype ${this.keyDType}, but got ${e.dtype}`);if(t.dtype!==this.valueDType)throw new Error(`Expect value dtype ${this.valueDType}, but got ${t.dtype}`)}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const e7=async(n,e,t,s)=>{switch(n.op){case"HashTable":case"HashTableV2":{const r=s.getHashTableHandleByName(n.name);if(r!=null)return[r];{const o=$("keyDType",n,e,t),i=$("valueDType",n,e,t),a=new JX(o,i);return s.addHashTable(n.name,a),[a.handle]}}case"InitializeTable":case"InitializeTableV2":case"LookupTableImport":case"LookupTableImportV2":{const r=$("tableHandle",n,e,t,s),o=$("keys",n,e,t),i=$("values",n,e,t);return[await s.getHashTableById(r.id).import(o,i)]}case"LookupTableFind":case"LookupTableFindV2":{const r=$("tableHandle",n,e,t,s),o=$("keys",n,e,t),i=$("defaultValue",n,e,t);return[await s.getHashTableById(r.id).find(o,i)]}case"LookupTableSize":case"LookupTableSizeV2":{const r=$("tableHandle",n,e,t,s);return[s.getHashTableById(r.id).tensorSize()]}default:throw TypeError(`Node type ${n.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const t7=(n,e,t,s=zn)=>{switch(n.op){case"ResizeBilinear":{const r=$("images",n,e,t),o=$("size",n,e,t),i=$("alignCorners",n,e,t),a=$("halfPixelCenters",n,e,t);return[s.image.resizeBilinear(r,[o[0],o[1]],i,a)]}case"ResizeNearestNeighbor":{const r=$("images",n,e,t),o=$("size",n,e,t),i=$("alignCorners",n,e,t),a=$("halfPixelCenters",n,e,t);return[s.image.resizeNearestNeighbor(r,[o[0],o[1]],i,a)]}case"CropAndResize":{const r=$("image",n,e,t),o=$("boxes",n,e,t),i=$("boxInd",n,e,t),a=$("cropSize",n,e,t),l=$("method",n,e,t),u=$("extrapolationValue",n,e,t);return[s.image.cropAndResize(r,o,i,a,l,u)]}case"ImageProjectiveTransformV3":{const r=$("images",n,e,t),o=$("transforms",n,e,t),i=$("outputShape",n,e,t),a=$("fillValue",n,e,t),l=$("interpolation",n,e,t),u=$("fillMode",n,e,t);return[s.image.transform(r,o,l.toLowerCase(),u.toLowerCase(),a,i)]}default:throw TypeError(`Node type ${n.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const n7=(n,e,t,s=zn)=>{switch(n.op){case"Equal":return[s.equal($("a",n,e,t),$("b",n,e,t))];case"NotEqual":return[s.notEqual($("a",n,e,t),$("b",n,e,t))];case"Greater":return[s.greater($("a",n,e,t),$("b",n,e,t))];case"GreaterEqual":return[s.greaterEqual($("a",n,e,t),$("b",n,e,t))];case"Less":return[s.less($("a",n,e,t),$("b",n,e,t))];case"LessEqual":return[s.lessEqual($("a",n,e,t),$("b",n,e,t))];case"LogicalAnd":return[s.logicalAnd($("a",n,e,t),$("b",n,e,t))];case"LogicalNot":return[s.logicalNot($("a",n,e,t))];case"LogicalOr":return[s.logicalOr($("a",n,e,t),$("b",n,e,t))];case"Select":case"SelectV2":return[s.where($("condition",n,e,t),$("a",n,e,t),$("b",n,e,t))];case"BitwiseAnd":return[s.bitwiseAnd($("a",n,e,t),$("b",n,e,t))];default:throw TypeError(`Node type ${n.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const s7=(n,e,t,s=zn)=>{switch(n.op){case"BatchMatMul":case"BatchMatMulV2":case"MatMul":return[s.matMul($("a",n,e,t),$("b",n,e,t),$("transposeA",n,e,t),$("transposeB",n,e,t))];case"Einsum":return[s.einsum($("equation",n,e,t),...$("tensors",n,e,t))];case"Transpose":return[s.transpose($("x",n,e,t),$("perm",n,e,t))];case"_FusedMatMul":const[r,o]=$("fusedOps",n,e,t),i=r==="biasadd",a=o==="prelu",l=$("numArgs",n,e,t),u=$("leakyreluAlpha",n,e,t);if(i){if(a&&l!==2)throw new Error("Fused MatMul with BiasAdd and Prelu must have two extra arguments: bias and alpha.");if(!a&&l!==1)throw new Error("Fused MatMul with BiasAdd must have one extra argument: bias.")}const[h,p]=$("args",n,e,t);return[s.fused.matMul({a:$("a",n,e,t),b:$("b",n,e,t),transposeA:$("transposeA",n,e,t),transposeB:$("transposeB",n,e,t),bias:h,activation:o,preluActivationWeights:p,leakyreluAlpha:u})];case"MatrixBandPart":return[s.linalg.bandPart($("a",n,e,t),$("numLower",n,e,t),$("numUpper",n,e,t))];default:throw TypeError(`Node type ${n.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const r7=(n,e,t,s=zn)=>{switch(n.op){case"EuclideanNorm":return[s.euclideanNorm($("x",n,e,t),$("axis",n,e,t),$("keepDims",n,e,t))];case"FusedBatchNorm":case"FusedBatchNormV2":return[s.batchNorm($("x",n,e,t),$("mean",n,e,t),$("variance",n,e,t),$("offset",n,e,t),$("scale",n,e,t),$("epsilon",n,e,t))];case"FusedBatchNormV3":return[s.batchNorm($("x",n,e,t),$("mean",n,e,t),$("variance",n,e,t),$("offset",n,e,t),$("scale",n,e,t),$("epsilon",n,e,t))];case"LRN":return[s.localResponseNormalization($("x",n,e,t),$("radius",n,e,t),$("bias",n,e,t),$("alpha",n,e,t),$("beta",n,e,t))];case"Softmax":return[s.softmax($("x",n,e,t))];case"LogSoftmax":return[s.logSoftmax($("x",n,e,t))];default:throw TypeError(`Node type ${n.op} is not implemented`)}};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const o7=(n,e,t,s=zn)=>{switch(n.op){case"RaggedGather":{const{outputNestedSplits:r,outputDenseValues:o}=s.raggedGather($("paramsNestedSplits",n,e,t),$("paramsDenseValues",n,e,t),$("indices",n,e,t),$("outputRaggedRank",n,e,t));return r.concat(o)}case"RaggedRange":{const{rtNestedSplits:r,rtDenseValues:o}=s.raggedRange($("starts",n,e,t),$("limits",n,e,t),$("splits",n,e,t));return[r,o]}case"RaggedTensorToTensor":return[s.raggedTensorToTensor($("shape",n,e,t),$("values",n,e,t),$("defaultValue",n,e,t),$("rowPartitionTensors",n,e,t),$("rowPartitionTypes",n,e,t))];default:throw TypeError(`Node type ${n.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const i7=(n,e,t,s=zn)=>{switch(n.op){case"Max":{const a=$("axis",n,e,t),l=$("keepDims",n,e,t);return[s.max($("x",n,e,t),a,l)]}case"Mean":{const a=$("axis",n,e,t),l=$("keepDims",n,e,t);return[s.mean($("x",n,e,t),a,l)]}case"Min":{const a=$("axis",n,e,t),l=$("keepDims",n,e,t);return[s.min($("x",n,e,t),a,l)]}case"Sum":{const a=$("axis",n,e,t),l=$("keepDims",n,e,t);return[s.sum($("x",n,e,t),a,l)]}case"All":{const a=$("axis",n,e,t),l=$("keepDims",n,e,t);return[s.all($("x",n,e,t),a,l)]}case"Any":{const a=$("axis",n,e,t),l=$("keepDims",n,e,t);return[s.any($("x",n,e,t),a,l)]}case"ArgMax":{const a=$("axis",n,e,t);return[s.argMax($("x",n,e,t),a)]}case"ArgMin":{const a=$("axis",n,e,t);return[s.argMin($("x",n,e,t),a)]}case"Prod":{const a=$("axis",n,e,t),l=$("keepDims",n,e,t);return[s.prod($("x",n,e,t),a,l)]}case"Cumprod":{const a=$("axis",n,e,t),l=$("exclusive",n,e,t),u=$("reverse",n,e,t);return[s.cumprod($("x",n,e,t),a,l,u)]}case"Cumsum":{const a=$("axis",n,e,t),l=$("exclusive",n,e,t),u=$("reverse",n,e,t);return[s.cumsum($("x",n,e,t),a,l,u)]}case"Bincount":const r=$("x",n,e,t),o=$("weights",n,e,t),i=$("size",n,e,t);return[s.bincount(r,o,i)];case"DenseBincount":{const a=$("x",n,e,t),l=$("weights",n,e,t),u=$("size",n,e,t),h=$("binaryOutput",n,e,t);return[s.denseBincount(a,l,u,h)]}default:throw TypeError(`Node type ${n.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const a7=(n,e,t,s=zn)=>{switch(n.op){case"ConcatV2":case"Concat":{const r=$("n",n,e,t),o=$("axis",n,e,t);let i=$("tensors",n,e,t);return i=i.slice(0,r),[s.concat(i,o)]}case"Gather":{const r=$("x",n,e,t),o=$("indices",n,e,t);return[s.gather(r,s.cast(o,"int32"),0)]}case"GatherV2":{const r=$("axis",n,e,t),o=$("batchDims",n,e,t),i=$("x",n,e,t),a=$("indices",n,e,t);return[s.gather(i,s.cast(a,"int32"),r,o)]}case"Reverse":{const r=$("dims",n,e,t),o=[];for(let a=0;a<r.length;a++)r[a]&&o.push(a);const i=$("x",n,e,t);return[s.reverse(i,o)]}case"ReverseV2":{const r=$("axis",n,e,t),o=$("x",n,e,t);return[s.reverse(o,r)]}case"Slice":{const r=$("begin",n,e,t),o=$("size",n,e,t);return[s.slice($("x",n,e,t),r,o)]}case"StridedSlice":{const r=$("begin",n,e,t),o=$("end",n,e,t),i=$("strides",n,e,t),a=$("beginMask",n,e,t),l=$("endMask",n,e,t),u=$("ellipsisMask",n,e,t),h=$("newAxisMask",n,e,t),p=$("shrinkAxisMask",n,e,t),f=$("x",n,e,t);return[s.stridedSlice(f,r,o,i,a,l,u,h,p)]}case"Pack":return ie(()=>{const r=$("axis",n,e,t),o=$("tensors",n,e,t),i=o[0].shape,a=s.squeeze(o[0]).shape,l=o.map(u=>{const h=ct(u.shape,i);if(!h&&!ct(s.squeeze(u).shape,a))throw new Error("the input tensors shape does not match");return h?u:s.reshape(u,i)});return[s.stack(l,r)]});case"Unpack":{const r=$("axis",n,e,t),o=$("tensor",n,e,t);return s.unstack(o,r)}case"Tile":{const r=$("reps",n,e,t);return[s.tile($("x",n,e,t),r)]}case"Split":case"SplitV":{const r=$("axis",n,e,t),o=$("numOrSizeSplits",n,e,t),i=$("x",n,e,t);return s.split(i,o,r)}case"ScatterNd":{const r=$("indices",n,e,t),o=$("values",n,e,t),i=$("shape",n,e,t);return[s.scatterND(r,o,i)]}case"GatherNd":{const r=$("x",n,e,t),o=$("indices",n,e,t);return[s.gatherND(r,o)]}case"SparseToDense":{const r=$("sparseIndices",n,e,t),o=$("outputShape",n,e,t),i=$("sparseValues",n,e,t),a=$("defaultValue",n,e,t);return[s.sparseToDense(r,i,o,i.dtype===a.dtype?a:s.cast(a,i.dtype))]}case"TensorScatterUpdate":{const r=$("indices",n,e,t),o=$("values",n,e,t),i=$("tensor",n,e,t);return[s.tensorScatterUpdate(i,r,o)]}default:throw TypeError(`Node type ${n.op} is not implemented`)}};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const l7=(n,e,t,s=zn)=>{switch(n.op){case"SparseFillEmptyRows":{const{outputIndices:r,outputValues:o,emptyRowIndicator:i,reverseIndexMap:a}=s.sparse.sparseFillEmptyRows($("indices",n,e,t),$("values",n,e,t),$("denseShape",n,e,t),$("defaultValue",n,e,t));return[r,o,i,a]}case"SparseReshape":{const{outputIndices:r,outputShape:o}=s.sparse.sparseReshape($("inputIndices",n,e,t),$("inputShape",n,e,t),$("newShape",n,e,t));return[r,o]}case"SparseSegmentMean":return[s.sparse.sparseSegmentMean($("data",n,e,t),$("indices",n,e,t),$("segmentIds",n,e,t))];case"SparseSegmentSum":return[s.sparse.sparseSegmentSum($("data",n,e,t),$("indices",n,e,t),$("segmentIds",n,e,t))];default:throw TypeError(`Node type ${n.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const u7=(n,e,t,s=zn)=>{switch(n.op){case"FFT":return[s.fft($("x",n,e,t))];case"IFFT":return[s.ifft($("x",n,e,t))];case"RFFT":return[s.rfft($("x",n,e,t))];case"IRFFT":return[s.irfft($("x",n,e,t))];default:throw TypeError(`Node type ${n.op} is not implemented`)}};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const c7=(n,e,t,s=zn)=>{switch(n.op){case"StaticRegexReplace":return[s.string.staticRegexReplace($("input",n,e,t),$("pattern",n,e,t),$("rewrite",n,e,t),$("replaceGlobal",n,e,t))];case"StringNGrams":{const{nGrams:r,nGramsSplits:o}=s.string.stringNGrams($("data",n,e,t),$("dataSplits",n,e,t),$("separator",n,e,t),$("nGramWidths",n,e,t),$("leftPad",n,e,t),$("rightPad",n,e,t),$("padWidth",n,e,t),$("preserveShortSequences",n,e,t));return[r,o]}case"StringSplit":{const{indices:r,values:o,shape:i}=s.string.stringSplit($("input",n,e,t),$("delimiter",n,e,t),$("skipEmpty",n,e,t));return[r,o,i]}case"StringToHashBucketFast":return[s.string.stringToHashBucketFast($("input",n,e,t),$("numBuckets",n,e,t))];default:throw TypeError(`Node type ${n.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const h7=(n,e,t,s=zn)=>{switch(n.op){case"Cast":return[s.cast($("x",n,e,t),$("dtype",n,e,t))];case"ExpandDims":{const r=$("axis",n,e,t);return[s.expandDims($("x",n,e,t),r)]}case"Squeeze":{const r=$("axis",n,e,t);return[s.squeeze($("x",n,e,t),r)]}case"Reshape":return[s.reshape($("x",n,e,t),$("shape",n,e,t))];case"EnsureShape":return[s.ensureShape($("x",n,e,t),$("shape",n,e,t))];case"MirrorPad":return[s.mirrorPad($("x",n,e,t),$("padding",n,e,t),$("mode",n,e,t))];case"PadV2":case"Pad":return[s.pad($("x",n,e,t),$("padding",n,e,t),$("constantValue",n,e,t))];case"SpaceToBatchND":{const r=$("blockShape",n,e,t),o=$("paddings",n,e,t);return[s.spaceToBatchND($("x",n,e,t),r,o)]}case"BatchToSpaceND":{const r=$("blockShape",n,e,t),o=$("crops",n,e,t);return[s.batchToSpaceND($("x",n,e,t),r,o)]}case"DepthToSpace":{const r=$("blockSize",n,e,t),o=$("dataFormat",n,e,t).toUpperCase();return[s.depthToSpace($("x",n,e,t),r,o)]}case"BroadcastTo":return[s.broadcastTo($("x",n,e,t),$("shape",n,e,t))];case"BroadcastArgs":return[s.broadcastArgs($("s0",n,e,t),$("s1",n,e,t))];default:throw TypeError(`Node type ${n.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gI(n,e,t,s,r=ie){const o=((i,a,l)=>{switch(i.category){case"arithmetic":return r(()=>VX(i,a,l));case"basic_math":return r(()=>BX(i,a,l));case"control":return KX(i,a,l);case"convolution":return r(()=>qX(i,a,l));case"creation":return r(()=>XX(i,a,l));case"dynamic":return YX(i,a,l);case"evaluation":return r(()=>QX(i,a,l));case"image":return r(()=>t7(i,a,l));case"graph":return r(()=>ZX(i,a,l));case"logical":return r(()=>n7(i,a,l));case"matrices":return r(()=>s7(i,a,l));case"normalization":return r(()=>r7(i,a,l));case"ragged":return r(()=>o7(i,a,l));case"reduction":return r(()=>i7(i,a,l));case"slice_join":return r(()=>a7(i,a,l));case"sparse":return r(()=>l7(i,a,l));case"spectral":return r(()=>u7(i,a,l));case"string":return r(()=>c7(i,a,l));case"transformation":return r(()=>h7(i,a,l));case"hash_table":return e7(i,a,l,s);case"custom":const u=WO(i.op);if(u&&u.customExecutor)return u.customExecutor(new zX(i,a,l));throw TypeError(`Custom op ${i.op} is not registered.`);default:throw TypeError(`Unknown op '${i.op}'. File an issue at https://github.com/tensorflow/tfjs/issues so we can add it, or register a custom execution with tf.registerOp()`)}})(n,e,t);return Ca(o)?o.then(i=>[].concat(i)):[].concat(o)}class yI{constructor(e={},t={},s={},r={},o){this.weightMap=e,this.tensorArrayMap=t,this.tensorListMap=s,this.functionMap=r,this.parseNodeNameCache=o,this.rootContext={id:0,frameName:"",iterationId:0},this.contexts=[this.rootContext],this.lastId=0,this.generateCurrentContextIds()}newFrame(e,t){return{id:e,frameName:t,iterationId:0}}set currentContext(e){this.contexts!==e&&(this.contexts=e,this.generateCurrentContextIds())}get currentContext(){return this.contexts}get currentContextId(){return this._currentContextIds[0]}get currentContextIds(){return this._currentContextIds}generateCurrentContextIds(){const e=[];for(let t=0;t<this.contexts.length-1;t++){const s=this.contexts.slice(0,this.contexts.length-t);e.push(this.contextIdforContexts(s))}e.push(""),this._currentContextIds=e}contextIdforContexts(e){return e?e.map(t=>t.id===0&&t.iterationId===0?"":`${t.frameName}-${t.iterationId}`).join("/"):""}enterFrame(e){this.contexts&&(this.lastId++,this.contexts=this.contexts.slice(),this.contexts.push(this.newFrame(this.lastId,e)),this._currentContextIds.unshift(this.contextIdforContexts(this.contexts)))}exitFrame(){if(this.contexts&&this.contexts.length>1)this.contexts=this.contexts.slice(),this.contexts.splice(-1),this.currentContextIds.shift();else throw new Error("Cannot exit frame, the context is empty")}nextIteration(){if(this.contexts&&this.contexts.length>0){this.contexts=this.contexts.slice(),this.lastId++;const e=Object.assign({},this.contexts[this.contexts.length-1]);e.iterationId+=1,e.id=this.lastId,this.contexts.splice(-1,1,e),this._currentContextIds.splice(0,1,this.contextIdforContexts(this.contexts))}else throw new Error("Cannot increase frame iteration, the context is empty")}getWeight(e){return this.weightMap[e]}addTensorArray(e){this.tensorArrayMap[e.id]=e}getTensorArray(e){return this.tensorArrayMap[e]}addTensorList(e){this.tensorListMap[e.id]=e}getTensorList(e){return this.tensorListMap[e]}dispose(e){for(const t in this.tensorArrayMap)this.tensorArrayMap[t].clearAndClose(e);for(const t in this.tensorListMap)this.tensorListMap[t].clearAndClose(e)}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xI(n,e,t,s){const r=new Set,o=[];let i=null,a=null;const l=new Set,u=new Set(Object.keys(n).map(f=>Ns(f)[0]));s=s||[];const h=new Set(s.map(f=>Ns(f.name)[0])),p=[...e];for(;p.length>0;){const f=p.pop();if((pa(f)||v7(f)||w7(f))&&i==null&&(i=f,a=i.children.map(m=>m.name).filter(m=>r.has(m))),r.add(f.name),t[f.name]==null&&!u.has(f.name)&&!h.has(f.name)){if(f.inputs.length===0){o.push(f.name);continue}f.inputs.forEach(m=>{l.has(m.name)||(l.add(m.name),p.push(m))})}}return{inputs:n,outputs:e,usedNodes:r,missingInputs:o,dynamicNode:i,syncInputs:a}}function d7(n,e){const{usedNodes:t,inputs:s}=e,r=Object.keys(s).map(v=>Ns(v)[0]).map(v=>n.nodes[v]),o=n.initNodes||[],i=v=>t.has(typeof v=="string"?v:v.name);function a(v){return[...new Map(v.map(w=>[w.name,w])).values()]}const l=a([...r,...n.weights,...o]).filter(i),u=a([...l,...Object.values(n.nodes)]).filter(i),h=new Map(u.map(v=>[v.name,v])),p={};for(const v of u){p[v.name]=p[v.name]||0;for(const w of v.children)i(w)||(p[w.name]=Number.POSITIVE_INFINITY),p[w.name]=(p[w.name]||0)+1}const f=Object.entries(p).filter(([,v])=>v===0).map(([v])=>v),m=[...f];for(;f.length>0;){const v=f.pop(),w=h.get(v);for(const S of w.children.filter(i))--p[S.name]===0&&(m.push(S.name),f.push(S.name))}const y=m.map(v=>h.get(v)),x=p7(y,l);return f7(x,l),x}function p7(n,e){const t=new Map(n.map(i=>[i.name,i])),s=e.map(i=>i.name),r=new Set(s);for(;s.length>0;){const i=s.pop(),a=t.get(i);for(const l of a.children)!t.has(l.name)||r.has(l.name)||(r.add(l.name),s.push(l.name))}return n.filter(i=>r.has(i.name))}class Bp extends Error{constructor(e){super(`NodesExecutionOrderError: ${e}`)}}function f7(n,e){const t=new Map(n.map((a,l)=>[a.name,l])),s=new Set(e.map(a=>a.name)),r=a=>s.has(typeof a=="string"?a:a.name),o=new Set(n.map(a=>a.name)),i=a=>o.has(typeof a=="string"?a:a.name);for(const a of n){for(const l of a.children.filter(i)){if(!t.has(l.name))throw new Bp(`Child ${l.name} of node ${a.name} is unreachable.`);if(t.get(a.name)>t.get(l.name))throw new Bp(`Node ${a.name} is scheduled to run after its child ${l.name}.`)}if(!r(a))for(const l of a.inputs){if(!t.has(l.name))throw new Bp(`Input ${l.name} of node ${a.name} is unreachable.`);if(t.get(l.name)>t.get(a.name))throw new Bp(`Node ${a.name} is scheduled to run before its input ${l.name}.`)}}}function m7(n){const e=new Map(n.map((a,l)=>[a.name,l])),t=Number.MAX_SAFE_INTEGER,s=n.map((a,l)=>pa(a)?t:l),r=a=>{const l=s[e.get(a.name)];return l??-1},o=n.map((a,l)=>a.children.map(r).reduce((u,h)=>Math.max(u,h),s[l])),i=new Map;for(let a=0;a<n.length;++a){const l=o[a];if(l===t)continue;const u=n[a],h=n[l];i.has(h.name)||i.set(h.name,[]),i.get(h.name).push(u)}return i}const g7=new Set(["Switch","Merge","Enter","Exit","NextIteration","StatelessIf","StatelessWhile","if","While"]),y7=new Set(["NonMaxSuppressionV2","NonMaxSuppressionV3","NonMaxSuppressionV5","Where"]),x7=new Set(["HashTable","HashTableV2","LookupTableImport","LookupTableImportV2","LookupTableFind","LookupTableFindV2","LookupTableSize","LookupTableSizeV2"]);function pa(n){return g7.has(n.op)}function v7(n){return y7.has(n.op)}function w7(n){return x7.has(n.op)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Uf{get weightIds(){return this.parent?this.parent.weightIds:this._weightIds}get functionExecutorMap(){return this.parent?this.parent.functionExecutorMap:this._functionExecutorMap}get weightMap(){return this.parent?this.parent.weightMap:this._weightMap}set weightMap(e){const t=Object.keys(e).map(s=>e[s].map(r=>r.id));this._weightIds=[].concat(...t),this._weightMap=e}set resourceManager(e){this._resourceManager=e}get inputs(){return this._inputs.map(e=>({name:e.name,shape:e.attrParams.shape?e.attrParams.shape.value:void 0,dtype:e.attrParams.dtype?e.attrParams.dtype.value:void 0}))}get outputs(){return this._outputs.map(e=>({name:e.name,shape:e.attrParams.shape?e.attrParams.shape.value:void 0,dtype:e.attrParams.dtype?e.attrParams.dtype.value:void 0}))}get inputNodes(){return this._inputs.map(e=>e.signatureKey||e.name)}get outputNodes(){return this._outputs.map(e=>{const t=e.signatureKey||e.name;return e.defaultOutput?`${t}:${e.defaultOutput}`:t})}get functions(){return Object.keys(this._functions).reduce((e,t)=>(e[t]=this._functions[t].signature,e),{})}constructor(e,t){this.graph=e,this.parent=t,this.compiledMap=new Map,this.parseNodeNameCache=new Map,this._weightMap={},this.SEPARATOR=",",this._functions={},this._functionExecutorMap={},this.keepIntermediateTensors=!1,this._outputs=e.outputs,this._inputs=e.inputs,this._initNodes=e.initNodes,this._signature=e.signature,this._functions=e.functions,e.functions!=null&&Object.keys(e.functions).forEach(s=>{this._functionExecutorMap[s]=new Uf(e.functions[s],this)})}getCompilationKey(e,t){const s=e.map(o=>o.name).sort(),r=t.map(o=>o.name).sort();return s.join(this.SEPARATOR)+"--"+r.join(this.SEPARATOR)}compile(e,t){const s=xI(e,t,this.weightMap,this._initNodes),{missingInputs:r,dynamicNode:o,syncInputs:i}=s;if(o!=null)throw new Error(`This execution contains the node '${o.name}', which has the dynamic op '${o.op}'. Please use model.executeAsync() instead. Alternatively, to avoid the dynamic ops, specify the inputs [${i}]`);if(r.length>0){const u=t.map(p=>p.name),h=Object.keys(e);throw new Error(`Cannot compute the outputs [${u}] from the provided inputs [${h}]. Missing the following inputs: [${r}]`)}const a=d7(this.graph,s),l=m7(a);return{orderedNodes:a,nodeLiveUntilMap:l}}cloneAndKeepTensor(e){if(e==null)return null;const t=e.clone();return kn(t),t}cloneTensorList(e){return e?e.map(s=>this.cloneAndKeepTensor(s)):null}cloneTensorMap(e){return Object.fromEntries(Object.entries(e).map(([t,s])=>[t,this.cloneTensorList(s)]))}execute(e,t){this.disposeIntermediateTensors(),e=this.mapInputs(e);const s=Object.keys(e).sort();this.checkInputs(e),this.checkInputShapeAndType(e),t=this.mapOutputs(t),this.checkOutputs(t);const r=s.map(f=>this.graph.nodes[Ns(f)[0]]),o=t.map(f=>Ns(f)[0]),i=new Set(o);let a=o.map(f=>this.graph.nodes[f]);a.length===0&&(a=this._outputs);const l=this.getCompilationKey(r,a);let u=this.compiledMap.get(l);u==null&&(u=this.compile(e,a),this.compiledMap.set(l,u));try{this.keepIntermediateTensors=ae().getBool("KEEP_INTERMEDIATE_TENSORS")}catch(f){this.keepIntermediateTensors=!1,console.warn(f.message)}const h={},p={};return ie(()=>{const f=new yI(this.weightMap,h,p,this.functionExecutorMap,this.parseNodeNameCache),m=Object.assign({},this.weightMap);this.keepIntermediateTensors&&(this.clonedTensorsMap=this.cloneTensorMap(this.weightMap)),Object.keys(e).forEach(w=>{const[S,k]=Ns(w,f),T=[];T[k]=e[w],m[S]=T,this.keepIntermediateTensors&&(this.clonedTensorsMap[S]=this.cloneTensorList(T))});const y=this.getFrozenTensorIds(m),{orderedNodes:x,nodeLiveUntilMap:v}=u;for(const w of x){if(m[w.name])continue;const S=gI(w,m,f,this._resourceManager);if(Ca(S))throw new Error(`The execution of the op '${w.op}' returned a promise. Please use model.executeAsync() instead.`);m[w.name]=S,this.keepIntermediateTensors&&(this.clonedTensorsMap[w.name]=this.cloneTensorList(S)),this.checkTensorForDisposalWithNodeLiveUntilInfo(w,m,f,y,i,v.get(w.name))}return this.parent==null&&f.dispose(y),t.map(w=>An(w,m,f))})}getFrozenTensorIds(e){const t=[].concat.apply([],Object.keys(e).map(s=>e[s]).map(s=>s.map(r=>r.id)));return new Set(t)}checkTensorForDisposal(e,t,s,r,o,i,a){if(!(pa(t)||i.has(e))){for(const l of s[e])l!=null&&(a[l.id]=(a[l.id]||0)+t.children.length);for(const l of t.inputs){if(pa(l))continue;const u=hI(l.name,s,r);if(u!=null)for(const h of u){if(!h||h.kept||o.has(h.id))continue;const p=a[h.id];p===1?(h.dispose(),delete a[h.id]):p!=null&&a[h.id]--}}}}checkTensorForDisposalWithNodeLiveUntilInfo(e,t,s,r,o,i){function a(l){return pa(l)||o.has(l.name)}if(!(pa(e)||i==null))for(const l of i){if(a(l))continue;const u=hI(l.name,t,s);for(const h of u)!h||h.kept||r.has(h.id)||h.dispose()}}async executeAsync(e,t){return this._executeAsync(e,t)}disposeIntermediateTensors(){this.clonedTensorsMap&&(Object.values(this.clonedTensorsMap).forEach(e=>{for(const t of e)t&&!t.isDisposed&&t.dispose()}),this.clonedTensorsMap=null)}getIntermediateTensors(){return this.clonedTensorsMap}async _executeAsync(e,t,s=!1,r={},o={}){this.disposeIntermediateTensors(),s||(e=this.mapInputs(e),this.checkInputs(e),this.checkInputShapeAndType(e),t=this.mapOutputs(t),this.checkOutputs(t));try{this.keepIntermediateTensors=ae().getBool("KEEP_INTERMEDIATE_TENSORS")}catch(f){this.keepIntermediateTensors=!1,console.warn(f.message)}const i=new yI(this.weightMap,r,o,this.functionExecutorMap,this.parseNodeNameCache);this.keepIntermediateTensors&&(this.clonedTensorsMap=this.cloneTensorMap(this.weightMap));const a=await this.executeWithControlFlow(e,i,t,s),l=t.map(f=>An(f,a,i)),u=l.map(f=>f.id),h=Object.keys(e).map(f=>e[f].id),p=new Set([...u,...h,...this.weightIds]);return Object.values(a).forEach(f=>{f.forEach(m=>{m&&!m.isDisposed&&!p.has(m.id)&&m.dispose()})}),this.parent==null&&i.dispose(p),l}async executeFunctionAsync(e,t,s){const r=e.reduce((o,i,a)=>(o[this.inputs[a].name]=i,o),{});return this._executeAsync(r,this.outputNodes,!0,t,s)}async executeWithControlFlow(e,t,s,r){const o=Object.keys(e),i=o.map(T=>this.graph.nodes[Ns(T)[0]]),a=s.map(T=>Ns(T)[0]),l=new Set(a);let u=a.map(T=>this.graph.nodes[T]);u.length===0&&(u=this._outputs);const{usedNodes:h,missingInputs:p,dynamicNode:f,syncInputs:m}=xI(e,u,this.weightMap,this._initNodes),y=[...i,...this.graph.weights,...this._initNodes||[]].map(T=>({node:T,contexts:t.currentContext})),x=Object.assign({},this.weightMap);Object.keys(e).forEach(T=>{const[I,E]=Ns(T),D=[];D[E]=e[T],x[I]=D});const v={},w=this.getFrozenTensorIds(x),S={};for(;y.length>0;){const T=this.processStack(i,y,t,x,S,w,l,v,h);await Promise.all(T)}f==null&&!r&&console.warn("This model execution did not contain any nodes with control flow or dynamic output shapes. You can use model.execute() instead.");const k=u.filter(T=>!pa(T)&&!An(T.name,x,t)).map(T=>T.name);if(k.length>0){let T="";throw f!=null&&(T=`Alternatively, to avoid the dynamic ops, use model.execute() and specify the inputs [${m}]`),new Error(`Cannot compute the outputs [${k}] from the provided inputs [${o}]. Consider providing the following inputs: [${p}]. ${T}`)}return x}processStack(e,t,s,r,o,i,a,l,u){const h=[];for(;t.length>0;){const p=t.pop();s.currentContext=p.contexts;let f="";if(p.node.op==="Enter"&&$("isConstant",p.node,r,s)&&([f]=Co(p.node.name,s)),r[p.node.name]==null){const m=gI(p.node,r,s,this._resourceManager);f||([f]=Co(p.node.name,s));const y=s.currentContext;Ca(m)?h.push(m.then(x=>(r[f]=x,this.keepIntermediateTensors&&(this.clonedTensorsMap[f]=this.cloneTensorList(x)),s.currentContext=y,this.checkTensorForDisposal(f,p.node,r,s,i,a,l),this.processChildNodes(p.node,t,s,r,o,u),x))):(r[f]=m,this.keepIntermediateTensors&&(this.clonedTensorsMap[f]=this.cloneTensorList(m)),this.checkTensorForDisposal(f,p.node,r,s,i,a,l),this.processChildNodes(p.node,t,s,r,o,u))}else this.processChildNodes(p.node,t,s,r,o,u)}return h}processChildNodes(e,t,s,r,o,i){e.children.forEach(a=>{const[l]=Co(a.name,s);o[l]||!i.has(a.name)||(a.op==="Merge"?a.inputNames.some(u=>!!An(u,r,s))&&(o[l]=!0,t.push({contexts:s.currentContext,node:a})):a.inputNames.every(u=>!!An(u,r,s))&&(o[l]=!0,t.push({contexts:s.currentContext,node:a})))})}dispose(){Object.keys(this.weightMap).forEach(e=>this.weightMap[e].forEach(t=>t.dispose()))}checkInputShapeAndType(e){Object.keys(e).forEach(t=>{const s=e[t],[r]=Ns(t),o=this.graph.nodes[r];if(o.attrParams.shape&&o.attrParams.shape.value){const i=o.attrParams.shape.value,a=i.length===s.shape.length&&s.shape.every((l,u)=>i[u]===-1||i[u]===l);L(a,()=>`The shape of dict['${o.name}'] provided in model.execute(dict) must be [${i}], but was [${s.shape}]`)}o.attrParams.dtype&&o.attrParams.dtype.value&&L(s.dtype===o.attrParams.dtype.value,()=>`The dtype of dict['${o.name}'] provided in model.execute(dict) must be ${o.attrParams.dtype.value}, but was ${s.dtype}`)})}mapInputs(e){var t,s;const r={};for(const o in e){const i=(s=(t=this._signature)===null||t===void 0?void 0:t.inputs)===null||s===void 0?void 0:s[o];i!=null?r[i.name]=e[o]:r[o]=e[o]}return r}checkInputs(e){const t=Object.keys(e).filter(s=>{const[r]=Ns(s);return this.graph.nodes[r]==null});if(t.length>0)throw new Error(`The dict provided in model.execute(dict) has keys: [${t}] that are not part of graph`)}mapOutputs(e){return e.map(t=>{var s,r;const o=(r=(s=this._signature)===null||s===void 0?void 0:s.outputs)===null||r===void 0?void 0:r[t];return o!=null?o.name:t},{})}checkOutputs(e){e.forEach(t=>{const[s]=Ns(t);if(!this.graph.nodes[s])throw new Error(`The output '${t}' is not found in the graph`)})}}class b7{constructor(e={},t={}){this.hashTableNameToHandle=e,this.hashTableMap=t}addHashTable(e,t){this.hashTableNameToHandle[e]=t.handle,this.hashTableMap[t.id]=t}getHashTableHandleByName(e){return this.hashTableNameToHandle[e]}getHashTableById(e){return this.hashTableMap[e]}dispose(){for(const e in this.hashTableMap)this.hashTableMap[e].clearAndClose(),delete this.hashTableMap[e];for(const e in this.hashTableNameToHandle)this.hashTableNameToHandle[e].dispose(),delete this.hashTableNameToHandle[e]}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const S7="?tfjs-format=file",C7="model.json";class k7{get modelVersion(){return this.version}get inputNodes(){return this.executor.inputNodes}get outputNodes(){return this.executor.outputNodes}get inputs(){return this.executor.inputs}get outputs(){return this.executor.outputs}get weights(){return this.executor.weightMap}get metadata(){return this.artifacts.userDefinedMetadata}get modelSignature(){return this.signature}get modelStructuredOutputKeys(){return this.structuredOutputKeys}constructor(e,t={},s=XR){this.modelUrl=e,this.loadOptions=t,this.version="n/a",this.io=s,t==null&&(this.loadOptions={}),this.resourceManager=new b7}findIOHandler(){const e=this.modelUrl;if(e.load!=null)this.handler=e;else if(this.loadOptions.requestInit!=null)this.handler=this.io.browserHTTPRequest(e,this.loadOptions);else{const t=this.io.getLoadHandlers(e,this.loadOptions);if(t.length===0)t.push(this.io.browserHTTPRequest(e,this.loadOptions));else if(t.length>1)throw new Error(`Found more than one (${t.length}) load handlers for URL '${[e]}'`);this.handler=t[0]}}load(){if(this.findIOHandler(),this.handler.load==null)throw new Error("Cannot proceed with model loading because the IOHandler provided does not have the `load` method implemented.");const e=this.handler.load();return Ca(e)?e.then(t=>t.getWeightStream==null?this.loadSync(t):this.loadStreaming(t)):this.loadSync(e)}loadSync(e){const t=this.io.decodeWeights(e.weightData,e.weightSpecs);return this.loadWithWeightMap(e,t)}async loadStreaming(e){if(e.getWeightStream==null)throw new Error("Model artifacts missing streamWeights function");const t=await wE(e.getWeightStream(),e.weightSpecs);return this.loadWithWeightMap(e,t)}loadWithWeightMap(e,t){this.artifacts=e;const s=this.artifacts.modelTopology;let r=this.artifacts.signature;if(this.artifacts.userDefinedMetadata!=null){const o=this.artifacts.userDefinedMetadata;o.signature!=null&&(r=o.signature),o.structuredOutputKeys!=null&&(this.structuredOutputKeys=o.structuredOutputKeys)}if(this.signature=r,this.version=`${s.versions.producer}.${s.versions.minConsumer}`,this.executor=new Uf(dI.Instance.transformGraph(s,this.signature)),this.executor.weightMap=this.convertTensorMapToTensorsMap(t),this.executor.resourceManager=this.resourceManager,e.modelInitializer!=null&&e.modelInitializer.node!=null){const o=dI.Instance.transformGraph(e.modelInitializer);this.initializer=new Uf(o),this.initializer.weightMap=this.executor.weightMap,this.initializer.resourceManager=this.resourceManager,this.initializerSignature=e.initializerSignature}return!0}async save(e,t){if(typeof e=="string"){const s=this.io.getSaveHandlers(e);if(s.length===0)throw new Error(`Cannot find any save handlers for URL '${e}'`);if(s.length>1)throw new Error(`Found more than one (${s.length}) save handlers for URL '${e}'`);e=s[0]}if(e.save==null)throw new Error("GraphModel.save() cannot proceed because the IOHandler provided does not have the `save` attribute defined.");return e.save(this.artifacts)}addStructuredOutputNames(e){if(this.structuredOutputKeys){const t=e instanceof $t?[e]:e,s={};return t.forEach((r,o)=>s[this.structuredOutputKeys[o]]=r),s}return e}predict(e,t){const s=this.execute(e,this.outputNodes);return this.addStructuredOutputNames(s)}async predictAsync(e,t){const s=await this.executeAsync(e,this.outputNodes);return this.addStructuredOutputNames(s)}normalizeInputs(e){var t;if(!(e instanceof $t)&&!Array.isArray(e)){const o=(t=this.signature)===null||t===void 0?void 0:t.inputs;if(o!=null)for(const i in o){const a=o[i];a.resourceId!=null&&(e[i]=this.resourceIdToCapturedInput[a.resourceId])}return e}e=Array.isArray(e)?e:[e];const s=Object.keys(this.resourceIdToCapturedInput).length;if(e.length+s!==this.inputNodes.length)throw new Error(`Input tensor count mismatch, the graph model has ${this.inputNodes.length-s} non-resource placeholders, while there are ${e.length} input tensors provided.`);let r=0;return this.inputNodes.reduce((o,i)=>{var a,l,u;const h=(u=(l=(a=this.signature)===null||a===void 0?void 0:a.inputs)===null||l===void 0?void 0:l[i])===null||u===void 0?void 0:u.resourceId;return h!=null?o[i]=this.resourceIdToCapturedInput[h]:o[i]=e[r++],o},{})}normalizeOutputs(e){return e=e||this.outputNodes,Array.isArray(e)?e:[e]}executeInitializerGraph(){return this.initializer==null?[]:this.initializerSignature==null?this.initializer.execute({},[]):this.initializer.execute({},Object.keys(this.initializerSignature.outputs))}async executeInitializerGraphAsync(){return this.initializer==null?[]:this.initializerSignature==null?this.initializer.executeAsync({},[]):this.initializer.executeAsync({},Object.keys(this.initializerSignature.outputs))}setResourceIdToCapturedInput(e){if(this.resourceIdToCapturedInput={},this.initializerSignature){const t=this.initializerSignature.outputs,s=Object.keys(t);for(let r=0;r<s.length;r++){const o=s[r],i=t[o];this.resourceIdToCapturedInput[i.resourceId]=e[r]}}}execute(e,t){this.resourceIdToCapturedInput==null&&this.setResourceIdToCapturedInput(this.executeInitializerGraph()),e=this.normalizeInputs(e),t=this.normalizeOutputs(t);const s=this.executor.execute(e,t);return s.length>1?s:s[0]}async executeAsync(e,t){this.resourceIdToCapturedInput==null&&this.setResourceIdToCapturedInput(await this.executeInitializerGraphAsync()),e=this.normalizeInputs(e),t=this.normalizeOutputs(t);const s=await this.executor.executeAsync(e,t);return s.length>1?s:s[0]}getIntermediateTensors(){return this.executor.getIntermediateTensors()}disposeIntermediateTensors(){this.executor.disposeIntermediateTensors()}convertTensorMapToTensorsMap(e){return Object.keys(e).reduce((t,s)=>(t[s]=[e[s]],t),{})}dispose(){this.executor.dispose(),this.initializer&&(this.initializer.dispose(),this.resourceIdToCapturedInput&&ot(this.resourceIdToCapturedInput)),this.resourceManager.dispose()}}async function jO(n,e={},t=XR){if(n==null)throw new Error("modelUrl in loadGraphModel() cannot be null. Please provide a url or an IOHandler that loads the model");e==null&&(e={}),e.fromTFHub&&typeof n=="string"&&(n=T7(n));const s=new k7(n,e,t);return await s.load(),s}function T7(n){return n.endsWith("/")||(n=n+"/"),`${n}${C7}${S7}`}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */var vI;(function(n){n[n.FAIL=0]="FAIL",n[n.SHORTEST=1]="SHORTEST",n[n.LONGEST=2]="LONGEST"})(vI||(vI={}));/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fe(n,e){Array.isArray(n)||(n=[n]),n.forEach(t=>{t!=null&&L(t.dtype!=="complex64",()=>`${e} does not support complex64 tensors in the CPU backend.`)})}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const N7=cb;class Qg extends ww{nextDataId(){return Qg.nextDataId++}constructor(){super(),this.blockSize=48,this.firstUse=!0,this.data=new H2(this,qr())}write(e,t,s){this.firstUse&&(this.firstUse=!1,ae().get("IS_NODE")&&Us(`
============================
Hi, looks like you are running TensorFlow.js in Node.js. To speed things up dramatically, install our node backend, visit https://github.com/tensorflow/tfjs-node for more details. 
============================`));const r={id:this.nextDataId()};return this.data.set(r,{values:e,dtype:s,refCount:1}),r}makeTensorInfo(e,t,s){let r;if(t==="string"&&s!=null&&s.length>0&&th(s[0])){const o=s.map(i=>gi(i));r=this.write(o,e,t)}else r=this.write(s,e,t);return{dataId:r,shape:e,dtype:t}}refCount(e){return this.data.has(e)?this.data.get(e).refCount:0}incRef(e){const t=this.data.get(e);t.refCount++}decRef(e){if(this.data.has(e)){const t=this.data.get(e);t.refCount--}}move(e,t,s,r,o){this.data.set(e,{values:t,dtype:r,refCount:o})}numDataIds(){return this.data.numDataIds()}async read(e){return this.readSync(e)}readSync(e){const{dtype:t,complexTensorInfos:s}=this.data.get(e);if(t==="complex64"){const r=this.readSync(s.real.dataId),o=this.readSync(s.imag.dataId);return Oo(r,o)}return OV(this.data.get(e).values,t)}bufferSync(e){const t=this.readSync(e.dataId);if(e.dtype==="string")try{const s=t.map(r=>vi(r));return nt(e.shape,e.dtype,s)}catch{throw new Error("Failed to decode encoded string bytes into utf-8")}return nt(e.shape,e.dtype,t)}makeOutput(e,t,s){return qr().makeTensorFromTensorInfo(this.makeTensorInfo(t,s,e),this)}disposeData(e,t=!1){if(this.data.has(e)){if(this.data.get(e).refCount--,!t&&this.data.get(e).refCount>0)return!1;const{complexTensorInfos:s}=this.data.get(e);s!=null&&(this.disposeData(s.real.dataId,!0),this.disposeData(s.imag.dataId,!0)),this.data.delete(e)}return!0}disposeIntermediateTensorInfo(e){this.disposeData(e.dataId)}async time(e){const t=us();return e(),{kernelMs:us()-t}}memory(){return{unreliable:!0,reasons:["The reported memory is an upper bound. Due to automatic garbage collection, the true allocated memory may be less."]}}where(e){Fe([e],"where");const t=this.readSync(e.dataId);return N7(e.shape,t)}dispose(){}floatPrecision(){return 32}epsilon(){return super.epsilon()}}Qg.nextDataId=0;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function HO(n){const e=new Float32Array(n.length);for(let t=0;t<n.length;++t)e[t]=Math.abs(n[t]);return e}const I7=n=>{const{x:e}=n.inputs,t=n.backend;Fe(e,"abs");let s=new Float32Array(fe(e.shape));const r=t.data.get(e.dataId).values;return s=HO(r),t.makeOutput(s,e.shape,e.dtype)},$7={kernelName:dm,backendName:"cpu",kernelFunc:I7};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tn(n){return(e,t,s,r,o)=>{const i=Ze(e,t),a=i.length,l=Be(i),u=fe(i),h=Fn(o,u),p=e.length,f=t.length,m=Be(e),y=Be(t),x=Xl(e,i),v=Xl(t,i);if(x.length+v.length===0)for(let w=0;w<h.length;++w)h[w]=n(s[w%s.length],r[w%r.length]);else for(let w=0;w<h.length;++w){const S=uu(w,a,l),k=S.slice(-p);x.forEach(D=>k[D]=0);const T=eo(k,p,m),I=S.slice(-f);v.forEach(D=>I[D]=0);const E=eo(I,f,y);h[w]=n(s[T],r[E])}return[h,i]}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Is(n){const{inputs:e,backend:t}=n,{real:s,imag:r}=e,o=t.data.get(s.dataId).values,i=t.data.get(r.dataId).values,a=t.makeTensorInfo(s.shape,"complex64"),l=t.data.get(a.dataId);return l.complexTensorInfos={real:t.makeTensorInfo(s.shape,"float32",o),imag:t.makeTensorInfo(r.shape,"float32",i)},a}const E7={kernelName:Dw,backendName:"cpu",kernelFunc:Is};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Gf(n,e,t="float32"){if(t==="complex64"){const r=Gf(n,e,"float32"),o=Gf(n,e,"float32");return Is({inputs:{real:r,imag:o},backend:n})}const s=Kn(fe(e),t);return n.makeTensorInfo(e,t,s)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uo(n){const{inputs:e,backend:t}=n,{x:s}=e;return t.incRef(s.dataId),{dataId:s.dataId,shape:s.shape,dtype:s.dtype}}const R7={kernelName:Sh,backendName:"cpu",kernelFunc:uo};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _a(n){const{inputs:e,backend:t}=n,{input:s}=e,r=t.data.get(s.dataId).complexTensorInfos.real,o=t.data.get(r.dataId).values;return t.makeTensorInfo(r.shape,r.dtype,o)}const D7={kernelName:u1,backendName:"cpu",kernelFunc:_a};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function KO(n,e,t,s){if(s==="int32"){const r=Int32Array.from(n);return[e,"int32",r]}if(s==="bool"){const r=Va([0],t),[o,i]=tn((a,l)=>a!==l?1:0)(e,[],n,r,"bool");return[i,"bool",o]}throw new Error(`Error in Cast: failed to cast ${t} to ${s}`)}function $i(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{dtype:o}=s;if(o==="complex64"){if(r.dtype==="complex64")return uo({inputs:{x:r},backend:t});const h=Gf(t,r.shape,r.dtype),p=$i({inputs:{x:r},backend:t,attrs:{dtype:"float32"}}),f=Is({inputs:{real:p,imag:h},backend:t});return t.disposeIntermediateTensorInfo(h),t.disposeIntermediateTensorInfo(p),f}if(r.dtype==="complex64"){const h=_a({inputs:{input:r},backend:t}),p=$i({inputs:{x:h},backend:t,attrs:{dtype:o}});return t.disposeIntermediateTensorInfo(h),p}if(!q2(r.dtype,o)){const h=uo({inputs:{x:r},backend:t});return{dataId:h.dataId,shape:h.shape,dtype:o}}const i=t.data.get(r.dataId).values,[a,l,u]=KO(i,r.shape,r.dtype,o);return t.makeTensorInfo(a,l,u)}const A7={kernelName:uh,backendName:"cpu",kernelFunc:$i};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vn(n,e,t,s){return t==null?({inputs:r,backend:o})=>{const{a:i,b:a}=r,l=o;Fe([i,a],n);const u=l.data.get(i.dataId).values,h=l.data.get(a.dataId).values,p=i.dtype==="string"?_o(u):u,f=i.dtype==="string"?_o(h):h,m=s||i.dtype,[y,x]=e(i.shape,a.shape,p,f,m);return l.makeTensorInfo(x,m,y)}:({inputs:r,backend:o})=>{const{a:i,b:a}=r,l=o;if(i.dtype==="complex64"||a.dtype==="complex64"){const u=$i({inputs:{x:i},backend:l,attrs:{dtype:"complex64"}}),h=l.data.get(u.dataId),p=h.complexTensorInfos.real,f=h.complexTensorInfos.imag,m=l.data.get(p.dataId).values,y=l.data.get(f.dataId).values,x=$i({inputs:{x:a},backend:l,attrs:{dtype:"complex64"}}),v=l.data.get(x.dataId),w=v.complexTensorInfos.real,S=v.complexTensorInfos.imag,k=l.data.get(w.dataId).values,T=l.data.get(S.dataId).values,[I,E,D]=t(i.shape,a.shape,m,y,k,T),O=l.makeTensorInfo(D,"float32",I),_=l.makeTensorInfo(D,"float32",E),P=Is({inputs:{real:O,imag:_},backend:l});return l.disposeIntermediateTensorInfo(u),l.disposeIntermediateTensorInfo(x),l.disposeIntermediateTensorInfo(O),l.disposeIntermediateTensorInfo(_),P}else{const u=l.data.get(i.dataId).values,h=l.data.get(a.dataId).values,p=s||i.dtype,[f,m]=e(i.shape,a.shape,u,h,p);return l.makeTensorInfo(m,p,f)}}}function uS(n){return(e,t,s,r,o,i)=>{const a=Ze(e,t),l=fe(a),u=a.length,h=Be(a),p=Fn("float32",l),f=Fn("float32",l),m=Xl(e,a),y=Xl(t,a),x=Oo(s,r),v=Oo(o,i),w=e.length,S=Be(e),k=t.length,T=Be(t);if(m.length+y.length===0)for(let I=0;I<p.length;I++){const E=I%x.length,D=I%v.length,O=n(x[E*2],x[E*2+1],v[D*2],v[D*2+1]);p[I]=O.real,f[I]=O.imag}else for(let I=0;I<p.length;I++){const E=uu(I,u,h),D=E.slice(-w);m.forEach(W=>D[W]=0);const O=eo(D,w,S),_=E.slice(-k);y.forEach(W=>_[W]=0);const P=eo(_,k,T),R=n(x[O*2],x[O*2+1],v[P*2],v[P*2+1]);p[I]=R.real,f[I]=R.imag}return[p,f,a]}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qO=tn(((n,e)=>n+e)),O7=uS(((n,e,t,s)=>({real:n+t,imag:e+s}))),Jl=vn(cu,qO,O7),_7={kernelName:cu,backendName:"cpu",kernelFunc:Jl};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cS(n,e,t,s,r){const o=fe(s),i=Kn(r,t);for(let a=0;a<n.length;a++){const l=n[a];if(l<0)throw new Error("Input x must be non-negative!");l>=r||(o>0?i[l]+=e[a]:i[l]+=1)}return i}function XO(n,e,t,s=!1){const r=n.shape[0],o=n.shape[1],i=nt([r,t],e.dtype);for(let a=0;a<r;a++)for(let l=0;l<o;l++){const u=n.get(a,l);if(u<0)throw new Error("Input x must be non-negative!");u>=t||(s?i.set(1,a,u):e.size>0?i.set(i.get(a,u)+e.get(a,l),a,u):i.set(i.get(a,u)+1,a,u))}return i}/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const YO=tn(((n,e)=>n&e)),F7=vn(wm,YO),P7={kernelName:wm,backendName:"cpu",kernelFunc:F7};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function po(n){return(e,t,s)=>{const r=Qt(t,e.length);for(let o=0;o<e.length;++o)r[o]=n(e[o],s);return r}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wt(n,e,t){const s=po(e);return Ui(n,s,t)}function Ui(n,e,t){return({inputs:s,attrs:r,backend:o})=>{const{x:i}=s;Fe(i,n);const a=o,l=a.data.get(i.dataId).values;let u;if(i.dtype==="string"){if(!Array.isArray(l))throw new Error("String tensor's value was not an instance of Array");u=_o(l)}else u=l;const h=t||i.dtype,p=e(u,h,r);return a.makeTensorInfo(i.shape,h,p)}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const QO=po(n=>Math.ceil(n)),L7=Ui(ch,QO),M7={kernelName:ch,backendName:"cpu",kernelFunc:L7};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ZO(n,e,t,s){const r=Qt(t,fe(e));if(s&&t!=="string"){let o=0;n.forEach(i=>{const a=fe(i.shape);r.set(i.vals,o),o+=a})}else{let o=0;n.forEach(i=>{const a=t==="string"?_o(i.vals):i.vals;let l=0;for(let u=0;u<i.shape[0];++u){const h=u*e[1]+o;for(let p=0;p<i.shape[1];++p)r[h+p]=a[l++]}o+=i.shape[1]})}return r}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const JO=tn((n,e)=>n===e?1:0),e_=vn(Em,JO,null,"bool"),z7={kernelName:Em,backendName:"cpu",kernelFunc:e_};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const t_=po(n=>Math.exp(n)),n_=Ui(yh,t_,"float32"),V7={kernelName:yh,backendName:"cpu",kernelFunc:n_};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const s_=po(n=>Math.expm1(n)),B7=Ui(xh,s_),W7={kernelName:xh,backendName:"cpu",kernelFunc:B7};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const r_=po(n=>Math.floor(n)),U7=Ui(vh,r_),G7={kernelName:vh,backendName:"cpu",kernelFunc:U7};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const o_=tn((n,e)=>Math.floor(n/e)),j7=vn(wh,o_,null,"int32"),H7={kernelName:wh,backendName:"cpu",kernelFunc:j7};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function i_(n,e,t,s,r,o,i,a,l){const u=nt([s,o],t);for(let h=0;h<s;h++){const p=[];let f=0;for(let m=0;m<r;m++){const y=n[h*r+m];f+=y*i[m],p.push(y)}if(f<0||f>=l/o)throw new Error(`Invalid indices: ${p} does not index into ${a}`);for(let m=0;m<o;m++)u.values[h*o+m]=e.get(...e.indexToLoc(f*o+m))}return u}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function a_(n,e,t){const s=nt(t,n.dtype);for(let r=0;r<s.size;++r){const i=s.indexToLoc(r).slice(),a=i[0],l=i[2],u=e.locToIndex([a,l]);i[2]=e.values[u];const h=n.locToIndex(i);0<=h&&h<n.values.length&&(s.values[r]=n.values[h])}return s}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const l_=tn((n,e)=>n>e?1:0),K7=vn(Om,l_,null,"bool"),q7={kernelName:Om,backendName:"cpu",kernelFunc:K7};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const u_=tn((n,e)=>n>=e?1:0),X7=vn(bh,u_,null,"bool"),Y7={kernelName:bh,backendName:"cpu",kernelFunc:X7};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const c_=tn((n,e)=>n<e?1:0),Q7=vn(Fm,c_,null,"bool"),Z7={kernelName:Fm,backendName:"cpu",kernelFunc:Q7};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const h_=tn((n,e)=>n<=e?1:0),J7=vn(Pm,h_,null,"bool"),e9={kernelName:Pm,backendName:"cpu",kernelFunc:J7};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function d_(n,e,t){const s=(e-n)/(t-1),r=Kn(t,"float32");r[0]=n;for(let o=1;o<r.length;o++)r[o]=r[o-1]+s;return r}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const p_=po(n=>Math.log(n)),t9=Ui(Nh,p_),n9={kernelName:Nh,backendName:"cpu",kernelFunc:t9};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function f_(n,e,t,s){const r=Fn(s,fe(t));for(let o=0;o<r.length;++o){const i=o*e;let a=n[i];for(let l=0;l<e;++l){const u=n[i+l];(Number.isNaN(u)||u>a)&&(a=u)}r[o]=a}return r}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const m_=tn(((n,e)=>Math.max(n,e))),s9=vn($h,m_),r9={kernelName:$h,backendName:"cpu",kernelFunc:s9};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const g_=tn(((n,e)=>Math.min(n,e))),o9=vn(Eh,g_),i9={kernelName:Eh,backendName:"cpu",kernelFunc:o9};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hS=tn(((n,e)=>n*e)),a9=uS(((n,e,t,s)=>({real:n*t-e*s,imag:n*s+e*t}))),Zg=vn(Dh,hS,a9),l9={kernelName:Dh,backendName:"cpu",kernelFunc:Zg};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function y_(n,e,t){const s=_i(-1,t);return hS([],e,s,n,t)}function u9(n){const{inputs:e,backend:t}=n,{x:s}=e;Fe(s,"neg");const r=t.data.get(s.dataId).values,[o,i]=y_(r,s.shape,s.dtype);return t.makeTensorInfo(i,s.dtype,o)}const c9={kernelName:Km,backendName:"cpu",kernelFunc:u9};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const x_=tn(((n,e)=>n!==e?1:0)),h9=vn(qm,x_,null,"bool"),d9={kernelName:qm,backendName:"cpu",kernelFunc:h9};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dS(n,e,t,s,r){const o=e.length,i=fe(e),a=Be(e),l=Be(r),u=Fn(t,fe(r));for(let h=0;h<i;++h){const p=uu(h,o,a),f=new Array(p.length);for(let y=0;y<f.length;y++)f[y]=p[s[y]];const m=eo(f,o,l);u[m]=n[h]}return u}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ms(n){const{inputs:e,attrs:t,backend:s}=n,{x:r}=e,{perm:o}=t;Fe(r,"transpose");const i=r.shape.length,a=new Array(i);for(let p=0;p<a.length;p++)a[p]=r.shape[o[p]];const l=s.data.get(r.dataId).values,u=dS(l,r.shape,r.dtype,o,a);return{dataId:s.write(u,a,r.dtype),shape:a,dtype:r.dtype}}const p9={kernelName:Ll,backendName:"cpu",kernelFunc:ms};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function v_(n,e,t,s){const[r,o]=In(n,s),i=Ds(e,"int32"),a=Kn(fe(r),i),l=fe(o);for(let u=0;u<a.length;++u){const h=u*l;let p=1;for(let f=0;f<l;++f)p*=t[h+f];a[u]=p}return{outVals:a,outShape:r,outDtype:i}}function f9(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{axis:o,keepDims:i}=s;Fe(r,"prod");const a=r.shape.length,l=it(o,r.shape),u=zt(l,a);let h=l,p=r;const f=[];u!=null&&(p=ms({inputs:{x:r},backend:t,attrs:{perm:u}}),f.push(p),h=Jt(h.length,a));const m=t.data.get(p.dataId).values,{outVals:y,outShape:x,outDtype:v}=v_(p.shape,p.dtype,m,h);let w=x;return i&&(w=Zt(x,l)),f.forEach(S=>t.disposeIntermediateTensorInfo(S)),t.makeTensorInfo(w,v,y)}const m9={kernelName:eg,backendName:"cpu",kernelFunc:f9};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function g9(n,e,t){n.forEach((s,r)=>{if(s<0||s>=t){const o=uu(r,e.length,Be(e)).join(",");throw new Error(`indices[${o}] = ${s} is not in [0, ${t})`)}})}function y9(n,e){for(let t=0;t<n.length;++t){const s=n[t],r=t===n.length-1?e:n[t+1].length;if(s.length===0)throw new Error("Ragged splits may not be empty");if(s[0]<0)throw new Error("Ragged splits must be non-negative");if(s[s.length-1]>r)throw new Error("Ragged splits must not point past values");for(let o=1;o<s.length;++o)if(s[o-1]>s[o])throw new Error("Ragged splits must be sorted in ascending order")}}function x9(n,e,t,s){const r=[];let o=0;const i=e.length-1+t.length,a=new Array(i).fill(null).map(()=>[0]);y9(t,s);let l=1;for(let u=0;u<e.length-1;++u){l*=e[u];const h=e[u+1];for(let p=1;p<l+1;++p)a[u].push(p*h)}for(let u=0;u<n.length;++u){let h=n[u],p=n[u]+1;for(let f=0;f<t.length;++f){const m=t[f],y=f+e.length-1;if(y>=0){const x=a[y],v=x[x.length-1]-m[h];for(let w=h;w<p;++w)a[y].push(m[w+1]+v)}h=m[h],p=m[p]}p!==h&&(r.push([h,p]),o+=p-h)}return{outSplits:a,valueSlices:r,numValues:o}}function v9(n){const e=[];for(let t=0;t<n.length;++t){const s=n[t].length,r=Qt("int32",s);e.push(r),n[t].forEach((o,i)=>r[i]=o)}return e}function wI(n,e){const t=n.slice(0,e);for(;t.length<e;)t.push(1);for(let s=e;s<n.length;s++)t[e-1]*=n[s];return t}function w9(n,e,t,s,r,o){const i=wI(e,2)[1],a=wI(o,2)[1];let l=0;for(const u of t)for(let h=u[0];h<u[1];++h){for(let p=0;p<s;++p)r[l*a+p]=n[h*i+p];++l}}function b9(n,e,t,s,r){const o=e.slice();o[0]=r;const i=Qt(t,fe(o)),a=n.length,l=a===0?0:a/e[0];return w9(n,e,s,l,i,o),[i,o]}function w_(n,e,t,s,r,o,i,a){if(n.length===0)throw new Error("paramsNestedSplits must be non empty");if(e[0].length===0)throw new Error("Split tensors must not be scalars");const l=e[0][0]-1;if(g9(o,i,l),s.length===0)throw new Error("params.rank must be nonzero");const u=s[0],{outSplits:h,valueSlices:p,numValues:f}=x9(o,i,n,u),m=v9(h),y=b9(t,s,r,p,f);return[m,y[0],y[1]]}/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bI=2147483647;function b_(n,e,t,s,r,o,i){if(e.length>1)throw new Error("starts must be a scalar or vector");if(r.length>1)throw new Error("limits must be a scalar or vector");if(i.length>1)throw new Error("deltas must be a scalar or vector");const a=e.length===0,l=r.length===0,u=i.length===0,h=[];a||h.push(e[0]),l||h.push(r[0]),u||h.push(i[0]);for(let v=1;v<h.length;++v)if(h[v]!==h[v-1])throw new Error("starts, limits, and deltas must have the same shape");const p=h.length===0?1:h[0],f=Qt("int32",p+1);f[0]=0;for(let v=0;v<p;++v){const w=a?n[0]:n[v],S=l?s[0]:s[v],k=u?o[0]:o[v];if(k===0)throw new Error("Requires delta != 0");let T;if(k>0&&S<w||k<0&&S>w)T=0;else if(T=Math.ceil(Math.abs((S-w)/k)),T>bI)throw new Error(`Requires ((limit - start) / delta) <= ${bI}`);f[v+1]=f[v]+T}const m=f[p],y=Qt(t,m);let x=0;for(let v=0;v<p;++v){const w=f[v+1]-f[v];let S=a?n[0]:n[v];const k=u?o[0]:o[v];for(let T=0;T<w;++T)y[x++]=S,S+=k}return[f,y]}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var nr=Or;class jf{constructor(e,t,s,r,o,i,a,l,u,h){this.shape=e,this.shapeShape=t,this.values=s,this.valuesShape=r,this.valuesDType=o,this.defaultValue=i,this.defaultValueShape=a,this.rowPartitionValues=l,this.rowPartitionValuesShapes=u,this.rowPartitionTypes=sD(h),this.raggedRank=rD(this.rowPartitionTypes)}getRowPartitionTypeByDimension(e){return this.rowPartitionTypes[0]===nr.FIRST_DIM_SIZE?this.rowPartitionTypes[e+1]:this.rowPartitionTypes[e]}getRowPartitionTensor(e){return this.rowPartitionTypes[0]===nr.FIRST_DIM_SIZE?this.rowPartitionValues[e+1]:this.rowPartitionValues[e]}getMaxWidth(e){const t=this.getRowPartitionTensor(e-1);switch(this.getRowPartitionTypeByDimension(e-1)){case nr.VALUE_ROWIDS:return jf.getMaxWidthValueRowID(t);case nr.ROW_SPLITS:return jf.getMaxWidthRowSplit(t);default:throw new Error(`Cannot handle partition type ${nr[this.getRowPartitionTypeByDimension(e-1)]}`)}}static getMaxWidthRowSplit(e){const t=e.length;if(t===0||t===1)return 0;let s=0;for(let r=0;r<t-1;++r){const o=e[r+1]-e[r];o>s&&(s=o)}return s}static getMaxWidthValueRowID(e){const t=e.length;if(t===0)return 0;let s=0,r=e[0],o=0;for(let i=1;i<t;++i){const a=e[i];a!==r&&(r=a,o=Math.max(i-s,o),s=i)}return Math.max(t-s,o)}tensorShapeFromTensor(e,t,s=!0){if(t.length===0){if(e[0]===-1)return[];throw new Error("The only valid scalar shape tensor is the fully unknown shape specified as -1.")}return CI(e,s)}calculateOutputSize(e){const t=this.valuesShape,s=this.defaultValueShape;oD(s,t);const r=this.tensorShapeFromTensor(this.shape,this.shapeShape),i=nD(this.raggedRank,r,t);i[0]<0&&(i[0]=e);for(let a=1;a<=this.raggedRank;++a)i[a]<0&&(i[a]=this.getMaxWidth(a));return i}calculateFirstParentOutputIndex(e,t,s){const r=Math.min(e,s),o=[];let i=0;for(let a=0;a<r;++a,i+=t)o.push(i);for(let a=r;a<e;++a)o.push(-1);return L(o.length===e,()=>"Final length of result must be equal to firstDimension."),o}calculateOutputIndexRowSplit(e,t,s,r){const o=e.length,i=[];for(let a=0;a<o-1;++a){const l=e[a+1]-e[a];let u=Math.min(r,l),h=t[a];h===-1&&(u=0);for(let p=0;p<u;++p)i.push(h),h+=s;for(let p=0;p<l-u;++p)i.push(-1)}if(o>0&&i.length!==e[o-1])throw new Error("Invalid row split size.");return i}calculateOutputIndexValueRowID(e,t,s,r){const o=e.length,i=[];if(o===0)return[];let a=0,l=e[0];if(l>=t.length)throw new Error(`Got currentValueRowId=${l}, which is not less than ${t.length}`);let u=t[l];i.push(u);for(let h=1;h<o;++h){const p=e[h];if(p===l)u>=0&&(++a,a<r?u+=s:u=-1);else{if(a=0,l=p,p>=t.length)throw new Error(`Got nextValueRowId=${p} which is not less than ${t.length}`);u=t[p]}i.push(u)}if(i.length!==e.length)throw new Error("Invalid row ids.");return i}calculateOutputIndex(e,t,s,r){const o=this.getRowPartitionTensor(e),i=this.getRowPartitionTypeByDimension(e);switch(i){case nr.VALUE_ROWIDS:return this.calculateOutputIndexValueRowID(o,t,s,r);case nr.ROW_SPLITS:if(o.length-1>t.length)throw new Error(`Row partition size is greater than output size: ${o.length-1} > ${t.length}`);return this.calculateOutputIndexRowSplit(o,t,s,r);default:throw new Error(`Unsupported partition type: ${nr[i]}`)}}getFirstDimensionSize(){const e=this.rowPartitionValues[0];if(this.rowPartitionTypes.length===0)throw new Error("No row_partition_types given.");const t=this.rowPartitionTypes[0];switch(t){case nr.FIRST_DIM_SIZE:return e[0];case nr.VALUE_ROWIDS:throw new Error("Cannot handle VALUE_ROWIDS in first dimension.");case nr.ROW_SPLITS:return this.rowPartitionValuesShapes[0][0]-1;default:throw new Error(`Cannot handle type ${nr[t]}`)}}compute(){if(this.rowPartitionValues[0].length<=0)throw new Error("Invalid first partition input. Tensor requires at least one element.");const t=this.getFirstDimensionSize(),s=this.calculateOutputSize(t),r=new Array(this.raggedRank+1);r[r.length-1]=1;for(let l=r.length-2;l>=0;--l)r[l]=r[l+1]*s[l+1];const o=CI(s,!1),i=Qt(this.valuesDType,fe(o));if(r[0]*s[0]>0){let l=this.calculateFirstParentOutputIndex(t,r[0],s[0]);for(let u=1;u<=this.raggedRank;++u)l=this.calculateOutputIndex(u-1,l,r[u],s[u]);this.setOutput(this.raggedRank,l,i,o)}return[o,i]}setOutput(e,t,s,r){if(s.length===0)return;const o=this.values,i=s;let a=r.slice();a=a.slice(e+1);const l=fe(a),u=t.length;let h=this.defaultValue;if(h.length!==l&&h.length!==1){const y=this.defaultValueShape;ie(()=>{const x=X(h,y);h=Vl(x,a).dataSync()})}let p=0,f=0,m=0;for(let y=0;y<=u;++y){let x=y<u?t[y]:-1;if(x===m){++m;continue}if(f<m){const v=o.subarray(p*l),w=i.subarray(f*l),S=(m-f)*l;SI(w,v,S)}if(y>=u){const v=s.length;x=Math.floor(v/l)}if(x>m)if(this.defaultValue.length===1)i.subarray(m*l,x*l).fill(this.defaultValue[0]),m=x;else for(;x>m;){const v=i.slice(m*l);SI(v,h,l),++m}x<0?(p=y+1,f=m):(p=y,f=m,m=f+1)}}}function SI(n,e,t){for(let s=0;s<t;s++)n[s]=e[s]}function CI(n,e){const t=[];for(let s of n){if(s<0){if(!e)throw new Error(`Dimension ${s} must be >= 0`);if(s<-1)throw new Error(`Dimension ${s} must be >= -1`);s=-1}t.push(s)}return t}function S_(n,e,t,s,r,o,i,a,l,u){return new jf(n,e,t,s,r,o,i,a,l,u).compute()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function C_(n,e,t,s){const r=n===e,o=n<e&&t<0,i=e<n&&t>1;if(r||o||i)return Kn(0,s);const a=Math.abs(Math.ceil((e-n)/t)),l=Kn(a,s);e<n&&t===1&&(t=-1),l[0]=n;for(let u=1;u<l.length;u++)l[u]=l[u-1]+t;return l}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const k_=po(n=>1/Math.sqrt(n)),S9=Ui(Lh,k_),C9={kernelName:Lh,backendName:"cpu",kernelFunc:S9};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ga(n,e,t,s,r,o,i,a,l,u){const h=[s/r,r],p=n.values,f=e.values;if(s===0)return nt(t,e.dtype);const m=l instanceof mn?l:nt(h,e.dtype);typeof l=="string"||typeof l=="number"?m.values.fill(l):typeof l=="boolean"&&m.values.fill(+l);for(let y=0;y<o;y++){const x=[];let v=0;for(let w=0;w<i;w++){const S=p[y*i+w];x.push(S),v+=S*a[w]}if(v<0||v>=s/r)throw new Error(`Invalid indices: ${x} does not index into ${t}`);for(let w=0;w<r;w++)u?m.values[v*r+w]+=f[y*r+w]:m.values[v*r+w]=e.rank===0?f[0]:f[y*r+w]}return m}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const k9=po(n=>1/(1+Math.exp(-n))),T_=wt(Wh,n=>1/(1+Math.exp(-n))),T9={kernelName:Wh,backendName:"cpu",kernelFunc:T_};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function N_(n,e,t,s,r){const o=ZR(s,e,t),i=fe(t),a=Be(s);if(o){const p=JR(e,a);return r==="string"?n.slice(p,p+i):n.subarray(p,p+i)}const l=r==="string"?_o(n):n,u=nt(s,r,l),h=nt(t,r);for(let p=0;p<h.size;++p){const f=h.indexToLoc(p),m=f.map((y,x)=>y+e[x]);h.set(u.get(...m),...f)}return r==="string"?kD(h.values):h.values}function Fa(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{begin:o,size:i}=s;Fe(r,"slice");const[a,l]=bb(r,o,i);YR(r,a,l);const u=t.data.get(r.dataId).values,h=N_(u,a,l,r.shape,r.dtype);return t.makeTensorInfo(l,r.dtype,h)}const N9={kernelName:ig,backendName:"cpu",kernelFunc:Fa};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function I_(n,e,t,s,r,o,i){const a=e[0],l=o[0],u=new Array(l),h=new Array(a),p=e[1];if(l===0){if(a!==0)throw new Error(dD(a));const v=Qt(t,0),w=Qt(r,0);return[v,[0,p],w,u,h]}let f=!0,m=0;const y=new Array(l).fill(0);for(let v=0;v<a;++v){const w=n[v*p];if(w<0)throw new Error(pD(v,w));if(w>=l)throw new Error(fD(v,w,l));++y[w],f=f&&w>=m,m=w}let x=!0;for(let v=0;v<l;++v){const w=y[v]===0;u[v]=w,x=x&&!w,y[v]=Math.max(y[v],1),v>0&&(y[v]+=y[v-1])}if(x&&f){const v=n,w=s;for(let S=0;S<a;++S)h[S]=S;return[v,[a,p],w,u,h]}else{const v=y[l-1],w=Qt(t,v*p),S=Qt(r,v),k=new Array(l).fill(0);for(let T=0;T<a;++T){const I=n[T*p],E=k[I],D=(I===0?0:y[I-1])+E;k[I]++;for(let O=0;O<p;++O)w[D*p+O]=n[T*p+O];S[D]=s[T],h[T]=D}for(let T=0;T<l;++T)if(k[T]===0){const E=T===0?0:y[T-1];w[E*p+0]=T;for(let D=1;D<p;++D)w[E*p+D]=0;S[E]=i}return[w,[v,p],S,u,h]}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $_(n,e,t,s,r){const o=fe(s),i=e[0],a=r.length,l=[];let u=1,h=-1;for(let v=0;v<a;++v){const w=r[v];if(w===-1){if(h!==-1)throw new Error(mD(h,v));h=v,l.push(1)}else{if(w<0)throw new Error(gD(v,w));u*=w,l.push(w)}}if(h!==-1){if(u<=0)throw new Error(yD());const v=Math.trunc(o/u);if(u*v!==o)throw new Error(xD(s,l));l[h]=v}if(fe(l)!==o)throw new Error(vD(s,l));const f=s.length,m=[];if(f>0){m[f-1]=1;for(let v=f-2;v>=0;--v)m[v]=m[v+1]*s[v+1]}const y=[];if(a>0){y[a-1]=1;for(let v=a-2;v>=0;--v)y[v]=y[v+1]*l[v+1]}const x=Qt(t,i*a);for(let v=0;v<i;++v){let w=0;for(let S=0;S<f;++S)w+=n[v*f+S]*m[S];for(let S=0;S<a;++S)x[v*a+S]=Math.trunc(w/y[S]),w%=y[S]}return[x,[i,a],l]}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pS(n,e,t,s,r,o=!1,i=0){const a=s.length,l=[e[0],n.length/e[0]],u=l[1],p=a>0?r[a-1]+1:0;if(p<0)throw new Error(yv());const f=e.slice();f[0]=p;const m=f.reduce((k,T)=>k*T,1),y=Qt(t,m);if(a===0)return p>0&&y.fill(i),[y,f];if(p<=0)throw new Error(yv());let x=0,v=1,w=0,S=r[x];for(;;){let k=0;if(v<a){if(k=r[v],S===k){++v;continue}if(S>=k)throw new Error(wD())}if(S<0||S>=p)throw new Error(bD(S,p));S>w&&y.fill(i,w*u,S*u);for(let T=x;T<v;++T){const I=s[T];if(I<0||I>=l[0])throw new Error(SD(T,s[T],l[0]));for(let E=0;E<u;E++)y[S*u+E]+=n[I*u+E]}if(o)for(let T=0;T<u;T++)y[S*u+T]/=v-x;if(x=v,++v,w=S+1,S=k,v>a)break}return w<p&&y.fill(i,w*u,p*u),[y,f]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const I9=po(n=>Math.sqrt(n)),$9=wt(Gh,n=>Math.sqrt(n)),E9={kernelName:Gh,backendName:"cpu",kernelFunc:$9};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const E_=tn(((n,e)=>{const t=n-e;return t*t})),R9=vn(jh,E_),D9={kernelName:jh,backendName:"cpu",kernelFunc:R9};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const R_=po((n,e)=>{const{pattern:t,replaceGlobal:s,rewrite:r}=e;return n.replace(new RegExp(t,s?"g":""),r)}),A9=Ui(hg,R_),O9={kernelName:hg,backendName:"cpu",kernelFunc:A9};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function D_(n,e,t,s){const r=nt(n,e.dtype);for(let o=0;o<r.size;o++){const i=r.indexToLoc(o),a=new Array(i.length);for(let l=0;l<a.length;l++)a[l]=i[l]*t[l]+s[l];r.set(e.get(...a),...i)}return r}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class _9{constructor(e,t,s,r,o,i){this.separator=gi(e),this.nGramWidths=t,this.leftPad=gi(s),this.rightPad=gi(r),this.padWidth=o,this.preserveShort=i}getPadWidth(e){return Math.min(this.padWidth<0?e-1:this.padWidth,e-1)}getNumNGrams(e,t){const s=this.getPadWidth(t);return Math.max(0,e+2*s-t+1)}createNGrams(e,t,s,r,o,i){for(let a=0;a<o;++a){const l=this.getPadWidth(i),u=Math.max(0,l-a),h=Math.max(0,l-(o-(a+1))),p=i-(u+h),f=t+(u>0?0:a-l);let m=0;m+=u*this.leftPad.length;for(let S=0;S<p;++S)m+=e[f+S].length;m+=h*this.rightPad.length;const y=u+h+p-1;m+=y*this.separator.length,s[r+a]=new Uint8Array(m);const x=s[r+a];let v=0;const w=S=>S.forEach(k=>x[v++]=k);for(let S=0;S<u;++S)w(this.leftPad),w(this.separator);for(let S=0;S<p-1;++S)w(e[f+S]),w(this.separator);if(p>0){w(e[f+p-1]);for(let S=0;S<h;++S)w(this.separator),w(this.rightPad)}else{for(let S=0;S<h-1;++S)w(this.rightPad),w(this.separator);w(this.rightPad)}}}compute(e,t){const s=e.length,r=t.length;if(r>0){let l=t[0];if(l!==0)throw new Error(`First split value must be 0, got ${l}`);for(let u=1;u<r;++u){let h=t[u]>=l;if(h=h&&t[u]<=s,!h)throw new Error(`Invalid split value ${t[u]}, must be in [${l}, ${s}]`);l=t[u]}if(l!==s)throw new Error(`Last split value must be data size. Expected ${s}, got ${l}`)}const o=r-1,i=Qt("int32",r);if(s===0||r===0){const l=new Array(s);for(let u=0;u<=o;++u)i[u]=0;return[l,i]}i[0]=0;for(let l=1;l<=o;++l){const u=t[l]-t[l-1];let h=0;this.nGramWidths.forEach(p=>{h+=this.getNumNGrams(u,p)}),this.preserveShort&&u>0&&h===0&&(h=1),i[l]=i[l-1]+h}const a=new Array(i[o]);for(let l=0;l<o;++l){const u=t[l];let h=i[l];if(this.nGramWidths.forEach(p=>{const f=t[l+1]-t[l],m=this.getNumNGrams(f,p);this.createNGrams(e,u,a,h,m,p),h+=m}),this.preserveShort&&h===i[l]){const p=t[l+1]-t[l];if(p===0)continue;const f=p+2*this.padWidth;this.createNGrams(e,u,a,h,1,f)}}return[a,i]}}function A_(n,e,t,s,r,o,i,a){return new _9(t,s,r,o,i,a).compute(n,e)}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function F9(n,e,t,s){if(!n.length)return;if(e.length===0){for(let o=0;o<n.length;++o)s.push(n.subarray(o,o+1));return}if(e.length===1){const o=e[0];let i=n.indexOf(o);for(;i!==-1;){const a=n.subarray(0,i);(!t||a.length!==0)&&s.push(a),n=n.subarray(i+1),i=n.indexOf(o)}(!t||n.length!==0)&&s.push(n);return}let r=0;for(let o=0;o<n.length+1;o++)if(o===n.length||e.indexOf(n[o])!==-1){const i=n.subarray(r,o);(!t||i.length!==0)&&s.push(i),r=o+1}}function O_(n,e,t){const s=n.length,r=[];let o=0,i=0;const a=new Array(s);for(let f=0;f<s;++f){const m=r.length;F9(n[f],e,t,r);const y=r.length-m;a[f]=y,o+=y,i=Math.max(i,y)}const l=Qt("int32",o*2),u=new Array(o),h=[s,i];let p=0;for(let f=0;f<s;++f)for(let m=0;m<a[f];++m)l[p*2]=f,l[p*2+1]=m,u[p]=r[p],++p;return[l,u,h]}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function __(n,e){const t=Qt("int32",n.length);for(let s=0;s<n.length;++s)t[s]=YV(n[s]).modulo(e).getLowBitsUnsigned();return t}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const F_=tn(((n,e)=>n-e)),P9=uS(((n,e,t,s)=>({real:n-t,imag:e-s}))),fS=vn(Hh,F_,P9),L9={kernelName:Hh,backendName:"cpu",kernelFunc:fS};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function P_(n,e){const t=new Array(n.rank);for(let r=0;r<t.length;r++)t[r]=n.shape[r]*e[r];const s=nt(t,n.dtype);for(let r=0;r<s.values.length;++r){const o=s.indexToLoc(r),i=new Array(n.rank);for(let l=0;l<i.length;l++)i[l]=o[l]%n.shape[l];const a=n.locToIndex(i);s.values[r]=n.values[a]}return s}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bc=(n,e)=>{const t=e.value-n.value;return t===0?n.index-e.index:t};function L_(n,e,t=0,s=n.length-1){for(;s>t;){if(s-t>600){const a=s-t+1,l=e-t+1,u=Math.log(a),h=.5*Math.exp(2*u/3),p=.5*Math.sqrt(u*h*(a-h)/a)*Math.sign(l-a/2),f=Math.max(t,Math.floor(e-l*h/a+p)),m=Math.min(s,Math.floor(e+(a-l)*h/a+p));L_(n,e,f,m)}const r=n[e];let o=t,i=s;for(Nl(n,t,e),bc(n[s],r)>0&&Nl(n,t,s);o<i;){for(Nl(n,o,i),o++,i--;bc(n[o],r)<0;)o=o+1;for(;bc(n[i],r)>0;)i=i-1}bc(n[t],r)===0?Nl(n,t,i):(i=i+1,Nl(n,i,s)),i<=e&&(t=i+1),e<=i&&(s=i-1)}}function M_(n,e,t,s,r){const o=e[e.length-1],[i,a]=[n.length/o,o],l=Fn(t,i*s),u=Fn("int32",i*s);for(let p=0;p<i;p++){const f=p*a,m=n.subarray(f,f+a);let y=new Array(m.length);m.forEach((S,k)=>y[k]={value:S,index:k}),s<y.length&&(L_(y,s),y=y.slice(0,s)),r&&y.sort(bc);const x=p*s,v=l.subarray(x,x+s),w=u.subarray(x,x+s);for(let S=0;S<s;S++)v[S]=y[S].value,w[S]=y[S].index}const h=e.slice();return h[h.length-1]=s,[nt(h,t,l),nt(h,"int32",u)]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function z_(n,e,t,s){const r=it(e,t)[0],o=[1,t[0],1];for(let y=0;y<r;y++)o[0]*=t[y];o[1]=t[r];for(let y=r+1;y<t.length;y++)o[2]*=t[y];const i=new Map,a=new Int32Array(t[r]),l=new mn(o,s,n),u=[],h=o[0]===1&&o[2]===1;for(let y=0;y<t[r];y++){let x;if(h)x=n[y].toString();else{const w=[];for(let S=0;S<o[0];S++)for(let k=0;k<o[2];k++)w.push(l.get(S,y,k));x=w.join(",")}const v=i.get(x);if(v!=null)a[y]=v;else{const w=i.size;i.set(x,w),a[y]=w,u.push(y)}}const p=o.slice();p[1]=i.size;const f=new mn(p,s);u.forEach((y,x)=>{for(let v=0;v<o[0];v++)for(let w=0;w<o[2];w++)f.set(l.get(v,y,w),v,x,w)});const m=t.slice();return m[r]=p[1],{outputValues:f.values,outputShape:m,indices:a}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const M9=Object.freeze(Object.defineProperty({__proto__:null,addImpl:qO,bincountImpl:cS,bincountReduceImpl:XO,bitwiseAndImpl:YO,castImpl:KO,ceilImpl:QO,concatImpl:ZO,equalImpl:JO,expImpl:t_,expm1Impl:s_,floorDivImpl:o_,floorImpl:r_,gatherNdImpl:i_,gatherV2Impl:a_,greaterEqualImpl:u_,greaterImpl:l_,lessEqualImpl:h_,lessImpl:c_,linSpaceImpl:d_,logImpl:p_,maxImpl:f_,maximumImpl:m_,minimumImpl:g_,multiplyImpl:hS,negImpl:y_,notEqualImpl:x_,prodImpl:v_,raggedGatherImpl:w_,raggedRangeImpl:b_,raggedTensorToTensorImpl:S_,rangeImpl:C_,rsqrtImpl:k_,scatterImpl:ga,sigmoidImpl:k9,simpleAbsImpl:HO,sliceImpl:N_,sparseFillEmptyRowsImpl:I_,sparseReshapeImpl:$_,sparseSegmentReductionImpl:pS,sqrtImpl:I9,squaredDifferenceImpl:E_,staticRegexReplaceImpl:R_,stridedSliceImpl:D_,stringNGramsImpl:A_,stringSplitImpl:O_,stringToHashBucketFastImpl:__,subImpl:F_,tileImpl:P_,topKImpl:M_,transposeImpl:dS,uniqueImpl:z_},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */gE("cpu",()=>new Qg,1);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const V_=wt(mh,n=>n>=0?n:Math.exp(n)-1),z9={kernelName:mh,backendName:"cpu",kernelFunc:V_};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function B_(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{alpha:o}=s;Fe([r],"leakyRelu");const i=fe(r.shape),a=t.data.get(r.dataId).values,l=Fn("float32",i);for(let u=0;u<a.length;u++)l[u]=a[u]<0?o*a[u]:a[u];return t.makeTensorInfo(r.shape,"float32",l)}const V9={kernelName:_m,backendName:"cpu",kernelFunc:B_};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const B9=tn((n,e)=>n<0?e*n:n);function W_(n){const{inputs:e,backend:t}=n,{x:s,alpha:r}=e;Fe([s,r],"prelu");const o=t.data.get(s.dataId).values,i=t.data.get(r.dataId).values,[a,l]=B9(s.shape,r.shape,o,i,"float32");return t.makeTensorInfo(l,"float32",a)}const W9={kernelName:Jm,backendName:"cpu",kernelFunc:W_};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const U_=wt(_h,n=>Math.max(0,n)),U9={kernelName:_h,backendName:"cpu",kernelFunc:U_};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const G_=wt(Fh,n=>Math.min(Math.max(0,n),6)),G9={kernelName:Fh,backendName:"cpu",kernelFunc:G_};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hf(n,e,t,s,r){if(t==="linear")return uo({inputs:{x:e},backend:n});if(t==="relu")return U_({inputs:{x:e},backend:n});if(t==="elu")return V_({inputs:{x:e},backend:n});if(t==="relu6")return G_({inputs:{x:e},backend:n});if(t==="prelu")return W_({inputs:{x:e,alpha:s},backend:n});if(t==="leakyrelu")return B_({inputs:{x:e},backend:n,attrs:{alpha:r}});if(t==="sigmoid")return T_({inputs:{x:e},backend:n});throw new Error(`Activation ${t} has not been implemented for the CPU backend.`)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Nt(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{shape:o}=s,i=fe(r.shape),a=K2(o,i),l=fe(a);L(i===l,()=>`The new shape (${a}) has ${l} elements and the old shape (${r.shape}) has ${i} elements. The new shape and old shape must have the same number of elements.`),t.incRef(r.dataId);const u=t.data.get(r.dataId);if(u.complexTensorInfos!=null){const h=u.complexTensorInfos.real,p=u.complexTensorInfos.imag;h.shape=a,p.shape=a}return{dataId:r.dataId,shape:a,dtype:r.dtype}}const j9={kernelName:tg,backendName:"cpu",kernelFunc:Nt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function j_(n){const{inputs:e,backend:t,attrs:s}=n,{a:r,b:o}=e,{transposeA:i,transposeB:a}=s;Fe([r,o],"matMul");const l=r.shape.length,u=o.shape.length,h=i?r.shape[l-2]:r.shape[l-1],p=a?o.shape[u-1]:o.shape[u-2],f=i?r.shape[l-1]:r.shape[l-2],m=a?o.shape[u-2]:o.shape[u-1],y=r.shape.slice(0,-2),x=o.shape.slice(0,-2),v=fe(y),w=fe(x),k=Ze(r.shape.slice(0,-2),o.shape.slice(0,-2)).concat([f,m]);L(h===p,()=>`Error in matMul: inner shapes (${h}) and (${p}) of Tensors with shapes ${r.shape} and ${o.shape} and transposeA=${i} and transposeB=${a} must match.`);const T=i?[v,h,f]:[v,f,h],I=a?[w,m,p]:[w,p,m],E=Nt({inputs:{x:r},backend:t,attrs:{shape:T}}),D=Nt({inputs:{x:o},backend:t,attrs:{shape:I}}),O=i?E.shape[1]:E.shape[2],_=i?E.shape[2]:E.shape[1],P=a?D.shape[1]:D.shape[2],R=Math.max(v,w),W=t.data.get(E.dataId).values,Q=t.data.get(D.dataId).values,ee=Be(E.shape),te=Be(D.shape),[oe,se,G]=i?[ee[0],1,ee[1]]:[ee[0],ee[1],1],[V,B,F]=a?[1,te[1],te[0]]:[te[1],1,te[0]],z=_*P,q=nt([R,_,P],E.dtype),re=q.values,ue=t.blockSize;for(let pe=0;pe<R;pe++){const he=pe%v,xe=pe%w;for(let ge=0;ge<_;ge+=ue){const Ie=Math.min(ge+ue,_);for(let Re=0;Re<P;Re+=ue){const Ue=Math.min(Re+ue,P);for(let qe=0;qe<O;qe+=ue){const Qe=Math.min(qe+ue,O);for(let Je=ge;Je<Ie;Je++)for(let Ke=Re;Ke<Ue;Ke++){let st=0;for(let rt=qe;rt<Qe;rt++){const nn=W[he*oe+Je*se+rt*G],mt=Q[rt*V+Ke*B+xe*F];st+=nn*mt}re[pe*z+(Je*P+Ke)]+=st}}}}}return t.disposeIntermediateTensorInfo(E),t.disposeIntermediateTensorInfo(D),t.makeTensorInfo(k,q.dtype,q.values)}const H9={kernelName:xm,backendName:"cpu",kernelFunc:j_};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function K9(n){const{inputs:e,backend:t,attrs:s}=n,{a:r,b:o,bias:i,preluActivationWeights:a}=e,{transposeA:l,transposeB:u,activation:h,leakyreluAlpha:p}=s;let f,m,y;const x=[];f=j_({inputs:{a:r,b:o},attrs:{transposeA:l,transposeB:u},backend:t}),i&&(m=Jl({inputs:{a:f,b:i},backend:t}),x.push(f),f=m),h&&(y=Hf(t,f,h,a,p),x.push(f),f=y);for(const w of x)t.disposeIntermediateTensorInfo(w);return f}const q9={kernelName:Tf,backendName:"cpu",kernelFunc:K9};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const X9=wt(nh,n=>Math.acos(n)),Y9={kernelName:nh,backendName:"cpu",kernelFunc:X9};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Q9=wt(sh,n=>Math.acosh(n)),Z9={kernelName:sh,backendName:"cpu",kernelFunc:Q9};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function J9(n){const{inputs:e,backend:t}=n,s=e;Fe(e,"addN");const r=s.map(a=>t.data.get(a.dataId).values),o=nt(s[0].shape,s[0].dtype),i=o.values;for(let a=0;a<s.length;a++){const l=r[a];for(let u=0;u<i.length;u++)i[u]+=l[u]}return t.makeTensorInfo(o.shape,o.dtype,o.values)}const eY={kernelName:pm,backendName:"cpu",kernelFunc:J9};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tY(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{axis:o,keepDims:i}=s;Fe(r,"all");const a=it(o,r.shape);let l=a;const u=zt(l,r.shape.length);let h=r;u!=null&&(h=ms({inputs:{x:r},backend:t,attrs:{perm:u}}),l=Jt(l.length,r.shape.length)),Mn("all",l,h.shape.length);const[p,f]=In(h.shape,l),m=fe(f),y=Kn(fe(p),h.dtype),x=t.data.get(h.dataId).values;for(let w=0;w<y.length;++w){const S=w*m;let k=x[S];for(let T=0;T<m;++T){const I=x[S+T];k=k&&I}y[w]=k}u!=null&&t.disposeIntermediateTensorInfo(h);const v=t.makeTensorInfo(p,h.dtype,y);if(i){const w=Zt(p,a),S=Nt({inputs:{x:v},backend:t,attrs:{shape:w}});return t.disposeIntermediateTensorInfo(v),S}return v}const nY={kernelName:Tw,backendName:"cpu",kernelFunc:tY};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sY(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{axis:o,keepDims:i}=s;Fe(r,"any");const a=it(o,r.shape);let l=a;const u=zt(l,r.shape.length);let h=r;u!=null&&(h=ms({inputs:{x:r},backend:t,attrs:{perm:u}}),l=Jt(l.length,r.shape.length)),Mn("any",l,h.shape.length);const[p,f]=In(h.shape,l),m=fe(f),y=Kn(fe(p),h.dtype),x=t.data.get(h.dataId).values;for(let w=0;w<y.length;++w){const S=w*m;let k=x[S];for(let T=0;T<m;++T){const I=x[S+T];k=k||I}y[w]=k}u!=null&&t.disposeIntermediateTensorInfo(h);const v=t.makeTensorInfo(p,h.dtype,y);if(i){const w=Zt(p,a),S=Nt({inputs:{x:v},backend:t,attrs:{shape:w}});return t.disposeIntermediateTensorInfo(v),S}return v}const rY={kernelName:Nw,backendName:"cpu",kernelFunc:sY};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oY(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{axis:o}=s;Fe(r,"argMax");let i=it(o,r.shape);const a=zt(i,r.shape.length);let l=r;const u=[];a!=null&&(l=ms({inputs:{x:r},backend:t,attrs:{perm:a}}),u.push(l),i=Jt(i.length,l.shape.length)),i=[i[0]],Mn("argMax",i,l.shape.length);const[h,p]=In(l.shape,i),f=fe(h),m=Kn(f,"int32"),y=fe(p),x=t.data.get(l.dataId).values;for(let v=0;v<m.length;++v){const w=v*y;let S=x[w],k=0;for(let T=0;T<y;++T){const I=x[w+T];I>S&&(S=I,k=T)}m[v]=k}return u.forEach(v=>t.disposeIntermediateTensorInfo(v)),t.makeTensorInfo(h,"int32",m)}const iY={kernelName:fm,backendName:"cpu",kernelFunc:oY};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aY(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{axis:o}=s;Fe(r,"argMin");let i=it(o,r.shape);const a=zt(i,r.shape.length);let l=r;const u=[];a!=null&&(l=ms({inputs:{x:r},backend:t,attrs:{perm:a}}),u.push(l),i=Jt(i.length,l.shape.length)),i=[i[0]],Mn("argMin",i,l.shape.length);const[h,p]=In(l.shape,i),f=fe(h),m=Kn(f,"int32"),y=fe(p),x=t.data.get(l.dataId).values;for(let v=0;v<m.length;++v){const w=v*y;let S=x[w],k=0;for(let T=0;T<y;++T){const I=x[w+T];I<S&&(S=I,k=T)}m[v]=k}return u.forEach(v=>t.disposeIntermediateTensorInfo(v)),t.makeTensorInfo(h,"int32",m)}const lY={kernelName:mm,backendName:"cpu",kernelFunc:aY};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const uY=wt(rh,n=>Math.asin(n)),cY={kernelName:rh,backendName:"cpu",kernelFunc:uY};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hY=wt(oh,n=>Math.asinh(n)),dY={kernelName:oh,backendName:"cpu",kernelFunc:hY};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pY=wt(ih,n=>Math.atan(n)),fY={kernelName:ih,backendName:"cpu",kernelFunc:pY};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mY=tn((n,e)=>Math.atan2(n,e)),gY=vn(lh,mY),yY={kernelName:lh,backendName:"cpu",kernelFunc:gY};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xY=wt(ah,n=>Math.atanh(n)),vY={kernelName:ah,backendName:"cpu",kernelFunc:xY};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mS(n,e,t,s,r,o){const i=r.strideHeight,a=r.strideWidth,l=r.dilationHeight,u=r.dilationWidth,h=r.effectiveFilterHeight,p=r.effectiveFilterWidth,f=r.padInfo.top,m=r.padInfo.left,y=o==="max"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,x=nt(r.outShape,t),v=x.values,w=r.outShape[1]*r.outShape[2]*r.outShape[3],S=r.outShape[2]*r.outShape[3],k=r.outShape[3];for(let T=0;T<r.batchSize;++T){const I=T*w,E=T*s[0];for(let D=0;D<r.inChannels;++D)for(let O=0;O<r.outHeight;++O){const _=O*i-f,P=Math.max(0,_),R=Math.min(r.inHeight,h+_),W=I+O*S;for(let Q=0;Q<r.outWidth;++Q){const ee=Q*a-m,te=Math.max(0,ee),oe=Math.min(r.inWidth,p+ee);let se=y,G=0,V=0;for(let F=P;F<R;F+=l){const z=E+F*s[1];for(let q=te;q<oe;q+=u){const re=z+q*s[2],ue=n[re+D];o==="max"&&ue>se?se=ue:o==="avg"&&(G+=ue,V++)}if(isNaN(se))break}const B=W+Q*k+D;v[B]=o==="avg"?G/V:se}}}return x}function H_(n,e,t,s,r=!1,o=!1){const i=nt(s.outShape,"int32"),a=s.strideHeight,l=s.strideWidth,u=s.dilationHeight,h=s.dilationWidth,p=s.effectiveFilterHeight,f=s.effectiveFilterWidth,m=s.padInfo.top,y=s.padInfo.left,x=nt(e,t,n);for(let v=0;v<s.batchSize;++v)for(let w=0;w<s.inChannels;++w)for(let S=0;S<s.outHeight;++S){const k=S*a-m;let T=k;for(;T<0;)T+=u;const I=Math.min(s.inHeight,p+k);for(let E=0;E<s.outWidth;++E){const D=E*l-y;let O=D;for(;O<0;)O+=h;const _=Math.min(s.inWidth,f+D);let P=Number.NEGATIVE_INFINITY,R=-1;for(let W=T;W<I;W+=u){const Q=W-k;for(let ee=O;ee<_;ee+=h){const te=ee-D,oe=x.get(v,W,ee,w);oe>P&&(P=oe,r?R=o?((v*s.inHeight+W)*s.inWidth+ee)*s.inChannels+w:(W*s.inWidth+ee)*s.inChannels+w:R=Q*f+te)}}i.set(R,v,S,E,w)}}return i}function K_(n,e,t,s,r,o){const i=r.strideDepth,a=r.strideHeight,l=r.strideWidth,u=r.dilationDepth,h=r.dilationHeight,p=r.dilationWidth,f=r.effectiveFilterDepth,m=r.effectiveFilterHeight,y=r.effectiveFilterWidth,x=r.padInfo.front,v=r.padInfo.top,w=r.padInfo.left,S=o==="max"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,k=nt(r.outShape,t),T=k.values,I=r.outShape[1]*r.outShape[2]*r.outShape[3]*r.outShape[4],E=r.outShape[2]*r.outShape[3]*r.outShape[4],D=r.outShape[3]*r.outShape[4],O=r.outShape[4];for(let _=0;_<r.batchSize;++_){const P=_*I,R=_*s[0];for(let W=0;W<r.inChannels;++W)for(let Q=0;Q<r.outDepth;++Q){const ee=Q*i-x;let te=ee;for(;te<0;)te+=u;const oe=Math.min(r.inDepth,f+ee),se=P+Q*E;for(let G=0;G<r.outHeight;++G){const V=G*a-v;let B=V;for(;B<0;)B+=h;const F=Math.min(r.inHeight,m+V),z=se+G*D;for(let q=0;q<r.outWidth;++q){const re=q*l-w;let ue=re;for(;ue<0;)ue+=p;const pe=Math.min(r.inWidth,y+re),he=z+q*O;let xe=S,ge=0,Ie=0;for(let Ue=te;Ue<oe;Ue+=u){const qe=R+Ue*s[1];for(let Qe=B;Qe<F;Qe+=h){const Je=qe+Qe*s[2];for(let Ke=ue;Ke<pe;Ke+=p){const st=Je+Ke*s[3],rt=n[st+W];if(o==="max"&&rt>xe?xe=rt:o==="avg"&&(ge+=rt,Ie++),isNaN(xe))break}if(isNaN(xe))break}if(isNaN(xe))break}const Re=he+W;T[Re]=o==="avg"?ge/Math.max(Ie,1):xe}}}}return k}function wY(n,e){const t=nt(e.outShape,"int32"),s=e.strideDepth,r=e.strideHeight,o=e.strideWidth,i=e.dilationDepth,a=e.dilationHeight,l=e.dilationWidth,u=e.effectiveFilterDepth,h=e.effectiveFilterHeight,p=e.effectiveFilterWidth,f=e.padInfo.front,m=e.padInfo.top,y=e.padInfo.left;for(let x=0;x<e.batchSize;++x)for(let v=0;v<e.inChannels;++v)for(let w=0;w<e.outDepth;++w){const S=w*s-f;let k=S;for(;k<0;)k+=i;const T=Math.min(e.inDepth,u+S);for(let I=0;I<e.outHeight;++I){const E=I*r-m;let D=E;for(;D<0;)D+=a;const O=Math.min(e.inHeight,h+E);for(let _=0;_<e.outWidth;++_){const P=_*o-y;let R=P;for(;R<0;)R+=l;const W=Math.min(e.inWidth,p+P);let Q=Number.NEGATIVE_INFINITY,ee=-1;for(let te=k;te<T;te+=i){const oe=te-S;for(let se=D;se<O;se+=a){const G=se-E;for(let V=R;V<W;V+=l){const B=V-P,F=n.get(x,te,se,V,v);F>=Q&&(Q=F,ee=oe*h*p+G*h+B)}}}t.set(ee,x,w,I,_,v)}}}return t}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bY(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e;Fe(r,"avgPool");const{filterSize:o,strides:i,pad:a,dimRoundingMode:l}=s,u=1;L(Ln(i,u),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${i} and dilations '${u}'`);const h=yr(r.shape,o,i,u,a,l);let p;if(h.filterWidth===1&&h.filterHeight===1&&ct(h.inShape,h.outShape))p=uo({inputs:{x:r},backend:t});else{const f=t.data.get(r.dataId).values,m=Be(r.shape),y=mS(f,r.shape,r.dtype,m,h,"avg");p=t.makeTensorInfo(h.outShape,r.dtype,y.values)}return p}const SY={kernelName:gm,backendName:"cpu",kernelFunc:bY};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function CY(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{filterSize:o,strides:i,pad:a,dimRoundingMode:l,dataFormat:u}=s;Fe(r,"avgPool3d");const h=Lo(r.shape,o,i,1,a,l,u),p=t.data.get(r.dataId).values,f=K_(p,r.shape,r.dtype,Be(r.shape),h,"avg");return t.makeTensorInfo(f.shape,"float32",f.values)}const kY={kernelName:ym,backendName:"cpu",kernelFunc:CY};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function TY(n){const{inputs:e,backend:t,attrs:s}=n,{dy:r,input:o}=e,{filterSize:i,strides:a,pad:l,dimRoundingMode:u}=s;Fe([r,o],"avgPool3DGrad");const h=Lo(o.shape,i,a,1,l,u),p=h.strideDepth,f=h.strideHeight,m=h.strideWidth,y=h.filterDepth,x=h.filterHeight,v=h.filterWidth,w=h.dilationDepth,S=h.dilationHeight,k=h.dilationWidth,T=h.effectiveFilterDepth,I=h.effectiveFilterHeight,E=h.effectiveFilterWidth,D=T-1-h.padInfo.front,O=E-1-h.padInfo.left,_=I-1-h.padInfo.top,P=nt(o.shape,"float32"),R=1/(y*x*v),W=t.bufferSync(r);for(let Q=0;Q<h.batchSize;++Q)for(let ee=0;ee<h.inChannels;++ee)for(let te=0;te<h.inDepth;++te)for(let oe=0;oe<h.inHeight;++oe)for(let se=0;se<h.inWidth;++se){const G=te-D,V=oe-_,B=se-O;let F=0;for(let z=0;z<T;z+=w){const q=(G+z)/p;if(!(q<0||q>=h.outDepth||Math.floor(q)!==q))for(let re=0;re<I;re+=S){const ue=(V+re)/f;if(!(ue<0||ue>=h.outHeight||Math.floor(ue)!==ue))for(let pe=0;pe<E;pe+=k){const he=(B+pe)/m;if(he<0||he>=h.outWidth||Math.floor(he)!==he)continue;const xe=W.get(Q,q,ue,he,ee);F+=xe}}}P.set(F*R,Q,te,oe,se,ee)}return t.makeTensorInfo(P.shape,P.dtype,P.values)}const NY={kernelName:$w,backendName:"cpu",kernelFunc:TY};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function IY(n){const{inputs:e,backend:t,attrs:s}=n,{dy:r,input:o}=e,i=o;Fe([r,o],"avgPoolGrad");const{filterSize:a,strides:l,pad:u}=s,h=yr(i.shape,a,l,1,u),p=h.strideHeight,f=h.strideWidth,m=h.filterHeight,y=h.filterWidth,x=h.dilationHeight,v=h.dilationWidth,w=h.effectiveFilterHeight,S=h.effectiveFilterWidth,k=S-1-h.padInfo.left,T=w-1-h.padInfo.top,I=nt(i.shape,"float32"),E=1/(m*y),D=t.data.get(r.dataId).values,O=nt(r.shape,"float32",D);for(let _=0;_<h.batchSize;++_)for(let P=0;P<h.inChannels;++P)for(let R=0;R<h.inHeight;++R)for(let W=0;W<h.inWidth;++W){const Q=R-T,ee=W-k;let te=0;for(let oe=0;oe<w;oe+=x){const se=(Q+oe)/p;if(!(se<0||se>=h.outHeight||Math.floor(se)!==se))for(let G=0;G<S;G+=v){const V=(ee+G)/f;if(V<0||V>=h.outWidth||Math.floor(V)!==V)continue;const B=O.get(_,se,V,P);te+=B}}I.set(te*E,_,R,W,P)}return t.makeTensorInfo(I.shape,I.dtype,I.values)}const $Y={kernelName:Iw,backendName:"cpu",kernelFunc:IY};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function EY(n){const{inputs:e,backend:t,attrs:s}=n,{x:r,scale:o,offset:i,mean:a,variance:l}=e;L(a.shape.length===l.shape.length,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),L(i==null||a.shape.length===i.shape.length,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),L(o==null||a.shape.length===o.shape.length,()=>"Batch normalization gradient requires mean and scale to have equal ranks."),Fe([r,a,l,o,i],"batchNorm");let{varianceEpsilon:u}=s;u==null&&(u=.001);const h=t.data.get(r.dataId).values,p=t.data.get(a.dataId).values,f=t.data.get(l.dataId).values,m=o?t.data.get(o.dataId).values:new Float32Array([1]),y=i?t.data.get(i.dataId).values:new Float32Array([0]),x=new Float32Array(h.length),v=y.length,w=m.length,S=f.length,k=p.length;let T=0,I=0,E=0,D=0;for(let O=0;O<h.length;++O)x[O]=y[T++]+(h[O]-p[I++])*m[E++]/Math.sqrt(f[D++]+u),T>=v&&(T=0),I>=k&&(I=0),E>=w&&(E=0),D>=S&&(D=0);return t.makeTensorInfo(r.shape,r.dtype,x)}const RY={kernelName:Dm,backendName:"cpu",kernelFunc:EY};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function DY(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{blockShape:o,crops:i}=s;Fe([r],"batchToSpaceND");const a=o.reduce((w,S)=>w*S),l=od(r.shape,o,a),u=id(l.length,o.length),h=ad(r.shape,o,a),p=Tb(i,o.length),f=Nb(h,i,o.length),m=Nt({inputs:{x:r},backend:t,attrs:{shape:l}}),y=ms({inputs:{x:m},backend:t,attrs:{perm:u}}),x=Nt({inputs:{x:y},backend:t,attrs:{shape:h}}),v=Fa({inputs:{x},backend:t,attrs:{begin:p,size:f}});return t.disposeIntermediateTensorInfo(m),t.disposeIntermediateTensorInfo(y),t.disposeIntermediateTensorInfo(x),v}const AY={kernelName:vm,backendName:"cpu",kernelFunc:DY};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function OY(n){const{inputs:e,backend:t,attrs:s}=n,{x:r,weights:o}=e,{size:i}=s,a=t.data.get(r.dataId).values,l=t.data.get(o.dataId).values,u=cS(a,l,o.dtype,o.shape,i);return t.makeTensorInfo([i],o.dtype,u)}const _Y={kernelName:Ew,backendName:"cpu",kernelFunc:OY};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function FY(n){const{inputs:e,backend:t}=n,{s0:s,s1:r}=e,o=t.data.get(s.dataId).values,i=t.data.get(r.dataId).values,a=Ze(Array.from(o),Array.from(i));return t.makeTensorInfo([a.length],"int32",Int32Array.from(a))}const PY={kernelName:Rw,backendName:"cpu",kernelFunc:FY};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const LY=wt(hh,(n,e)=>{const t=e;return n>t.clipValueMax?t.clipValueMax:n<t.clipValueMin?t.clipValueMin:n}),MY={kernelName:hh,backendName:"cpu",kernelFunc:LY};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zY=n=>{const{x:e}=n.inputs,t=n.backend,s=new Float32Array(fe(e.shape)),r=t.data.get(e.dataId),o=r.complexTensorInfos.real,i=r.complexTensorInfos.imag,a=t.data.get(o.dataId).values,l=t.data.get(i.dataId).values;for(let u=0;u<a.length;u++){const h=a[u],p=l[u];s[u]=Math.hypot(h,p)}return t.makeOutput(s,e.shape,"float32")},VY={kernelName:bm,backendName:"cpu",kernelFunc:zY};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eu(n){const{inputs:e,backend:t}=n,{input:s}=e,r=t.data.get(s.dataId).complexTensorInfos.imag,o=t.data.get(r.dataId).values;return t.makeTensorInfo(r.shape,r.dtype,o)}const BY={kernelName:Xw,backendName:"cpu",kernelFunc:eu};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tu(n){const{inputs:e,backend:t,attrs:s}=n,{axis:r}=s,o=it(r,e[0].shape)[0],i=e.map(x=>x.shape);Sb(i,o);let a=to(e.map(x=>x.shape),o);if(fe(a)===0)return t.makeTensorInfo(a,e[0].dtype,[]);const l=e.filter(x=>fe(x.shape)>0);if(l.length===1)return uo({inputs:{x:l[0]},backend:t});if(l[0].dtype==="complex64"){const x=l.map(T=>_a({inputs:{input:T},backend:t})),v=l.map(T=>eu({inputs:{input:T},backend:t})),w=tu({inputs:x,backend:t,attrs:{axis:o}}),S=tu({inputs:v,backend:t,attrs:{axis:o}}),k=Is({inputs:{real:w,imag:S},backend:t});return x.forEach(T=>t.disposeIntermediateTensorInfo(T)),v.forEach(T=>t.disposeIntermediateTensorInfo(T)),t.disposeIntermediateTensorInfo(w),t.disposeIntermediateTensorInfo(S),k}const u=l.map(x=>{const w=[-1,fe(x.shape.slice(o))];return Nt({inputs:{x},backend:t,attrs:{shape:w}})}),h=u.map(x=>({vals:t.data.get(x.dataId).values,shape:x.shape}));a=to(u.map(x=>x.shape),1);const p=u[0].shape[0]===1,f=ZO(h,a,e[0].dtype,p),m=to(l.map(x=>x.shape),o),y=t.makeTensorInfo(m,e[0].dtype,f);return u.forEach(x=>t.disposeIntermediateTensorInfo(x)),y}const WY={kernelName:Sm,backendName:"cpu",kernelFunc:tu};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function q_(n){const{inputs:e,backend:t,attrs:s}=n,{x:r,filter:o}=e,{strides:i,pad:a,dataFormat:l,dilations:u,dimRoundingMode:h}=s;Fe([r,o],"conv2d");const p=Mo(l),f=Nn(r.shape,o.shape,i,u,a,h,!1,p),m=f.filterHeight,y=f.filterWidth,x=f.dilationHeight,v=f.dilationWidth,w=f.padInfo.left,S=f.padInfo.top,k=f.dataFormat==="channelsLast",T=new mn(f.outShape,r.dtype),I=Be(r.shape),E=Be(o.shape),D=I[0],O=k?I[1]:I[2],_=k?I[2]:1,P=k?1:I[1],R=T.strides[0],W=k?T.strides[1]:T.strides[2],Q=k?T.strides[2]:1,ee=k?1:T.strides[1],te=t.data.get(r.dataId).values,oe=t.data.get(o.dataId).values,se=T.values;for(let G=0;G<f.batchSize;++G){const V=G*D,B=G*R;for(let F=0;F<f.outHeight;++F){const z=B+F*W,q=F*f.strideHeight-S;for(let re=0;re<m;++re){const ue=q+re*x;if(ue<0||ue>=f.inHeight)continue;const pe=re*E[0],he=V+ue*O;for(let xe=0;xe<f.outWidth;++xe){const ge=z+xe*Q,Ie=xe*f.strideWidth-w;for(let Re=0;Re<y;++Re){const Ue=Ie+Re*v;if(Ue<0||Ue>=f.inWidth)continue;const qe=pe+Re*E[1],Qe=he+Ue*_;let Je=qe;for(let Ke=0;Ke<f.inChannels;++Ke){const st=te[Qe+Ke*P];for(let rt=0;rt<f.outChannels;++rt)se[ge+rt*ee]+=st*oe[Je+rt];Je+=f.outChannels}}}}}}return t.makeTensorInfo(T.shape,T.dtype,se)}const UY={kernelName:Cm,backendName:"cpu",kernelFunc:q_};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function GY(n){const{inputs:e,backend:t,attrs:s}=n,{x:r,dy:o}=e,{strides:i,pad:a,dataFormat:l,dimRoundingMode:u,filterShape:h}=s;Fe([r,o],"conv2dBackpropFilter");const p=Mo(l),f=Nn(r.shape,h,i,1,a,u,!1,p),{strideHeight:m,strideWidth:y,filterHeight:x,filterWidth:v}=f,w=f.dataFormat==="channelsLast",S=new mn(f.filterShape,"float32"),k=f.padInfo.left,T=f.padInfo.top,I=t.data.get(r.dataId).values,E=t.data.get(o.dataId).values,D=new mn(r.shape,r.dtype,I),O=new mn(o.shape,o.dtype,E);for(let _=0;_<x;++_){const P=Math.max(0,Math.ceil((T-_)/m)),R=Math.min(f.outHeight,(f.inHeight+T-_)/m);for(let W=0;W<v;++W){const Q=Math.max(0,Math.ceil((k-W)/y)),ee=Math.min(f.outWidth,(f.inWidth+k-W)/y);for(let te=0;te<f.inChannels;++te)for(let oe=0;oe<f.outChannels;++oe){let se=0;for(let G=0;G<f.batchSize;++G)for(let V=P;V<R;++V){const B=_+V*m-T;for(let F=Q;F<ee;++F){const z=W+F*y-k;w?se+=D.get(G,B,z,te)*O.get(G,V,F,oe):se+=D.get(G,te,B,z)*O.get(G,oe,V,F)}}S.set(se,_,W,te,oe)}}}return t.makeTensorInfo(S.shape,S.dtype,S.values)}const jY={kernelName:Aw,backendName:"cpu",kernelFunc:GY};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function HY(n){const{inputs:e,backend:t,attrs:s}=n,{dy:r,filter:o}=e,{inputShape:i,strides:a,pad:l,dataFormat:u,dimRoundingMode:h}=s;Fe([r,o],"conv2dBackpropInput");const p=Be(o.shape),f=Be(r.shape);let m=Mo(u);const y=Nn(i,o.shape,a,1,l,h,!1,m),x=new mn(y.inShape,"float32"),v=x.values,w=t.data.get(r.dataId).values,S=t.data.get(o.dataId).values,[k,T,I]=p,{batchSize:E,filterHeight:D,filterWidth:O,inChannels:_,inHeight:P,inWidth:R,outChannels:W,outHeight:Q,outWidth:ee,strideHeight:te,strideWidth:oe}=y;m=y.dataFormat;const se=D-1-y.padInfo.top,G=O-1-y.padInfo.left,V=m==="channelsLast",B=x.strides[0],F=V?x.strides[1]:x.strides[2],z=V?x.strides[2]:1,q=V?1:x.strides[1],re=f[0],ue=V?f[1]:f[2],pe=V?f[2]:1,he=V?1:f[1];for(let xe=0;xe<E;++xe)for(let ge=0;ge<_;++ge)for(let Ie=0;Ie<P;++Ie){const Re=Ie-se,Ue=Math.max(0,Math.ceil(Re/te)),qe=Math.min(Q,(D+Re)/te);for(let Qe=0;Qe<R;++Qe){const Je=Qe-G,Ke=Math.max(0,Math.ceil(Je/oe)),st=Math.min(ee,(O+Je)/oe);let rt=0;for(let mt=Ue;mt<qe;++mt){const Dt=mt*te-Re;for(let xt=Ke;xt<st;++xt){const Kt=xt*oe-Je,Vt=re*xe+ue*mt+pe*xt,qt=k*(D-1-Dt)+T*(O-1-Kt)+I*ge;for(let an=0;an<W;++an){const Bn=w[Vt+he*an],$n=S[qt+an];rt+=Bn*$n}}}const nn=B*xe+F*Ie+z*Qe+q*ge;v[nn]=rt}}return t.makeTensorInfo(x.shape,x.dtype,x.values)}const KY={kernelName:km,backendName:"cpu",kernelFunc:HY};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qY(n){const{inputs:e,backend:t,attrs:s}=n,{x:r,filter:o}=e,{strides:i,pad:a,dilations:l}=s;Fe([r,o],"conv3d");const u=Li(r.shape,o.shape,i,l,a),{filterDepth:h,filterHeight:p,filterWidth:f,dilationDepth:m,dilationHeight:y,dilationWidth:x,padInfo:v}=u,w=v.front,S=v.left,k=v.top,T=new mn(u.outShape,r.dtype),I=t.data.get(r.dataId).values,E=t.data.get(o.dataId).values,D=T.values,O=Be(r.shape),_=Be(o.shape);for(let P=0;P<u.batchSize;++P){const R=P*O[0],W=P*T.strides[0];for(let Q=0;Q<u.outDepth;++Q){const ee=W+Q*T.strides[1],te=Q*u.strideDepth-w;for(let oe=0;oe<h;++oe){const se=te+oe*m;if(se<0||se>=u.inDepth)continue;const G=oe*_[0],V=R+se*O[1];for(let B=0;B<u.outHeight;++B){const F=ee+B*T.strides[2],z=B*u.strideHeight-k;for(let q=0;q<p;++q){const re=z+q*y;if(re<0||re>=u.inHeight)continue;const ue=G+q*_[1],pe=V+re*O[2];for(let he=0;he<u.outWidth;++he){const xe=F+he*u.outChannels,ge=he*u.strideWidth-S;for(let Ie=0;Ie<f;++Ie){const Re=ge+Ie*x;if(Re<0||Re>=u.inWidth)continue;const Ue=ue+Ie*_[2],qe=pe+Re*u.inChannels;let Qe=Ue;for(let Je=0;Je<u.inChannels;++Je){const Ke=I[qe+Je];for(let st=0;st<u.outChannels;++st)D[xe+st]+=Ke*E[Qe+st];Qe+=u.outChannels}}}}}}}}return t.makeTensorInfo(T.shape,T.dtype,T.values)}const XY={kernelName:Tm,backendName:"cpu",kernelFunc:qY};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function YY(n){const{inputs:e,backend:t,attrs:s}=n,{x:r,dy:o}=e,{strides:i,pad:a,filterShape:l}=s;Fe([r,o],"conv3dBackpropFilterV2");const u=Be(r.shape),h=Be(o.shape),p=Li(r.shape,l,i,1,a),f=p.strideDepth,m=p.strideHeight,y=p.strideWidth,x=p.filterDepth,v=p.filterHeight,w=p.filterWidth,S=new mn(p.filterShape,"float32"),k=S.values,[T,I,E,D]=S.strides,O=t.data.get(o.dataId).values,[_,P,R,W]=h,Q=t.data.get(r.dataId).values,[ee,te,oe,se]=u,G=p.padInfo.front,V=p.padInfo.left,B=p.padInfo.top;for(let F=0;F<x;++F){const z=Math.max(0,Math.ceil((G-F)/f)),q=Math.min(p.outDepth,(p.inDepth+G-F)/f),re=F*T;for(let ue=0;ue<v;++ue){const pe=Math.max(0,Math.ceil((B-ue)/m)),he=Math.min(p.outHeight,(p.inHeight+B-ue)/m),xe=ue*I+re;for(let ge=0;ge<w;++ge){const Ie=Math.max(0,Math.ceil((V-ge)/y)),Re=Math.min(p.outWidth,(p.inWidth+V-ge)/y),Ue=ge*E+xe;for(let qe=0;qe<p.inChannels;++qe){const Qe=qe*D+Ue;for(let Je=0;Je<p.outChannels;++Je){let Ke=0;for(let st=0;st<p.batchSize;++st){const rt=st*ee,nn=st*_;for(let mt=z;mt<q;++mt){const xt=(F+mt*f-G)*te+rt,Kt=mt*P+nn;for(let Vt=pe;Vt<he;++Vt){const an=(ue+Vt*m-B)*oe+xt,Bn=Vt*R+Kt;for(let $n=Ie;$n<Re;++$n){const ys=(ge+$n*y-V)*se+an,ln=$n*W+Bn;Ke+=Q[ys+qe]*O[ln+Je]}}}}k[Qe+Je]=Ke}}}}}return t.makeTensorInfo(S.shape,S.dtype,S.values)}const QY={kernelName:Ow,backendName:"cpu",kernelFunc:YY};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ZY(n){const{inputs:e,backend:t,attrs:s}=n,{dy:r,filter:o}=e,{pad:i,strides:a,inputShape:l}=s;Fe([r],"conv3dBackpropInputV2");const u=Be(r.shape),h=Be(o.shape),p=Li(l,o.shape,a,1,i),f=new mn(p.inShape,"float32"),m=f.values,[y,x,v,w]=f.strides,S=t.data.get(r.dataId).values,[k,T,I,E]=u,D=t.data.get(o.dataId).values,[O,_,P,R]=h,{batchSize:W,filterDepth:Q,filterHeight:ee,filterWidth:te,inChannels:oe,inDepth:se,inHeight:G,inWidth:V,outChannels:B,outDepth:F,outHeight:z,outWidth:q,strideDepth:re,strideHeight:ue,strideWidth:pe}=p,he=Q-1-p.padInfo.front,xe=ee-1-p.padInfo.top,ge=te-1-p.padInfo.left;for(let Ie=0;Ie<W;++Ie)for(let Re=0;Re<oe;++Re)for(let Ue=0;Ue<se;++Ue){const qe=Ue-he,Qe=Math.max(0,Math.ceil(qe/re)),Je=Math.min(F,(Q+qe)/re);for(let Ke=0;Ke<G;++Ke){const st=Ke-xe,rt=Math.max(0,Math.ceil(st/ue)),nn=Math.min(z,(ee+st)/ue);for(let mt=0;mt<V;++mt){const Dt=mt-ge,xt=Math.max(0,Math.ceil(Dt/pe)),Kt=Math.min(q,(te+Dt)/pe);let Vt=0;for(let qt=Qe;qt<Je;++qt){const an=qt*re-qe;for(let Bn=rt;Bn<nn;++Bn){const $n=Bn*ue-st;for(let gs=xt;gs<Kt;++gs){const ys=gs*pe-Dt,ln=k*Ie+T*qt+I*Bn+E*gs,$u=O*(Q-1-an)+_*(ee-1-$n)+P*(te-1-ys)+R*Re;for(let wr=0;wr<B;++wr){const Ya=S[ln+wr],ly=D[$u+wr];Vt+=Ya*ly}}}}m[y*Ie+x*Ue+v*Ke+w*mt+Re]=Vt}}}return t.makeTensorInfo(f.shape,f.dtype,f.values)}const JY={kernelName:_w,backendName:"cpu",kernelFunc:ZY};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const eQ=wt(dh,n=>Math.cos(n)),tQ={kernelName:dh,backendName:"cpu",kernelFunc:eQ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nQ=wt(ph,n=>Math.cosh(n)),sQ={kernelName:ph,backendName:"cpu",kernelFunc:nQ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rQ(n){const{inputs:e,backend:t,attrs:s}=n,{image:r,boxes:o,boxInd:i}=e,{cropSize:a,method:l,extrapolationValue:u}=s,[h,p,f,m]=r.shape,y=o.shape[0],[x,v]=a,w=nt([y,x,v,m],"float32"),S=t.data.get(o.dataId).values,k=t.data.get(i.dataId).values,T=t.data.get(r.dataId).values,I=Be(r.shape),E=Be(w.shape);for(let D=0;D<y;D++){const O=D*4,_=S[O],P=S[O+1],R=S[O+2],W=S[O+3],Q=k[D];if(Q>=h)continue;const ee=x>1?(R-_)*(p-1)/(x-1):0,te=v>1?(W-P)*(f-1)/(v-1):0;for(let oe=0;oe<x;oe++){const se=x>1?_*(p-1)+oe*ee:.5*(_+R)*(p-1);if(se<0||se>p-1){for(let G=0;G<v;G++)for(let V=0;V<m;V++){const B=V+G*E[2]+oe*E[1]+D*E[0];w.values[B]=u}continue}if(l==="bilinear"){const G=Math.floor(se),V=Math.ceil(se),B=se-G;for(let F=0;F<v;F++){const z=v>1?P*(f-1)+F*te:.5*(P+W)*(f-1);if(z<0||z>f-1){for(let pe=0;pe<m;pe++){const he=pe+F*E[2]+oe*E[1]+D*E[0];w.values[he]=u}continue}const q=Math.floor(z),re=Math.ceil(z),ue=z-q;for(let pe=0;pe<m;pe++){let he=pe+q*I[2]+G*I[1]+Q*I[0];const xe=T[he];he=pe+re*I[2]+G*I[1]+Q*I[0];const ge=T[he];he=pe+q*I[2]+V*I[1]+Q*I[0];const Ie=T[he];he=pe+re*I[2]+V*I[1]+Q*I[0];const Re=T[he],Ue=xe+(ge-xe)*ue,qe=Ie+(Re-Ie)*ue;he=pe+F*E[2]+oe*E[1]+D*E[0],w.values[he]=Ue+(qe-Ue)*B}}}else for(let G=0;G<v;++G){const V=v>1?P*(f-1)+G*te:.5*(P+W)*(f-1);if(V<0||V>f-1){for(let z=0;z<m;z++){const q=z+G*E[2]+oe*E[1]+D*E[0];w.values[q]=u}continue}const B=Math.round(V),F=Math.round(se);for(let z=0;z<m;z++){const q=z+B*I[2]+F*I[1]+Q*I[0],re=z+G*E[2]+oe*E[1]+D*E[0];w.values[re]=T[q]}}}}return t.makeTensorInfo(w.shape,w.dtype,w.values)}const oQ={kernelName:Pw,backendName:"cpu",kernelFunc:rQ};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iQ(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{axis:o,exclusive:i,reverse:a}=s;Fe(r,"cumprod");const l=zt([o],r.shape.length);let u=r;l!=null&&(u=ms({inputs:{x:r},backend:t,attrs:{perm:l}}));const h=Jt(1,r.shape.length)[0];if(h!==u.shape.length-1)throw new Error(`backend.cumprod in CPU expects an inner-most axis=${u.shape.length-1} but got axis=${h}`);const p=Ds(u.dtype,"int32"),f=Cw(fe(u.shape),p),m=t.data.get(u.dataId).values,y=u.shape[u.shape.length-1],x=a?(w,S)=>w+y-S-1:(w,S)=>w+S;for(let w=0;w<m.length;w+=y)for(let S=0;S<y;S++){const k=x(w,S);if(S===0)f[k]=i?1:m[k];else{const T=x(w,S-1);f[k]=i?m[T]*f[T]:m[k]*f[T]}}const v=t.makeTensorInfo(u.shape,p,f);if(l!=null){const w=Mi(l),S=ms({inputs:{x:v},backend:t,attrs:{perm:w}});return t.disposeIntermediateTensorInfo(v),t.disposeIntermediateTensorInfo(u),S}return v}const aQ={kernelName:Fw,backendName:"cpu",kernelFunc:iQ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lQ(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{axis:o,exclusive:i,reverse:a}=s;Fe(r,"cumsum");const l=zt([o],r.shape.length);let u=r;l!=null&&(u=ms({inputs:{x:r},backend:t,attrs:{perm:l}}));const h=Jt(1,r.shape.length)[0];if(h!==u.shape.length-1)throw new Error(`backend.cumsum in CPU expects an inner-most axis=${u.shape.length-1} but got axis=${h}`);const p=Ds(u.dtype,"int32"),f=Kn(fe(u.shape),p),m=t.data.get(u.dataId).values,y=u.shape[u.shape.length-1],x=a?(w,S)=>w+y-S-1:(w,S)=>w+S;for(let w=0;w<m.length;w+=y)for(let S=0;S<y;S++){const k=x(w,S);if(S===0)f[k]=i?0:m[k];else{const T=x(w,S-1);f[k]=i?m[T]+f[T]:m[k]+f[T]}}const v=t.makeTensorInfo(u.shape,p,f);if(l!=null){const w=Mi(l),S=ms({inputs:{x:v},backend:t,attrs:{perm:w}});return t.disposeIntermediateTensorInfo(v),t.disposeIntermediateTensorInfo(u),S}return v}const uQ={kernelName:Nm,backendName:"cpu",kernelFunc:lQ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cQ(n){const{inputs:e,backend:t,attrs:s}=n,{x:r,weights:o}=e,{size:i,binaryOutput:a}=s;if(r.shape.length===1){const l=t.data.get(r.dataId).values,u=t.data.get(o.dataId).values,h=cS(l,u,o.dtype,o.shape,i);return t.makeTensorInfo([i],o.dtype,h)}else if(r.shape.length===2){const l=t.bufferSync(r),u=t.bufferSync(o),h=XO(l,u,i,a);return t.makeTensorInfo(h.shape,o.dtype,h.values)}throw new Error(`Error in denseBincount: input must be at most rank 2, but got rank${r.shape.length}.`)}const hQ={kernelName:Lw,backendName:"cpu",kernelFunc:cQ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dQ(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{blockSize:o,dataFormat:i}=s;L(i==="NHWC",()=>`Only NHWC dataFormat supported on CPU for depthToSpace. Got ${i}`);const a=r.shape[0],l=r.shape[1],u=r.shape[2],h=r.shape[3],p=l*o,f=u*o,m=h/(o*o),y=t.data.get(r.dataId).values,x=new Float32Array(a*p*f*m);let v=0;for(let w=0;w<a;++w)for(let S=0;S<p;++S){const k=Math.floor(S/o),T=S%o;for(let I=0;I<f;++I){const E=Math.floor(I/o),D=I%o,O=(T*o+D)*m;for(let _=0;_<m;++_){const R=_+O+h*(E+u*(k+l*w));x[v++]=y[R]}}}return t.makeTensorInfo([a,p,f,m],r.dtype,x)}const pQ={kernelName:Mw,backendName:"cpu",kernelFunc:dQ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function X_(n){const{inputs:e,backend:t,attrs:s}=n,{x:r,filter:o}=e,{strides:i,pad:a,dilations:l,dimRoundingMode:u}=s;Fe([r,o],"depthwiseConv2DNative");const h=Be(r.shape),p=Be(o.shape);let f=l;f==null&&(f=[1,1]),L(Ln(i,f),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${i} and dilations '${f}'`);const m=Nn(r.shape,o.shape,i,f,a,u,!0),{filterHeight:y,filterWidth:x,dilationHeight:v,dilationWidth:w,padInfo:S}=m,k=S.left,T=S.top,I=m.outChannels/m.inChannels,E=new mn(m.outShape,r.dtype),D=t.data.get(r.dataId).values,O=t.data.get(o.dataId).values,_=E.values;for(let P=0;P<m.batchSize;++P){const R=P*h[0],W=P*E.strides[0];for(let Q=0;Q<m.outHeight;++Q){const ee=W+Q*E.strides[1],te=Q*m.strideHeight-T;for(let oe=0;oe<y;++oe){const se=te+oe*v;if(se<0||se>=m.inHeight)continue;const G=oe*p[0],V=R+se*h[1];for(let B=0;B<m.outWidth;++B){const F=ee+B*E.strides[2],z=B*m.strideWidth-k;for(let q=0;q<x;++q){const re=z+q*w;if(re<0||re>=m.inWidth)continue;const ue=G+q*p[1],pe=V+re*m.inChannels;let he=F,xe=ue;for(let ge=0;ge<m.inChannels;++ge){const Ie=D[pe+ge];for(let Re=0;Re<I;++Re)_[he+Re]+=Ie*O[xe+Re];he+=I,xe+=I}}}}}}return t.makeTensorInfo(E.shape,E.dtype,E.values)}const fQ={kernelName:Im,backendName:"cpu",kernelFunc:X_};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mQ(n){const{inputs:e,backend:t,attrs:s}=n,{x:r,dy:o}=e,{strides:i,dilations:a,pad:l,dimRoundingMode:u,filterShape:h}=s;Fe([r,o],"depthwiseConv2dNativeBackpropFilter");const p=Nn(r.shape,h,i,a,l,u,!0),{strideHeight:f,strideWidth:m,filterHeight:y,filterWidth:x}=p,v=new mn(p.filterShape,"float32"),w=p.padInfo.left,S=p.padInfo.top,k=p.outChannels/p.inChannels,T=t.data.get(r.dataId).values,I=new mn(r.shape,r.dtype,T),E=t.data.get(o.dataId).values,D=new mn(o.shape,o.dtype,E);for(let O=0;O<y;++O){const _=Math.max(0,Math.ceil((S-O)/f)),P=Math.min(p.outHeight,(p.inHeight+S-O)/f);for(let R=0;R<x;++R){const W=Math.max(0,Math.ceil((w-R)/m)),Q=Math.min(p.outWidth,(p.inWidth+w-R)/m);for(let ee=0;ee<p.outChannels;++ee){const te=Math.trunc(ee/k),oe=ee%k;let se=0;for(let G=0;G<p.batchSize;++G)for(let V=_;V<P;++V){const B=O+V*f-S;for(let F=W;F<Q;++F){const z=R+F*m-w;se+=I.get(G,B,z,te)*D.get(G,V,F,ee)}}v.set(se,O,R,te,oe)}}}return t.makeTensorInfo(v.shape,v.dtype,v.values)}const gQ={kernelName:zw,backendName:"cpu",kernelFunc:mQ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yQ(n){const{inputs:e,backend:t,attrs:s}=n,{dy:r,filter:o}=e,{strides:i,dilations:a,pad:l,dimRoundingMode:u,inputShape:h}=s;Fe([r,o],"depthwiseConv2DNativeBackpropInput");const p=Be(r.shape),f=Be(o.shape),m=Nn(h,o.shape,i,a,l,u,!0),y=new mn(m.inShape,"float32"),x=y.values,[v,w,S]=y.strides,k=t.data.get(r.dataId).values,[T,I,E]=p,D=t.data.get(o.dataId).values,[O,_,P]=f,{batchSize:R,filterHeight:W,filterWidth:Q,inChannels:ee,inHeight:te,inWidth:oe,outChannels:se,outHeight:G,outWidth:V,strideHeight:B,strideWidth:F}=m,z=W-1-m.padInfo.top,q=Q-1-m.padInfo.left,re=se/ee;for(let ue=0;ue<R;++ue)for(let pe=0;pe<ee;++pe)for(let he=0;he<te;++he){const xe=he-z,ge=Math.max(0,Math.ceil(xe/B)),Ie=Math.min(G,(W+xe)/B);for(let Re=0;Re<oe;++Re){const Ue=Re-q,qe=Math.max(0,Math.ceil(Ue/F)),Qe=Math.min(V,(Q+Ue)/F);let Je=0;for(let Ke=ge;Ke<Ie;++Ke){const st=Ke*B-xe;for(let rt=qe;rt<Qe;++rt){const nn=rt*F-Ue,mt=T*ue+I*Ke+E*rt,Dt=O*(W-1-st)+_*(Q-1-nn)+P*pe;for(let xt=0;xt<re;++xt){const Kt=pe*re+xt,Vt=k[mt+Kt],qt=D[Dt+xt];Je+=Vt*qt}}}x[v*ue+w*he+S*Re+pe]=Je}}return t.makeTensorInfo(y.shape,y.dtype,y.values)}const xQ={kernelName:Vw,backendName:"cpu",kernelFunc:yQ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vQ(n){const{inputs:e,backend:t}=n,{x:s}=e,r=fe(s.shape),o=t.data.get(s.dataId).values,i=nt([r,r],s.dtype),a=i.values;for(let u=0;u<o.length;u++)a[u*r+u]=o[u];const l=[...s.shape,...s.shape];return t.makeTensorInfo(l,i.dtype,i.values)}const wQ={kernelName:Bw,backendName:"cpu",kernelFunc:vQ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bQ={kernelName:$m,backendName:"cpu",kernelFunc:({inputs:n,backend:e,attrs:t})=>{const{x:s,filter:r}=n,{strides:o,pad:i,dilations:a}=t,l=e,u=l.data.get(s.dataId).values,h=s.shape.length,p=l.data.get(r.dataId).values,f=r.shape.length,{batchSize:m,inHeight:y,inWidth:x,inChannels:v,outHeight:w,outWidth:S,padInfo:k,strideHeight:T,strideWidth:I,filterHeight:E,filterWidth:D,dilationHeight:O,dilationWidth:_,outShape:P}=Zh(s.shape,r.shape,o,i,"NHWC",a),R=fe(P),W=P.length,Q=Qt(s.dtype,R);for(let te=0;te<m;++te)for(let oe=0;oe<w;++oe){const se=oe*T-k.top;for(let G=0;G<S;++G){const V=G*I-k.left;for(let B=0;B<v;++B){let F=Number.MIN_SAFE_INTEGER;for(let q=0;q<E;++q){const re=se+q*O;if(re>=0&&re<y)for(let ue=0;ue<D;++ue){const pe=V+ue*_;if(pe>=0&&pe<x){const he=eo([te,re,pe,B],h,Be(s.shape)),xe=eo([q,ue,B],f,Be(r.shape)),ge=u[he]+p[xe];ge>F&&(F=ge)}}}const z=eo([te,oe,G,B],W,Be(P));Q[z]=F}}}return{dataId:l.write(Va(Q,s.dtype),P,s.dtype),shape:P,dtype:s.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const SQ={kernelName:Zx,backendName:"cpu",kernelFunc:({inputs:n,backend:e,attrs:t})=>{const{x:s,filter:r,dy:o}=n,{strides:i,pad:a,dilations:l}=t,u=e,h=cr(s.shape,u.data.get(s.dataId).values),p=cr(r.shape,u.data.get(r.dataId).values),{batchSize:f,inHeight:m,inWidth:y,inChannels:x,outHeight:v,outWidth:w,padInfo:S,strideHeight:k,strideWidth:T,filterHeight:I,filterWidth:E,dilationHeight:D,dilationWidth:O,outShape:_}=Zh(s.shape,r.shape,i,a,"NHWC",l);L(o.rank===_.length,()=>`Error in ${Zx}, dy must have the same rank as output ${_.length}, but got ${o.rank}`);const P=cr(_,u.data.get(o.dataId).values),R=Y2(r.shape,r.dtype);for(let Q=0;Q<f;++Q)for(let ee=0;ee<v;++ee){const te=ee*k-S.top;for(let oe=0;oe<w;++oe){const se=oe*T-S.left;for(let G=0;G<x;++G){let V=Number.MIN_SAFE_INTEGER,B=0,F=0;for(let z=0;z<I;++z){const q=te+z*D;if(q>=0&&q<m)for(let re=0;re<E;++re){const ue=se+re*O;if(ue>=0&&ue<y){const pe=h[Q][q][ue][G]+p[z][re][G];pe>V&&(V=pe,B=z,F=re)}}}R[B][F][G]+=P[Q][ee][oe][G]}}}return{dataId:u.write(Va(R,s.dtype),r.shape,r.dtype),shape:r.shape,dtype:r.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const CQ={kernelName:Qx,backendName:"cpu",kernelFunc:({inputs:n,backend:e,attrs:t})=>{const{x:s,filter:r,dy:o}=n,{strides:i,pad:a,dilations:l}=t,u=e,h=cr(s.shape,u.data.get(s.dataId).values),p=cr(r.shape,u.data.get(r.dataId).values),{batchSize:f,inHeight:m,inWidth:y,inChannels:x,outHeight:v,outWidth:w,padInfo:S,strideHeight:k,strideWidth:T,filterHeight:I,filterWidth:E,dilationHeight:D,dilationWidth:O,outShape:_}=Zh(s.shape,r.shape,i,a,"NHWC",l);L(o.rank===_.length,()=>`Error in ${Qx}, dy must have the same rank as output ${_.length}, but got ${o.rank}`);const P=cr(_,u.data.get(o.dataId).values),R=Y2(s.shape,s.dtype);for(let Q=0;Q<f;++Q)for(let ee=0;ee<v;++ee){const te=ee*k-S.top;for(let oe=0;oe<w;++oe){const se=oe*T-S.left;for(let G=0;G<x;++G){let V=Number.MIN_SAFE_INTEGER,B=te<0?0:te,F=se<0?0:se;for(let z=0;z<I;++z){const q=te+z*D;if(q>=0&&q<m)for(let re=0;re<E;++re){const ue=se+re*O;if(ue>=0&&ue<y){const pe=h[Q][q][ue][G]+p[z][re][G];pe>V&&(V=pe,B=q,F=ue)}}}R[Q][B][F][G]+=P[Q][ee][oe][G]}}}return{dataId:u.write(Va(R,s.dtype),s.shape,s.dtype),shape:s.shape,dtype:s.dtype}}};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kQ(n){const{inputs:e,backend:t,attrs:s}=n,{image:r}=e,{canvas:o,options:i}=s,{contextOptions:a,imageOptions:l}=i||{},u=(l==null?void 0:l.alpha)||1,h=(a==null?void 0:a.contextType)||"2d";if(h!=="2d")throw new Error(`Context type ${a.contextType} is not supported by the CPU backend.`);const p=o.getContext(h,(a==null?void 0:a.contextAttributes)||{});if(p==null)throw new Error(`Could not get the context with ${h} type.`);const[f,m]=r.shape.slice(0,2),y=r.shape.length===2?1:r.shape[2],x=t.data.get(r.dataId).values,v=r.dtype==="float32"?255:1,w=new Uint8ClampedArray(m*f*4);for(let k=0;k<f*m;++k){const T=[0,0,0,255*u];for(let E=0;E<y;E++){const D=x[k*y+E];if(r.dtype==="float32"){if(D<0||D>1)throw new Error(`Tensor values for a float32 Tensor must be in the range [0 - 1] but encountered ${D}.`)}else if(r.dtype==="int32"&&(D<0||D>255))throw new Error(`Tensor values for a int32 Tensor must be in the range [0 - 255] but encountered ${D}.`);y===1?(T[0]=D*v,T[1]=D*v,T[2]=D*v):T[E]=D*v}const I=k*4;w[I+0]=Math.round(T[0]),w[I+1]=Math.round(T[1]),w[I+2]=Math.round(T[2]),w[I+3]=Math.round(T[3])}o.width=m,o.height=f;const S=new ImageData(w,m,f);return p.putImageData(S,0,0),r}const TQ={kernelName:BV,backendName:"cpu",kernelFunc:kQ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gd(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{axis:o,keepDims:i}=s;Fe(r,"sum");let a;r.dtype==="bool"?a=$i({inputs:{x:r},backend:t,attrs:{dtype:"int32"}}):a=uo({inputs:{x:r},backend:t});const l=a.shape.length,u=it(o,a.shape),h=zt(u,l);let p=u,f=a;h!=null&&(f=ms({inputs:{x:a},backend:t,attrs:{perm:h}}),p=Jt(p.length,l)),Mn("sum",p,f.shape.length);const[m,y]=In(f.shape,p),x=Ds(f.dtype,"int32");let v=Gf(t,m,x);const w=fe(y),S=t.data.get(v.dataId).values,k=t.data.get(f.dataId).values;for(let T=0;T<S.length;++T){const I=T*w;let E=0;for(let D=0;D<w;++D)E+=k[I+D];S[T]=E}if(i){const T=Zt(v.shape,u),I=v;v=Nt({inputs:{x:v},backend:t,attrs:{shape:T}}),t.disposeIntermediateTensorInfo(I)}return t.disposeIntermediateTensorInfo(a),h!=null&&t.disposeIntermediateTensorInfo(f),v}const NQ={kernelName:ag,backendName:"cpu",kernelFunc:gd};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function IQ(n){const{inputs:e,backend:t,attrs:s}=n,{equation:r}=s,o=e,{allDims:i,summedDims:a,idDims:l}=_b(r,o.length);Pb(i.length,l,o);const{path:u,steps:h}=Lb(a,l),p=h.length;let f=null,m=i.length;const y=[];for(let x=0;x<p;++x){for(const v of h[x]){const{permutationIndices:w,expandDims:S}=Fb(m,l[v]);let k;Mb(w)?k=o[v]:(k=ms({inputs:{x:o[v]},backend:t,attrs:{perm:w}}),y.push(k));const T=k.shape.slice();for(let I=0;I<S.length;++I)T.splice(S[I],0,1);ct(k.shape,T)||(k=Nt({inputs:{x:k},backend:t,attrs:{shape:T}}),y.push(k)),f===null?f=k:(f=Zg({inputs:{a:k,b:f},backend:t}),y.push(f))}x<p-1&&(u[x]>=0&&(f=gd({inputs:{x:f},backend:t,attrs:{axis:u[x]-(i.length-m),keepDims:!1}}),y.push(f)),m--)}for(const x of y)x!==f&&t.disposeIntermediateTensorInfo(x);return f}const $Q={kernelName:Ww,backendName:"cpu",kernelFunc:IQ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function EQ(n){const{inputs:e,backend:t}=n,{dy:s,y:r}=e;Fe([s,r],"eluGrad");const o=new Float32Array(fe(r.shape)),i=t.data.get(r.dataId).values,a=t.data.get(s.dataId).values;for(let l=0;l<i.length;++l){const u=i[l];u>=0?o[l]=a[l]:o[l]=a[l]*(u+1)}return t.makeTensorInfo(r.shape,"float32",o)}const RQ={kernelName:Uw,backendName:"cpu",kernelFunc:EQ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const DQ=Ib,AQ=$b,OQ=Eb,_Q=Rb,FQ=Db,PQ=Ab,LQ=wt(gh,n=>{const e=Math.sign(n),t=Math.abs(n),s=1/(1+DQ*t);return e*(1-((((PQ*s+FQ)*s+_Q)*s+OQ)*s+AQ)*s*Math.exp(-t*t))}),MQ={kernelName:gh,backendName:"cpu",kernelFunc:LQ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Kf(n){const{inputs:e,backend:t,attrs:s}=n,{input:r}=e,{dim:o}=s,i=r.shape.length,a=r.shape.slice();let l=o;return o<0&&(L(-(i+1)<=o,()=>`Axis must be in the interval [${-(i+1)}, ${i}]`),l=i+o+1),a.splice(l,0,1),Nt({inputs:{x:r},backend:t,attrs:{shape:a}})}const zQ={kernelName:Rm,backendName:"cpu",kernelFunc:Kf};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const VQ=tn((n,e)=>n/e),gS=vn(fh,VQ),zv={kernelName:fh,backendName:"cpu",kernelFunc:gS};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Y_(n,e,t){const s=n.shape,r=s[0],o=s[1],i=t.data.get(n.dataId),a=i.complexTensorInfos.real,l=i.complexTensorInfos.imag,u=[r,o],h=fe(u),p=Fn("float32",h),f=Fn("float32",h);for(let v=0;v<r;v++){const w=Fa({inputs:{x:a},backend:t,attrs:{begin:[v,0],size:[1,o]}}),S=Fa({inputs:{x:l},backend:t,attrs:{begin:[v,0],size:[1,o]}}),k=Is({inputs:{real:w,imag:S},backend:t}),{real:T,imag:I}=BQ(k,e,t),E=Oo(T,I);for(let D=0;D<o;D++){const O=Ob(E,D);p[v*o+D]=O.real,f[v*o+D]=O.imag}t.disposeIntermediateTensorInfo(w),t.disposeIntermediateTensorInfo(S),t.disposeIntermediateTensorInfo(k)}const m=t.makeTensorInfo(u,"float32",p),y=t.makeTensorInfo(u,"float32",f),x=Is({inputs:{real:m,imag:y},backend:t});return t.disposeIntermediateTensorInfo(m),t.disposeIntermediateTensorInfo(y),x}function BQ(n,e,t){const s=fe(n.shape),r=t.data.get(n.dataId),o=t.data.get(r.complexTensorInfos.real.dataId).values,i=t.data.get(r.complexTensorInfos.imag.dataId).values;if(WQ(s)){const a=Vv(o,i,s,e,t),l=[n.shape[0],n.shape[1]];if(e){const u=t.makeTensorInfo(l,"float32",a.real),h=t.makeTensorInfo(l,"float32",a.imag),p=t.makeTensorInfo([],"float32",_i(s,"float32")),f=uo({inputs:{x:p},backend:t}),m=zv.kernelFunc({inputs:{a:u,b:p},backend:t}),y=zv.kernelFunc({inputs:{a:h,b:f},backend:t}),x=t.data.get(m.dataId).values,v=t.data.get(y.dataId).values;return t.disposeIntermediateTensorInfo(u),t.disposeIntermediateTensorInfo(h),t.disposeIntermediateTensorInfo(p),t.disposeIntermediateTensorInfo(f),t.disposeIntermediateTensorInfo(m),t.disposeIntermediateTensorInfo(y),{real:x,imag:v}}return a}else{const a=Oo(o,i),l=UQ(a,s,e);return iD(l)}}function WQ(n){return(n&n-1)===0}function Vv(n,e,t,s,r){if(t===1)return{real:n,imag:e};const o=Oo(n,e),i=t/2,a=aD(o),l=a.real,u=a.imag,h=[l.length],p=r.makeTensorInfo(h,"float32",l),f=r.makeTensorInfo(h,"float32",u),m=Is({inputs:{real:p,imag:f},backend:r}),y=lD(o),x=y.real,v=y.imag,w=[x.length],S=r.makeTensorInfo(w,"float32",x),k=r.makeTensorInfo(w,"float32",v),T=Is({inputs:{real:S,imag:k},backend:r}),I=Vv(l,u,i,s,r),E=I.real,D=I.imag,O=[E.length],_=r.makeTensorInfo(O,"float32",E),P=r.makeTensorInfo(O,"float32",D),R=Is({inputs:{real:_,imag:P},backend:r}),W=Vv(x,v,i,s,r),Q=W.real,ee=W.imag,te=[Q.length],oe=r.makeTensorInfo(te,"float32",Q),se=r.makeTensorInfo(te,"float32",ee),G=Is({inputs:{real:oe,imag:se},backend:r}),V=cD(t,s),B=[V.real.length],F=r.makeTensorInfo(B,"float32",V.real),z=r.makeTensorInfo(B,"float32",V.imag),q=Is({inputs:{real:F,imag:z},backend:r}),re=Zg({inputs:{a:q,b:G},backend:r}),ue=Jl({inputs:{a:R,b:re},backend:r}),pe=fS({inputs:{a:R,b:re},backend:r}),he=_a({inputs:{input:ue},backend:r}),xe=_a({inputs:{input:pe},backend:r}),ge=eu({inputs:{input:ue},backend:r}),Ie=eu({inputs:{input:pe},backend:r}),Re=tu({inputs:[he,xe],backend:r,attrs:{axis:0}}),Ue=tu({inputs:[ge,Ie],backend:r,attrs:{axis:0}}),qe=r.data.get(Re.dataId).values,Qe=r.data.get(Ue.dataId).values;return r.disposeIntermediateTensorInfo(p),r.disposeIntermediateTensorInfo(f),r.disposeIntermediateTensorInfo(m),r.disposeIntermediateTensorInfo(S),r.disposeIntermediateTensorInfo(k),r.disposeIntermediateTensorInfo(T),r.disposeIntermediateTensorInfo(_),r.disposeIntermediateTensorInfo(P),r.disposeIntermediateTensorInfo(R),r.disposeIntermediateTensorInfo(oe),r.disposeIntermediateTensorInfo(se),r.disposeIntermediateTensorInfo(G),r.disposeIntermediateTensorInfo(F),r.disposeIntermediateTensorInfo(z),r.disposeIntermediateTensorInfo(q),r.disposeIntermediateTensorInfo(re),r.disposeIntermediateTensorInfo(ue),r.disposeIntermediateTensorInfo(pe),r.disposeIntermediateTensorInfo(he),r.disposeIntermediateTensorInfo(ge),r.disposeIntermediateTensorInfo(xe),r.disposeIntermediateTensorInfo(Ie),r.disposeIntermediateTensorInfo(Re),r.disposeIntermediateTensorInfo(Ue),{real:qe,imag:Qe}}function UQ(n,e,t){const s=new Float32Array(e*2);for(let r=0;r<e;r++){let o=0,i=0;for(let a=0;a<e;a++){const l=hD(r*a,e,t),u=Ob(n,a);o+=u.real*l.real-u.imag*l.imag,i+=u.real*l.imag+u.imag*l.real}t&&(o/=e,i/=e),uD(s,o,i,r)}return s}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function GQ(n){const{inputs:e,backend:t}=n,{input:s}=e,r=fe(s.shape),o=s.shape[s.shape.length-1],i=r/o,a=Nt({inputs:{x:s},backend:t,attrs:{shape:[i,o]}}),l=Y_(a,!1,t),u=Nt({inputs:{x:l},backend:t,attrs:{shape:s.shape}});return t.disposeIntermediateTensorInfo(a),t.disposeIntermediateTensorInfo(l),u}const jQ={kernelName:Gw,backendName:"cpu",kernelFunc:GQ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yS(n){const{backend:e,attrs:t}=n,{shape:s,value:r,dtype:o}=t,i=o||lu(r),a=Qt(i,fe(s));return KQ(a,r,i),e.makeTensorInfo(s,i,a)}const HQ={kernelName:jw,backendName:"cpu",kernelFunc:yS};function KQ(n,e,t){n.fill(e)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qQ={kernelName:Hw,backendName:"cpu",kernelFunc:({inputs:n,attrs:e,backend:t})=>{const{image:s}=n,r=t,o=Fn(s.dtype,fe(s.shape)),[i,a,l,u]=s.shape,h=r.data.get(s.dataId).values;for(let f=0;f<i;f++){const m=f*l*a*u;for(let y=0;y<a;y++){const x=y*(l*u);for(let v=0;v<l;v++){const w=v*u;for(let S=0;S<u;S++){const k=Math.round(l-v-1),T=m+x+w+S;let I=h[T];if(k>=0&&k<l){const E=k*u,D=m+x+E+S;I=h[D]}o[T]=I}}}}return{dataId:r.write(o,s.shape,s.dtype),shape:s.shape,dtype:s.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function XQ(n){const{inputs:e,backend:t,attrs:s}=n,{x:r,filter:o,bias:i,preluActivationWeights:a}=e,{strides:l,pad:u,dataFormat:h,dilations:p,dimRoundingMode:f,activation:m,leakyreluAlpha:y}=s;let x=q_({inputs:{x:r,filter:o},backend:t,attrs:{strides:l,pad:u,dataFormat:h,dilations:p,dimRoundingMode:f}});if(i){const v=x;if(h==="NCHW"&&i.shape.length===1&&i.shape[0]!==1){const w=Nt({inputs:{x:i},backend:t,attrs:{shape:[i.shape[0],1,1]}});x=Jl({inputs:{a:x,b:w},backend:t}),t.disposeIntermediateTensorInfo(w)}else x=Jl({inputs:{a:x,b:i},backend:t});t.disposeIntermediateTensorInfo(v)}if(m){const v=x;if(h==="NCHW"&&m==="prelu"&&a.shape.length===1&&a.shape[0]!==1){const w=Nt({inputs:{x:a},backend:t,attrs:{shape:[a.shape[0],1,1]}});x=Hf(t,x,m,w,y),t.disposeIntermediateTensorInfo(w)}else x=Hf(t,x,m,a,y);t.disposeIntermediateTensorInfo(v)}return x}const YQ={kernelName:Nf,backendName:"cpu",kernelFunc:XQ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function QQ(n){const{inputs:e,backend:t,attrs:s}=n,{x:r,filter:o,bias:i,preluActivationWeights:a}=e,{strides:l,pad:u,dataFormat:h,dilations:p,dimRoundingMode:f,activation:m,leakyreluAlpha:y}=s;let x=X_({inputs:{x:r,filter:o},backend:t,attrs:{strides:l,pad:u,dataFormat:h,dilations:p,dimRoundingMode:f}});if(i){const v=x;x=Jl({inputs:{a:x,b:i},backend:t}),t.disposeIntermediateTensorInfo(v)}if(m){const v=x;x=Hf(t,x,m,a,y),t.disposeIntermediateTensorInfo(v)}return x}const ZQ={kernelName:If,backendName:"cpu",kernelFunc:QQ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function JQ(n){const{inputs:e,backend:t}=n,{params:s,indices:r}=e,o=fe(s.shape),i=r.shape,a=i[i.length-1],[l,u,h,p]=wb(s,r);if(u===0)return t.makeTensorInfo(l,s.dtype,[]);const f=t.data.get(r.dataId).values,m=t.bufferSync(s),y=i_(f,m,s.dtype,u,a,h,p,s.shape,o);return t.makeTensorInfo(l,s.dtype,y.values)}const eZ={kernelName:Kw,backendName:"cpu",kernelFunc:JQ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tZ(n){const{inputs:e,backend:t,attrs:s}=n,{x:r,indices:o}=e,{axis:i,batchDims:a}=s;Fe([r,o],"gatherV2");const l=it(i,r.shape)[0],u=t.data.get(o.dataId).values,h=r.shape[l];for(let T=0;T<u.length;++T){const I=u[T];L(I<=h-1&&I>=0,()=>`GatherV2: the index value ${I} is not in [0, ${h-1}]`)}let p=a;a==null&&(p=0);const f=fe(o.shape),m=CD(r,o,l,p),y=Nt({inputs:{x:r},backend:t,attrs:{shape:[m.batchSize,m.outerSize,m.dimSize,m.sliceSize]}}),x=Nt({inputs:{x:o},backend:t,attrs:{shape:[m.batchSize,f/m.batchSize]}}),v=[m.batchSize,m.outerSize,f/m.batchSize,m.sliceSize],w=t.bufferSync(x),S=t.bufferSync(y),k=a_(S,w,v);return t.disposeIntermediateTensorInfo(y),t.disposeIntermediateTensorInfo(x),t.makeTensorInfo(m.outputShape,k.dtype,k.values)}const nZ={kernelName:Am,backendName:"cpu",kernelFunc:tZ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sZ(n){const{inputs:e,backend:t}=n,{input:s}=e,r=fe(s.shape),o=s.shape[s.shape.length-1],i=r/o,a=Nt({inputs:{x:s},backend:t,attrs:{shape:[i,o]}}),l=Y_(a,!0,t),u=Nt({inputs:{x:l},backend:t,attrs:{shape:s.shape}});return t.disposeIntermediateTensorInfo(a),t.disposeIntermediateTensorInfo(l),u}const rZ={kernelName:qw,backendName:"cpu",kernelFunc:sZ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const oZ=wt(Ch,n=>Number.isFinite(n)?1:0,"bool"),iZ={kernelName:Ch,backendName:"cpu",kernelFunc:oZ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const aZ=wt(kh,n=>Math.abs(n)===1/0?1:0,"bool"),lZ={kernelName:kh,backendName:"cpu",kernelFunc:aZ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const uZ=wt(Th,n=>Number.isNaN(n)?1:0,"bool"),cZ={kernelName:Th,backendName:"cpu",kernelFunc:uZ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hZ(n){const{backend:e,attrs:t}=n,{start:s,stop:r,num:o}=t,i=d_(s,r,o);return e.makeTensorInfo([i.length],"float32",i)}const dZ={kernelName:Yw,backendName:"cpu",kernelFunc:hZ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pZ=wt(Ih,n=>Math.log1p(n)),fZ={kernelName:Ih,backendName:"cpu",kernelFunc:pZ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mZ=tn((n,e)=>n&&e),gZ=vn(Lm,mZ,null,"bool"),yZ={kernelName:Lm,backendName:"cpu",kernelFunc:gZ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xZ=wt(Mm,n=>n?0:1,"bool"),vZ={kernelName:Mm,backendName:"cpu",kernelFunc:xZ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wZ=tn((n,e)=>n||e),bZ=vn(zm,wZ,null,"bool"),SZ={kernelName:zm,backendName:"cpu",kernelFunc:bZ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function CZ(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{depthRadius:o,bias:i,alpha:a,beta:l}=s;Fe(r,"LRN");const u=r.shape[3],h=u-1,p=t.data.get(r.dataId).values,f=fe(r.shape),m=new Float32Array(f);function y(x){const v=x%u;let w=x-v+Math.max(0,v-o);const S=x-v+Math.min(v+o,h);let k=0;for(;w<=S;w++){const T=p[w];k+=T*T}return k}for(let x=0;x<f;x++){const v=y(x),w=p[x]*Math.pow(i+a*v,-l);m[x]=w}return t.makeTensorInfo(r.shape,r.dtype,m)}const kZ={kernelName:Vm,backendName:"cpu",kernelFunc:CZ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function TZ(n){const{inputs:e,backend:t,attrs:s}=n,{x:r,y:o,dy:i}=e,{depthRadius:a,bias:l,alpha:u,beta:h}=s;Fe(i,"LRNGrad");const p=fe(i.shape),f=i.shape[3],m=t.data.get(i.dataId).values,y=t.data.get(r.dataId).values,x=t.data.get(o.dataId).values,v=new Float32Array(p),w=p;for(let S=0;S<w;S++){const k=S%f,T=S-k+Math.max(0,k-a),I=S-k+Math.min(f,k+a+1);let E=0;for(let D=T;D<I;D++)E+=Math.pow(y[D],2);E=u*E+l;for(let D=T;D<I;D++){let O=-2*u*h*y[D]*x[S]/E;S===D&&(O+=Math.pow(E,-h)),O*=m[S],v[D]+=O}}return t.makeTensorInfo(i.shape,r.dtype,v)}const NZ={kernelName:Qw,backendName:"cpu",kernelFunc:TZ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Q_(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{reductionIndices:o,keepDims:i}=s,a=t;let l=r.shape;const u=l.length,h=it(o,l);let p=h;const f=zt(p,u);let m=a.data.get(r.dataId).values;if(f!=null){const T=new Array(u);for(let I=0;I<T.length;I++)T[I]=l[f[I]];m=dS(m,l,r.dtype,f,T),p=Jt(p.length,u),l=T}Fe(r,"max"),Mn("max",p,u);const[y,x]=In(l,p),v=fe(x),w=f_(m,v,y,r.dtype),S=a.write(w,y,r.dtype);let k=y;return i&&(k=Zt(y,h)),{dataId:S,shape:k,dtype:r.dtype}}const IZ={kernelName:Bm,backendName:"cpu",kernelFunc:Q_};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $Z(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e;Fe(r,"maxPool");const{filterSize:o,strides:i,pad:a,dimRoundingMode:l}=s,u=1;L(Ln(i,u),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${i} and dilations '${u}'`);const h=yr(r.shape,o,i,u,a,l);let p;if(h.filterWidth===1&&h.filterHeight===1&&ct(h.inShape,h.outShape))p=uo({inputs:{x:r},backend:t});else{const f=t.data.get(r.dataId).values,m=Be(r.shape),y=mS(f,r.shape,r.dtype,m,h,"max");p=t.makeTensorInfo(h.outShape,r.dtype,y.values)}return p}const EZ={kernelName:Wm,backendName:"cpu",kernelFunc:$Z};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function RZ(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{filterSize:o,strides:i,pad:a,dimRoundingMode:l,dataFormat:u}=s;Fe(r,"maxPool3d");const h=Lo(r.shape,o,i,1,a,l,u),p=t.data.get(r.dataId).values,f=K_(p,r.shape,r.dtype,Be(r.shape),h,"max");return t.makeTensorInfo(f.shape,"float32",f.values)}const DZ={kernelName:Um,backendName:"cpu",kernelFunc:RZ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function AZ(n){const{inputs:e,backend:t,attrs:s}=n,{dy:r,input:o}=e,{filterSize:i,strides:a,pad:l,dimRoundingMode:u}=s;Fe([r,o],"maxPool3DGrad");const h=Lo(o.shape,i,a,1,l,u),p=t.bufferSync(o),f=wY(p,h),m=h.strideDepth,y=h.strideHeight,x=h.strideWidth,v=h.dilationDepth,w=h.dilationHeight,S=h.dilationWidth,k=h.effectiveFilterDepth,T=h.effectiveFilterHeight,I=h.effectiveFilterWidth,E=k-1-h.padInfo.front,D=I-1-h.padInfo.left,O=T-1-h.padInfo.top,_=nt(o.shape,"float32"),P=t.bufferSync(r);for(let R=0;R<h.batchSize;++R)for(let W=0;W<h.inChannels;++W)for(let Q=0;Q<h.inDepth;++Q)for(let ee=0;ee<h.inHeight;++ee)for(let te=0;te<h.inWidth;++te){const oe=Q-E,se=ee-O,G=te-D;let V=0;for(let B=0;B<k;B+=v){const F=(oe+B)/m;if(!(F<0||F>=h.outDepth||Math.floor(F)!==F))for(let z=0;z<T;z+=w){const q=(se+z)/y;if(!(q<0||q>=h.outHeight||Math.floor(q)!==q))for(let re=0;re<I;re+=S){const ue=(G+re)/x;if(ue<0||ue>=h.outWidth||Math.floor(ue)!==ue)continue;const pe=k*T*I-1-f.get(R,F,q,ue,W),he=B*T*I+z*I+re,xe=pe===he?1:0;if(xe===0)continue;const ge=P.get(R,F,q,ue,W);V+=ge*xe}}}_.set(V,R,Q,ee,te,W)}return t.makeTensorInfo(_.shape,_.dtype,_.values)}const OZ={kernelName:Jw,backendName:"cpu",kernelFunc:AZ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _Z(n){const{inputs:e,backend:t,attrs:s}=n,{dy:r,input:o,output:i}=e,a=o;Fe([o,i],"maxPoolGrad");const{filterSize:l,strides:u,pad:h,dimRoundingMode:p}=s,f=yr(a.shape,l,u,1,h,p),m=t.data.get(a.dataId).values,y=nt(f.outShape,a.dtype,H_(m,a.shape,a.dtype,f).values),x=f.strideHeight,v=f.strideWidth,w=f.dilationHeight,S=f.dilationWidth,k=f.effectiveFilterHeight,T=f.effectiveFilterWidth,I=T-1-f.padInfo.left,E=k-1-f.padInfo.top,D=nt(a.shape,"float32"),O=t.data.get(r.dataId).values,_=nt(r.shape,"float32",O);for(let P=0;P<f.batchSize;++P)for(let R=0;R<f.inChannels;++R)for(let W=0;W<f.inHeight;++W)for(let Q=0;Q<f.inWidth;++Q){const ee=W-E,te=Q-I;let oe=0;for(let se=0;se<k;se+=w){const G=(ee+se)/x;if(!(G<0||G>=f.outHeight||Math.floor(G)!==G))for(let V=0;V<T;V+=S){const B=(te+V)/v;if(B<0||B>=f.outWidth||Math.floor(B)!==B)continue;const F=k*T-1-y.get(P,G,B,R),z=se*T+V,q=F===z?1:0;if(q===0)continue;const re=_.get(P,G,B,R);oe+=re*q}}D.set(oe,P,W,Q,R)}return t.makeTensorInfo(D.shape,D.dtype,D.values)}const FZ={kernelName:Zw,backendName:"cpu",kernelFunc:_Z};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function PZ(n,e,t,s,r){const o=Be(e),i=mS(n,e,t,o,r,"max"),a=H_(n,e,t,r,!0,s);return[i.values,a.values]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const LZ={kernelName:e1,backendName:"cpu",kernelFunc:({inputs:n,attrs:e,backend:t})=>{const{x:s}=n,{filterSize:r,strides:o,pad:i,includeBatchInIndex:a}=e,l=t;Fe(s,"MaxPoolWithArgmax");const u=l.data.get(s.dataId).values,h=yr(s.shape,r,o,[1,1],i),[p,f]=PZ(u,s.shape,s.dtype,a,h),m=l.write(p,h.outShape,s.dtype),y=l.write(f,h.outShape,s.dtype);return[{dataId:m,shape:h.outShape,dtype:s.dtype},{dataId:y,shape:h.outShape,dtype:"int32"}]}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function MZ(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{axis:o,keepDims:i}=s,a=it(o,r.shape),u=In(r.shape,a)[1],h=fe(u),p=[],f=t.makeTensorInfo([],"float32",new Float32Array([h]));p.push(f);const m=$i({inputs:{x:r},backend:t,attrs:{dtype:"float32"}});p.push(m);const y=gS({inputs:{a:m,b:f},backend:t});p.push(y);const x=gd({inputs:{x:y},backend:t,attrs:{axis:o,keepDims:i}});return p.forEach(v=>t.disposeIntermediateTensorInfo(v)),x}const zZ={kernelName:Gm,backendName:"cpu",kernelFunc:MZ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function VZ(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{axis:o,keepDims:i}=s;Fe(r,"min");const a=it(o,r.shape);let l=a;const u=zt(l,r.shape.length);let h=r;u!=null&&(h=ms({inputs:{x:r},backend:t,attrs:{perm:u}}),l=Jt(l.length,r.shape.length)),Mn("min",l,h.shape.length);const[p,f]=In(h.shape,l),m=fe(f),y=Kn(fe(p),h.dtype),x=t.data.get(h.dataId).values;for(let w=0;w<y.length;++w){const S=w*m;let k=x[S];for(let T=0;T<m;++T){const I=x[S+T];(Number.isNaN(I)||I<k)&&(k=I)}y[w]=k}u!=null&&t.disposeIntermediateTensorInfo(h);const v=t.makeTensorInfo(p,h.dtype,y);if(i){const w=Zt(p,a),S=Nt({inputs:{x:v},backend:t,attrs:{shape:w}});return t.disposeIntermediateTensorInfo(v),S}return v}const BZ={kernelName:jm,backendName:"cpu",kernelFunc:VZ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function WZ(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{paddings:o,mode:i}=s;Fe(r,"mirrorPad");const a=o.map((k,T)=>k[0]+r.shape[T]+k[1]),l=o.map(k=>k[0]),u=o.map((k,T)=>k[0]+r.shape[T]),h=i==="reflect"?0:1,p=t.data.get(r.dataId).values,f=r.shape.length,m=Be(r.shape),y=fe(a),x=a.length,v=Be(a),w=Fn(r.dtype,y);for(let k=0;k<y;k++){let T=uu(k,x,v);for(let E=0;E<x;E++)T[E]<l[E]?T[E]=l[E]*2-T[E]-h:T[E]>=u[E]&&(T[E]=(u[E]-1)*2-T[E]+h);T=T.map((E,D)=>E-l[D]);const I=eo(T,f,m);w[k]=p[I]}return{dataId:t.write(w,a,r.dtype),shape:a,dtype:r.dtype}}const UZ={kernelName:Hm,backendName:"cpu",kernelFunc:WZ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const GZ=tn(((n,e)=>{const t=n%e;return n<0&&e<0||n>=0&&e>=0?t:(t+e)%e})),jZ=vn(Rh,GZ),HZ={kernelName:Rh,backendName:"cpu",kernelFunc:jZ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Z_(n){const{inputs:e,backend:t,attrs:s}=n,{logits:r}=e,{dim:o}=s,i=r.shape.length;let a=o;if(a===-1&&(a=i-1),a!==i-1)throw Error(`Softmax along a non-last dimension is not yet supported. Logits was rank ${i} and dim was ${a}`);const l=it([a],r.shape),u=Q_({inputs:{x:r},backend:t,attrs:{reductionIndices:l,keepDims:!1}}),h=Zt(u.shape,l),p=Nt({inputs:{x:u},backend:t,attrs:{shape:h}}),f=fS({inputs:{a:r,b:p},backend:t}),m=n_({inputs:{x:f},backend:t}),y=gd({inputs:{x:m},backend:t,attrs:{axis:l,keepDims:!1}}),x=Nt({inputs:{x:y},backend:t,attrs:{shape:h}}),v=gS({inputs:{a:m,b:x},backend:t});return t.disposeIntermediateTensorInfo(u),t.disposeIntermediateTensorInfo(p),t.disposeIntermediateTensorInfo(f),t.disposeIntermediateTensorInfo(m),t.disposeIntermediateTensorInfo(y),t.disposeIntermediateTensorInfo(x),v}const KZ={kernelName:cg,backendName:"cpu",kernelFunc:Z_};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qZ(n){const{inputs:e,backend:t,attrs:s}=n,{logits:r}=e,{numSamples:o,seed:i,normalized:a}=s;Fe(r,"multinomial");const l=a?r:Z_({inputs:{logits:r},backend:t,attrs:{dim:-1}}),u=l.shape[0],h=l.shape[1],p=t.data.get(l.dataId).values,f=[u,o],m=Kn(fe(f),"int32");for(let y=0;y<u;++y){const x=y*h,v=new Float32Array(h-1);v[0]=p[x];for(let k=1;k<v.length;++k)v[k]=v[k-1]+p[x+k];const w=$g.alea(i.toString()),S=y*o;for(let k=0;k<o;++k){const T=w();m[S+k]=v.length;for(let I=0;I<v.length;I++)if(T<v[I]){m[S+k]=I;break}}}return a||t.disposeIntermediateTensorInfo(l),t.makeTensorInfo(f,"int32",m)}const XZ={kernelName:t1,backendName:"cpu",kernelFunc:qZ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const YZ=pb;function QZ(n){const{inputs:e,backend:t,attrs:s}=n,{boxes:r,scores:o}=e,{maxOutputSize:i,iouThreshold:a,scoreThreshold:l}=s;Fe(r,"NonMaxSuppression");const u=t.data.get(r.dataId).values,h=t.data.get(o.dataId).values,{selectedIndices:p}=YZ(u,h,i,a,l);return t.makeTensorInfo([p.length],"int32",new Int32Array(p))}const ZZ={kernelName:n1,backendName:"cpu",kernelFunc:QZ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const JZ=fb;function eJ(n){const{inputs:e,backend:t,attrs:s}=n,{boxes:r,scores:o}=e,{maxOutputSize:i,iouThreshold:a,scoreThreshold:l,padToMaxOutputSize:u}=s;Fe(r,"NonMaxSuppressionPadded");const h=t.data.get(r.dataId).values,p=t.data.get(o.dataId).values,{selectedIndices:f,validOutputs:m}=JZ(h,p,i,a,l,u);return[t.makeTensorInfo([f.length],"int32",new Int32Array(f)),t.makeTensorInfo([],"int32",new Int32Array([m]))]}const tJ={kernelName:s1,backendName:"cpu",kernelFunc:eJ};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nJ=mb;function sJ(n){const{inputs:e,backend:t,attrs:s}=n,{boxes:r,scores:o}=e,{maxOutputSize:i,iouThreshold:a,scoreThreshold:l,softNmsSigma:u}=s;Fe(r,"NonMaxSuppressionWithScore");const h=t.data.get(r.dataId).values,p=t.data.get(o.dataId).values,f=i,m=a,y=l,x=u,{selectedIndices:v,selectedScores:w}=nJ(h,p,f,m,y,x);return[t.makeTensorInfo([v.length],"int32",new Int32Array(v)),t.makeTensorInfo([w.length],"float32",new Float32Array(w))]}const rJ={kernelName:r1,backendName:"cpu",kernelFunc:sJ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oJ(n){const{inputs:e,backend:t,attrs:s}=n,{indices:r}=e,{dtype:o,depth:i,onValue:a,offValue:l}=s;Fe(r,"oneHot");const u=fe(r.shape),h=new Float32Array(u*i);h.fill(l);const p=t.data.get(r.dataId).values;for(let f=0;f<u;++f)p[f]>=0&&p[f]<i&&(h[f*i+p[f]]=a);return t.makeTensorInfo([...r.shape,i],o,h)}const iJ={kernelName:Ym,backendName:"cpu",kernelFunc:oJ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qf(n){const{inputs:e,backend:t}=n,{x:s}=e;if(s.dtype==="string")throw new Error("zerosLike is not supported for string tensors");if(s.dtype==="complex64"){const r=_a({inputs:{input:s},backend:t}),o=qf({inputs:{x:r},backend:t}),i=eu({inputs:{input:s},backend:t}),a=qf({inputs:{x:i},backend:t}),l=Is({inputs:{real:o,imag:a},backend:t});return t.disposeIntermediateTensorInfo(r),t.disposeIntermediateTensorInfo(o),t.disposeIntermediateTensorInfo(i),t.disposeIntermediateTensorInfo(a),l}else return yS({backend:t,attrs:{shape:s.shape,value:0,dtype:s.dtype}})}const aJ={kernelName:fg,backendName:"cpu",kernelFunc:qf};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function J_(n){const{inputs:e,backend:t}=n,{x:s}=e;if(s.dtype==="string")throw new Error("onesLike is not supported for string tensors");if(s.dtype==="complex64"){const r=_a({inputs:{input:s},backend:t}),o=J_({inputs:{x:r},backend:t}),i=eu({inputs:{input:s},backend:t}),a=qf({inputs:{x:i},backend:t}),l=Is({inputs:{real:o,imag:a},backend:t});return t.disposeIntermediateTensorInfo(r),t.disposeIntermediateTensorInfo(o),t.disposeIntermediateTensorInfo(i),t.disposeIntermediateTensorInfo(a),l}else return yS({backend:t,attrs:{shape:s.shape,value:1,dtype:s.dtype}})}const lJ={kernelName:Xm,backendName:"cpu",kernelFunc:J_};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eF(n){const{inputs:e,backend:t,attrs:s}=n,{axis:r}=s;if(e.length===1)return Kf({inputs:{input:e[0]},backend:t,attrs:{dim:r}});const o=e[0].shape,i=e[0].dtype;e.forEach(h=>{Ls(o,h.shape,"All tensors passed to stack must have matching shapes"),L(i===h.dtype,()=>"All tensors passed to stack must have matching dtypes")});const a=[],l=e.map(h=>{const p=Kf({inputs:{input:h},backend:t,attrs:{dim:r}});return a.push(p),p}),u=tu({inputs:l,backend:t,attrs:{axis:r}});return a.forEach(h=>t.disposeIntermediateTensorInfo(h)),u}const uJ={kernelName:Qm,backendName:"cpu",kernelFunc:eF};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cJ(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{paddings:o,constantValue:i}=s;Fe(r,"pad");const a=o.map((S,k)=>S[0]+r.shape[k]+S[1]),l=o.map(S=>S[0]),u=t.data.get(r.dataId).values,h=fe(r.shape),p=r.shape.length,f=Be(r.shape),m=fe(a),y=a.length,x=Be(a),v=Fn(r.dtype,m);i!==0&&v.fill(i);for(let S=0;S<h;S++){const T=uu(S,p,f).map((E,D)=>E+l[D]),I=eo(T,y,x);v[I]=u[S]}return{dataId:t.write(v,a,r.dtype),shape:a,dtype:r.dtype}}const tF={kernelName:Zm,backendName:"cpu",kernelFunc:cJ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hJ=tn((n,e)=>Math.pow(n,e)),dJ=vn(Ah,hJ),pJ={kernelName:Ah,backendName:"cpu",kernelFunc:dJ};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fJ(n){const{inputs:e,backend:t,attrs:s}=n,{paramsNestedSplits:r,paramsDenseValues:o,indices:i}=e,{outputRaggedRank:a}=s,l=r.map(w=>t.data.get(w.dataId).values),u=r.map(w=>w.shape),h=t.data.get(o.dataId).values,p=t.data.get(i.dataId).values,[f,m,y]=w_(l,u,h,o.shape,o.dtype,p,i.shape),x=f.map(w=>t.makeTensorInfo([w.length],"int32",w)),v=t.makeTensorInfo(y,o.dtype,m);return x.concat([v])}const mJ={kernelName:o1,backendName:"cpu",kernelFunc:fJ};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gJ(n){const{inputs:e,backend:t}=n,{starts:s,limits:r,deltas:o}=e,i=t.data.get(s.dataId).values,a=t.data.get(r.dataId).values,l=t.data.get(o.dataId).values,[u,h]=b_(i,s.shape,s.dtype,a,r.shape,l,o.shape),p=t.makeTensorInfo([u.length],"int32",u),f=t.makeTensorInfo([h.length],s.dtype,h);return[p,f]}const yJ={kernelName:i1,backendName:"cpu",kernelFunc:gJ};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xJ(n){const{inputs:e,backend:t,attrs:s}=n,{shape:r,values:o,defaultValue:i,rowPartitionTensors:a}=e,{rowPartitionTypes:l}=s,u=t.data.get(r.dataId).values,h=t.data.get(o.dataId).values,p=t.data.get(i.dataId).values,f=a.map(v=>t.data.get(v.dataId).values),m=a.map(v=>v.shape),[y,x]=S_(u,r.shape,h,o.shape,o.dtype,p,i.shape,f,m,l);return t.makeTensorInfo(y,o.dtype,x)}const vJ={kernelName:a1,backendName:"cpu",kernelFunc:xJ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wJ(n){const{backend:e,attrs:t}=n,{start:s,stop:r,dtype:o,step:i}=t,a=C_(s,r,i,o);return e.makeTensorInfo([a.length],o,a)}const bJ={kernelName:l1,backendName:"cpu",kernelFunc:wJ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const SJ=wt(Oh,n=>1/n),CJ={kernelName:Oh,backendName:"cpu",kernelFunc:SJ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kJ(n){const{inputs:e,backend:t,attrs:s}=n,{images:r}=e,{alignCorners:o,halfPixelCenters:i,size:a}=s;Fe(r,"resizeBilinear");const l=Be(r.shape),[u,h]=a,[p,f,m,y]=r.shape,x=t.data.get(r.dataId).values,v=new Float32Array(fe([p,u,h,y])),w=[o&&u>1?f-1:f,o&&h>1?m-1:m],S=[o&&u>1?u-1:u,o&&h>1?h-1:h];let k=0;const T=w[0]/S[0],I=w[1]/S[1];for(let E=0;E<p;E++)for(let D=0;D<u;D++){let O;i?O=T*(D+.5)-.5:O=T*D;const _=Math.max(0,Math.floor(O)),P=O-_,R=Math.min(f-1,Math.ceil(O)),W=E*l[0]+_*l[1],Q=E*l[0]+R*l[1];for(let ee=0;ee<h;ee++){let te;i?te=I*(ee+.5)-.5:te=I*ee;const oe=Math.max(0,Math.floor(te)),se=te-oe,G=Math.min(m-1,Math.ceil(te)),V=W+oe*l[2],B=Q+oe*l[2],F=W+G*l[2],z=Q+G*l[2];for(let q=0;q<y;q++){const re=x[V+q],ue=x[B+q],pe=x[F+q],he=x[z+q],xe=re+(pe-re)*se,ge=ue+(he-ue)*se,Ie=xe+(ge-xe)*P;v[k++]=Ie}}}return t.makeTensorInfo([p,u,h,y],"float32",v)}const TJ={kernelName:sg,backendName:"cpu",kernelFunc:kJ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function NJ(n){const{inputs:e,backend:t,attrs:s}=n,{images:r,dy:o}=e,{alignCorners:i}=s;Fe([o,r],"resizeBilinearGrad");const a=Be(r.shape),[l,u,h,p]=r.shape,[,f,m]=o.shape,y=new Float32Array(l*u*h*p),x=[i&&f>1?u-1:u,i&&m>1?h-1:h],v=[i&&f>1?f-1:f,i&&m>1?m-1:m],w=x[0]/v[0],S=x[1]/v[1],k=t.data.get(o.dataId).values;let T=0;for(let I=0;I<l;I++){const E=I*a[0];for(let D=0;D<f;D++){const O=D*w,_=Math.floor(O),P=Math.min(Math.ceil(O),u-1),R=E+_*a[1],W=E+P*a[1],Q=O-_,ee=1-Q;for(let te=0;te<m;te++){const oe=te*S,se=Math.floor(oe),G=Math.min(Math.ceil(oe),h-1),V=oe-se,B=1-V,F=R+se*a[2],z=R+G*a[2],q=W+se*a[2],re=W+G*a[2],ue=ee*B,pe=ee*V,he=Q*B,xe=Q*V;for(let ge=0;ge<p;ge++){const Ie=k[T++];y[F+ge]+=Ie*ue,y[z+ge]+=Ie*pe,y[q+ge]+=Ie*he,y[re+ge]+=Ie*xe}}}}return t.makeTensorInfo([l,h,u,p],"float32",y)}const IJ={kernelName:h1,backendName:"cpu",kernelFunc:NJ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $J(n){const{inputs:e,backend:t,attrs:s}=n,{images:r}=e,{alignCorners:o,halfPixelCenters:i,size:a}=s;Fe(r,"resizeNearestNeighbor");const l=Be(r.shape),[u,h]=a,[p,f,m,y]=r.shape,x=t.data.get(r.dataId).values,v=new Float32Array(p*u*h*y),w=[o&&u>1?f-1:f,o&&h>1?m-1:m],S=[o&&u>1?u-1:u,o&&h>1?h-1:h],k=w[0]/S[0],T=w[1]/S[1];let I=0;for(let E=0;E<p;E++){const D=E*l[0];for(let O=0;O<u;O++){const _=i?k*(O+.5):k*O;let P=Math.min(f-1,o?Math.round(_):Math.floor(_));i&&(P=Math.max(0,P));const R=D+P*l[1];for(let W=0;W<h;W++){const Q=i?T*(W+.5):T*W;let ee=Math.min(m-1,o?Math.round(Q):Math.floor(Q));i&&(ee=Math.max(0,ee));const te=R+ee*l[2];for(let oe=0;oe<y;oe++){const se=x[te+oe];v[I++]=se}}}}return t.makeTensorInfo([p,u,h,y],r.dtype,v)}const EJ={kernelName:ng,backendName:"cpu",kernelFunc:$J};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function RJ(n){const{inputs:e,backend:t,attrs:s}=n,{images:r,dy:o}=e,{alignCorners:i}=s;Fe([o,r],"resizeNearestNeighborGrad");const a=Be(r.shape),l=Be(o.shape),[u,h,p,f]=r.shape,[,m,y]=o.shape,x=new Float32Array(u*h*p*f),v=t.data.get(o.dataId).values,w=[i&&m>1?h-1:h,i&&y>1?p-1:p],S=[i&&m>1?m-1:m,i&&y>1?y-1:y],k=w[0]/S[0],T=w[1]/S[1],I=1/k,E=1/T,D=Math.ceil(I)*2+2,O=Math.ceil(E)*2+2;for(let _=0;_<u;_++){const P=_*a[0];for(let R=0;R<h;R++){const W=P+R*a[1],Q=Math.floor(R*I),ee=Math.floor(Q-D/2);for(let te=0;te<p;te++){const oe=W+te*a[2],se=Math.floor(te*E),G=Math.floor(se-O/2);for(let V=0;V<f;V++){let B=0;for(let F=0;F<D;F++){const z=F+ee;if(z<0||z>=m)continue;const q=P+z*l[1],re=z*k,ue=Math.min(h-1,i?Math.round(re):Math.floor(re));if(R===ue)for(let pe=0;pe<O;pe++){const he=pe+G;if(he<0||he>=y)continue;const xe=q+he*l[2],ge=he*T,Ie=Math.min(p-1,i?Math.round(ge):Math.floor(ge));te===Ie&&(B+=v[xe+V])}}x[oe+V]=B}}}}return t.makeTensorInfo(r.shape,r.dtype,x)}const DJ={kernelName:c1,backendName:"cpu",kernelFunc:RJ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function AJ(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{dims:o}=s;Fe(r,"reverse");const i=r.shape.length,a=it(o,r.shape);if(i===0)return uo({inputs:{x:r},backend:t});const l=new mn(r.shape,r.dtype),u=t.bufferSync(r);for(let h=0;h<l.size;h++){const p=l.indexToLoc(h),f=p.slice();a.forEach(m=>f[m]=r.shape[m]-1-f[m]),l.set(u.get(...f),...p)}return t.makeTensorInfo(l.shape,l.dtype,l.values)}const OJ={kernelName:rg,backendName:"cpu",kernelFunc:AJ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _J={kernelName:$1,backendName:"cpu",kernelFunc:({inputs:n,attrs:e,backend:t})=>{const{image:s}=n,{radians:r,fillValue:o,center:i}=e,a=t,l=Fn(s.dtype,fe(s.shape)),[u,h,p,f]=s.shape,[m,y]=kb(i,h,p),x=255,v=Math.sin(r),w=Math.cos(r),S=a.data.get(s.dataId).values;for(let T=0;T<u;T++){const I=T*p*h*f;for(let E=0;E<h;E++){const D=E*(p*f);for(let O=0;O<p;O++){const _=O*f;for(let P=0;P<f;P++){const R=[u,E,O,P],W=R[2],Q=R[1];let ee=(W-m)*w-(Q-y)*v,te=(W-m)*v+(Q-y)*w;ee=Math.round(ee+m),te=Math.round(te+y);let oe=o;if(typeof o!="number"&&(P===3?oe=x:oe=o[P]),ee>=0&&ee<p&&te>=0&&te<h){const G=te*(p*f),V=ee*f,B=I+G+V+P;oe=S[B]}const se=I+D+_+P;l[se]=oe}}}}return{dataId:a.write(l,s.shape,s.dtype),shape:s.shape,dtype:s.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const FJ=wt(Ph,n=>{const e=Math.floor(n);return n-e<.5?Math.floor(n):n-e>.5?Math.ceil(n):e%2===0?e:e+1}),PJ={kernelName:Ph,backendName:"cpu",kernelFunc:FJ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function LJ(n){const{inputs:e,backend:t,attrs:s}=n,{indices:r,updates:o}=e,{shape:i}=s,{sliceRank:a,numUpdates:l,sliceSize:u,strides:h,outputSize:p}=Ua(o,r,i),f=!0,m=t.bufferSync(r),y=t.bufferSync(o),x=ga(m,y,i,p,u,l,a,h,0,f);return t.makeTensorInfo(i,x.dtype,x.values)}const MJ={kernelName:d1,backendName:"cpu",kernelFunc:LJ};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zJ(n,e){let t=0,s=n.length,r=0;for(;t<s;)r=Math.floor((t+s)/2),n[r]<e?t=r+1:s=r;return s}function VJ(n,e){let t=0,s=n.length,r=0;for(;t<s;)r=Math.floor((t+s)/2),n[r]<=e?t=r+1:s=r;return s}function BJ(n,e,t,s,r,o){const i=Qt("int32",t*r);for(let a=0;a<t;++a){const l=n.slice(a*s,(a+1)*s),u=a*r;for(let h=0;h<r;++h)i[u+h]=o==="left"?zJ(l,e[h+u]):VJ(l,e[h+u])}return i}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function WJ(n){const{inputs:e,backend:t,attrs:s}=n,{sortedSequence:r,values:o}=e,{side:i}=s,a=t.data.get(r.dataId).values,l=t.data.get(o.dataId).values,u=BJ(a,l,r.shape[0],r.shape[1],o.shape[1],i);return t.makeTensorInfo(o.shape,"int32",u)}const UJ={kernelName:f1,backendName:"cpu",kernelFunc:WJ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function GJ(n){const{inputs:e,backend:t}=n,{condition:s,t:r,e:o}=e;Fe([s,r,o],"select");const i=s.shape.length,a=t.data.get(s.dataId).values,l=t.data.get(r.dataId).values,u=t.data.get(o.dataId).values,h=Ds(r.dtype,o.dtype),p=Kn(fe(r.shape),h);let f=0;const m=i===0||i>1||r.shape.length===1?1:fe(r.shape.slice(1));for(let y=0;y<a.length;y++)for(let x=0;x<m;x++)a[y]===1?p[f++]=l[y]:p[f++]=u[y];return t.makeTensorInfo(r.shape,h,p)}const jJ={kernelName:og,backendName:"cpu",kernelFunc:GJ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const HJ=zg,KJ=Vg,qJ=wt(Mh,n=>n>=0?KJ*n:HJ*(Math.exp(n)-1)),XJ={kernelName:Mh,backendName:"cpu",kernelFunc:qJ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const YJ=wt(Bh,n=>n<0?-1:n>0?1:0),QJ={kernelName:Bh,backendName:"cpu",kernelFunc:YJ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ZJ=wt(zh,n=>Math.sin(n)),JJ={kernelName:zh,backendName:"cpu",kernelFunc:ZJ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const eee=wt(Vh,n=>Math.sinh(n)),tee={kernelName:Vh,backendName:"cpu",kernelFunc:eee};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nee=11920928955078125e-23,kI=Math.log(nee)+2,see=wt(Uh,n=>{const e=n>-kI,t=n<kI,s=Math.exp(n);let r;return t?r=s:e?r=n:r=Math.log(1+s),r}),ree={kernelName:Uh,backendName:"cpu",kernelFunc:see};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oee(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{blockShape:o,paddings:i}=s;Fe([r],"spaceToBatchND");const a=fe(o),l=[[0,0]];l.push(...i);for(let E=1+o.length;E<r.shape.length;++E)l.push([0,0]);const u=tF.kernelFunc({inputs:{x:r},backend:t,attrs:{paddings:l,constantValue:0}}),h=od(u.shape,o,a,!1),p=id(h.length,o.length,!1),f=ad(u.shape,o,a,!1),x=Nt({inputs:{x:u},backend:t,attrs:{shape:h}}),S=ms({inputs:{x},backend:t,attrs:{perm:p}}),I=Nt({inputs:{x:S},backend:t,attrs:{shape:f}});return t.disposeIntermediateTensorInfo(u),t.disposeIntermediateTensorInfo(x),t.disposeIntermediateTensorInfo(S),I}const iee={kernelName:lg,backendName:"cpu",kernelFunc:oee};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aee(n){const{inputs:e,backend:t}=n,{indices:s,values:r,denseShape:o,defaultValue:i}=e;if(o.shape.length!==1)throw new Error(`Dense shape must be a vector, saw:
        ${o.shape}`);if(s.shape.length!==2)throw new Error(`Indices must be a matrix, saw:
        ${s.shape}`);if(r.shape.length!==1)throw new Error(`Values must be a vector, saw:
        ${r.shape}`);if(i.shape.length!==0)throw new Error(`Default value must be a scalar, saw:
        ${i.shape}`);const a=t.data.get(s.dataId).values,l=t.data.get(r.dataId).values,u=t.data.get(o.dataId).values,h=t.data.get(i.dataId).values[0],[p,f,m,y,x]=I_(a,s.shape,s.dtype,l,r.dtype,u,h);return[t.makeTensorInfo(f,s.dtype,p),t.makeTensorInfo([f[0]],r.dtype,m),t.makeTensorInfo([y.length],"bool",new Uint8Array(y.map(v=>Number(v)))),t.makeTensorInfo([x.length],s.dtype,new Int32Array(x))]}const lee={kernelName:m1,backendName:"cpu",kernelFunc:aee};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uee(n){const{inputs:e,backend:t}=n,{inputIndices:s,inputShape:r,newShape:o}=e;if(s.shape.length!==2)throw new Error(`Input indices should be a matrix but received shape
        ${s.shape}`);if(r.shape.length!==1)throw new Error(`Input shape should be a vector but received shape
        ${r.shape}`);if(o.shape.length!==1)throw new Error(`Target shape should be a vector but received shape ${o.shape}`);const i=Array.from(t.data.get(r.dataId).values),a=t.data.get(s.dataId).values,l=Array.from(t.data.get(o.dataId).values),[u,h,p]=$_(a,s.shape,s.dtype,i,l);return[t.makeTensorInfo(h,s.dtype,u),t.makeTensorInfo([p.length],o.dtype,new Int32Array(p))]}const cee={kernelName:g1,backendName:"cpu",kernelFunc:uee};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hee(n){const{inputs:e,backend:t}=n,{data:s,indices:r,segmentIds:o}=e;if(s.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(r.shape.length!==1)throw new Error(`Indices should be a vector but received shape
          ${r.shape}`);if(o.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
          ${o.shape}`);if(r.shape[0]!==o.shape[0])throw new Error("segmentIds and indices should have same size.");const i=t.data.get(s.dataId).values,a=t.data.get(r.dataId).values,l=t.data.get(o.dataId).values,[u,h]=pS(i,s.shape,s.dtype,a,l,!0);return t.makeTensorInfo(h,s.dtype,u)}const dee={kernelName:y1,backendName:"cpu",kernelFunc:hee};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pee(n){const{inputs:e,backend:t}=n,{data:s,indices:r,segmentIds:o}=e;if(s.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(r.shape.length!==1)throw new Error(`Indices should be a vector but received shape
         ${r.shape}`);if(o.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
         ${o.shape}`);if(r.shape[0]!==o.shape[0])throw new Error("segmentIds and indices should have same size.");const i=t.data.get(s.dataId).values,a=t.data.get(r.dataId).values,l=t.data.get(o.dataId).values,[u,h]=pS(i,s.shape,s.dtype,a,l);return t.makeTensorInfo(h,s.dtype,u)}const fee={kernelName:x1,backendName:"cpu",kernelFunc:pee};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mee(n){const{inputs:e,backend:t,attrs:s}=n,{sparseIndices:r,sparseValues:o,defaultValue:i}=e,{outputShape:a}=s,{sliceRank:l,numUpdates:u,sliceSize:h,strides:p,outputSize:f}=Ua(o,r,a),m=!1,y=t.bufferSync(r);let x;switch(o.dtype){case"bool":{const v=t.bufferSync(o),w=!!t.data.get(i.dataId).values[0];x=ga(y,v,a,f,h,u,l,p,w,m);break}case"float32":{const v=t.bufferSync(o),w=t.data.get(i.dataId).values[0];x=ga(y,v,a,f,h,u,l,p,w,m);break}case"int32":{const v=t.bufferSync(o),w=t.data.get(i.dataId).values[0];x=ga(y,v,a,f,h,u,l,p,w,m);break}case"string":{const v=t.bufferSync(o),w=vi(t.data.get(i.dataId).values[0]);x=ga(y,v,a,f,h,u,l,p,w,m);break}default:throw new Error(`Unsupported type ${o.dtype}`)}return t.makeTensorInfo(a,x.dtype,x.values)}const gee={kernelName:v1,backendName:"cpu",kernelFunc:mee};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yee(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{numOrSizeSplits:o,axis:i}=s,a=it(i,r.shape)[0],l=zb(r,o,a),u=new Array(r.shape.length).fill(0),h=r.shape.slice();return l.map(p=>{const f=[...h];f[a]=p;const m=Fa({inputs:{x:r},backend:t,attrs:{begin:u,size:f}});return u[a]+=p,m})}const xee={kernelName:ug,backendName:"cpu",kernelFunc:yee};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vee={kernelName:w1,backendName:"cpu",kernelFunc:({inputs:n,backend:e})=>{const{x:t}=n,s=e;Fe(t,"square");const r=s.data.get(t.dataId).values,o=new Float32Array(r.length);for(let a=0;a<r.length;++a){const l=r[a];o[a]=l*l}return{dataId:s.write(o,t.shape,t.dtype),shape:t.shape,dtype:t.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wee=wt(Yh,(n,e)=>{const t=e;return isNaN(n)?NaN:n>0?1:t.alpha}),bee={kernelName:Yh,backendName:"cpu",kernelFunc:wee};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function See(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{begin:o,end:i,strides:a,beginMask:l,endMask:u,ellipsisMask:h,newAxisMask:p,shrinkAxisMask:f}=s;Fe(r,"stridedSlice");const{finalShapeSparse:m,finalShape:y,isIdentity:x,sliceDim0:v,isSimpleSlice:w,begin:S,end:k,strides:T}=eD(r.shape,o,i,a,l,u,h,p,f);let I;if(x)I=Nt({inputs:{x:r},backend:t,attrs:{shape:y}});else if(v||w){L(r.shape.length>=1,()=>`Input must have rank at least 1, got: ${r.shape.length}`);const E=QR(S,k,T),D=Fa({inputs:{x:r},backend:t,attrs:{begin:S,size:E}});I=Nt({inputs:{x:D},backend:t,attrs:{shape:y}}),t.disposeIntermediateTensorInfo(D)}else{const E=t.bufferSync(r),D=D_(m,E,T,S);I=t.makeTensorInfo(y,D.dtype,D.values)}return I}const Cee={kernelName:b1,backendName:"cpu",kernelFunc:See};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kee(n){const{inputs:e,backend:t,attrs:s}=n,{separator:r,nGramWidths:o,leftPad:i,rightPad:a,padWidth:l,preserveShortSequences:u}=s,{data:h,dataSplits:p}=e,f=t.data.get(h.dataId).values,m=t.data.get(p.dataId).values,[y,x]=A_(f,m,r,o,i,a,l,u);return[t.makeTensorInfo([y.length],"string",y),t.makeTensorInfo(p.shape,"int32",x)]}const Tee={kernelName:S1,backendName:"cpu",kernelFunc:kee};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Nee(n){const{inputs:e,backend:t,attrs:s}=n,{skipEmpty:r}=s,{input:o,delimiter:i}=e;if(o.dtype!=="string")throw new Error("Input must be of datatype string");if(o.shape.length!==1)throw new Error(`Input must be a vector, got shape: ${o.shape}`);if(i.shape.length!==0)throw new Error(`Delimiter must be a scalar, got shape: ${i.shape}`);const a=t.data.get(o.dataId).values,l=t.data.get(i.dataId).values[0],[u,h,p]=O_(a,l,r),f=h.length;return[t.makeTensorInfo([f,2],"int32",u),t.makeTensorInfo([f],"string",h),t.makeTensorInfo([2],"int32",new Int32Array(p))]}const Iee={kernelName:C1,backendName:"cpu",kernelFunc:Nee};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $ee(n){const{inputs:e,backend:t,attrs:s}=n,{numBuckets:r}=s,{input:o}=e;if(o.dtype!=="string")throw new Error("Input must be of datatype string");if(r<=0)throw new Error("Number of buckets must be at least 1");const i=t.data.get(o.dataId).values,a=__(i,r);return t.makeTensorInfo(o.shape,"int32",a)}const Eee={kernelName:k1,backendName:"cpu",kernelFunc:$ee};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ree=wt(Kh,n=>Math.tan(n)),Dee={kernelName:Kh,backendName:"cpu",kernelFunc:Ree};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Aee=wt(qh,n=>Math.tanh(n)),Oee={kernelName:qh,backendName:"cpu",kernelFunc:Aee};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _ee(n){const{inputs:e,backend:t}=n,{tensor:s,indices:r,updates:o}=e,{sliceRank:i,numUpdates:a,sliceSize:l,strides:u,outputSize:h}=Ua(o,r,s.shape),p=!1,f=t.bufferSync(r),m=t.bufferSync(o),y=t.bufferSync(s),x=ga(f,m,s.shape,h,l,a,i,u,y,p);return t.makeTensorInfo(s.shape,x.dtype,x.values)}const Fee={kernelName:p1,backendName:"cpu",kernelFunc:_ee};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pee(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{reps:o}=s;Fe(r,"tile");const i=P_(t.bufferSync(r),o);return t.makeTensorInfo(i.shape,i.dtype,i.values)}const Lee={kernelName:Xh,backendName:"cpu",kernelFunc:Pee};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mee(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{k:o,sorted:i}=s;Fe(r,"topk");const a=t.data.get(r.dataId).values,[l,u]=M_(a,r.shape,r.dtype,o,i);return[t.makeTensorInfo(l.shape,l.dtype,l.values),t.makeTensorInfo(u.shape,u.dtype,u.values)]}const zee={kernelName:T1,backendName:"cpu",kernelFunc:Mee};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vee(n){const{inputs:e,attrs:t,backend:s}=n,{image:r,transforms:o}=e,{interpolation:i,fillMode:a,fillValue:l,outputShape:u}=t,[h,p,f,m]=r.shape,[y,x]=u??[p,f],v=[h,y,x,m],w=Be(r.shape),S=w[0],k=w[1],T=w[2],I=Be(v),E=I[0],D=I[1],O=I[2],_=Fn(r.dtype,fe(v));_.fill(l);const P=s.data.get(r.dataId).values,R=s.data.get(o.dataId).values;for(let Q=0;Q<h;++Q){const ee=o.shape[0]===1?R:R.subarray(Q*8,Q*8+8);for(let te=0;te<y;++te)for(let oe=0;oe<x;++oe)for(let se=0;se<m;++se){let G;const V=ee[6]*oe+ee[7]*te+1;if(V===0)continue;const B=(ee[0]*oe+ee[1]*te+ee[2])/V,F=(ee[3]*oe+ee[4]*te+ee[5])/V,z=TI(B,f,a),q=TI(F,p,a);switch(i){case"nearest":G=Hee(P,p,f,S,k,T,Q,q,z,se,l);break;case"bilinear":G=Kee(P,p,f,S,k,T,Q,q,z,se,l);break;default:throw new Error(`Error in Transform: Expect 'nearest' or 'bilinear', but got ${i}`)}const re=Q*E+te*D+oe*O+se;_[re]=G}return s.makeTensorInfo(v,r.dtype,_)}return{dataId:s.write(_,v,r.dtype),shape:r.shape,dtype:r.dtype}}const Bee={kernelName:N1,backendName:"cpu",kernelFunc:Vee};function TI(n,e,t){switch(t){case"reflect":return Wee(n,e);case"wrap":return Uee(n,e);case"nearest":return jee(n,e);case"constant":default:return Gee(n)}}function Wee(n,e){let t=n;if(t<0)if(e<=1)t=0;else{const s=2*e;t<s&&(t=s*Math.trunc(-t/s)+t),t=t<-e?t+s:-t-1}else if(t>e-1)if(e<=1)t=0;else{const s=2*e;t-=s*Math.trunc(t/s),t>=e&&(t=s-t-1)}return bw(0,t,e-1)}function Uee(n,e){let t=n;if(t<0)if(e<=1)t=0;else{const s=e-1;t+=e*(Math.trunc(-t/s)+1)}else if(t>e-1)if(e<=1)t=0;else{const s=e-1;t-=e*Math.trunc(t/s)}return bw(0,t,e-1)}function Gee(n,e){return n}function jee(n,e){return bw(0,n,e-1)}function Sc(n,e,t,s,r,o,i,a,l,u,h){const p=i*s+a*r+l*o+u;return 0<=a&&a<e&&0<=l&&l<t?n[p]:h}function Hee(n,e,t,s,r,o,i,a,l,u,h){const p=Math.round(a),f=Math.round(l);return Sc(n,e,t,s,r,o,i,p,f,u,h)}function Kee(n,e,t,s,r,o,i,a,l,u,h){const p=Math.floor(a),f=Math.floor(l),m=p+1,y=f+1,x=(y-l)*Sc(n,e,t,s,r,o,i,p,f,u,h)+(l-f)*Sc(n,e,t,s,r,o,i,p,y,u,h),v=(y-l)*Sc(n,e,t,s,r,o,i,m,f,u,h)+(l-f)*Sc(n,e,t,s,r,o,i,m,y,u,h);return(m-a)*x+(a-p)*v}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qee(n){const{inputs:e,attrs:t,backend:s}=n,{axis:r}=t,{x:o}=e;Fe(o,"unique");const i=s.data.get(o.dataId).values,{outputValues:a,outputShape:l,indices:u}=z_(i,r,o.shape,o.dtype);return[s.makeTensorInfo(l,o.dtype,a),s.makeTensorInfo([u.length],"int32",u)]}const Xee={kernelName:I1,backendName:"cpu",kernelFunc:qee};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Yee(n){const{inputs:e,backend:t,attrs:s}=n,{value:r}=e;let{axis:o}=s;o<0&&(o+=r.shape.length);const i=r.shape.length,a=r.shape[o],l=new Array(i-1);let u=0;for(let m=0;m<i;m++)m!==o&&(l[u++]=r.shape[m]);const h=new Array(i).fill(0),p=r.shape.slice();p[o]=1;const f=new Array(a);for(let m=0;m<f.length;m++){h[o]=m;const y=Fa({inputs:{x:r},backend:t,attrs:{begin:h,size:p}});f[m]=Nt({inputs:{x:y},backend:t,attrs:{shape:l}}),t.disposeIntermediateTensorInfo(y)}return f}const Qee={kernelName:dg,backendName:"cpu",kernelFunc:Yee};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zee(n){const{inputs:e,backend:t,attrs:s}=n,{x:r,segmentIds:o}=e,{numSegments:i}=s;Fe(r,"unsortedSegmentSum");const a=r.shape.length,l=o.shape.length,u=[],h=[],p=a-l;let f=o;for(let y=0;y<p;++y){const x=Kf({inputs:{input:f},backend:t,attrs:{dim:y+1}});f=x,h.push(x)}for(let y=0;y<i;++y){const x=_i(y,"int32"),v=t.makeTensorInfo([],"int32",x),w=e_({inputs:{a:v,b:f},backend:t}),S=$i({inputs:{x:w},backend:t,attrs:{dtype:"float32"}}),k=Zg({inputs:{a:S,b:r},backend:t}),T=gd({inputs:{x:k},backend:t,attrs:{axis:0,keepDims:!1}});u.push(T),h.push(v),h.push(w),h.push(S),h.push(k),h.push(T)}const m=eF({inputs:u,backend:t,attrs:{axis:0}});return h.forEach(y=>t.disposeIntermediateTensorInfo(y)),m}const Jee={kernelName:pg,backendName:"cpu",kernelFunc:Zee};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ete=[q9,$7,Y9,Z9,_7,eY,nY,rY,iY,lY,cY,dY,fY,yY,vY,SY,kY,NY,$Y,H9,RY,AY,_Y,P7,PY,A7,M7,MY,E7,VY,WY,UY,jY,KY,XY,QY,JY,tQ,sQ,oQ,aQ,uQ,hQ,pQ,fQ,gQ,xQ,wQ,bQ,SQ,CQ,TQ,$Q,z9,RQ,z7,MQ,V7,zQ,W7,jQ,HQ,qQ,G7,H7,YQ,ZQ,eZ,nZ,q7,Y7,R7,rZ,BY,iZ,lZ,cZ,V9,Z7,e9,dZ,n9,fZ,yZ,vZ,SZ,kZ,NZ,IZ,r9,EZ,DZ,OZ,FZ,LZ,zZ,BZ,i9,UZ,HZ,XZ,l9,c9,ZZ,tJ,rJ,d9,iJ,lJ,uJ,tF,pJ,W9,m9,mJ,yJ,vJ,bJ,D7,zv,CJ,U9,G9,j9,TJ,IJ,EJ,DJ,OJ,_J,PJ,C9,MJ,UJ,jJ,XJ,T9,QJ,JJ,tee,N9,KZ,ree,iee,lee,cee,dee,fee,gee,xee,E9,vee,D9,O9,bee,Cee,Tee,Iee,Eee,L9,NQ,Dee,Oee,Fee,Lee,zee,Bee,p9,Xee,Qee,Jee,aJ];for(const n of ete)J2(n);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fa={},Wp={alpha:!1,antialias:!1,premultipliedAlpha:!1,preserveDrawingBuffer:!1,depth:!1,stencil:!1,failIfMajorPerformanceCaveat:!0};function tte(n,e){fa[n]=e}function Vr(n,e){if(!(n in fa)||e!=null){const s=ste(n,e);if(s!==null)fa[n]=s;else return console.log("Could not get context for WebGL version",n),null}const t=fa[n];return t==null||t.isContextLost()?(delete fa[n],Vr(n)):(t.disable(t.DEPTH_TEST),t.disable(t.STENCIL_TEST),t.disable(t.BLEND),t.disable(t.DITHER),t.disable(t.POLYGON_OFFSET_FILL),t.disable(t.SAMPLE_COVERAGE),t.enable(t.SCISSOR_TEST),t.enable(t.CULL_FACE),t.cullFace(t.BACK),fa[n])}function nte(n){if(!ae().getBool("IS_SAFARI")&&typeof OffscreenCanvas<"u"&&n===2)return new OffscreenCanvas(300,150);if(typeof document<"u")return document.createElement("canvas");throw new Error("Cannot create a canvas in this context")}function ste(n,e){if(n!==1&&n!==2)throw new Error("Cannot get WebGL rendering context, WebGL is disabled.");const t=e??nte(n);return t.addEventListener("webglcontextlost",s=>{s.preventDefault(),delete fa[n]},!1),ae().getBool("SOFTWARE_WEBGL_ENABLED")&&(Wp.failIfMajorPerformanceCaveat=!1),n===1?t.getContext("webgl",Wp)||t.getContext("experimental-webgl",Wp):t.getContext("webgl2",Wp)}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var Wc;(function(n){n[n.DENSE=0]="DENSE",n[n.SHARED_BATCH=1]="SHARED_BATCH"})(Wc||(Wc={}));var Gs;(function(n){n[n.RENDER=0]="RENDER",n[n.UPLOAD=1]="UPLOAD",n[n.PIXELS=2]="PIXELS",n[n.DOWNLOAD=3]="DOWNLOAD"})(Gs||(Gs={}));var On;(function(n){n[n.UNPACKED_FLOAT16=0]="UNPACKED_FLOAT16",n[n.UNPACKED_FLOAT32=1]="UNPACKED_FLOAT32",n[n.PACKED_4X1_UNSIGNED_BYTE=2]="PACKED_4X1_UNSIGNED_BYTE",n[n.PACKED_2X2_FLOAT32=3]="PACKED_2X2_FLOAT32",n[n.PACKED_2X2_FLOAT16=4]="PACKED_2X2_FLOAT16"})(On||(On={}));function yd(n,e){return[e,n]}function rte(n,e){return n*e}function Up(n){const e=fe(n),t=Math.ceil(e/4);return Kx(t)}function yu(n,e){return[Math.max(1,Math.ceil(e/2)),Math.max(1,Math.ceil(n/2))]}function ote(n,e){const[t,s]=yu(n,e);return t*s*4}function xS(n,e){const t=n;let s,r,o,i,a,l,u,h,p,f;return ae().getNumber("WEBGL_VERSION")===2?(s=t.R32F,r=t.R16F,o=t.RGBA16F,i=t.RGBA32F,a=t.RED,u=4,h=1,p=t.HALF_FLOAT,f=t.FLOAT,l=t.RGBA8):(s=n.RGBA,r=n.RGBA,o=n.RGBA,i=t.RGBA,a=n.RGBA,u=4,h=4,p=e!=null?e.HALF_FLOAT_OES:null,f=n.FLOAT,l=n.RGBA),{internalFormatFloat:s,internalFormatHalfFloat:r,internalFormatPackedHalfFloat:o,internalFormatPackedFloat:i,textureFormatFloat:a,downloadTextureFormat:l,downloadUnpackNumChannels:u,defaultNumChannels:h,textureTypeHalfFloat:p,textureTypeFloat:f}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $e(n,e){const t=e();return ae().getBool("DEBUG")&&ite(n),t}function ite(n){const e=n.getError();if(e!==n.NO_ERROR)throw new Error("WebGL Error: "+cte(n,e))}const ate=596e-10,lte=65504;function ute(n){return!!(ae().getBool("WEBGL_RENDER_FLOAT32_ENABLED")||n===0||ate<Math.abs(n)&&Math.abs(n)<lte)}function cte(n,e){switch(e){case n.NO_ERROR:return"NO_ERROR";case n.INVALID_ENUM:return"INVALID_ENUM";case n.INVALID_VALUE:return"INVALID_VALUE";case n.INVALID_OPERATION:return"INVALID_OPERATION";case n.INVALID_FRAMEBUFFER_OPERATION:return"INVALID_FRAMEBUFFER_OPERATION";case n.OUT_OF_MEMORY:return"OUT_OF_MEMORY";case n.CONTEXT_LOST_WEBGL:return"CONTEXT_LOST_WEBGL";default:return`Unknown error code ${e}`}}function Gp(n,e){return Bo(n,()=>n.getExtension(e),'Extension "'+e+'" not supported on this browser.')}function hte(n,e){const t=Bo(n,()=>n.createShader(n.VERTEX_SHADER),"Unable to create vertex WebGLShader.");if($e(n,()=>n.shaderSource(t,e)),$e(n,()=>n.compileShader(t)),n.getShaderParameter(t,n.COMPILE_STATUS)===!1)throw console.log(n.getShaderInfoLog(t)),new Error("Failed to compile vertex shader.");return t}function dte(n,e){const t=Bo(n,()=>n.createShader(n.FRAGMENT_SHADER),"Unable to create fragment WebGLShader.");if($e(n,()=>n.shaderSource(t,e)),$e(n,()=>n.compileShader(t)),ae().get("ENGINE_COMPILE_ONLY"))return t;if(n.getShaderParameter(t,n.COMPILE_STATUS)===!1)throw nF(e,n.getShaderInfoLog(t)),new Error("Failed to compile fragment shader.");return t}const pte=/ERROR: [0-9]+:([0-9]+):/g;function nF(n,e){const t=pte.exec(e);if(t==null){console.log(`Couldn't parse line number in error: ${e}`),console.log(n);return}const s=+t[1],r=n.split(`
`),o=r.length.toString().length+2,i=r.map((p,f)=>Pl((f+1).toString(),o)+p);let a=0;for(let p=0;p<i.length;p++)a=Math.max(i[p].length,a);const l=i.slice(0,s-1),u=i.slice(s-1,s),h=i.slice(s);console.log(l.join(`
`)),console.log(e.split(`
`)[0]),console.log(`%c ${Pl(u[0],a)}`,"border:1px solid red; background-color:#e3d2d2; color:#a61717"),console.log(h.join(`
`))}function fte(n){return Bo(n,()=>n.createProgram(),"Unable to create WebGLProgram.")}function mte(n,e){if($e(n,()=>n.linkProgram(e)),!ae().get("ENGINE_COMPILE_ONLY")&&n.getProgramParameter(e,n.LINK_STATUS)===!1)throw console.log(n.getProgramInfoLog(e)),new Error("Failed to link vertex and fragment shaders.")}function wx(n,e){if($e(n,()=>n.validateProgram(e)),n.getProgramParameter(e,n.VALIDATE_STATUS)===!1)throw console.log(n.getProgramInfoLog(e)),new Error("Shader program validation failed.")}function gte(n,e){const t=Bo(n,()=>n.createBuffer(),"Unable to create WebGLBuffer");return $e(n,()=>n.bindBuffer(n.ARRAY_BUFFER,t)),$e(n,()=>n.bufferData(n.ARRAY_BUFFER,e,n.STATIC_DRAW)),t}function yte(n,e){const t=Bo(n,()=>n.createBuffer(),"Unable to create WebGLBuffer");return $e(n,()=>n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,t)),$e(n,()=>n.bufferData(n.ELEMENT_ARRAY_BUFFER,e,n.STATIC_DRAW)),t}function xte(n){return Bo(n,()=>n.createTexture(),"Unable to create WebGLTexture.")}function vte(n,e){const t=ae().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(n<=0||e<=0){const s=`[${n}x${e}]`;throw new Error("Requested texture size "+s+" is invalid.")}if(n>t||e>t){const s=`[${n}x${e}]`,r=`[${t}x${t}]`;throw new Error("Requested texture size "+s+" greater than WebGL maximum on this browser / GPU "+r+".")}}function wte(n){return Bo(n,()=>n.createFramebuffer(),"Unable to create WebGLFramebuffer.")}function NI(n,e,t,s,r,o,i){const a=n.getAttribLocation(e,t);return a===-1?!1:($e(n,()=>n.bindBuffer(n.ARRAY_BUFFER,s)),$e(n,()=>n.vertexAttribPointer(a,r,n.FLOAT,!1,o,i)),$e(n,()=>n.enableVertexAttribArray(a)),!0)}function bte(n,e,t){Nte(n,t),$e(n,()=>n.activeTexture(n.TEXTURE0+t)),$e(n,()=>n.bindTexture(n.TEXTURE_2D,e))}function Ste(n,e,t){return Bo(n,()=>n.getUniformLocation(e,t),'uniform "'+t+'" not present in program.')}function Cte(n,e,t){return n.getUniformLocation(e,t)}function kte(n,e,t,s){$e(n,()=>bte(n,e,s)),$e(n,()=>n.uniform1i(t,s))}function bx(n,e,t){$e(n,()=>n.bindFramebuffer(n.FRAMEBUFFER,t)),$e(n,()=>n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,e,0))}function II(n,e){$e(n,()=>n.bindFramebuffer(n.FRAMEBUFFER,e)),$e(n,()=>n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,null,0))}function jp(n){const e=n.checkFramebufferStatus(n.FRAMEBUFFER);if(e!==n.FRAMEBUFFER_COMPLETE)throw new Error("Error binding framebuffer: "+Tte(n,e))}function Tte(n,e){switch(e){case n.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_ATTACHMENT";case n.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT";case n.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:return"FRAMEBUFFER_INCOMPLETE_DIMENSIONS";case n.FRAMEBUFFER_UNSUPPORTED:return"FRAMEBUFFER_UNSUPPORTED";default:return`unknown error ${e}`}}function Bo(n,e,t){const s=$e(n,()=>e());if(s==null)throw new Error(t);return s}function Nte(n,e){const t=n.MAX_COMBINED_TEXTURE_IMAGE_UNITS-1,s=e+n.TEXTURE0;if(s<n.TEXTURE0||s>t){const r=`[gl.TEXTURE0, gl.TEXTURE${t}]`;throw new Error(`textureUnit must be in ${r}.`)}}function nu(n,e=2){return fe(n.slice(0,n.length-e))}function su(n){if(n.length===0)throw Error("Cannot get rows and columns of an empty shape array.");return[n.length>1?n[n.length-2]:1,n[n.length-1]]}function Hp(n){let e=[1,1,1];return n.length===0||n.length===1&&n[0]===1||(e=[nu(n),...su(n)]),e}function Ite(n,e=!1){let t=ae().getNumber("WEBGL_MAX_TEXTURE_SIZE"),s=ae().getNumber("WEBGL_MAX_SIZE_FOR_NARROW_TEXTURE");s===1/0&&ae().getBool("WEBGL_AUTO_SQUARIFY_NARROW_TEXTURE_SHAPE")&&(s=t/2),e&&(t=t*2,s=s*2,n=n.map((a,l)=>l>=n.length-2?Sw(n[l]):n[l]),n.length===1&&(n=[2,n[0]])),n.length!==2&&(n=Oi(n).newShape);let r=fe(n),o=null;n.length<=1&&r<=t?o=[1,r]:n.length===2&&n[0]<=t&&n[1]<=t?o=n:n.length===3&&n[0]*n[1]<=t&&n[2]<=t?o=[n[0]*n[1],n[2]]:n.length===3&&n[0]<=t&&n[1]*n[2]<=t?o=[n[0],n[1]*n[2]]:n.length===4&&n[0]*n[1]*n[2]<=t&&n[3]<=t?o=[n[0]*n[1]*n[2],n[3]]:n.length===4&&n[0]<=t&&n[1]*n[2]*n[3]<=t&&(o=[n[0],n[1]*n[2]*n[3]]);const i=o!=null&&Math.max(...o)>s&&Math.min(...o)<=(e?2:1)&&Math.min(...o)>0;if(o==null||i)if(e){const a=nu(n);let l=2,u=2;n.length&&([l,u]=su(n)),r=a*(l/2)*(u/2),o=Kx(r).map(h=>h*2)}else o=Kx(r);return o}function Kp(n){return n%2===0}function Xf(n,e){if(n=n.slice(-2),e=e.slice(-2),ct(n,e)||!n.length||!e.length||n[0]===0||n[1]===0||e[0]===0||e[1]===0)return!0;if(n.length!==e.length){const t=n[n.length-1],s=e[e.length-1];if(t===s||Kp(t)&&Kp(s)&&(n[0]===1||e[0]===1))return!0}return n[1]===e[1]&&Kp(n[0])&&Kp(e[0])}let Sx,Cx;function $te(n){if(Sx==null){const e=Vr(n);Sx=e.getParameter(e.MAX_TEXTURE_SIZE)}return Sx}function Ete(n){if(Cx==null){const e=Vr(n);Cx=e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS)}return Math.min(16,Cx)}function Rte(n){if(n===0)return 0;let e;const t=Vr(n);return lr(t,"EXT_disjoint_timer_query_webgl2")&&n===2?e=2:lr(t,"EXT_disjoint_timer_query")?e=1:e=0,e}function lr(n,e){return n.getExtension(e)!=null}function $I(n){try{if(Vr(n)!=null)return!0}catch(e){return console.log("Error when getting WebGL context: ",e),!1}return!1}function Dte(n){if(n===0)return!1;const e=Vr(n);if(n===1){if(!lr(e,"OES_texture_float"))return!1}else if(!lr(e,"EXT_color_buffer_float"))return!1;return Bv(e)}function Ate(n){if(n===0)return!1;const e=Vr(n);if(n===1){if(!lr(e,"OES_texture_float")||!lr(e,"WEBGL_color_buffer_float"))return!1}else{if(lr(e,"EXT_color_buffer_float"))return Bv(e);const s="EXT_color_buffer_half_float";if(lr(e,s)){const r=e.getExtension(s);return Ote(e,r)}return!1}return Bv(e)}function Bv(n){const e=xS(n),t=n.createTexture();n.bindTexture(n.TEXTURE_2D,t),n.texImage2D(n.TEXTURE_2D,0,e.internalFormatFloat,1,1,0,e.textureFormatFloat,e.textureTypeFloat,null);const o=n.createFramebuffer();n.bindFramebuffer(n.FRAMEBUFFER,o),n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,t,0);const i=n.checkFramebufferStatus(n.FRAMEBUFFER)===n.FRAMEBUFFER_COMPLETE;return n.bindTexture(n.TEXTURE_2D,null),n.bindFramebuffer(n.FRAMEBUFFER,null),n.deleteTexture(t),n.deleteFramebuffer(o),i}function Ote(n,e){const t=xS(n,e),s=n.createTexture();n.bindTexture(n.TEXTURE_2D,s),n.texImage2D(n.TEXTURE_2D,0,t.internalFormatHalfFloat,1,1,0,t.textureFormatFloat,t.textureTypeHalfFloat,null);const i=n.createFramebuffer();n.bindFramebuffer(n.FRAMEBUFFER,i),n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,s,0);const a=n.checkFramebufferStatus(n.FRAMEBUFFER)===n.FRAMEBUFFER_COMPLETE;return n.bindTexture(n.TEXTURE_2D,null),n.bindFramebuffer(n.FRAMEBUFFER,null),n.deleteTexture(s),n.deleteFramebuffer(i),a}function _te(n){return n!==2?!1:Vr(n).fenceSync!=null}function xd(n,e){Array.isArray(n)||(n=[n]),n.forEach(t=>{t!=null&&L(t.dtype!=="complex64",()=>`${e} does not support complex64 tensors in the WebGL backend.`)})}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Me=ae();Me.registerFlag("HAS_WEBGL",()=>Me.getNumber("WEBGL_VERSION")>0);Me.registerFlag("WEBGL_VERSION",()=>$I(2)?2:$I(1)?1:0);Me.registerFlag("WEBGL_CHECK_NUMERICAL_PROBLEMS",()=>!1);Me.registerFlag("WEBGL_BUFFER_SUPPORTED",()=>Me.get("WEBGL_VERSION")===2);Me.registerFlag("WEBGL_CPU_FORWARD",()=>!0);Me.registerFlag("WEBGL_FORCE_F16_TEXTURES",()=>!1);Me.registerFlag("WEBGL_PACK",()=>Me.getBool("HAS_WEBGL"));Me.registerFlag("WEBGL_PACK_NORMALIZATION",()=>Me.getBool("WEBGL_PACK"));Me.registerFlag("WEBGL_PACK_CLIP",()=>Me.getBool("WEBGL_PACK"));Me.registerFlag("WEBGL_PACK_DEPTHWISECONV",()=>Me.getBool("WEBGL_PACK"));Me.registerFlag("WEBGL_PACK_BINARY_OPERATIONS",()=>Me.getBool("WEBGL_PACK"));Me.registerFlag("WEBGL_PACK_UNARY_OPERATIONS",()=>Me.getBool("WEBGL_PACK"));Me.registerFlag("WEBGL_PACK_ARRAY_OPERATIONS",()=>Me.getBool("WEBGL_PACK"));Me.registerFlag("WEBGL_PACK_IMAGE_OPERATIONS",()=>Me.getBool("WEBGL_PACK"));Me.registerFlag("WEBGL_PACK_REDUCE",()=>Me.getBool("WEBGL_PACK"));Me.registerFlag("WEBGL_LAZILY_UNPACK",()=>Me.getBool("WEBGL_PACK"));Me.registerFlag("WEBGL_CONV_IM2COL",()=>Me.getBool("WEBGL_PACK"));Me.registerFlag("WEBGL_PACK_CONV2DTRANSPOSE",()=>Me.getBool("WEBGL_PACK"));Me.registerFlag("WEBGL_MAX_TEXTURE_SIZE",()=>$te(Me.getNumber("WEBGL_VERSION")));Me.registerFlag("WEBGL_MAX_TEXTURES_IN_SHADER",()=>Ete(Me.getNumber("WEBGL_VERSION")));Me.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION",()=>{const n=Me.getNumber("WEBGL_VERSION");return n===0?0:Rte(n)});Me.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE",()=>Me.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0&&!dE());Me.registerFlag("WEBGL_RENDER_FLOAT32_CAPABLE",()=>Dte(Me.getNumber("WEBGL_VERSION")));Me.registerFlag("WEBGL_RENDER_FLOAT32_ENABLED",()=>Me.getBool("WEBGL_FORCE_F16_TEXTURES")?!1:Me.getBool("WEBGL_RENDER_FLOAT32_CAPABLE"));Me.registerFlag("WEBGL_DOWNLOAD_FLOAT_ENABLED",()=>Ate(Me.getNumber("WEBGL_VERSION")));Me.registerFlag("WEBGL_FENCE_API_ENABLED",()=>_te(Me.getNumber("WEBGL_VERSION")));Me.registerFlag("WEBGL_SIZE_UPLOAD_UNIFORM",()=>Me.getBool("WEBGL_RENDER_FLOAT32_ENABLED")?4:0);Me.registerFlag("WEBGL_DELETE_TEXTURE_THRESHOLD",()=>-1,n=>{if(typeof n!="number")throw new Error(`WEBGL_DELETE_TEXTURE_THRESHOLD must be a number but got ${n}.`);if(n<0&&n!==-1)throw new Error(`WEBGL_DELETE_TEXTURE_THRESHOLD must be -1 (indicating never delete) or at least 0, but got ${n}.`)});Me.registerFlag("WEBGL_FLUSH_THRESHOLD",()=>dE()?1:-1,n=>{if(typeof n!="number")throw new Error(`WEBGL_FLUSH_THRESHOLD must be a number but got ${n}.`);if(n<0&&n!==-1)throw new Error(`WEBGL_FLUSH_THRESHOLD must be -1 (indicating never manual flush) or at least 0, but got ${n}.`)});Me.registerFlag("CPU_HANDOFF_SIZE_THRESHOLD",()=>128);Me.registerFlag("WEBGL_USE_SHAPES_UNIFORMS",()=>!1);Me.registerFlag("TOPK_LAST_DIM_CPU_HANDOFF_SIZE_THRESHOLD",()=>1e5);Me.registerFlag("TOPK_K_CPU_HANDOFF_THRESHOLD",()=>128);Me.registerFlag("WEBGL_EXP_CONV",()=>!1);Me.registerFlag("SOFTWARE_WEBGL_ENABLED",()=>Me.getBool("IS_TEST"));Me.registerFlag("WEBGL_MAX_SIZE_FOR_NARROW_TEXTURE",()=>1/0);Me.registerFlag("WEBGL_AUTO_SQUARIFY_NARROW_TEXTURE_SHAPE",()=>!1);Me.registerFlag("WEBGL2_ISNAN_CUSTOM",()=>!1);Me.registerFlag("ENGINE_COMPILE_ONLY",()=>!1);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function is(){let n,e,t,s,r,o,i,a,l,u;return ae().getNumber("WEBGL_VERSION")===2?(n="#version 300 es",e="in",t="out",s="in",r="texture",o="outputColor",i="out vec4 outputColor;",a=ae().getBool("WEBGL2_ISNAN_CUSTOM")?`
      bool isnan_custom(float val) {
        uint floatToUint = floatBitsToUint(val);
        return (floatToUint & 0x7fffffffu) > 0x7f800000u;
      }

      bvec4 isnan_custom(vec4 val) {
        return bvec4(isnan_custom(val.x),
          isnan_custom(val.y), isnan_custom(val.z), isnan_custom(val.w));
      }

      #define isnan(value) isnan_custom(value)
    `:"",l="",u=`
      #define round(value) newRound(value)
      int newRound(float value) {
        return int(floor(value + 0.5));
      }

      ivec4 newRound(vec4 value) {
        return ivec4(floor(value + vec4(0.5)));
      }
    `):(n="",e="attribute",t="varying",s="varying",r="texture2D",o="gl_FragColor",i="",a=`
      #define isnan(value) isnan_custom(value)
      bool isnan_custom(float val) {
        return (val > 0. || val < 1. || val == 0.) ? false : true;
      }
      bvec4 isnan_custom(vec4 val) {
        return bvec4(isnan(val.x), isnan(val.y), isnan(val.z), isnan(val.w));
      }
    `,l=`
      uniform float INFINITY;

      bool isinf(float val) {
        return abs(val) == INFINITY;
      }
      bvec4 isinf(vec4 val) {
        return equal(abs(val), vec4(INFINITY));
      }
    `,u=`
      int round(float value) {
        return int(floor(value + 0.5));
      }

      ivec4 round(vec4 value) {
        return ivec4(floor(value + vec4(0.5)));
      }
    `),{version:n,attribute:e,varyingVs:t,varyingFs:s,texture2D:r,output:o,defineOutput:i,defineSpecialNaN:a,defineSpecialInf:l,defineRound:u}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ha(n,e,t="index"){const s=Be(e);return s.map((r,o)=>{const i=`int ${n[o]} = ${t} / ${r}`,a=o===s.length-1?`int ${n[o+1]} = ${t} - ${n[o]} * ${r}`:`index -= ${n[o]} * ${r}`;return`${i}; ${a};`}).join("")}function Jg(n,e,t="index"){const s=Be(e);return s.map((r,o)=>{const i=`int ${n[o]} = ${t} / outShapeStrides[${o}]`,a=o===s.length-1?`int ${n[o+1]} = ${t} - ${n[o]} * outShapeStrides[${o}]`:`index -= ${n[o]} * outShapeStrides[${o}]`;return`${i}; ${a};`}).join("")}function Fte(n,e){const t=n.length,s=n.map(o=>`${e}[${o}]`),r=new Array(t-1);r[t-2]=s[t-1];for(let o=t-3;o>=0;--o)r[o]=`(${r[o+1]} * ${s[o+1]})`;return r}function Pte(n,e,t="index"){const s=n.map((o,i)=>i),r=Fte(s,e);return r.map((o,i)=>{const a=`int ${n[i]} = ${t} / ${r[i]}`,l=i===r.length-1?`int ${n[i+1]} = ${t} - ${n[i]} * ${r[i]}`:`index -= ${n[i]} * ${r[i]}`;return`${a}; ${l};`}).join("")}function vS(n){const e=Be(n).map(t=>t.toString());return`
  int getFlatIndex(ivec3 coords) {
    return coords.x * ${e[0]} + coords.y * ${e[1]} + coords.z;
  }
`}function wS(){return`
  int getFlatIndex(ivec3 coords) {
    return coords.x * outShapeStrides[0] + coords.y * outShapeStrides[1] + coords.z;
  }
`}const sF=`
  const float FLOAT_MAX = 1.70141184e38;
  const float FLOAT_MIN = 1.17549435e-38;

  lowp vec4 encode_float(highp float v) {
    if (isnan(v)) {
      return vec4(255, 255, 255, 255);
    }

    highp float av = abs(v);

    if(av < FLOAT_MIN) {
      return vec4(0.0, 0.0, 0.0, 0.0);
    } else if(v > FLOAT_MAX) {
      return vec4(0.0, 0.0, 128.0, 127.0) / 255.0;
    } else if(v < -FLOAT_MAX) {
      return vec4(0.0, 0.0,  128.0, 255.0) / 255.0;
    }

    highp vec4 c = vec4(0,0,0,0);

    highp float e = floor(log2(av));
    highp float m = exp2(fract(log2(av))) - 1.0;

    c[2] = floor(128.0 * m);
    m -= c[2] / 128.0;
    c[1] = floor(32768.0 * m);
    m -= c[1] / 32768.0;
    c[0] = floor(8388608.0 * m);

    highp float ebias = e + 127.0;
    c[3] = floor(ebias / 2.0);
    ebias -= c[3] * 2.0;
    c[2] += floor(ebias) * 128.0;

    c[3] += 128.0 * step(0.0, -v);

    return c / 255.0;
  }
`;/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const{getBroadcastDims:rF}=J6;function Lte(n,e,t){const s=[];if(n.forEach(m=>{const y=fe(m.shapeInfo.logicalShape);if(m.shapeInfo.isUniform?s.push(`uniform float ${m.name}${y>1?`[${y}]`:""};`):(s.push(`uniform sampler2D ${m.name};`),s.push(`uniform int offset${m.name};`)),t.enableShapeUniforms){const{uniformShape:x}=bS(t.packedInputs,m.shapeInfo.logicalShape,m.shapeInfo.texShape);switch(x.length){case 1:s.push(`uniform int ${m.name}Shape;`);break;case 2:s.push(`uniform ivec2 ${m.name}Shape;`);break;case 3:s.push(`uniform ivec3 ${m.name}Shape;`);break;case 4:s.push(`uniform ivec4 ${m.name}Shape;`);break}s.push(`uniform ivec2 ${m.name}TexShape;`)}}),t.enableShapeUniforms){switch(e.logicalShape.length){case 1:s.push("uniform int outShape;");break;case 2:s.push("uniform ivec2 outShape;"),s.push("uniform int outShapeStrides;");break;case 3:s.push("uniform ivec3 outShape;"),s.push("uniform ivec2 outShapeStrides;");break;case 4:s.push("uniform ivec4 outShape;"),s.push("uniform ivec3 outShapeStrides;");break}s.push("uniform ivec2 outTexShape;")}t.customUniforms&&t.customUniforms.forEach(m=>{s.push(`uniform ${m.type} ${m.name}${m.arrayIndex?`[${m.arrayIndex}]`:""};`)});const r=s.join(`
`),o=n.map(m=>Mte(m,e,t.packedInputs,t.enableShapeUniforms)).join(`
`),i=e.texShape,a=is(),l=Bte(a);let u,h,p=Gte(a);return e.isPacked?(u=zte(e.logicalShape,i,t.enableShapeUniforms),h=Ute(a)):(u=Vte(e.logicalShape,i,t.enableShapeUniforms),h=Wte(a)),t.packedInputs&&(p+=qte),[p,l,h,r,u,o,t.userCode].join(`
`)}function xu(n,e=!1){const t=n.shapeInfo.logicalShape;switch(t.length){case 0:return ine(n,e);case 1:return lne(n,e);case 2:return cne(n,e);case 3:return dne(n,e);case 4:return fne(n,e);case 5:return mne(n);case 6:return gne(n);default:throw new Error(`${t.length}-D input sampling is not yet supported`)}}function oF(n,e){switch(n.shapeInfo.logicalShape.length){case 0:return one(n);case 1:return ane(n,e);case 2:return une(n,e);case 3:return hne(n,e);default:return pne(n,e)}}function Mte(n,e,t=!1,s){let r="";t?r+=oF(n,s):r+=xu(n,s);const o=n.shapeInfo.logicalShape,i=e.logicalShape;return o.length<=i.length&&(t?r+=yne(n,e):r+=xne(n,e)),r}function zte(n,e,t){switch(n.length){case 0:return iF();case 1:return Xte(n,e,t);case 2:return sne(n,e,t);case 3:return Qte(n,e,t);default:return Jte(n,e,t)}}function Vte(n,e,t){switch(n.length){case 0:return iF();case 1:return Yte(n,e,t);case 2:return rne(n,e,t);case 3:return Zte(n,e,t);case 4:return ene(n,e,t);case 5:return tne(n,e);case 6:return nne(n,e);default:throw new Error(`${n.length}-D output sampling is not yet supported`)}}function Bte(n){return`
    float sampleTexture(sampler2D textureSampler, vec2 uv) {
      return ${n.texture2D}(textureSampler, uv).r;
    }
  `}function Wte(n){return`
    void setOutput(float val) {
      ${n.output} = vec4(val, 0, 0, 0);
    }
  `}function Ute(n){return`
    void setOutput(vec4 val) {
      ${n.output} = val;
    }
  `}function Gte(n){return`${n.version}
    precision highp float;
    precision highp int;
    precision highp sampler2D;
    ${n.varyingFs} vec2 resultUV;
    ${n.defineOutput}
    const vec2 halfCR = vec2(0.5, 0.5);

    struct ivec5
    {
      int x;
      int y;
      int z;
      int w;
      int u;
    };

    struct ivec6
    {
      int x;
      int y;
      int z;
      int w;
      int u;
      int v;
    };

    uniform float NAN;
    ${n.defineSpecialNaN}
    ${n.defineSpecialInf}
    ${n.defineRound}

    int imod(int x, int y) {
      return x - y * (x / y);
    }

    int idiv(int a, int b, float sign) {
      int res = a / b;
      int mod = imod(a, b);
      if (sign < 0. && mod != 0) {
        res -= 1;
      }
      return res;
    }

    //Based on the work of Dave Hoskins
    //https://www.shadertoy.com/view/4djSRW
    #define HASHSCALE1 443.8975
    float random(float seed){
      vec2 p = resultUV * seed;
      vec3 p3  = fract(vec3(p.xyx) * HASHSCALE1);
      p3 += dot(p3, p3.yzx + 19.19);
      return fract((p3.x + p3.y) * p3.z);
    }

    ${jte}
    ${Hte}
    ${Kte}
  `}const jte=`
vec2 uvFromFlat(int texNumR, int texNumC, int index) {
  int texR = index / texNumC;
  int texC = index - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
vec2 packedUVfrom1D(int texNumR, int texNumC, int index) {
  int texelIndex = index / 2;
  int texR = texelIndex / texNumC;
  int texC = texelIndex - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,Hte=`
vec2 packedUVfrom2D(int texelsInLogicalRow, int texNumR,
  int texNumC, int row, int col) {
  int texelIndex = (row / 2) * texelsInLogicalRow + (col / 2);
  int texR = texelIndex / texNumC;
  int texC = texelIndex - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,Kte=`
vec2 packedUVfrom3D(int texNumR, int texNumC,
    int texelsInBatch, int texelsInLogicalRow, int b,
    int row, int col) {
  int index = b * texelsInBatch + (row / 2) * texelsInLogicalRow + (col / 2);
  int texR = index / texNumC;
  int texC = index - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,qte=`
  float getChannel(vec4 frag, vec2 innerDims) {
    vec2 modCoord = mod(innerDims, 2.);
    return modCoord.x == 0. ?
      (modCoord.y == 0. ? frag.r : frag.g) :
      (modCoord.y == 0. ? frag.b : frag.a);
  }
  float getChannel(vec4 frag, int dim) {
    float modCoord = mod(float(dim), 2.);
    return modCoord == 0. ? frag.r : frag.g;
  }
`;function iF(){return`
    int getOutputCoords() {
      return 0;
    }
  `}function Xte(n,e,t){const s=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)];return s[0]===1?t?`
      int getOutputCoords() {
        return 2 * int(resultUV.x * ceil(float(outTexShape[1]) / 2.0));
      }
    `:`
      int getOutputCoords() {
        return 2 * int(resultUV.x * ${s[1]}.0);
      }
    `:s[1]===1?t?`
      int getOutputCoords() {
        return 2 * int(resultUV.y * ceil(float(outTexShape[0]) / 2.0));
      }
    `:`
      int getOutputCoords() {
        return 2 * int(resultUV.y * ${s[0]}.0);
      }
    `:t?`
    int getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));
      return 2 * (resTexRC.x * packedTexShape[1] + resTexRC.y);
    }
  `:`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${s[0]}, ${s[1]}));
      return 2 * (resTexRC.x * ${s[1]} + resTexRC.y);
    }
  `}function Yte(n,e,t){return e[0]===1?t?`
      int getOutputCoords() {
        return int(resultUV.x * float(outTexShape[1]));
      }
    `:`
      int getOutputCoords() {
        return int(resultUV.x * ${e[1]}.0);
      }
    `:e[1]===1?t?`
      int getOutputCoords() {
        return int(resultUV.y * float(outTexShape[0]));
      }
    `:`
      int getOutputCoords() {
        return int(resultUV.y * ${e[0]}.0);
      }
    `:t?`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(outTexShape[0], outTexShape[1]));
      return resTexRC.x * outTexShape[1] + resTexRC.y;
    }
  `:`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${e[0]}, ${e[1]}));
      return resTexRC.x * ${e[1]} + resTexRC.y;
    }
  `}function Qte(n,e,t){if(t)return`
    ivec3 getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      int texelsInLogicalRow = int(ceil(float(outShape[2]) / 2.0));
      int texelsInBatch = texelsInLogicalRow * int(ceil(float(outShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));
      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;

      int b = index / texelsInBatch;
      index -= b * texelsInBatch;

      int r = 2 * (index / texelsInLogicalRow);
      int c = imod(index, texelsInLogicalRow) * 2;

      return ivec3(b, r, c);
    }
  `;const s=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)],r=Math.ceil(n[2]/2),o=r*Math.ceil(n[1]/2);return`
    ivec3 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${s[0]}, ${s[1]}));
      int index = resTexRC.x * ${s[1]} + resTexRC.y;

      int b = index / ${o};
      index -= b * ${o};

      int r = 2 * (index / ${r});
      int c = imod(index, ${r}) * 2;

      return ivec3(b, r, c);
    }
  `}function Zte(n,e,t){if(t)return`
  ivec3 getOutputCoords() {
    ivec2 resTexRC = ivec2(resultUV.yx *
                           vec2(outTexShape[0], outTexShape[1]));
    int index = resTexRC.x * outTexShape[1] + resTexRC.y;
    ${Jg(["r","c","d"],n)}
    return ivec3(r, c, d);
  }
`;const s=Ha(["r","c","d"],n);return`
    ivec3 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${e[0]}, ${e[1]}));
      int index = resTexRC.x * ${e[1]} + resTexRC.y;
      ${s}
      return ivec3(r, c, d);
    }
  `}function Jte(n,e,t){if(t)return`
    ivec4 getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));
      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;

      int texelsInLogicalRow = int(ceil(float(outShape[3]) / 2.0));
      int texelsInBatch = texelsInLogicalRow * int(ceil(float(outShape[2]) / 2.0));
      int texelsInBatchN = texelsInBatch * outShape[1];

      int b2 = index / texelsInBatchN;
      index -= b2 * texelsInBatchN;

      int b = index / texelsInBatch;
      index -= b * texelsInBatch;

      int r = 2 * (index / texelsInLogicalRow);
      int c = imod(index, texelsInLogicalRow) * 2;

      return ivec4(b2, b, r, c);
    }
  `;const s=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)],r=Math.ceil(n[n.length-1]/2),o=r*Math.ceil(n[n.length-2]/2);let i=o,a="",l="b, r, c";for(let u=2;u<n.length-1;u++)i*=n[n.length-u-1],a=`
      int b${u} = index / ${i};
      index -= b${u} * ${i};
    `+a,l=`b${u}, `+l;return`
    ivec${n.length} getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${s[0]}, ${s[1]}));
      int index = resTexRC.x * ${s[1]} + resTexRC.y;

      ${a}

      int b = index / ${o};
      index -= b * ${o};

      int r = 2 * (index / ${r});
      int c = imod(index, ${r}) * 2;

      return ivec${n.length}(${l});
    }
  `}function ene(n,e,t){if(t)return`
    ivec4 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(outTexShape[0], outTexShape[1]));
      int index = resTexRC.x * outTexShape[1] + resTexRC.y;
      ${Jg(["r","c","d","d2"],n)}
      return ivec4(r, c, d, d2);
    }
  `;const s=Ha(["r","c","d","d2"],n);return`
    ivec4 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(${e[0]}, ${e[1]}));
      int index = resTexRC.x * ${e[1]} + resTexRC.y;
      ${s}
      return ivec4(r, c, d, d2);
    }
  `}function tne(n,e){const t=Ha(["r","c","d","d2","d3"],n);return`
    ivec5 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx * vec2(${e[0]},
                             ${e[1]}));

      int index = resTexRC.x * ${e[1]} + resTexRC.y;

      ${t}

      ivec5 outShape = ivec5(r, c, d, d2, d3);
      return outShape;
    }
  `}function nne(n,e){const t=Ha(["r","c","d","d2","d3","d4"],n);return`
    ivec6 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(${e[0]}, ${e[1]}));
      int index = resTexRC.x * ${e[1]} + resTexRC.y;

      ${t}

      ivec6 result = ivec6(r, c, d, d2, d3, d4);
      return result;
    }
  `}function sne(n,e,t){const s=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)];if(ct(n,e))return t?`
      ivec2 getOutputCoords() {
        ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
        return 2 * ivec2(resultUV.yx * vec2(packedTexShape[0], packedTexShape[1]));
      }
    `:`
      ivec2 getOutputCoords() {
        return 2 * ivec2(resultUV.yx * vec2(${s[0]}, ${s[1]}));
      }
    `;const r=Math.ceil(n[1]/2);return t?`
    ivec2 getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      int texelsInLogicalRow = int(ceil(float(outShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));

      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;
      int r = 2 * (index / texelsInLogicalRow);
      int c = imod(index, texelsInLogicalRow) * 2;

      return ivec2(r, c);
    }
  `:`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${s[0]}, ${s[1]}));

      int index = resTexRC.x * ${s[1]} + resTexRC.y;
      int r = 2 * (index / ${r});
      int c = imod(index, ${r}) * 2;

      return ivec2(r, c);
    }
  `}function rne(n,e,t){return ct(n,e)?t?`
      ivec2 getOutputCoords() {
        return ivec2(resultUV.yx * vec2(outTexShape[0], outTexShape[1]));
      }
    `:`
      ivec2 getOutputCoords() {
        return ivec2(resultUV.yx * vec2(${e[0]}, ${e[1]}));
      }
    `:n[1]===1?t?`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(outTexShape[0], outTexShape[1]));
        int index = resTexRC.x * outTexShape[1] + resTexRC.y;
        return ivec2(index, 0);
      }
    `:`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(${e[0]}, ${e[1]}));
        int index = resTexRC.x * ${e[1]} + resTexRC.y;
        return ivec2(index, 0);
      }
    `:n[0]===1?t?`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(outTexShape[0], outTexShape[1]));
        int index = resTexRC.x * outTexShape[1] + resTexRC.y;
        return ivec2(0, index);
      }
    `:`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(${e[0]}, ${e[1]}));
        int index = resTexRC.x * ${e[1]} + resTexRC.y;
        return ivec2(0, index);
      }
    `:t?`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(outTexShape[0], outTexShape[1]));
      int index = resTexRC.x * outTexShape[1] + resTexRC.y;
      int r = index / outShape[1];
      int c = index - r * outShape[1];
      return ivec2(r, c);
    }
  `:`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${e[0]}, ${e[1]}));
      int index = resTexRC.x * ${e[1]} + resTexRC.y;
      int r = index / ${n[1]};
      int c = index - r * ${n[1]};
      return ivec2(r, c);
    }
  `}function Ka(n){return`offset${n}`}function one(n){const e=n.name,t="get"+e.charAt(0).toUpperCase()+e.slice(1),s=is();return`
    vec4 ${t}() {
      return ${s.texture2D}(${e}, halfCR);
    }
  `}function ine(n,e){const t=n.name,s="get"+t.charAt(0).toUpperCase()+t.slice(1);if(n.shapeInfo.isUniform)return`float ${s}() {return ${t};}`;const[r,o]=n.shapeInfo.texShape;if(r===1&&o===1)return`
      float ${s}() {
        return sampleTexture(${t}, halfCR);
      }
    `;const i=Ka(t);if(e)return`
    float ${s}() {
      vec2 uv = uvFromFlat(${t}TexShape[0], ${t}TexShape[1], ${i});
      return sampleTexture(${t}, uv);
    }
  `;const[a,l]=n.shapeInfo.texShape;return`
    float ${s}() {
      vec2 uv = uvFromFlat(${a}, ${l}, ${i});
      return sampleTexture(${t}, uv);
    }
  `}function ane(n,e){const t=n.name,s="get"+t.charAt(0).toUpperCase()+t.slice(1),r=n.shapeInfo.texShape,o=is();if(e)return`
    vec4 ${s}(int index) {
      ivec2 packedTexShape = ivec2(ceil(float(${t}TexShape[0]) / 2.0), ceil(float(${t}TexShape[1]) / 2.0));
      vec2 uv = packedUVfrom1D(
        packedTexShape[0], packedTexShape[1], index);
      return ${o.texture2D}(${t}, uv);
    }
  `;const i=[Math.ceil(r[0]/2),Math.ceil(r[1]/2)];return`
    vec4 ${s}(int index) {
      vec2 uv = packedUVfrom1D(
        ${i[0]}, ${i[1]}, index);
      return ${o.texture2D}(${t}, uv);
    }
  `}function lne(n,e){const t=n.name,s="get"+t.charAt(0).toUpperCase()+t.slice(1);if(n.shapeInfo.isUniform)return`
      float ${s}(int index) {
        ${vu(n)}
      }
    `;const r=n.shapeInfo.texShape,o=r[0],i=r[1];if(i===1&&o===1)return`
      float ${s}(int index) {
        return sampleTexture(${t}, halfCR);
      }
    `;const a=Ka(t);return i===1?e?`
      float ${s}(int index) {
        vec2 uv = vec2(0.5, (float(index + ${a}) + 0.5) / float(${t}TexShape[0]));
        return sampleTexture(${t}, uv);
      }
    `:`
      float ${s}(int index) {
        vec2 uv = vec2(0.5, (float(index + ${a}) + 0.5) / ${o}.0);
        return sampleTexture(${t}, uv);
      }
    `:o===1?e?`
      float ${s}(int index) {
        vec2 uv = vec2((float(index + ${a}) + 0.5) / float(${t}TexShape[1]), 0.5);
        return sampleTexture(${t}, uv);
      }
    `:`
      float ${s}(int index) {
        vec2 uv = vec2((float(index + ${a}) + 0.5) / ${i}.0, 0.5);
        return sampleTexture(${t}, uv);
      }
    `:e?`
    float ${s}(int index) {
      vec2 uv = uvFromFlat(${t}TexShape[0], ${t}TexShape[1], index + ${a});
      return sampleTexture(${t}, uv);
    }
  `:`
    float ${s}(int index) {
      vec2 uv = uvFromFlat(${o}, ${i}, index + ${a});
      return sampleTexture(${t}, uv);
    }
  `}function une(n,e){const t=n.shapeInfo.logicalShape,s=n.name,r="get"+s.charAt(0).toUpperCase()+s.slice(1),o=n.shapeInfo.texShape,i=o[0],a=o[1],l=is();if(o!=null&&ct(t,o))return e?`
      vec4 ${r}(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(${s}TexShape[1], ${s}TexShape[0]);

        return ${l.texture2D}(${s}, uv);
      }
    `:`
      vec4 ${r}(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(${a}.0, ${i}.0);

        return ${l.texture2D}(${s}, uv);
      }
    `;if(e)return`
    vec4 ${r}(int row, int col) {
      ivec2 packedTexShape = ivec2(ceil(float(${s}TexShape[0]) / 2.0), ceil(float(${s}TexShape[1]) / 2.0));
      int valuesPerRow = int(ceil(float(${s}Shape[1]) / 2.0));
      vec2 uv = packedUVfrom2D(valuesPerRow, packedTexShape[0], packedTexShape[1], row, col);
      return ${l.texture2D}(${s}, uv);
    }
  `;const u=[Math.ceil(o[0]/2),Math.ceil(o[1]/2)],h=Math.ceil(t[1]/2);return`
    vec4 ${r}(int row, int col) {
      vec2 uv = packedUVfrom2D(${h}, ${u[0]}, ${u[1]}, row, col);
      return ${l.texture2D}(${s}, uv);
    }
  `}function cne(n,e){const t=n.shapeInfo.logicalShape,s=n.name,r="get"+s.charAt(0).toUpperCase()+s.slice(1),o=n.shapeInfo.texShape;if(o!=null&&ct(t,o)){if(e)return`
      float ${r}(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(${s}TexShape[1], ${s}TexShape[0]);
        return sampleTexture(${s}, uv);
      }
    `;const f=o[0],m=o[1];return`
    float ${r}(int row, int col) {
      vec2 uv = (vec2(col, row) + halfCR) / vec2(${m}.0, ${f}.0);
      return sampleTexture(${s}, uv);
    }
  `}const{newShape:i,keptDims:a}=Oi(t),l=i;if(l.length<t.length){const f=wu(n,l),m=["row","col"];return`
      ${xu(f,e)}
      float ${r}(int row, int col) {
        return ${r}(${bu(m,a)});
      }
    `}if(n.shapeInfo.isUniform)return`
      float ${r}(int row, int col) {
        int index = round(dot(vec2(row, col), vec2(${t[1]}, 1)));
        ${vu(n)}
      }
    `;const u=o[0],h=o[1],p=Ka(s);return h===1?e?`
      float ${r}(int row, int col) {
        float index = dot(vec3(row, col, ${p}), vec3(${s}Shape[1], 1, 1));
        vec2 uv = vec2(0.5, (index + 0.5) / float(${s}TexShape[0]));
        return sampleTexture(${s}, uv);
      }
    `:`
    float ${r}(int row, int col) {
      float index = dot(vec3(row, col, ${p}), vec3(${t[1]}, 1, 1));
      vec2 uv = vec2(0.5, (index + 0.5) / ${u}.0);
      return sampleTexture(${s}, uv);
    }
  `:u===1?e?`
      float ${r}(int row, int col) {
        float index = dot(vec3(row, col, ${p}), vec3(${s}Shape[1], 1, 1));
        vec2 uv = vec2((index + 0.5) / float(${s}TexShape[1]), 0.5);
        return sampleTexture(${s}, uv);
      }
    `:`
    float ${r}(int row, int col) {
      float index = dot(vec3(row, col, ${p}), vec3(${t[1]}, 1, 1));
      vec2 uv = vec2((index + 0.5) / ${h}.0, 0.5);
      return sampleTexture(${s}, uv);
    }
  `:e?`
      float ${r}(int row, int col) {
        // Explicitly use integer operations as dot() only works on floats.
        int index = row * ${s}Shape[1] + col + ${p};
        vec2 uv = uvFromFlat(${s}TexShape[0], ${s}TexShape[1], index);
        return sampleTexture(${s}, uv);
      }
    `:`
  float ${r}(int row, int col) {
    // Explicitly use integer operations as dot() only works on floats.
    int index = row * ${t[1]} + col + ${p};
    vec2 uv = uvFromFlat(${u}, ${h}, index);
    return sampleTexture(${s}, uv);
  }
`}function hne(n,e){const t=n.shapeInfo.logicalShape,s=n.name,r="get"+s.charAt(0).toUpperCase()+s.slice(1),o=n.shapeInfo.texShape,i=[Math.ceil(o[0]/2),Math.ceil(o[1]/2)];if(t[0]===1){const f=t.slice(1),m=[1,2],y=wu(n,f),x=["b","row","col"];return`
        ${oF(y,e)}
        vec4 ${r}(int b, int row, int col) {
          return ${r}(${bu(x,m)});
        }
      `}const a=is();if(e)return`
    vec4 ${r}(int b, int row, int col) {
      ivec2 packedTexShape = ivec2(ceil(float(${s}TexShape[0]) / 2.0), ceil(float(${s}TexShape[1]) / 2.0));
      int valuesPerRow = int(ceil(float(${s}Shape[2]) / 2.0));
      int texelsInBatch = valuesPerRow * int(ceil(float(${s}Shape[1]) / 2.0));
      vec2 uv = packedUVfrom3D(
        packedTexShape[0], packedTexShape[1], texelsInBatch, valuesPerRow, b, row, col);
      return ${a.texture2D}(${s}, uv);
    }
  `;const l=i[0],u=i[1],h=Math.ceil(t[2]/2),p=h*Math.ceil(t[1]/2);return`
    vec4 ${r}(int b, int row, int col) {
      vec2 uv = packedUVfrom3D(
        ${l}, ${u}, ${p}, ${h}, b, row, col);
      return ${a.texture2D}(${s}, uv);
    }
  `}function dne(n,e){const t=n.shapeInfo.logicalShape,s=n.name,r="get"+s.charAt(0).toUpperCase()+s.slice(1),o=t[1]*t[2],i=t[2],{newShape:a,keptDims:l}=Oi(t),u=a;if(u.length<t.length){const x=wu(n,u),v=["row","col","depth"];return`
        ${xu(x,e)}
        float ${r}(int row, int col, int depth) {
          return ${r}(${bu(v,l)});
        }
      `}if(n.shapeInfo.isUniform)return`
      float ${r}(int row, int col, int depth) {
        int index = round(dot(vec3(row, col, depth),
                          vec3(${o}, ${i}, 1)));
        ${vu(n)}
      }
    `;const h=n.shapeInfo.texShape,p=h[0],f=h[1],m=n.shapeInfo.flatOffset;if(f===o&&m==null)return e?`
      float ${r}(int row, int col, int depth) {
        int stride1 = ${s}Shape[2];
        float texR = float(row);
        float texC = dot(vec2(col, depth), vec2(stride1, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${s}TexShape[1], ${s}TexShape[0]);
        return sampleTexture(${s}, uv);
      }
    `:`
        float ${r}(int row, int col, int depth) {
          float texR = float(row);
          float texC = dot(vec2(col, depth), vec2(${i}, 1));
          vec2 uv = (vec2(texC, texR) + halfCR) /
                     vec2(${f}.0, ${p}.0);
          return sampleTexture(${s}, uv);
        }
      `;if(f===i&&m==null)return e?`
      float ${r}(int row, int col, int depth) {
        float texR = dot(vec2(row, col), vec2(${s}Shape[1], 1));
        float texC = float(depth);
        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${s}TexShape[1], ${s}TexShape[0]);
        return sampleTexture(${s}, uv);
      }
    `:`
    float ${r}(int row, int col, int depth) {
      float texR = dot(vec2(row, col), vec2(${t[1]}, 1));
      float texC = float(depth);
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${f}.0, ${p}.0);
      return sampleTexture(${s}, uv);
    }
  `;const y=Ka(s);return e?`
    float ${r}(int row, int col, int depth) {
      // Explicitly use integer operations as dot() only works on floats.
      int stride0 = ${s}Shape[1] * ${s}Shape[2];
      int stride1 = ${s}Shape[2];
      int index = row * stride0 + col * stride1 + depth + ${y};
      vec2 uv = uvFromFlat(${s}TexShape[0], ${s}TexShape[1], index);
      return sampleTexture(${s}, uv);
    }
    `:`
      float ${r}(int row, int col, int depth) {
        // Explicitly use integer operations as dot() only works on floats.
        int index = row * ${o} + col * ${i} + depth + ${y};
        vec2 uv = uvFromFlat(${p}, ${f}, index);
        return sampleTexture(${s}, uv);
      }
  `}function pne(n,e){const t=n.name,s="get"+t.charAt(0).toUpperCase()+t.slice(1),r=is();if(e)return`
    vec4 ${s}(int b2, int b, int row, int col) {
      int valuesPerRow = int(ceil(float(${t}Shape[3]) / 2.0));
      int texelsInBatch = valuesPerRow * int(ceil(float(${t}Shape[2]) / 2.0));
      int index = b * texelsInBatch + (row / 2) * valuesPerRow + (col / 2);
      texelsInBatch *= ${t}Shape[1];
      index = b2 * texelsInBatch + index;
      ivec2 packedTexShape = ivec2(ceil(float(${t}TexShape[0]) / 2.0), ceil(float(${t}TexShape[1]) / 2.0));
      int texR = index / packedTexShape[1];
      int texC = index - texR * packedTexShape[1];
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(packedTexShape[1], packedTexShape[0]); return ${r.texture2D}(${t}, uv);
    }
  `;const o=n.shapeInfo.logicalShape,i=o.length,a=n.shapeInfo.texShape,l=[Math.ceil(a[0]/2),Math.ceil(a[1]/2)],u=l[0],h=l[1],p=Math.ceil(o[i-1]/2);let f=p*Math.ceil(o[i-2]/2),m="int b, int row, int col",y=`b * ${f} + (row / 2) * ${p} + (col / 2)`;for(let x=2;x<i-1;x++)m=`int b${x}, `+m,f*=o[i-x-1],y=`b${x} * ${f} + `+y;return`
    vec4 ${s}(${m}) {
      int index = ${y};
      int texR = index / ${h};
      int texC = index - texR * ${h};
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${h}, ${u});
      return ${r.texture2D}(${t}, uv);
    }
  `}function fne(n,e){const t=n.shapeInfo.logicalShape,s=n.name,r="get"+s.charAt(0).toUpperCase()+s.slice(1),o=t[3],i=t[2]*o,a=t[1]*i,{newShape:l,keptDims:u}=Oi(t);if(l.length<t.length){const S=wu(n,l),k=["row","col","depth","depth2"];return`
      ${xu(S,e)}
      float ${r}(int row, int col, int depth, int depth2) {
        return ${r}(${bu(k,u)});
      }
    `}if(n.shapeInfo.isUniform)return`
      float ${r}(int row, int col, int depth, int depth2) {
        int index = round(dot(vec4(row, col, depth, depth2),
                          vec4(${a}, ${i}, ${o}, 1)));
        ${vu(n)}
      }
    `;const h=n.shapeInfo.flatOffset,p=n.shapeInfo.texShape,f=p[0],m=p[1],y=`int stride2 = ${s}Shape[3];`,x=`int stride1 = ${s}Shape[2] * stride2;`,v=`int stride0 = ${s}Shape[1] * stride1;`;if(m===a&&h==null)return e?`
      float ${r}(int row, int col, int depth, int depth2) {
        ${y}
        ${x}
        float texR = float(row);
        float texC =
            dot(vec3(col, depth, depth2),
                vec3(stride1, stride2, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${s}TexShape[1], ${s}TexShape[0]);
        return sampleTexture(${s}, uv);
      }
    `:`
      float ${r}(int row, int col, int depth, int depth2) {
        float texR = float(row);
        float texC =
            dot(vec3(col, depth, depth2),
                vec3(${i}, ${o}, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${m}.0, ${f}.0);
        return sampleTexture(${s}, uv);
      }
    `;if(m===o&&h==null)return e?`
      float ${r}(int row, int col, int depth, int depth2) {
        float texR = dot(vec3(row, col, depth),
                         vec3(${s}Shape[1] * ${s}Shape[2], ${s}Shape[2], 1));
        float texC = float(depth2);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${s}TexShape[1], ${s}TexShape[0]);
        return sampleTexture(${s}, uv);
      }
    `:`
      float ${r}(int row, int col, int depth, int depth2) {
        float texR = dot(vec3(row, col, depth),
                         vec3(${t[1]*t[2]}, ${t[2]}, 1));
        float texC = float(depth2);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${m}.0, ${f}.0);
        return sampleTexture(${s}, uv);
      }
    `;const w=Ka(s);return e?`
    float ${r}(int row, int col, int depth, int depth2) {
      // Explicitly use integer operations as dot() only works on floats.
      ${y}
      ${x}
      ${v}
      int index = row * stride0 + col * stride1 +
          depth * stride2 + depth2;
      vec2 uv = uvFromFlat(${s}TexShape[0], ${s}TexShape[1], index + ${w});
      return sampleTexture(${s}, uv);
    }
  `:`
    float ${r}(int row, int col, int depth, int depth2) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * ${a} + col * ${i} +
          depth * ${o} + depth2;
      vec2 uv = uvFromFlat(${f}, ${m}, index + ${w});
      return sampleTexture(${s}, uv);
    }
  `}function mne(n){const e=n.shapeInfo.logicalShape,t=n.name,s="get"+t.charAt(0).toUpperCase()+t.slice(1),r=e[4],o=e[3]*r,i=e[2]*o,a=e[1]*i,{newShape:l,keptDims:u}=Oi(e);if(l.length<e.length){const x=wu(n,l),v=["row","col","depth","depth2","depth3"];return`
      ${xu(x)}
      float ${s}(int row, int col, int depth, int depth2, int depth3) {
        return ${s}(${bu(v,u)});
      }
    `}if(n.shapeInfo.isUniform)return`
      float ${s}(int row, int col, int depth, int depth2, int depth3) {
        float index = dot(
          vec4(row, col, depth, depth2),
          vec4(${a}, ${i}, ${o}, ${r})) +
          depth3;
        ${vu(n)}
      }
    `;const h=n.shapeInfo.flatOffset,p=n.shapeInfo.texShape,f=p[0],m=p[1];if(m===a&&h==null)return`
      float ${s}(int row, int col, int depth, int depth2, int depth3) {
        int texR = row;
        float texC = dot(vec4(col, depth, depth2, depth3),
                         vec4(${i}, ${o}, ${r}, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${m}.0, ${f}.0);
        return sampleTexture(${t}, uv);
      }
    `;if(m===r&&h==null)return`
      float ${s}(int row, int col, int depth, int depth2, int depth3) {
        float texR = dot(
          vec4(row, col, depth, depth2),
          vec4(${e[1]*e[2]*e[3]},
               ${e[2]*e[3]}, ${e[3]}, 1));
        int texC = depth3;
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${m}.0, ${f}.0);
        return sampleTexture(${t}, uv);
      }
    `;const y=Ka(t);return`
    float ${s}(int row, int col, int depth, int depth2, int depth3) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * ${a} + col * ${i} + depth * ${o} +
          depth2 * ${r} + depth3 + ${y};
      vec2 uv = uvFromFlat(${f}, ${m}, index);
      return sampleTexture(${t}, uv);
    }
  `}function gne(n){const e=n.shapeInfo.logicalShape,t=n.name,s="get"+t.charAt(0).toUpperCase()+t.slice(1),{newShape:r,keptDims:o}=Oi(e);if(r.length<e.length){const v=wu(n,r),w=["row","col","depth","depth2","depth3","depth4"];return`
      ${xu(v)}
      float ${s}(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        return ${s}(${bu(w,o)});
      }
    `}const i=e[5],a=e[4]*i,l=e[3]*a,u=e[2]*l,h=e[1]*u;if(n.shapeInfo.isUniform)return`
      float ${s}(int row, int col, int depth,
                  int depth2, int depth3, int depth4) {
        int index = round(dot(
          vec4(row, col, depth, depth2),
          vec4(${h}, ${u}, ${l}, ${a})) +
          dot(
            vec2(depth3, depth4),
            vec2(${i}, 1)));
        ${vu(n)}
      }
    `;const p=n.shapeInfo.flatOffset,f=n.shapeInfo.texShape,m=f[0],y=f[1];if(y===h&&p==null)return`
      float ${s}(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        int texR = row;
        float texC = dot(vec4(col, depth, depth2, depth3),
          vec4(${u}, ${l}, ${a}, ${i})) +
               float(depth4);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${y}.0, ${m}.0);
        return sampleTexture(${t}, uv);
      }
    `;if(y===i&&p==null)return`
      float ${s}(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        float texR = dot(vec4(row, col, depth, depth2),
          vec4(${e[1]*e[2]*e[3]*e[4]},
               ${e[2]*e[3]*e[4]},
               ${e[3]*e[4]},
               ${e[4]})) + float(depth3);
        int texC = depth4;
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${y}.0, ${m}.0);
        return sampleTexture(${t}, uv);
      }
    `;const x=Ka(t);return`
    float ${s}(int row, int col, int depth,
                  int depth2, int depth3, int depth4) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * ${h} + col * ${u} + depth * ${l} +
          depth2 * ${a} + depth3 * ${i} + depth4 + ${x};
      vec2 uv = uvFromFlat(${m}, ${y}, index);
      return sampleTexture(${t}, uv);
    }
  `}function vu(n){const e=n.name,t=fe(n.shapeInfo.logicalShape);return t<2?`return ${e};`:`
    for (int i = 0; i < ${t}; i++) {
      if (i == index) {
        return ${e}[i];
      }
    }
  `}function yne(n,e){const t=n.name,s=t.charAt(0).toUpperCase()+t.slice(1),r="get"+s+"AtOutCoords",o=n.shapeInfo.logicalShape.length,i=e.logicalShape.length,a=rF(n.shapeInfo.logicalShape,e.logicalShape),l=St(i),u=i-o;let h;const p=["x","y","z","w","u","v"];o===0?h="":i<2&&a.length>=1?h="coords = 0;":h=a.map(S=>`coords.${p[S+u]} = 0;`).join(`
`);let f="";i<2&&o>0?f="coords":f=n.shapeInfo.logicalShape.map((S,k)=>`coords.${p[k+u]}`).join(", ");let m="return outputValue;";const x=fe(n.shapeInfo.logicalShape)===1,w=fe(e.logicalShape)===1;if(o===1&&!x&&!w)m=`
      return vec4(outputValue.xy, outputValue.xy);
    `;else if(x&&!w)i===1?m=`
        return vec4(outputValue.x, outputValue.x, 0., 0.);
      `:m=`
        return vec4(outputValue.x);
      `;else if(a.length){const S=o-2,k=o-1;a.indexOf(S)>-1&&a.indexOf(k)>-1?m="return vec4(outputValue.x);":a.indexOf(S)>-1?m="return vec4(outputValue.x, outputValue.y, outputValue.x, outputValue.y);":a.indexOf(k)>-1&&(m="return vec4(outputValue.xx, outputValue.zz);")}return`
    vec4 ${r}() {
      ${l} coords = getOutputCoords();
      ${h}
      vec4 outputValue = get${s}(${f});
      ${m}
    }
  `}function xne(n,e){const t=n.name,s=t.charAt(0).toUpperCase()+t.slice(1),r="get"+s+"AtOutCoords",o=e.texShape,i=n.shapeInfo.texShape,a=n.shapeInfo.logicalShape.length,l=e.logicalShape.length;if(!n.shapeInfo.isUniform&&a===l&&n.shapeInfo.flatOffset==null&&ct(i,o))return`
      float ${r}() {
        return sampleTexture(${t}, resultUV);
      }
    `;const u=St(l),h=rF(n.shapeInfo.logicalShape,e.logicalShape),p=l-a;let f;const m=["x","y","z","w","u","v"];a===0?f="":l<2&&h.length>=1?f="coords = 0;":f=h.map(x=>`coords.${m[x+p]} = 0;`).join(`
`);let y="";return l<2&&a>0?y="coords":y=n.shapeInfo.logicalShape.map((x,v)=>`coords.${m[v+p]}`).join(", "),`
    float ${r}() {
      ${u} coords = getOutputCoords();
      ${f}
      return get${s}(${y});
    }
  `}function St(n){if(n<=1)return"int";if(n===2)return"ivec2";if(n===3)return"ivec3";if(n===4)return"ivec4";if(n===5)return"ivec5";if(n===6)return"ivec6";throw Error(`GPU for rank ${n} is not yet supported`)}function bS(n,e,t){const{newShape:s,keptDims:r}=Oi(e),o=e.length,i=n&&o===3&&e[0]===1,a=i?e.slice(1):s,l=!n&&o>1&&!ct(e,t)&&s.length<o||i;return{useSqueezeShape:l,uniformShape:l?a:e,keptDims:r}}function wu(n,e){const t=JSON.parse(JSON.stringify(n));return t.shapeInfo.logicalShape=e,t}function bu(n,e){return e.map(t=>n[t]).join(", ")}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vne(n,e,t,s){const r=t.map((h,p)=>{const f={logicalShape:h.shape,texShape:h.isUniform?null:h.texData.texShape,isUniform:h.isUniform,isPacked:h.isUniform?!1:h.texData.isPacked,flatOffset:null};return h.texData!=null&&h.texData.slice!=null&&h.texData.slice.flatOffset>0&&(f.flatOffset=h.texData.slice.flatOffset),{name:e.variableNames[p],shapeInfo:f}}),o=r.map(h=>h.shapeInfo),i={logicalShape:s.shape,texShape:s.texData.texShape,isUniform:!1,isPacked:s.texData.isPacked,flatOffset:null},a=Lte(r,i,e),l=dte(n.gl,a),u=n.createProgram(l);return ae().get("ENGINE_COMPILE_ONLY")?{program:e,fragmentShader:l,source:a,webGLProgram:u,inShapeInfos:o,outShapeInfo:i,variablesLocations:null,customUniformLocations:null,infLoc:null,nanLoc:null,outShapeLocation:null,outShapeStridesLocation:null,outTexShapeLocation:null}:(n.buildVao(u),Object.assign({program:e,fragmentShader:l,source:a,webGLProgram:u,inShapeInfos:o,outShapeInfo:i},aF(n,e,u)))}function aF(n,e,t){const s=[],r=[];let o,i,a,l=null,u=null;u=n.getUniformLocation(t,"NAN",!1),ae().getNumber("WEBGL_VERSION")===1&&(l=n.getUniformLocation(t,"INFINITY",!1));const h=!1;for(const p of e.variableNames){const f={name:p,uniform:n.getUniformLocation(t,p,h),offset:n.getUniformLocation(t,`offset${p}`,h)};e.enableShapeUniforms&&(f.shape=n.getUniformLocation(t,`${p}Shape`,h),f.texShape=n.getUniformLocation(t,`${p}TexShape`,h)),s.push(f)}if(e.enableShapeUniforms&&(o=n.getUniformLocation(t,"outShape",h),a=n.getUniformLocation(t,"outShapeStrides",h),i=n.getUniformLocation(t,"outTexShape",h)),e.customUniforms)for(const p of e.customUniforms)r.push(n.getUniformLocation(t,p.name,h));return{variablesLocations:s,customUniformLocations:r,infLoc:l,nanLoc:u,outShapeLocation:o,outShapeStridesLocation:a,outTexShapeLocation:i}}function EI(n,e){if(n.length!==e.length)throw Error(`Binary was compiled with ${n.length} inputs, but was executed with ${e.length} inputs`);n.forEach((t,s)=>{const r=t.logicalShape,o=e[s],i=o.shape;if(!ct(r,i))throw Error(`Binary was compiled with different shapes than the current args. Shapes ${r} and ${i} must match`);if(t.isUniform&&o.isUniform)return;const a=t.texShape,l=o.isUniform?null:o.texData.texShape;if(!ct(a,l))throw Error(`Binary was compiled with different texture shapes than the current args. Shape ${a} and ${l} must match`)})}function wne(n,e,t,s,r){e.program.enableShapeUniforms||(EI(e.inShapeInfos,t),EI([e.outShapeInfo],[s]));const o=s.texData.texture,i=s.texData.texShape;s.texData.isPacked?n.setOutputPackedMatrixTexture(o.texture,i[0],i[1]):n.setOutputMatrixTexture(o.texture,i[0],i[1]),n.setProgram(e.webGLProgram),n.bindVertexArray(e.webGLProgram.vao),ae().getNumber("WEBGL_VERSION")===1&&e.infLoc!==null&&n.gl.uniform1f(e.infLoc,1/0),e.nanLoc!==null&&n.gl.uniform1f(e.nanLoc,NaN);for(let l=0;l<t.length;++l){const u=t[l],{uniform:h,offset:p,shape:f,texShape:m}=e.variablesLocations[l];if(f){const{uniformShape:y}=bS(e.program.packedInputs,u.shape,u.texData.texShape);switch(y.length){case 1:n.gl.uniform1iv(f,new Int32Array(y));break;case 2:n.gl.uniform2iv(f,new Int32Array(y));break;case 3:n.gl.uniform3iv(f,new Int32Array(y));break;case 4:n.gl.uniform4iv(f,new Int32Array(y));break}}if(m&&n.gl.uniform2i(m,u.texData.texShape[0],u.texData.texShape[1]),h!=null){if(u.isUniform){if(fe(u.shape)<2)n.gl.uniform1f(h,u.uniformValues[0]);else{let y=u.uniformValues;y instanceof Float32Array||(y=new Float32Array(y)),n.gl.uniform1fv(h,y)}continue}u.texData.slice!=null&&p!=null&&n.gl.uniform1i(p,u.texData.slice.flatOffset),n.setInputMatrixTexture(u.texData.texture.texture,h,l)}}const a=e.outShapeLocation;if(a)switch(s.shape.length){case 1:n.gl.uniform1iv(a,new Int32Array(s.shape));break;case 2:n.gl.uniform2iv(a,new Int32Array(s.shape));break;case 3:n.gl.uniform3iv(a,new Int32Array(s.shape));break;case 4:n.gl.uniform4iv(a,new Int32Array(s.shape));break}if(e.outShapeStridesLocation){const l=Be(s.shape);switch(s.shape.length){case 2:n.gl.uniform1iv(e.outShapeStridesLocation,new Int32Array(l));break;case 3:n.gl.uniform2iv(e.outShapeStridesLocation,new Int32Array(l));break;case 4:n.gl.uniform3iv(e.outShapeStridesLocation,new Int32Array(l));break}}if(e.outTexShapeLocation&&n.gl.uniform2i(e.outTexShapeLocation,s.texData.texShape[0],s.texData.texShape[1]),e.program.customUniforms&&r)for(let l=0;l<e.program.customUniforms.length;++l){const u=e.program.customUniforms[l],h=e.customUniformLocations[l],p=r[l];if(u.type==="float")n.gl.uniform1fv(h,p);else if(u.type==="vec2")n.gl.uniform2fv(h,p);else if(u.type==="vec3")n.gl.uniform3fv(h,p);else if(u.type==="vec4")n.gl.uniform4fv(h,p);else if(u.type==="int")n.gl.uniform1iv(h,p);else if(u.type==="ivec2")n.gl.uniform2iv(h,p);else if(u.type==="ivec3")n.gl.uniform3iv(h,p);else if(u.type==="ivec4")n.gl.uniform4iv(h,p);else throw Error(`uniform type ${u.type} is not supported yet.`)}n.executeProgram()}function bne(n,e,t){let s="";e.concat(t).forEach(i=>{const a=i.texData!=null&&i.texData.slice!=null&&i.texData.slice.flatOffset>0;if(n.enableShapeUniforms&&!i.isUniform){const l=i.texData.texShape,{useSqueezeShape:u,uniformShape:h,keptDims:p}=bS(n.packedInputs,i.shape,l);let f="",m="",y="";if(h.length===1&&n.packedInputs){const I=[Math.ceil(l[0]/2),Math.ceil(l[1]/2)];f=`${I[0]>1}_${I[1]>1}`}else if(h.length===2&&!n.packedInputs)m=`${h[0]>1}_${h[1]>1}`;else if(h.length>2&&!n.packedInputs){const I=Be(h);y=`${I[0]===l[1]}_${I[I.length-1]===l[1]}`}const x=i.shape.length,v=h.length===2&&ct(i.shape,l),w=fe(i.shape)===1,S=Xl(i.shape,t.shape),k=!n.packedInputs&&x===t.shape.length&&ct(l,t.texData.texShape),T=n.packedInputs||h.length>2?"":`${l[0]>1}_${l[1]>1}`;s+=`${x}_${k}_${u?p:""}_${h.length}_${w}_${S}_${v}_${f}_${m}_${y}_${T}_${a}`}else{const l=i.isUniform?"uniform":i.texData.texShape;s+=`${i.shape}_${l}_${a}`}});const r=n.userCode;let o=n.constructor.name;return o+="_"+s+"_"+r+`${ae().getNumber("WEBGL_VERSION")}`,o}function Xn(n){return ae().getBool("WEBGL_USE_SHAPES_UNIFORMS")&&n<=4}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Sne{constructor(e){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outPackingScheme=Wc.DENSE,this.customUniforms=[{name:"texShape",type:"ivec2"}];const t=is();this.outputShape=e,this.enableShapeUniforms=Xn(this.outputShape.length),this.userCode=`
      ivec3 outCoordsFromFlatIndex(int index) {
        ${this.enableShapeUniforms?Jg(["r","c","d"],e):Ha(["r","c","d"],e)}
        return ivec3(r, c, d);
      }

      void main() {
        ivec2 resTexRC = ivec2(resultUV.yx * vec2(texShape[0], texShape[1]));
        int index = 4 * (resTexRC.x * texShape[1] + resTexRC.y);

        vec4 result = vec4(0.);

        for (int i=0; i<4; i++) {
          int flatIndex = index + i;
          ivec3 rc = outCoordsFromFlatIndex(flatIndex);
          result[i] = getA(rc.x, rc.y, rc.z);
        }

        ${t.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Cne{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outPackingScheme=Wc.DENSE,this.customUniforms=[{name:"texShape",type:"ivec2"}];const t=is();this.outputShape=e,this.enableShapeUniforms=Xn(this.outputShape.length),this.userCode=`
      ivec3 outCoordsFromFlatIndex(int index) {
        ${this.enableShapeUniforms?Jg(["r","c","d"],e):Ha(["r","c","d"],e)}
        return ivec3(r, c, d);
      }

      void main() {
        ivec2 resTexRC = ivec2(resultUV.yx * vec2(texShape[0], texShape[1]));
        int index = 4 * (resTexRC.x * texShape[1] + resTexRC.y);

        vec4 result = vec4(0.);

        for (int i=0; i<4; i++) {
          int flatIndex = index + i;
          ivec3 rc = outCoordsFromFlatIndex(flatIndex);
          result[i] = getChannel(getA(rc.x, rc.y, rc.z), vec2(rc.y, rc.z));
        }

        ${t.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class kne{constructor(e){this.variableNames=["A"],this.outTexUsage=Gs.DOWNLOAD;const t=is();this.outputShape=e,this.userCode=`
      ${sF}

      void main() {
        float x = getAAtOutCoords();
        ${t.output} = encode_float(x);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Tne{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outTexUsage=Gs.DOWNLOAD;const t=is();this.outputShape=e,this.userCode=`
      ${sF}

      void main() {
        ivec3 coords = getOutputCoords();
        float x = getChannel(getAAtOutCoords(), vec2(coords.y, coords.z));
        ${t.output} = encode_float(x);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Nne={R:0,G:1,B:2,A:3};class RI{constructor(e,t=!1,s="RGBA"){this.variableNames=["A"],this.customUniforms=[{name:"texShape",type:"ivec2"}];const r=is();this.outputShape=e,this.enableShapeUniforms=Xn(this.outputShape.length);let o="result";t&&(o="floor(result * 255. + 0.5)");let i="";for(let a=0;a<s.length;a++){const l=s[a];i+=`
          if(offset == ${a}) {
            result = values[${Nne[l]}];
          }`}this.userCode=`
      ${this.enableShapeUniforms?wS():vS(e)}

      void main() {
        ivec3 coords = getOutputCoords();
        int flatIndex = getFlatIndex(coords);
        float result = 0.;
        int offset = imod(flatIndex, ${s.length});

        flatIndex = idiv(flatIndex, ${s.length}, 1.);

        int r = flatIndex / texShape[1];
        if (r < texShape[0]) {
          int c = imod(flatIndex, texShape[1]);
          vec2 uv = (vec2(c, r) + halfCR) / vec2(texShape[1], texShape[0]);
          vec4 values = ${r.texture2D}(A, uv);
          ${i}
        }
        ${r.output} = vec4(${o}, 0., 0., 0.);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Ine{constructor(e,t=!1){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.customUniforms=[{name:"texShape",type:"ivec2"}];const s=is();this.outputShape=e,this.enableShapeUniforms=Xn(this.outputShape.length);let r="",o="result";t&&(o="floor(result * 255. + 0.5)");for(let i=0;i<=1;i++)for(let a=0;a<=1;a++){const l=i*2+a;r+=`
          localCoords = coords;
          if(localCoords[2] + ${a} < ${this.enableShapeUniforms?"outShape[2]":`${e[2]}`}) {
          localCoords[2] += ${a};
          if (localCoords[1] + ${i} < ${this.enableShapeUniforms?"outShape[1]":`${e[1]}`}) {
            localCoords[1] += ${i};

            flatIndex = getFlatIndex(localCoords);
            offset = imod(flatIndex, 4);

            flatIndex = idiv(flatIndex, 4, 1.);

            int r = flatIndex / texShape[1];
            int c = imod(flatIndex, texShape[1]);
            vec2 uv = (vec2(c, r) + halfCR) / vec2(texShape[1], texShape[0]);
            values = ${s.texture2D}(A, uv);

            if (offset == 0) {
              result[${l}] = values[0];
            } else if (offset == 1) {
              result[${l}] = values[1];
            } else if (offset == 2) {
              result[${l}] = values[2];
            } else {
              result[${l}] = values[3];
            }
          }
        }
        `}this.userCode=`
        ${this.enableShapeUniforms?wS():vS(e)}

        void main() {
          ivec3 coords = getOutputCoords();

          vec4 result = vec4(0.);
          int flatIndex, r, c, offset;
          ivec3 localCoords;
          vec2 uv;
          vec4 values;

          ${r}

          ${s.output} = ${o};
        }
    `}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $ne(n){const e=is(),t=`${e.version}
    precision highp float;
    ${e.attribute} vec3 clipSpacePos;
    ${e.attribute} vec2 uv;
    ${e.varyingVs} vec2 resultUV;

    void main() {
      gl_Position = vec4(clipSpacePos, 1);
      resultUV = uv;
    }`;return hte(n,t)}function Ene(n){const e=new Float32Array([-1,1,0,0,1,-1,-1,0,0,0,1,1,0,1,1,1,-1,0,1,0]);return gte(n,e)}function Rne(n){const e=new Uint16Array([0,1,2,2,1,3]);return yte(n,e)}function vd(n,e,t,s,r,o){vte(e,t);const i=xte(n),a=n.TEXTURE_2D;return $e(n,()=>n.bindTexture(a,i)),$e(n,()=>n.texParameteri(a,n.TEXTURE_WRAP_S,n.CLAMP_TO_EDGE)),$e(n,()=>n.texParameteri(a,n.TEXTURE_WRAP_T,n.CLAMP_TO_EDGE)),$e(n,()=>n.texParameteri(a,n.TEXTURE_MIN_FILTER,n.NEAREST)),$e(n,()=>n.texParameteri(a,n.TEXTURE_MAG_FILTER,n.NEAREST)),ae().getNumber("WEBGL_VERSION")===1?$e(n,()=>n.texImage2D(a,0,s,e,t,0,r,o,null)):$e(n,()=>n.texStorage2D(a,1,s,e,t)),$e(n,()=>n.bindTexture(n.TEXTURE_2D,null)),{texture:i,texShape:[t,e]}}function lF(n){return n.internalFormatFloat}function Dne(n,e,t,s){const[r,o]=yd(e,t);return vd(n,r,o,lF(s),s.textureFormatFloat,n.FLOAT)}function uF(n){return n.internalFormatHalfFloat}function Ane(n,e,t,s){const[r,o]=yd(e,t);return vd(n,r,o,uF(s),s.textureFormatFloat,s.textureTypeHalfFloat)}function cF(n){return n.downloadTextureFormat}function One(n,e,t,s){const[r,o]=yd(e,t);return vd(n,r,o,cF(s),n.RGBA,n.UNSIGNED_BYTE)}function hF(n){return n.internalFormatPackedFloat}function _ne(n,e,t,s){const[r,o]=yu(e,t);return vd(n,r,o,hF(s),n.RGBA,n.FLOAT)}function dF(n){return n.internalFormatPackedHalfFloat}function Fne(n,e,t,s){const[r,o]=yu(e,t);return vd(n,r,o,dF(s),n.RGBA,s.textureTypeHalfFloat)}function Pne(n,e,t){return $e(n,()=>n.bindBuffer(n.ARRAY_BUFFER,t)),NI(n,e,"clipSpacePos",t,3,20,0)&&NI(n,e,"uv",t,2,20,12)}function Lne(n,e,t,s,r,o){$e(n,()=>n.bindTexture(n.TEXTURE_2D,e));let i,a,l;r instanceof Uint8Array?(i=new Uint8Array(t*s*4),a=n.UNSIGNED_BYTE,l=n.RGBA):(i=new Float32Array(t*s*4),a=n.FLOAT,l=o.internalFormatPackedFloat),i.set(r),ae().getNumber("WEBGL_VERSION")===2?$e(n,()=>n.texSubImage2D(n.TEXTURE_2D,0,0,0,t,s,n.RGBA,a,i)):$e(n,()=>n.texImage2D(n.TEXTURE_2D,0,l,t,s,0,n.RGBA,a,i)),$e(n,()=>n.bindTexture(n.TEXTURE_2D,null))}function Mne(n,e,t){$e(n,()=>n.bindTexture(n.TEXTURE_2D,e)),t.data instanceof Uint8Array?ae().getNumber("WEBGL_VERSION")===2?$e(n,()=>n.texSubImage2D(n.TEXTURE_2D,0,0,0,t.width,t.height,n.RGBA,n.UNSIGNED_BYTE,t.data)):$e(n,()=>n.texImage2D(n.TEXTURE_2D,0,n.RGBA,t.width,t.height,0,n.RGBA,n.UNSIGNED_BYTE,t.data)):ae().getNumber("WEBGL_VERSION")===2?$e(n,()=>n.texSubImage2D(n.TEXTURE_2D,0,0,0,n.RGBA,n.UNSIGNED_BYTE,t)):$e(n,()=>n.texImage2D(n.TEXTURE_2D,0,n.RGBA,n.RGBA,n.UNSIGNED_BYTE,t)),$e(n,()=>n.bindTexture(n.TEXTURE_2D,null))}function zne(n,e,t,s){const r=n.createBuffer();$e(n,()=>n.bindBuffer(n.PIXEL_PACK_BUFFER,r));const a=4*4*e*t;return $e(n,()=>n.bufferData(n.PIXEL_PACK_BUFFER,a,n.STREAM_READ)),$e(n,()=>n.readPixels(0,0,t,e,n.RGBA,n.FLOAT,0)),$e(n,()=>n.bindBuffer(n.PIXEL_PACK_BUFFER,null)),r}function Vne(n,e,t){const s=n,r=new Float32Array(t);return s.bindBuffer(s.PIXEL_PACK_BUFFER,e),s.getBufferSubData(s.PIXEL_PACK_BUFFER,0,r),s.bindBuffer(s.PIXEL_PACK_BUFFER,null),r}function Bne(n,e,t,s){const[r,o]=yd(e,t),i=4,a=new Uint8Array(rte(e*t,i));return $e(n,()=>n.readPixels(0,0,r,o,s.downloadTextureFormat,n.UNSIGNED_BYTE,a)),new Float32Array(a.buffer)}function Wne(n,e,t,s,r,o,i,a){const l=n,u=new Float32Array(ote(o,i));return l.bindBuffer(l.PIXEL_PACK_BUFFER,e),l.getBufferSubData(l.PIXEL_PACK_BUFFER,0,u),l.bindBuffer(l.PIXEL_PACK_BUFFER,null),u}function Une(n,e,t){const s=new Float32Array(e*t*4);return $e(n,()=>n.readPixels(0,0,t,e,n.RGBA,n.FLOAT,s)),s}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class kx{constructor(e){this.outputTexture=null,this.program=null,this.disposed=!1,this.itemsToPoll=[];const t=ae().getNumber("WEBGL_VERSION");if(e!=null?(this.gl=e,tte(t,e)):this.gl=Vr(t),e=this.gl,ae().getNumber("WEBGL_VERSION")===2){const o=e;this.createVertexArray=()=>$e(o,()=>o.createVertexArray()),this.bindVertexArray=i=>$e(o,()=>o.bindVertexArray(i)),this.deleteVertexArray=i=>$e(o,()=>o.deleteVertexArray(i)),this.getVertexArray=()=>$e(o,()=>o.getParameter(o.VERTEX_ARRAY_BINDING))}else if(e!=null){const o=e.getExtension("OES_vertex_array_object");if(o==null)throw new Error("All WebGL1 implementations are expected to offer OES_vertex_array_object.");this.createVertexArray=()=>$e(e,()=>o.createVertexArrayOES()),this.bindVertexArray=i=>$e(e,()=>o.bindVertexArrayOES(i)),this.deleteVertexArray=i=>$e(e,()=>o.deleteVertexArrayOES(i)),this.getVertexArray=()=>$e(e,()=>e.getParameter(o.VERTEX_ARRAY_BINDING_OES))}let s="WEBGL_color_buffer_float";const r="EXT_color_buffer_half_float";if(this.parallelCompilationExtension=this.gl.getExtension("KHR_parallel_shader_compile"),ae().getNumber("WEBGL_VERSION")===1){const o="OES_texture_float",i="OES_texture_half_float";if(this.textureFloatExtension=Gp(this.gl,o),lr(this.gl,i))this.textureHalfFloatExtension=Gp(this.gl,i);else if(ae().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support half float textures, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.");if(this.colorBufferFloatExtension=this.gl.getExtension(s),lr(this.gl,r))this.colorBufferHalfFloatExtension=Gp(this.gl,r);else if(ae().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support color renderable half floats, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.")}else if(s="EXT_color_buffer_float",lr(this.gl,s))this.colorBufferFloatExtension=this.gl.getExtension(s);else if(lr(this.gl,r))this.colorBufferHalfFloatExtension=this.gl.getExtension(r);else throw new Error("GL context does not support color renderable floats");this.vertexBuffer=Ene(this.gl),this.indexBuffer=Rne(this.gl),this.framebuffer=wte(this.gl),this.textureConfig=xS(this.gl,this.textureHalfFloatExtension)}get debug(){return ae().getBool("DEBUG")}dispose(){if(this.disposed)return;this.program!=null&&console.warn("Disposing a GPGPUContext that still has a bound WebGLProgram. This is probably a resource leak, delete the program with GPGPUContext.deleteProgram before disposing."),this.outputTexture!=null&&console.warn("Disposing a GPGPUContext that still has a bound output matrix texture.  This is probably a resource leak, delete the output matrix texture with GPGPUContext.deleteMatrixTexture before disposing.");const e=this.gl;$e(e,()=>e.finish()),$e(e,()=>e.bindFramebuffer(e.FRAMEBUFFER,null)),$e(e,()=>e.deleteFramebuffer(this.framebuffer)),$e(e,()=>e.bindBuffer(e.ARRAY_BUFFER,null)),$e(e,()=>e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,null)),$e(e,()=>e.deleteBuffer(this.indexBuffer)),this.disposed=!0}createFloat32MatrixTexture(e,t){return this.throwIfDisposed(),Dne(this.gl,e,t,this.textureConfig)}createFloat16MatrixTexture(e,t){return this.throwIfDisposed(),Ane(this.gl,e,t,this.textureConfig)}createUnsignedBytesMatrixTexture(e,t){return this.throwIfDisposed(),One(this.gl,e,t,this.textureConfig)}uploadPixelDataToTexture(e,t){this.throwIfDisposed(),Mne(this.gl,e,t)}uploadDenseMatrixToTexture(e,t,s,r){this.throwIfDisposed(),Lne(this.gl,e,t,s,r,this.textureConfig)}createFloat16PackedMatrixTexture(e,t){return this.throwIfDisposed(),Fne(this.gl,e,t,this.textureConfig)}createPackedMatrixTexture(e,t){return this.throwIfDisposed(),_ne(this.gl,e,t,this.textureConfig)}deleteMatrixTexture(e){this.throwIfDisposed(),this.outputTexture===e&&(II(this.gl,this.framebuffer),this.outputTexture=null),$e(this.gl,()=>this.gl.deleteTexture(e))}downloadByteEncodedFloatMatrixFromOutputTexture(e,t,s){return this.downloadMatrixDriver(e,()=>Bne(this.gl,t,s,this.textureConfig))}downloadPackedMatrixFromBuffer(e,t,s,r,o,i){return Wne(this.gl,e,t,s,r,o,i,this.textureConfig)}downloadFloat32MatrixFromBuffer(e,t){return Vne(this.gl,e,t)}createBufferFromTexture(e,t,s){this.bindTextureToFrameBuffer(e);const r=zne(this.gl,t,s,this.textureConfig);return this.unbindTextureToFrameBuffer(),r}createAndWaitForFence(){const e=this.createFence(this.gl);return this.pollFence(e)}createFence(e){let t,s;if(ae().getBool("WEBGL_FENCE_API_ENABLED")){const r=e,o=r.fenceSync(r.SYNC_GPU_COMMANDS_COMPLETE,0);e.flush(),s=()=>{const i=r.clientWaitSync(o,0,0);return i===r.ALREADY_SIGNALED||i===r.CONDITION_SATISFIED},t=o}else ae().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?(t=this.beginQuery(),this.endQuery(),s=()=>this.isQueryAvailable(t,ae().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))):s=()=>!0;return{query:t,isFencePassed:s}}downloadMatrixFromPackedTexture(e,t,s){return this.downloadMatrixDriver(e,()=>Une(this.gl,t,s))}createProgram(e){this.throwIfDisposed();const t=this.gl;this.vertexShader==null&&(this.vertexShader=$ne(t));const s=fte(t);$e(t,()=>t.attachShader(s,this.vertexShader)),$e(t,()=>t.attachShader(s,e)),mte(t,s);const r=Object.assign(s,{vao:this.createVertexArray()});return this.debug&&wx(t,r),r}buildVao(e){this.setProgram(e),this.bindVertexArray(e.vao);const t=this.gl;$e(t,()=>t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this.indexBuffer)),Pne(t,e,this.vertexBuffer)}deleteProgram(e){this.throwIfDisposed(),e===this.program&&(this.program=null),e!=null&&($e(this.gl,()=>this.gl.deleteProgram(e)),this.deleteVertexArray(e.vao))}setProgram(e){this.throwIfDisposed(),this.program=e,this.program!=null&&this.debug&&wx(this.gl,this.program),$e(this.gl,()=>this.gl.useProgram(e))}getUniformLocation(e,t,s=!0){return this.throwIfDisposed(),s?Ste(this.gl,e,t):Cte(this.gl,e,t)}getAttributeLocation(e,t){return this.throwIfDisposed(),$e(this.gl,()=>this.gl.getAttribLocation(e,t))}getUniformLocationNoThrow(e,t){return this.throwIfDisposed(),this.gl.getUniformLocation(e,t)}setInputMatrixTexture(e,t,s){this.throwIfDisposed(),this.throwIfNoProgram(),kte(this.gl,e,t,s)}setOutputMatrixTexture(e,t,s){this.setOutputMatrixTextureDriver(e,s,t)}setOutputPackedMatrixTexture(e,t,s){this.throwIfDisposed();const[r,o]=yu(t,s);this.setOutputMatrixTextureDriver(e,r,o)}setOutputMatrixWriteRegion(e,t,s,r){this.setOutputMatrixWriteRegionDriver(s,e,r,t)}setOutputPackedMatrixWriteRegion(e,t,s,r){throw new Error("setOutputPackedMatrixWriteRegion not implemented.")}debugValidate(){this.program!=null&&wx(this.gl,this.program),jp(this.gl)}executeProgram(){this.throwIfDisposed(),this.throwIfNoProgram();const e=this.gl;if(this.debug){const t=this.getVertexArray();console.assert(t===this.program.vao,"VAO changed between setProgram and executeProgram!"),this.debugValidate()}$e(e,()=>e.drawElements(e.TRIANGLES,6,e.UNSIGNED_SHORT,0))}blockUntilAllProgramsCompleted(){this.throwIfDisposed(),$e(this.gl,()=>this.gl.finish())}getQueryTimerExtension(){return this.disjointQueryTimerExtension==null&&(this.disjointQueryTimerExtension=Gp(this.gl,ae().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2?"EXT_disjoint_timer_query_webgl2":"EXT_disjoint_timer_query")),this.disjointQueryTimerExtension}getQueryTimerExtensionWebGL2(){return this.getQueryTimerExtension()}getQueryTimerExtensionWebGL1(){return this.getQueryTimerExtension()}beginQuery(){if(ae().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2){const s=this.gl,r=this.getQueryTimerExtensionWebGL2(),o=s.createQuery();return s.beginQuery(r.TIME_ELAPSED_EXT,o),o}const e=this.getQueryTimerExtensionWebGL1(),t=e.createQueryEXT();return e.beginQueryEXT(e.TIME_ELAPSED_EXT,t),t}endQuery(){if(ae().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2){const t=this.gl,s=this.getQueryTimerExtensionWebGL2();t.endQuery(s.TIME_ELAPSED_EXT);return}const e=this.getQueryTimerExtensionWebGL1();e.endQueryEXT(e.TIME_ELAPSED_EXT)}async waitForQueryAndGetTime(e){return await aN(()=>this.disposed||this.isQueryAvailable(e,ae().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))),this.getQueryTime(e,ae().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))}getQueryTime(e,t){if(t===0)return null;if(t===2){const s=this.gl;return s.getQueryParameter(e,s.QUERY_RESULT)/1e6}else{const s=this.getQueryTimerExtensionWebGL1();return s.getQueryObjectEXT(e,s.QUERY_RESULT_EXT)/1e6}}isQueryAvailable(e,t){if(t===0)return!0;if(t===2){const s=this.gl,r=this.getQueryTimerExtensionWebGL2(),o=s.getQueryParameter(e,s.QUERY_RESULT_AVAILABLE);return this.disjoint==null&&(this.disjoint=this.gl.getParameter(r.GPU_DISJOINT_EXT)),o&&!this.disjoint}else{const s=this.getQueryTimerExtensionWebGL1(),r=s.getQueryObjectEXT(e,s.QUERY_RESULT_AVAILABLE_EXT);return this.disjoint==null&&(this.disjoint=this.gl.getParameter(s.GPU_DISJOINT_EXT)),r&&!this.disjoint}}pollFence(e){return new Promise(t=>{this.addItemToPoll(()=>e.isFencePassed(),()=>t())})}pollItems(){const e=Gne(this.itemsToPoll.map(t=>t.isDoneFn));for(let t=0;t<=e;++t){const{resolveFn:s}=this.itemsToPoll[t];s()}this.itemsToPoll=this.itemsToPoll.slice(e+1)}addItemToPoll(e,t){if(this.itemsToPoll.push({isDoneFn:e,resolveFn:t}),this.itemsToPoll.length>1)return;let s;"setTimeoutCustom"in ae().platform&&(s=ae().platform.setTimeoutCustom.bind(ae().platform)),aN(()=>(this.pollItems(),this.itemsToPoll.length===0),()=>0,null,s)}bindTextureToFrameBuffer(e){this.throwIfDisposed(),bx(this.gl,e,this.framebuffer),this.debug&&jp(this.gl)}unbindTextureToFrameBuffer(){this.outputTexture!=null?(bx(this.gl,this.outputTexture,this.framebuffer),this.debug&&jp(this.gl)):II(this.gl,this.framebuffer)}downloadMatrixDriver(e,t){this.bindTextureToFrameBuffer(e);const s=t();return this.unbindTextureToFrameBuffer(),s}setOutputMatrixTextureDriver(e,t,s){this.throwIfDisposed();const r=this.gl;bx(r,e,this.framebuffer),this.debug&&jp(r),this.outputTexture=e,$e(r,()=>r.viewport(0,0,t,s)),$e(r,()=>r.scissor(0,0,t,s))}setOutputMatrixWriteRegionDriver(e,t,s,r){this.throwIfDisposed(),$e(this.gl,()=>this.gl.scissor(e,t,s,r))}throwIfDisposed(){if(this.disposed)throw new Error("Attempted to use disposed GPGPUContext.")}throwIfNoProgram(){if(this.program==null)throw new Error("No GPU program is currently set.")}}function Gne(n){let e=0;for(;e<n.length&&n[e]();++e);return e-1}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const{addImpl:jne,bincountImpl:pF,bincountReduceImpl:Hne,bitwiseAndImpl:Kne,castImpl:qne,ceilImpl:Xne,concatImpl:Yne,equalImpl:Qne,expImpl:Zne,expm1Impl:Jne,floorImpl:ese,gatherNdImpl:tse,gatherV2Impl:nse,greaterImpl:sse,greaterEqualImpl:rse,lessImpl:ose,lessEqualImpl:ise,linSpaceImpl:ase,logImpl:lse,maxImpl:use,maximumImpl:cse,minimumImpl:hse,multiplyImpl:dse,negImpl:pse,notEqualImpl:fse,prodImpl:mse,raggedGatherImpl:gse,raggedRangeImpl:yse,raggedTensorToTensorImpl:xse,rangeImpl:vse,rsqrtImpl:wse,scatterImpl:bse,sigmoidImpl:Sse,simpleAbsImpl:fF,sliceImpl:Cse,sparseFillEmptyRowsImpl:kse,sparseReshapeImpl:Tse,sparseSegmentReductionImpl:mF,sqrtImpl:Nse,staticRegexReplaceImpl:Ise,stridedSliceImpl:$se,stringNGramsImpl:Ese,stringSplitImpl:Rse,stringToHashBucketFastImpl:Dse,subImpl:Ase,tileImpl:Ose,topKImpl:_se,transposeImpl:SS,uniqueImpl:Fse}=M9;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gF(n,e){return["x","y","z","w","u","v"].slice(0,e).map(t=>`${n}.${t}`)}function ns(n,e){return e===1?[n]:gF(n,e)}function Pse(n,e){if(n===1)return"rc";let t="";for(let s=0;s<n;s++)t+=e[s],s<n-1&&(t+=",");return t}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Lse{constructor(e){if(this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outputShape=e,this.rank=e.length,this.enableShapeUniforms=Xn(this.outputShape.length),this.rank===0)this.userCode=`
        void main() {
          setOutput(vec4(getA(), 0., 0., 0.));
        }
      `;else{const t=ns("rc",this.rank),s=St(this.rank),r=this.getOutOfBoundsCondition(t),o=this.getSetup(t),i=this.getOutput(t);this.userCode=`
        void main() {
          ${s} rc = getOutputCoords();

          if(${r}) {
            setOutput(vec4(0));
          } else {
            ${o}

            setOutput(vec4(${i}));
          }
        }
      `}}getSourceCoordsArr(e){const t=[];for(let s=0;s<=1;s++)for(let r=0;r<=1;r++){let o=`${s===0?"r":"rp1"}, ${r===0?"c":"cp1"}`;for(let i=2;i<this.rank;i++)o=`${e[e.length-1-i]},`+o;t.push(o)}return t}getOutOfBoundsCondition(e){if(this.rank===1)return`rc > ${this.enableShapeUniforms?"outShape":this.outputShape[0]}`;let t="";for(let s=this.rank-2;s<this.rank;s++)t+=`${e[s]} >= ${this.enableShapeUniforms?`outShape[${s}]`:this.outputShape[s]}`,s<this.rank-1&&(t+="||");return t}getSetup(e){if(this.rank===1)return"";const t=e.slice(-2),s=this.enableShapeUniforms?`outShape[${this.rank} - 1]`:this.outputShape[this.rank-1],r=this.enableShapeUniforms?`outShape[${this.rank} - 2]`:this.outputShape[this.rank-2];return`
      int r = ${t[0]};
      int c = ${t[1]};
      int rp1 = r + 1;
      int cp1 = c + 1;

      bool cEdge = cp1 >= ${s};
      bool rEdge = rp1 >= ${r};
    `}getOutput(e){const t=this.getSourceCoordsArr(e);return this.rank===1?`getA(rc), (rc + 1 >= ${this.enableShapeUniforms?"outShape":this.outputShape[0]} ? 0. : getA(rc + 1)), 0, 0`:`getA(${t[0]}),
            cEdge ? 0. : getA(${t[1]}),
            rEdge ? 0. : getA(${t[2]}),
            rEdge || cEdge ? 0. : getA(${t[3]})`}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class yF{constructor(e,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"inputShape",type:"ivec3"}],this.outputShape=e,this.enableShapeUniforms=Xn(this.outputShape.length);let s="";for(let r=0;r<4;r++){let o="thisRC = rc;";r%2===1&&(o+="thisRC.z += 1;"),r>1&&(o+="thisRC.y += 1;"),s+=`
        ${o}
        ${r>0?"if(thisRC.y < rows && thisRC.z < cols){":""}
          int flatIndex = getFlatIndex(thisRC);

          ivec3 inputRC = inputCoordsFromReshapedOutCoords(flatIndex);
          vec2 inputRCInnerDims = vec2(float(inputRC.y),float(inputRC.z));

          result[${r}] =
            getChannel(getA(inputRC.x, inputRC.y, inputRC.z), inputRCInnerDims);
        ${r>0?"}":""}
      `}this.userCode=`
      ${Mse(t,this.enableShapeUniforms)}
      ${this.enableShapeUniforms?wS():vS(e)}

      void main() {
        ivec3 rc = getOutputCoords();

        vec4 result = vec4(0.);

        ivec3 thisRC;
        int rows = ${this.enableShapeUniforms?"outShape[1]":e[1]};
        int cols = ${this.enableShapeUniforms?"outShape[2]":e[2]};

        ${s}

        setOutput(result);
      }
    `}}function Mse(n,e){return`
    ivec3 inputCoordsFromReshapedOutCoords(int index) {
      ${e?Pte(["r","c","d"],"inputShape"):Ha(["r","c","d"],n)}
      return ivec3(r, c, d);
    }
  `}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class zse{constructor(e){this.gpgpu=e,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0,this.freeTextures={},this.usedTextures={},this.logEnabled=!1}acquireTexture(e,t,s){const r=AI(t,s),o=OI(e,r,s);o in this.freeTextures||(this.freeTextures[o]=[]),o in this.usedTextures||(this.usedTextures[o]=[]);const i=DI(e,r,this.gpgpu.gl,this.gpgpu.textureConfig,s);if(this.freeTextures[o].length>0){this.numFreeTextures--,this.numUsedTextures++,this._numBytesFree-=i,this.log();const l=this.freeTextures[o].pop();return this.usedTextures[o].push(l),l}let a;return r===On.PACKED_2X2_FLOAT32?a=this.gpgpu.createPackedMatrixTexture(e[0],e[1]):r===On.PACKED_2X2_FLOAT16?a=this.gpgpu.createFloat16PackedMatrixTexture(e[0],e[1]):r===On.UNPACKED_FLOAT32?a=this.gpgpu.createFloat32MatrixTexture(e[0],e[1]):r===On.UNPACKED_FLOAT16?a=this.gpgpu.createFloat16MatrixTexture(e[0],e[1]):r===On.PACKED_4X1_UNSIGNED_BYTE&&(a=this.gpgpu.createUnsignedBytesMatrixTexture(e[0],e[1])),this.usedTextures[o].push(a),this.numUsedTextures++,this._numBytesAllocated+=i,this.log(),a}releaseTexture(e,t,s,r){if(this.freeTextures==null)return;const o=AI(s,r),i=OI(t,o,r);i in this.freeTextures||(this.freeTextures[i]=[]);const a=DI(t,o,this.gpgpu.gl,this.gpgpu.textureConfig,r),l=ae().getNumber("WEBGL_DELETE_TEXTURE_THRESHOLD");l!==-1&&this._numBytesAllocated>l?(this.gpgpu.deleteMatrixTexture(e.texture),this._numBytesAllocated-=a):(this.freeTextures[i].push(e),this.numFreeTextures++,this._numBytesFree+=a),this.numUsedTextures--;const u=this.usedTextures[i],h=u&&u.indexOf(e);if(h==null||h<0)throw new Error("Cannot release a texture that was never provided by this texture manager");u[h]=u[u.length-1],u.pop(),this.log()}log(){if(!this.logEnabled)return;const e=this.numFreeTextures+this.numUsedTextures;console.log("Free/Used",`${this.numFreeTextures} / ${this.numUsedTextures}`,`(${e})`);const t=this._numBytesFree/this._numBytesAllocated;console.log(`Bytes allocated: ${this._numBytesAllocated}`),console.log(`Bytes unused: ${this._numBytesFree} (${Math.round(100*t)}%)`)}get numBytesAllocated(){return this._numBytesAllocated}get numBytesFree(){return this._numBytesFree}getNumUsedTextures(){return this.numUsedTextures}getNumFreeTextures(){return this.numFreeTextures}dispose(){if(this.freeTextures!=null){for(const e in this.freeTextures)this.freeTextures[e].forEach(t=>{this.gpgpu.deleteMatrixTexture(t.texture)});for(const e in this.usedTextures)this.usedTextures[e].forEach(t=>{this.gpgpu.deleteMatrixTexture(t.texture)});this.freeTextures=null,this.usedTextures=null,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0}}}function Vse(n,e){const t=n;if(e===t.R32F)return 4;if(e===t.R16F)return 2;if(e===t.RGBA32F)return 16;if(e===n.RGBA)return 16;if(e===t.RGBA16F)return 8;if(e===t.RGBA8)return 4;throw new Error(`Unknown internal format ${e}`)}function DI(n,e,t,s,r){const o=Bse(e,s);let i;if(r){const[l,u]=yu(n[0],n[1]);i=l*u}else{const[l,u]=yd(n[0],n[1]);i=l*u}const a=Vse(t,o);return i*a}function Bse(n,e){switch(n){case On.PACKED_2X2_FLOAT32:return hF(e);case On.PACKED_2X2_FLOAT16:return dF(e);case On.UNPACKED_FLOAT32:return lF(e);case On.UNPACKED_FLOAT16:return uF(e);case On.PACKED_4X1_UNSIGNED_BYTE:return cF(e);default:throw new Error(`Unknown physical texture type ${n}`)}}function Wse(n){return ae().getBool("WEBGL_RENDER_FLOAT32_ENABLED")?n?On.PACKED_2X2_FLOAT32:On.UNPACKED_FLOAT32:n?On.PACKED_2X2_FLOAT16:On.UNPACKED_FLOAT16}function AI(n,e){if(n===Gs.UPLOAD)return On.PACKED_2X2_FLOAT32;if(n===Gs.RENDER||n==null)return Wse(e);if(n===Gs.DOWNLOAD||n===Gs.PIXELS)return On.PACKED_4X1_UNSIGNED_BYTE;throw new Error(`Unknown logical texture type ${n}`)}function OI(n,e,t){return`${n[0]}_${n[1]}_${e}_${t}`}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Jr{constructor(e,t){this.variableNames=["A"],this.outputShape=e,this.enableShapeUniforms=Xn(this.outputShape.length),this.userCode=`
      float unaryOperation(float x) {
        ${t}
      }

      void main() {
        float x = getAAtOutCoords();
        float y = unaryOperation(x);

        setOutput(y);
      }
    `}}const vr="if (isnan(x)) return x;",Use="return x;",_I="return abs(x);",Gse="return (x >= 0.0) ? x : (exp(x) - 1.0);",jse=vr+`
  return (x < 0.0) ? 0.0 : x;
`,Hse=vr+`
  return (x < 0.0) ? 0.0 : min(6.0, x);
`,ui="return x;",Kse="return 1.0 / (1.0 + exp(-1.0 * x));";/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qse="return x;",Xse=`
  vec4 result;

  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);
  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);
  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);
  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);

  return result;
`,Yse=`
  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,Qse=`
  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,Zse="return 1.0 / (1.0 + exp(-1.0 * x));";class di{constructor(e,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.enableShapeUniforms=Xn(this.outputShape.length),this.userCode=`
      vec4 unaryOperation(vec4 x) {
        ${t}
      }

      void main() {
        vec4 x = getAAtOutCoords();
        vec4 y = unaryOperation(x);

        setOutput(y);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Jse{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outputShape=e,this.enableShapeUniforms=Xn(this.outputShape.length);const t=e.length,s=ns("rc",t),r=St(t),o=Pse(t,s),i=s.slice(-2),a=t<=1?"rc":`vec2(${i.join(",")})`;this.userCode=`
      void main() {
        ${r} rc = getOutputCoords();
        vec4 packedInput = getA(${o});

        setOutput(getChannel(packedInput, ${a}));
      }
    `}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ere=cb,tre=1e-7,nre=1e-4,qp={};function sre(n){return n in qp||(qp[n]={}),qp[n]}const rre=ae().getNumber("CPU_HANDOFF_SIZE_THRESHOLD"),ore=600;function ire(){return ae().global.screen==null?1024:ae().global.screen.height*ae().global.screen.width*window.devicePixelRatio*ore/1024/1024}class ey extends ww{nextDataId(){return ey.nextDataId++}constructor(e){if(super(),this.pendingRead=new WeakMap,this.pendingDisposal=new WeakSet,this.dataRefCount=new WeakMap,this.numBytesInGPU=0,this.uploadWaitMs=0,this.downloadWaitMs=0,this.lastGlFlushTime=0,this.warnedAboutMemory=!1,this.pendingDeletes=0,this.disposed=!1,!ae().getBool("HAS_WEBGL"))throw new Error("WebGL is not supported on this device");let t;if(e!=null){if(e instanceof kx)t=e;else{const s=Vr(ae().getNumber("WEBGL_VERSION"),e);t=new kx(s)}this.binaryCache={},this.gpgpuCreatedLocally=!1}else{const s=Vr(ae().getNumber("WEBGL_VERSION"));t=new kx(s),this.binaryCache=sre(ae().getNumber("WEBGL_VERSION")),this.gpgpuCreatedLocally=!0}this.gpgpu=t,this.canvas=this.gpgpu.gl.canvas,this.textureManager=new zse(this.gpgpu),this.numMBBeforeWarning=ire(),this.texData=new H2(this,qr())}numDataIds(){return this.texData.numDataIds()-this.pendingDeletes}writeTexture(e,t,s,r,o,i){const a=this.makeTensorInfo(t,s),l=this.texData.get(a.dataId);l.isPacked=!1,l.texture={texture:e,texShape:[r,o]},l.texShape=[r,o];const u=Hp(t),h=new RI(u,!1,i),p=this.runWebGLProgram(h,[a],s,[[r,o]]);return p.shape=t,l.texture=null,this.disposeIntermediateTensorInfo(a),p.dataId}write(e,t,s){if((ae().getBool("WEBGL_CHECK_NUMERICAL_PROBLEMS")||ae().getBool("DEBUG"))&&this.checkNumericalProblems(e),s==="complex64"&&e!=null)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");const r={id:this.nextDataId()};return this.texData.set(r,{shape:t,dtype:s,values:e,usage:Gs.UPLOAD,refCount:1}),r}refCount(e){return this.texData.has(e)?this.texData.get(e).refCount:0}incRef(e){const t=this.texData.get(e);t.refCount++}decRef(e){if(this.texData.has(e)){const t=this.texData.get(e);t.refCount--}}move(e,t,s,r,o){if(ae().getBool("DEBUG")&&this.checkNumericalProblems(t),r==="complex64")throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");this.texData.set(e,{shape:s,dtype:r,values:t,usage:Gs.UPLOAD,refCount:o})}disposeIntermediateTensorInfo(e){this.disposeData(e.dataId)}readSync(e){const t=this.texData.get(e),{values:s,dtype:r,complexTensorInfos:o,slice:i,shape:a,isPacked:l}=t;if(i!=null){let f;l?f=new di(a,ui):f=new Jr(a,ui);const m=this.runWebGLProgram(f,[{dataId:e,shape:a,dtype:r}],r),y=this.readSync(m.dataId);return this.disposeIntermediateTensorInfo(m),y}if(s!=null)return this.convertAndCacheOnCPU(e);if(r==="string")return s;const u=this.activeTimers!=null;let h;u&&(h=us());let p;if(r==="complex64"){const f=this.readSync(o.real.dataId),m=this.readSync(o.imag.dataId);p=Oo(f,m)}else p=this.getValuesFromTexture(e);return u&&(this.downloadWaitMs+=us()-h),this.convertAndCacheOnCPU(e,p)}async read(e){if(this.pendingRead.has(e)){const y=this.pendingRead.get(e);return new Promise(x=>y.push(x))}const t=this.texData.get(e),{values:s,shape:r,slice:o,dtype:i,complexTensorInfos:a,isPacked:l}=t;if(o!=null){let y;l?y=new di(r,ui):y=new Jr(r,ui);const x=this.runWebGLProgram(y,[{dataId:e,shape:r,dtype:i}],i),v=this.read(x.dataId);return this.disposeIntermediateTensorInfo(x),v}if(s!=null)return this.convertAndCacheOnCPU(e);if(ae().getBool("DEBUG")&&!ae().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")&&ae().getNumber("WEBGL_VERSION")===2)throw new Error("tensor.data() with WEBGL_DOWNLOAD_FLOAT_ENABLED=false and WEBGL_VERSION=2 not yet supported.");let u=null,h;if(i!=="complex64"&&ae().get("WEBGL_BUFFER_SUPPORTED")){h=this.decode(e);const y=this.texData.get(h.dataId);u=this.gpgpu.createBufferFromTexture(y.texture.texture,...Up(r))}this.pendingRead.set(e,[]),i!=="complex64"&&await this.gpgpu.createAndWaitForFence();let p;if(i==="complex64"){const y=await Promise.all([this.read(a.real.dataId),this.read(a.imag.dataId)]),x=y[0],v=y[1];p=Oo(x,v)}else if(u==null)p=this.getValuesFromTexture(e);else{const y=fe(r);p=this.gpgpu.downloadFloat32MatrixFromBuffer(u,y)}if(h!=null&&this.disposeIntermediateTensorInfo(h),u!=null){const y=this.gpgpu.gl;$e(y,()=>y.deleteBuffer(u))}const f=this.convertAndCacheOnCPU(e,p),m=this.pendingRead.get(e);return this.pendingRead.delete(e),m.forEach(y=>y(f)),this.pendingDisposal.has(e)&&(this.pendingDisposal.delete(e),this.disposeData(e)&&qr().removeDataId(e,this),this.pendingDeletes--),f}readToGPU(e,t={}){const s=this.texData.get(e),{values:r,shape:o,slice:i,dtype:a,isPacked:l,texture:u}=s;if(a==="complex64")throw new Error("Does not support reading texture for complex64 dtype.");if(i!=null){let m;l?m=new di(o,ui):m=new Jr(o,ui);const y=this.runWebGLProgram(m,[{dataId:e,shape:o,dtype:a}],a),x=this.readToGPU(y,t);return this.disposeIntermediateTensorInfo(y),x}if(u==null)throw r!=null?new Error("Data is not on GPU but on CPU."):new Error("There is no data on GPU or CPU.");const h=this.decode(e,t.customTexShape),p=qr().makeTensorFromTensorInfo(h),f=this.texData.get(h.dataId);return Object.assign({tensorRef:p},f.texture)}bufferSync(e){const t=this.readSync(e.dataId);if(e.dtype==="string")try{const s=t.map(r=>vi(r));return nt(e.shape,e.dtype,s)}catch{throw new Error("Failed to decode encoded string bytes into utf-8")}return nt(e.shape,e.dtype,t)}checkNumericalProblems(e){if(e!=null)for(let t=0;t<e.length;t++){const s=e[t];if(!ute(s))throw ae().getBool("WEBGL_RENDER_FLOAT32_CAPABLE")?Error(`The value ${s} cannot be represented with your current settings. Consider enabling float32 rendering: 'tf.env().set('WEBGL_RENDER_FLOAT32_ENABLED', true);'`):Error(`The value ${s} cannot be represented on this device.`)}}getValuesFromTexture(e){const{shape:t,dtype:s,isPacked:r}=this.texData.get(e),o=fe(t);if(ae().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")){const f=this.decode(e),m=this.texData.get(f.dataId),y=this.gpgpu.downloadMatrixFromPackedTexture(m.texture.texture,...Up(t)).subarray(0,o);return this.disposeIntermediateTensorInfo(f),y}const i=ae().getBool("WEBGL_PACK")&&r===!0,a=i?Hp(t):t,l=i?new Tne(a):new kne(a),u=this.runWebGLProgram(l,[{shape:a,dtype:s,dataId:e}],"float32"),h=this.texData.get(u.dataId),p=this.gpgpu.downloadByteEncodedFloatMatrixFromOutputTexture(h.texture.texture,h.texShape[0],h.texShape[1]).subarray(0,o);return this.disposeIntermediateTensorInfo(u),p}timerAvailable(){return ae().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0}time(e){const t=this.activeTimers,s=[];let r=!1;this.programTimersStack==null?(this.programTimersStack=s,r=!0):this.activeTimers.push(s),this.activeTimers=s,e();const o=ka(this.activeTimers.map(l=>l.query)).filter(l=>l!=null),i=ka(this.activeTimers.map(l=>l.name)).filter(l=>l!=null);this.activeTimers=t,r&&(this.programTimersStack=null);const a={uploadWaitMs:this.uploadWaitMs,downloadWaitMs:this.downloadWaitMs,kernelMs:null,wallMs:null};return(async()=>{if(ae().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0){const l=await Promise.all(o);a.kernelMs=IV(l),a.getExtraProfileInfo=()=>l.map((u,h)=>({name:i[h],ms:u})).map(u=>`${u.name}: ${u.ms}`).join(", ")}else a.kernelMs={error:"WebGL query timers are not supported in this environment."};return this.uploadWaitMs=0,this.downloadWaitMs=0,a})()}memory(){return{unreliable:!1,numBytesInGPU:this.numBytesInGPU,numBytesInGPUAllocated:this.textureManager.numBytesAllocated,numBytesInGPUFree:this.textureManager.numBytesFree}}startTimer(){return ae().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?this.gpgpu.beginQuery():{startMs:us(),endMs:null}}endTimer(e){return ae().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?(this.gpgpu.endQuery(),e):(e.endMs=us(),e)}async getQueryTime(e){if(ae().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0)return this.gpgpu.waitForQueryAndGetTime(e);const t=e;return t.endMs-t.startMs}disposeData(e,t=!1){if(this.pendingDisposal.has(e))return!1;if(!this.texData.has(e))return!0;if(t?this.texData.get(e).refCount=0:this.texData.get(e).refCount--,!t&&this.texData.get(e).refCount>0)return!1;if(this.pendingRead.has(e))return this.pendingDisposal.add(e),this.pendingDeletes++,!1;this.releaseGPUData(e);const{complexTensorInfos:s}=this.texData.get(e);return s!=null&&(this.disposeData(s.real.dataId,t),this.disposeData(s.imag.dataId,t)),this.texData.delete(e),!0}releaseGPUData(e){const{texture:t,dtype:s,texShape:r,usage:o,isPacked:i,slice:a}=this.texData.get(e),l=a&&a.origDataId||e,u=this.dataRefCount.get(l);u>1?this.dataRefCount.set(l,u-1):(this.dataRefCount.delete(l),t!=null&&(this.numBytesInGPU-=this.computeBytes(r,s),this.textureManager.releaseTexture(t,r,o,i)));const h=this.texData.get(e);h.texture=null,h.texShape=null,h.isPacked=!1,h.slice=null}getTexture(e){return this.uploadToGPU(e),this.texData.get(e).texture.texture}getDataInfo(e){return this.texData.get(e)}shouldExecuteOnCPU(e,t=rre){return ae().getBool("WEBGL_CPU_FORWARD")&&e.every(s=>this.texData.get(s.dataId).texture==null&&fe(s.shape)<t)}getGPGPUContext(){return this.gpgpu}where(e){Us("tf.where() in webgl locks the UI thread. Call tf.whereAsync() instead");const t=e.dataSync();return ere(e.shape,t)}packedUnaryOp(e,t,s){const r=new di(e.shape,t),o=this.compileAndRun(r,[e],s);return qr().makeTensorFromTensorInfo(o)}abs(e){if(this.shouldExecuteOnCPU([e])&&e.dtype!=="complex64"){const r=fF(this.texData.get(e.dataId).values);return this.makeOutput(e.shape,e.dtype,r)}if(ae().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,_I,e.dtype);const t=new Jr(e.shape,_I),s=this.compileAndRun(t,[e]);return qr().makeTensorFromTensorInfo(s)}makeTensorInfo(e,t,s){let r;if(t==="string"&&s!=null&&s.length>0&&th(s[0])){const o=s.map(i=>gi(i));r=this.write(o,e,t)}else r=this.write(s,e,t);return this.texData.get(r).usage=null,{dataId:r,shape:e,dtype:t}}makeOutput(e,t,s){return qr().makeTensorFromTensorInfo(this.makeTensorInfo(e,t,s),this)}unpackTensor(e){const t=new Jse(e.shape);return this.runWebGLProgram(t,[e],e.dtype)}packTensor(e){const t=new Lse(e.shape);return this.runWebGLProgram(t,[e],e.dtype,null,!0)}packedReshape(e,t){const s=[nu(e.shape),...su(e.shape)],r={dtype:e.dtype,shape:s,dataId:e.dataId},o=[nu(t),...su(t)],i=new yF(o,s),a=!0,l=[s],u=this.runWebGLProgram(i,[r],e.dtype,l,a);return{dataId:u.dataId,shape:t,dtype:u.dtype}}decode(e,t){const s=this.texData.get(e),{isPacked:r,shape:o,dtype:i}=s;if(t!=null){const f=fe(o),m=t[0]*t[1]*4;L(f<=m,()=>"customTexShape is too small. Row * Column * 4 should be equal or larger than the size of the tensor data.")}const a=Hp(o);let l;r?l=new Cne(a):l=new Sne(a);const u=!0,h=[t??Up(a)],p=this.runWebGLProgram(l,[{shape:a,dtype:i,dataId:e}],i,h,u,t);return{dtype:i,shape:o,dataId:p.dataId}}runWebGLProgram(e,t,s,r,o=!1,i){const a=this.makeTensorInfo(e.outputShape,s),l=this.texData.get(a.dataId);if(e.packedOutput&&(l.isPacked=!0),e.outPackingScheme===Wc.DENSE){const w=i??Up(e.outputShape);l.texShape=w.map(S=>S*2)}if(e.outTexUsage!=null&&(l.usage=e.outTexUsage),fe(a.shape)===0)return l.values=Fn(a.dtype,0),a;const u=[],h=t.map(w=>{if(w.dtype==="complex64")throw new Error("GPGPUProgram does not support complex64 input. For complex64 dtypes, please separate the program into real and imaginary parts.");let S=this.texData.get(w.dataId);if(S.texture==null){if(!e.packedInputs&&fe(w.shape)<=ae().getNumber("WEBGL_SIZE_UPLOAD_UNIFORM"))return{shape:w.shape,texData:null,isUniform:!0,uniformValues:S.values};e.packedInputs&&(S.isPacked=!0,S.shape=w.shape)}if(this.uploadToGPU(w.dataId),!!S.isPacked!=!!e.packedInputs)w=S.isPacked?this.unpackTensor(w):this.packTensor(w),u.push(w),S=this.texData.get(w.dataId);else if(S.isPacked&&!Xf(S.shape,w.shape)){const k=w,T=w.shape;w.shape=S.shape,w=this.packedReshape(w,T),u.push(w),S=this.texData.get(w.dataId),k.shape=T}return{shape:w.shape,texData:S,isUniform:!1}});this.uploadToGPU(a.dataId);const p={shape:a.shape,texData:l,isUniform:!1},f=bne(e,h,p),m=this.getAndSaveBinary(f,()=>vne(this.gpgpu,e,h,p)),y=this.activeTimers!=null;let x;y&&(x=this.startTimer()),ae().get("ENGINE_COMPILE_ONLY")||wne(this.gpgpu,m,h,p,r),u.forEach(w=>this.disposeIntermediateTensorInfo(w)),y&&(x=this.endTimer(x),this.activeTimers.push({name:e.constructor.name,query:this.getQueryTime(x)}));const v=ae().getNumber("WEBGL_FLUSH_THRESHOLD");if(v>0){const w=us();w-this.lastGlFlushTime>v&&(this.gpgpu.gl.flush(),this.lastGlFlushTime=w)}if(!ae().getBool("WEBGL_LAZILY_UNPACK")&&l.isPacked&&o===!1){const w=this.unpackTensor(a);return this.disposeIntermediateTensorInfo(a),w}return a}compileAndRun(e,t,s,r,o=!1){return s=s||t[0].dtype,this.runWebGLProgram(e,t,s,r,o)}getAndSaveBinary(e,t){return e in this.binaryCache||(this.binaryCache[e]=t()),this.binaryCache[e]}getTextureManager(){return this.textureManager}dispose(){this.disposed||(ae().getBool("IS_TEST")||Object.keys(this.binaryCache).forEach(t=>{this.gpgpu.deleteProgram(this.binaryCache[t].webGLProgram),delete this.binaryCache[t]}),this.textureManager.dispose(),this.canvas!=null&&typeof HTMLCanvasElement<"u"&&this.canvas instanceof HTMLCanvasElement?this.canvas.remove():this.canvas=null,this.gpgpuCreatedLocally&&(this.gpgpu.program=null,this.gpgpu.dispose()),this.disposed=!0)}floatPrecision(){return this.floatPrecisionValue==null&&(this.floatPrecisionValue=ie(()=>{if(!ae().get("WEBGL_RENDER_FLOAT32_ENABLED")){const e=ae().getBool("DEBUG");ae().set("DEBUG",!1);const t=this.abs(We(1e-8)).dataSync()[0];if(ae().set("DEBUG",e),t>0)return 32}return 16})),this.floatPrecisionValue}epsilon(){return this.floatPrecision()===32?tre:nre}uploadToGPU(e){const t=this.texData.get(e),{shape:s,dtype:r,values:o,texture:i,usage:a,isPacked:l}=t;if(i!=null)return;const u=this.activeTimers!=null;let h;u&&(h=us());let p=t.texShape;if(p==null&&(p=Ite(s,l),t.texShape=p),o!=null){const f=Hp(s);let m,y=p[1],x=p[0];const v=o instanceof Uint8Array||o instanceof Uint8ClampedArray;(l||!v)&&([y,x]=yu(p[0],p[1])),l?m=new Ine(f,v):m=new RI(f,v);const w=v?[x,y]:p,S=this.makeTensorInfo(w,r),k=this.texData.get(S.dataId);v?k.usage=Gs.PIXELS:k.usage=Gs.UPLOAD,k.texShape=w,this.gpgpu.uploadDenseMatrixToTexture(this.getTexture(S.dataId),y,x,o);const T=[[x,y]],E=this.runWebGLProgram(m,[S],r,T,!0),D=this.texData.get(E.dataId);t.texShape=D.texShape,t.isPacked=D.isPacked,t.usage=D.usage,ae().get("ENGINE_COMPILE_ONLY")?this.disposeData(E.dataId):(t.texture=D.texture,t.values=null,this.texData.delete(E.dataId)),this.disposeIntermediateTensorInfo(S),u&&(this.uploadWaitMs+=us()-h)}else{const f=this.acquireTexture(p,a,r,l);t.texture=f}}convertAndCacheOnCPU(e,t){const s=this.texData.get(e),{dtype:r}=s;return t!=null&&(s.values=are(t,r)),s.values}acquireTexture(e,t,s,r){if(this.numBytesInGPU+=this.computeBytes(e,s),!this.warnedAboutMemory&&this.numBytesInGPU>this.numMBBeforeWarning*1024*1024){const o=(this.numBytesInGPU/1024/1024).toFixed(2);this.warnedAboutMemory=!0,console.warn(`High memory usage in GPU: ${o} MB, most likely due to a memory leak`)}return this.textureManager.acquireTexture(e,t,r)}computeBytes(e,t){return e[0]*e[1]*kf(t)}checkCompileCompletion(){for(const[,e]of Object.entries(this.binaryCache))this.checkCompletion_(e)}async checkCompileCompletionAsync(){const e=[];if(this.gpgpu.parallelCompilationExtension){for(const[,t]of Object.entries(this.binaryCache))e.push(this.checkCompletionAsync_(t));return Promise.all(e)}else{for(const[,t]of Object.entries(this.binaryCache)){const s=new Promise(r=>{try{this.checkCompletion_(t),r(!0)}catch(o){throw o}});e.push(s)}return Promise.all(e)}}async checkCompletionAsync_(e){return this.gpgpu.gl.getProgramParameter(e.webGLProgram,this.gpgpu.parallelCompilationExtension.COMPLETION_STATUS_KHR)?this.checkCompletion_(e):(await tD(),this.checkCompletionAsync_(e))}checkCompletion_(e){if(this.gpgpu.gl.getProgramParameter(e.webGLProgram,this.gpgpu.gl.LINK_STATUS)===!1)throw console.log(this.gpgpu.gl.getProgramInfoLog(e.webGLProgram)),this.gpgpu.gl.getShaderParameter(e.fragmentShader,this.gpgpu.gl.COMPILE_STATUS)===!1?(nF(e.source,this.gpgpu.gl.getShaderInfoLog(e.fragmentShader)),new Error("Failed to compile fragment shader.")):new Error("Failed to link vertex and fragment shaders.");return!0}getUniformLocations(){for(const e of Object.values(this.binaryCache)){this.gpgpu.buildVao(e.webGLProgram);const{variablesLocations:t,customUniformLocations:s,infLoc:r,nanLoc:o,outShapeLocation:i,outShapeStridesLocation:a,outTexShapeLocation:l}=aF(this.gpgpu,e.program,e.webGLProgram);e.variablesLocations=t,e.customUniformLocations=s,e.infLoc=r,e.nanLoc=o,e.outShapeLocation=i,e.outShapeStridesLocation=a,e.outTexShapeLocation=l}}createTensorFromGPUData(e,t,s){e.channels=e.channels||"RGBA";const{texture:r,height:o,width:i,channels:a}=e,l=qr().backend;if(!l.gpgpu.gl.isTexture(r))throw new Error("The texture is invalid. Also, please make sure the texture and the TFJS WebGL backend are using the same canvas. If you want to use your own custom canvas, you have to create and use the custom TFJS WebGL backend created from the canvas through 'new tf.MathBackendWebGL(customCanvas)'.");const u=l.writeTexture(r,t,s,o,i,a);return qr().makeTensorFromDataId(u,t,s,l)}}ey.nextDataId=0;function are(n,e){if(e==="float32"||e==="complex64")return n;if(e==="int32"||e==="bool"){const t=e==="int32"?new Int32Array(n.length):new Uint8Array(n.length);for(let s=0;s<t.length;++s)t[s]=Math.round(n[s]);return t}else throw new Error(`Unknown dtype ${e}`)}/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */pE()&&gE("webgl",()=>new ey,2);/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const CS=`
  if (isnan(a)) return a;
  if (isnan(b)) return b;
`;class Pa{constructor(e,t,s){this.variableNames=["A","B"],this.outputShape=Ze(t,s),this.enableShapeUniforms=Xn(this.outputShape.length),this.userCode=`
      float binaryOperation(float a, float b) {
        ${e}
      }

      void main() {
        float a = getAAtOutCoords();
        float b = getBAtOutCoords();
        setOutput(binaryOperation(a, b));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qa=`
  result.r = isNaN.r ? NAN : result.r;
  result.g = isNaN.g ? NAN : result.g;
  result.b = isNaN.b ? NAN : result.b;
  result.a = isNaN.a ? NAN : result.a;
`;class Su{constructor(e,t,s,r=!1){this.variableNames=["A","B"],this.supportsBroadcasting=!0,this.packedInputs=!0,this.packedOutput=!0,this.outputShape=Ze(t,s);const o=this.outputShape.length;this.enableShapeUniforms=Xn(o);let i="";if(r)if(o===0||fe(this.outputShape)===1)i=`
          result.y = 0.;
          result.z = 0.;
          result.w = 0.;
        `;else if(i=`
          ${St(o)} coords = getOutputCoords();
        `,o===1)this.enableShapeUniforms?i+=`
            result.y = (coords + 1) >= outShape ? 0. : result.y;
            result.z = 0.;
            result.w = 0.;
          `:i+=`
            result.y = (coords + 1) >= ${this.outputShape[0]} ? 0. : result.y;
            result.z = 0.;
            result.w = 0.;
          `;else{const l=ns("coords",o);this.enableShapeUniforms?i+=`
            bool nextRowOutOfBounds =
              (${l[o-2]} + 1) >= outShape[${o} - 2];
            bool nextColOutOfBounds =
              (${l[o-1]} + 1) >= outShape[${o} - 1];
            result.y = nextColOutOfBounds ? 0. : result.y;
            result.z = nextRowOutOfBounds ? 0. : result.z;
            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;
          `:i+=`
            bool nextRowOutOfBounds =
              (${l[o-2]} + 1) >= ${this.outputShape[o-2]};
            bool nextColOutOfBounds =
              (${l[o-1]} + 1) >= ${this.outputShape[o-1]};
            result.y = nextColOutOfBounds ? 0. : result.y;
            result.z = nextRowOutOfBounds ? 0. : result.z;
            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;
          `}this.userCode=`
      vec4 binaryOperation(vec4 a, vec4 b) {
        ${e}
      }

      void main() {
        vec4 a = getAAtOutCoords();
        vec4 b = getBAtOutCoords();

        vec4 result = binaryOperation(a, b);
        ${i}

        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ps(n){const{inputs:e,backend:t}=n,{x:s}=e;return t.incRef(s.dataId),{dataId:s.dataId,shape:s.shape,dtype:s.dtype}}const lre={kernelName:Sh,backendName:"webgl",kernelFunc:Ps};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Gi(n){const{inputs:e,backend:t}=n,{real:s,imag:r}=e,o=t.makeTensorInfo(s.shape,"complex64"),i=t.texData.get(o.dataId),a=Ps({inputs:{x:s},backend:t}),l=Ps({inputs:{x:r},backend:t});return i.complexTensorInfos={real:a,imag:l},o}const ure={kernelName:Dw,backendName:"webgl",kernelFunc:Gi};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xF="return (a < 0.) ? b * a : a;",vF=`
  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));
  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);
`;function cre(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{alpha:o}=s,i=t.makeTensorInfo([],"float32",_i(o,"float32")),a=ae().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Su(vF,r.shape,i.shape):new Pa(xF,r.shape,i.shape),l=t.runWebGLProgram(a,[r,i],"float32");return t.disposeIntermediateTensorInfo(i),l}const hre={kernelName:_m,backendName:"webgl",kernelFunc:cre};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wF="return (a < 0.) ? b * a : a;",bF=`
  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));
  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);
`;function dre(n){const{inputs:e,backend:t}=n,{x:s,alpha:r}=e,o=ae().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Su(bF,s.shape,r.shape):new Pa(wF,s.shape,r.shape);return t.runWebGLProgram(o,[s,r],"float32")}const pre={kernelName:Jm,backendName:"webgl",kernelFunc:dre};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Cu="if (isnan(x)) return x;";function pt({opSnippet:n,packedOpSnippet:e,cpuKernelImpl:t,dtype:s}){return({inputs:r,backend:o})=>{const{x:i}=r,a=o,l=s||i.dtype;if(a.shouldExecuteOnCPU([i])&&t!=null){const p=a.texData.get(i.dataId),f=t(p.values,l);return a.makeTensorInfo(i.shape,l,f)}const u=ae().getBool("WEBGL_PACK_UNARY_OPERATIONS")&&e!=null;let h;return u?h=new di(i.shape,e):h=new Jr(i.shape,n),a.runWebGLProgram(h,[i],l)}}function Vn({opSnippet:n,packedOpSnippet:e,checkOutOfBounds:t=!1,supportsComplex:s=!1,cpuKernelImpl:r,dtype:o}){return({inputs:i,backend:a})=>{const{a:l,b:u}=i,h=a;if(s&&l.dtype==="complex64"){const y=h.texData.get(l.dataId),x=h.texData.get(u.dataId),[v,w]=[[y.complexTensorInfos.real,x.complexTensorInfos.real],[y.complexTensorInfos.imag,x.complexTensorInfos.imag]].map(k=>{const[T,I]=k,E={dataId:T.dataId,dtype:T.dtype,shape:l.shape},D={dataId:I.dataId,dtype:I.dtype,shape:u.shape},O=new Pa(n,l.shape,u.shape);return h.runWebGLProgram(O,[E,D],Ds(T.dtype,I.dtype))}),S=Gi({inputs:{real:v,imag:w},backend:h});return h.disposeIntermediateTensorInfo(v),h.disposeIntermediateTensorInfo(w),S}const p=o||Ds(l.dtype,u.dtype);if((l.dtype==="string"||u.dtype==="string"||h.shouldExecuteOnCPU([l,u]))&&r!=null){const y=h.texData.get(l.dataId).values,x=h.texData.get(u.dataId).values,v=l.dtype==="string"?_o(y):y,w=l.dtype==="string"?_o(x):x,[S,k]=r(l.shape,u.shape,v,w,p),T=h.makeTensorInfo(k,p),I=h.texData.get(T.dataId);return I.values=S,T}const f=ae().getBool("WEBGL_PACK_BINARY_OPERATIONS")&&e!=null;let m;return f?m=new Su(e,l.shape,u.shape,t):m=new Pa(n,l.shape,u.shape),h.runWebGLProgram(m,[l,u],p)}}function Uc(n,e=!1){if(n==="linear")return e?qse:Use;if(n==="relu")return e?Yse:jse;if(n==="elu")return e?Xse:Gse;if(n==="relu6")return e?Qse:Hse;if(n==="prelu")return e?bF:wF;if(n==="leakyrelu")return e?vF:xF;if(n==="sigmoid")return e?Zse:Kse;throw new Error(`Activation ${n} has not been implemented for the WebGL backend.`)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class SF{constructor(e,t,s,r=!1,o=!1,i=!1,a=null,l=!1,u=!1){this.variableNames=["matrixA","matrixB"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=s,this.enableShapeUniforms=Xn(this.outputShape.length);const h=r?e[1]:e[2],p=Math.ceil(h/2),f=r?"i * 2, rc.y":"rc.y, i * 2",m=o?"rc.z, i * 2":"i * 2, rc.z",y=r?["a.xxyy","a.zzww"]:["a.xxzz","a.yyww"],x=o?["b.xzxz","b.ywyw"]:["b.xyxy","b.zwzw"];let v="",w="";a&&(l?v=`vec4 activation(vec4 a) {
          vec4 b = getPreluActivationWeightsAtOutCoords();
          ${a}
        }`:u?v=`vec4 activation(vec4 a) {
          vec4 b = getLeakyreluAlphaAtOutCoords();
          ${a}
        }`:v=`vec4 activation(vec4 x) {
          ${a}
        }`,w="result = activation(result);");const S=i?"result += getBiasAtOutCoords();":"";i&&this.variableNames.push("bias"),l&&this.variableNames.push("preluActivationWeights"),u&&this.variableNames.push("leakyreluAlpha");let k="rc.x",T="rc.x";e[0]<t[0]?k=`imod(rc.x, ${e[0]})`:t[0]<e[0]&&(T=`imod(rc.x, ${t[0]})`),this.userCode=`
      ${v}
      // Don't use uniform for sharedDimensionPacked for performance.
      const float sharedDimension = ${p}.0;

      vec4 dot2x2ARowBCol(ivec3 rc) {
        vec4 result = vec4(0);
        int batchA = ${k};
        int batchB = ${T};
        for (int i = 0; i < ${p}; i++) {
          vec4 a = getMatrixA(batchA, ${f});
          vec4 b = getMatrixB(batchB, ${m});

          // These swizzled products need to be separately added.
          // See: https://github.com/tensorflow/tfjs/issues/1735
          result += (${y[0]} * ${x[0]});
          result += (${y[1]} * ${x[1]});
        }
        return result;
      }

      void main() {
        ivec3 rc = getOutputCoords();
        vec4 result = dot2x2ARowBCol(rc);

        ${S}

        ${w}

        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const FI={REAL:"return areal * breal - aimag * bimag;",IMAG:"return areal * bimag + aimag * breal;"};class PI{constructor(e,t,s){this.variableNames=["AReal","AImag","BReal","BImag"],this.outputShape=Ze(t,s),this.userCode=`
      float binaryOpComplex(
          float areal, float aimag, float breal, float bimag) {
        ${e}
      }

      void main() {
        float areal = getARealAtOutCoords();
        float aimag = getAImagAtOutCoords();
        float breal = getBRealAtOutCoords();
        float bimag = getBImagAtOutCoords();
        setOutput(binaryOpComplex(areal, aimag, breal, bimag));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const LI="return a * b;";function kS(n){const{inputs:e,backend:t}=n,{a:s,b:r}=e,o=Ds(s.dtype,r.dtype);if(s.dtype==="complex64"){const a=t.texData.get(s.dataId),l=t.texData.get(r.dataId),u=new PI(FI.REAL,s.shape,r.shape),h=new PI(FI.IMAG,s.shape,r.shape),p=[{dataId:a.complexTensorInfos.real.dataId,dtype:a.complexTensorInfos.real.dtype,shape:s.shape},{dataId:a.complexTensorInfos.imag.dataId,dtype:a.complexTensorInfos.imag.dtype,shape:s.shape},{dataId:l.complexTensorInfos.real.dataId,dtype:l.complexTensorInfos.real.dtype,shape:r.shape},{dataId:l.complexTensorInfos.imag.dataId,dtype:l.complexTensorInfos.imag.dtype,shape:r.shape}],f=t.runWebGLProgram(u,p,"float32"),m=t.runWebGLProgram(h,p,"float32"),y=Gi({inputs:{real:f,imag:m},backend:t});return t.disposeIntermediateTensorInfo(f),t.disposeIntermediateTensorInfo(m),y}if(t.shouldExecuteOnCPU([s,r])){const a=t.texData.get(s.dataId),l=t.texData.get(r.dataId),[u,h]=dse(s.shape,r.shape,a.values,l.values,o),p=t.makeTensorInfo(h,o),f=t.texData.get(p.dataId);return f.values=u,p}let i;return ae().getBool("WEBGL_PACK_BINARY_OPERATIONS")?i=new Su(LI,s.shape,r.shape):i=new Pa(LI,s.shape,r.shape),t.runWebGLProgram(i,[s,r],o)}const fre={kernelName:Dh,backendName:"webgl",kernelFunc:kS};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mre(n,e,t){const s=[nu(n.shape),...su(n.shape)],r={dtype:n.dtype,shape:s,dataId:n.dataId},o=[nu(e),...su(e)],i=new yF(o,s),a=!0,l=[s],u=t.runWebGLProgram(i,[r],n.dtype,l,a);return{dataId:u.dataId,shape:e,dtype:u.dtype}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Te(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{shape:o}=s,i=t,a=fe(r.shape),l=K2(o,a),u=fe(l);L(a===u,()=>`The new shape (${l}) has ${u} elements and the old shape (${r.shape}) has ${a} elements. The new shape and old shape must have the same number of elements.`);const h=i.texData.get(r.dataId);return h.isPacked&&!Xf(r.shape,l)&&!(h.texture!==null&&Xf(h.shape,l))?mre(r,l,i):(i.incRef(r.dataId),{dataId:r.dataId,shape:l,dtype:r.dtype})}const gre={kernelName:tg,backendName:"webgl",kernelFunc:Te};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class MI{constructor(e,t){this.variableNames=["x"];const{windowSize:s,batchSize:r,inSize:o,outSize:i}=e;this.outputShape=[r,i];const a=Math.floor(s/4)*4,l=s%4;let u="sumValue += dot(values, ones);";if(t!=null){const p=1/t;u=`sumValue += dot(values * ${Hl(p)?p.toPrecision(2):p}, ones);`}let h="";o%s>0&&(h=`
        if (inIdx < 0 || inIdx >= ${o}) {
          return 0.0;
        }
      `),this.userCode=`
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float getValue(int batch, int inIdx) {
        ${h}
        return getX(batch, inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * ${s};

        float sumValue = 0.0;

        for (int i = 0; i < ${a}; i += 4) {
          int inIdx = inOffset + i;
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          ${u}
        }

        int inIdx = inOffset + ${a};
        if (${l===1}) {
          vec4 values = vec4(getValue(batch, inIdx), 0.0, 0.0, 0.0);

          ${u}
        } else if (${l===2}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1), 0.0, 0.0);

          ${u}
        } else if (${l===3}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2), 0.0);

          ${u}
        }
        setOutput(sumValue);
      }
    `}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class yre{constructor(e,t){this.variableNames=["x"];const{windowSize:s,batchSize:r,inSize:o,outSize:i}=e;this.outputShape=[r,i];let a="0.0",l="";t==="prod"?a="1.0":t==="min"?(a="1.0 / 1e-20",l="min"):t==="max"&&(a="-1.0 / 1e-20",l="max");let u=`${t}(${t}(${t}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;t==="sum"?u="sumValue":t==="prod"?u="prodValue":t==="all"?u="allValue":t==="any"&&(u="anyValue");const h=Math.floor(s/4)*4,p=s%4;let f=`
      if (${t==="sum"}) {
        sumValue += dot(values, ones);
      } else if (${t==="prod"}) {
        vec2 tmp = vec2(values[0], values[1]) * vec2(values[2], values[3]);
        prodValue *= tmp[0] * tmp[1];
      } else {
        minMaxValue = ${l}(values, minMaxValue);
        if (${t==="min"} || ${t==="max"}) {
          minMaxValue = ${l}(values, minMaxValue);
          bvec4 isNaN = isnan(values);
          if (isNaN.r || isNaN.g || isNaN.b || isNaN.a) {
            minMaxValue = vec4(NAN);
          }
        }
      }
    `,m="vec4";t==="all"?(a="1.0",f=`
        bool reducedAllValue = all(values);
        float floatedReducedAllValue = float(reducedAllValue);
        allValue = float(allValue >= 1.0 && floatedReducedAllValue >= 1.0);
      `,m="bvec4"):t==="any"&&(a="0.0",f=`
        bool reducedAnyValue = any(values);
        float floatedReducedAnyValue = float(reducedAnyValue);
        anyValue = float(anyValue >= 1.0 || floatedReducedAnyValue >= 1.0);
      `,m="bvec4");let y="";o%s>0&&(y=`
        if (inIdx < 0 || inIdx >= ${o}) {
          return initializationValue;
        }
      `),this.userCode=`
      const float initializationValue = ${a};
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float getValue(int batch, int inIdx) {
        ${y}
        return getX(batch, inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * ${s};

        vec4 minMaxValue = vec4(${a});
        float prodValue = 1.0;
        float sumValue = 0.0;
        float allValue = 1.0;
        float anyValue = 0.0;

        for (int i = 0; i < ${h}; i += 4) {
          int inIdx = inOffset + i;
          ${m} values = ${m}(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          ${f}
        }

        int inIdx = inOffset + ${h};
        if (${p===1}) {
          ${m} values = ${m}(
            getValue(batch, inIdx),
            initializationValue,
            initializationValue,
            initializationValue
          );

          ${f}
        } else if (${p===2}) {
          ${m} values = ${m}(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            initializationValue,
            initializationValue
          );

          ${f}
        } else if (${p===3}) {
          ${m} values = ${m}(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            initializationValue
          );

          ${f}
        }
        setOutput(${u});
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xre(n){const e=[];for(;e.length===0||e[e.length-1].outSize!==1;){const t=e.length?e[e.length-1].outSize:n[1],s=Mg(t);e.push({inSize:t,windowSize:s,outSize:Math.ceil(t/s)})}return e}function Xa(n,e,t,s){const r=xre(n.shape);let o=n;for(let i=0;i<r.length;i++){const{inSize:a,windowSize:l,outSize:u}=r[i];let h,p;t==="mean"?h=i===0?new MI({windowSize:l,inSize:a,batchSize:n.shape[0],outSize:u},a):new MI({windowSize:l,inSize:a,batchSize:n.shape[0],outSize:u}):h=new yre({windowSize:l,inSize:a,batchSize:n.shape[0],outSize:u},t),p=o,o=s.runWebGLProgram(h,[o],e),p.dataId!==n.dataId&&s.disposeIntermediateTensorInfo(p)}return o}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class vre{constructor(e,t){this.variableNames=["A"];const s=new Array(e.length);for(let i=0;i<s.length;i++)s[i]=e[t[i]];this.outputShape=s,this.rank=s.length;const r=St(this.rank),o=wre(t);this.userCode=`
    void main() {
      ${r} resRC = getOutputCoords();
      setOutput(getA(${o}));
    }
    `}}function wre(n){const e=n.length;if(e>6)throw Error(`Transpose for rank ${e} is not yet supported`);const t=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u","resRC.v"],s=new Array(e);for(let r=0;r<n.length;r++)s[n[r]]=t[r];return s.join()}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class bre{constructor(e,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0;const s=new Array(e.length);for(let h=0;h<s.length;h++)s[h]=e[t[h]];if(this.outputShape=s,this.rank=s.length,this.rank>6)throw Error(`Packed transpose for rank ${this.rank} is not yet supported.`);const r=St(this.rank),o=gF("rc",this.rank),i=new Array(this.rank);for(let h=0;h<t.length;h++)i[t[h]]=o[h];const a=`vec2(${i.slice(-2).join()})`,l=`++${o[this.rank-1]} < ${s[this.rank-1]}`,u=`getChannel(getA(${i.join()}), ${a})`;this.userCode=`
    void main() {
      ${r} rc = getOutputCoords();
      vec4 result = vec4(0.);
      result[0] = ${u};
      if(${l}) {
        result[1] = ${u};
      }
      --${o[this.rank-1]};
      if(++${o[this.rank-2]} < ${s[this.rank-2]}) {
        result[2] = ${u};
        if(${l}) {
          result[3] = ${u};
        }
      }
      setOutput(result);
    }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ty(n,e,t){const s=ae().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new bre(n.shape,e):new vre(n.shape,e);return t.runWebGLProgram(s,[n],n.dtype)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Sre(n,e,t,s){const r=e,o=n.shape.length,i=it(r,n.shape);let a=i;const l=zt(a,o),u=l!=null;let h=n;u&&(h=ty(n,l,s),a=Jt(a.length,o)),Mn("sum",a,o);const[p,f]=In(h.shape,a);let m=p;t&&(m=Zt(p,i));const y=fe(f),v=fe(n.shape)/y,w=Te({inputs:{x:h},attrs:{shape:[v,y]},backend:s}),S=E1(n.dtype),k=Xa(w,S,"sum",s),T=Te({inputs:{x:k},attrs:{shape:m},backend:s});return s.disposeIntermediateTensorInfo(w),s.disposeIntermediateTensorInfo(k),u&&s.disposeIntermediateTensorInfo(h),T}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ny(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{axis:o,keepDims:i}=s;return Sre(r,o,i,t)}const Cre={kernelName:ag,backendName:"webgl",kernelFunc:ny};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rs(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{perm:o}=s,i=t,a=r.shape.length,l=new Array(a);for(let h=0;h<l.length;h++)l[h]=r.shape[o[h]];let u;if(i.shouldExecuteOnCPU([r])){const p=i.texData.get(r.dataId).values,f=SS(p,r.shape,r.dtype,o,l);u=i.makeTensorInfo(l,r.dtype);const m=i.texData.get(u.dataId);m.values=f}else u=ty(r,o,i);return u}const kre={kernelName:Ll,backendName:"webgl",kernelFunc:rs};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const CF=1e3;function Yf({a:n,b:e,transposeA:t,transposeB:s,backend:r,bias:o=null,preluActivationWeights:i=null,leakyreluAlpha:a=0,activation:l=null}){const u=n.shape.length,h=e.shape.length,p=t?n.shape[u-2]:n.shape[u-1],f=s?e.shape[h-1]:e.shape[h-2],m=t?n.shape[u-1]:n.shape[u-2],y=s?e.shape[h-2]:e.shape[h-1],x=n.shape.slice(0,-2),v=e.shape.slice(0,-2),w=fe(x),S=fe(v),T=Ze(n.shape.slice(0,-2),e.shape.slice(0,-2)).concat([m,y]);L(p===f,()=>`Error in matMul: inner shapes (${p}) and (${f}) of Tensors with shapes ${n.shape} and ${e.shape} and transposeA=${t} and transposeB=${s} must match.`);const I=t?[w,p,m]:[w,m,p],E=s?[S,y,f]:[S,f,y],D=Te({inputs:{x:n},backend:r,attrs:{shape:I}}),O=Te({inputs:{x:e},backend:r,attrs:{shape:E}}),_=[D,O],P=Math.max(w,S),R=t?D.shape[1]:D.shape[2],W=o!=null,Q=i!=null,ee=l==="leakyrelu",te=l!=null?Uc(l,!0):null,oe=W||Q||ee||te!=null;let se;if((m===1||y===1)&&R>CF&&oe===!1){let V=D,B=O;t&&(V=rs({inputs:{x:D},backend:r,attrs:{perm:[0,2,1]}}),_.push(V)),s&&(B=rs({inputs:{x:O},backend:r,attrs:{perm:[0,2,1]}}),_.push(B));const F=y!==1,z=y===1;let q=V;F&&(q=Te({inputs:{x:V},backend:r,attrs:{shape:[P,R,1]}}),_.push(q));const re=y===1?2:1;let ue=B;z&&(ue=Te({inputs:{x:B},backend:r,attrs:{shape:[P,1,R]}}),_.push(ue));const pe=kS({inputs:{a:q,b:ue},backend:r});se=ny({inputs:{x:pe},backend:r,attrs:{axis:re,keepDims:!0}}),_.push(pe)}else{const V=Ds(n.dtype,e.dtype),B=new SF(I,E,[P,m,y],t,s,W,te,Q,ee),F=[D,O];if(o!=null&&F.push(o),Q&&F.push(i),ee){const z=r.makeTensorInfo([],"float32",_i(a,"float32"));F.push(z),_.push(z)}se=r.runWebGLProgram(B,F,V)}const G=Te({inputs:{x:se},backend:r,attrs:{shape:T}});_.push(se);for(const V of _)r.disposeIntermediateTensorInfo(V);return G}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Tre(n){const{inputs:e,backend:t,attrs:s}=n,{a:r,b:o,bias:i,preluActivationWeights:a}=e,{transposeA:l,transposeB:u,activation:h,leakyreluAlpha:p}=s;return Yf({a:r,b:o,transposeA:l,transposeB:u,backend:t,bias:i,preluActivationWeights:a,leakyreluAlpha:p,activation:h})}const Nre={kernelName:Tf,backendName:"webgl",kernelFunc:Tre};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zI="return abs(x);";function Ire(n){const{inputs:e,backend:t}=n,{x:s}=e;if(t.shouldExecuteOnCPU([s])&&s.dtype!=="complex64"){const o=t.texData.get(s.dataId),i=fF(o.values);return t.makeTensorInfo(s.shape,s.dtype,i)}let r;return ae().getBool("WEBGL_PACK_UNARY_OPERATIONS")?r=new di(s.shape,zI):r=new Jr(s.shape,zI),t.runWebGLProgram(r,[s],s.dtype)}const $re={kernelName:dm,backendName:"webgl",kernelFunc:Ire};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ere=vr+`
  if (abs(x) > 1.) {
    return NAN;
  }
  return acos(x);
`,Rre=pt({opSnippet:Ere}),Dre={kernelName:nh,backendName:"webgl",kernelFunc:Rre};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Are=vr+`
  if (x < 1.0) return NAN;
return log(x + sqrt(x * x - 1.0));`,Ore=pt({opSnippet:Are}),_re={kernelName:sh,backendName:"webgl",kernelFunc:Ore};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const VI="return a + b;",Fre=Vn({opSnippet:VI,packedOpSnippet:VI,supportsComplex:!0,cpuKernelImpl:jne}),Pre={kernelName:cu,backendName:"webgl",kernelFunc:Fre};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Lre{constructor(e,t){this.outputShape=[],this.outputShape=e,this.variableNames=t.map((o,i)=>`T${i}`);const s=[];this.variableNames.forEach(o=>{s.push(`float v${o} = get${o}AtOutCoords();`)});const r=this.variableNames.map(o=>`v${o}`).join(" + ");this.userCode=`
      void main() {
        ${s.join(`
        `)}

        float result = ${r};
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Mre{constructor(e,t){this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.variableNames=t.map((o,i)=>`T${i}`);const s=[];this.variableNames.forEach(o=>{s.push(`vec4 v${o} = get${o}AtOutCoords();`)});const r=this.variableNames.map(o=>`v${o}`).join(" + ");this.userCode=`
      void main() {
        ${s.join(`
        `)}

        vec4 result = ${r};
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mf(n){const{inputs:e,backend:t}=n,s=e;if(s.length===1)return Ps({inputs:{x:s[0]},backend:t});if(s.length>ae().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER")){const l=Math.floor(s.length/2),u=mf({inputs:s.slice(0,l),backend:t}),h=mf({inputs:s.slice(l),backend:t});return mf({inputs:[u,h],backend:t})}const r=s.map(l=>l.dtype).reduce((l,u)=>Ds(l,u)),o=s.map(l=>l.shape),a=ae().getBool("WEBGL_PACK")?new Mre(s[0].shape,o):new Lre(s[0].shape,o);return t.runWebGLProgram(a,s,r)}const zre={kernelName:pm,backendName:"webgl",kernelFunc:mf};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vre(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{axis:o,keepDims:i}=s,a=r.shape.length,l=it(o,r.shape);let u=l;const h=zt(u,a);let p=r;h!=null&&(p=rs({inputs:{x:r},backend:t,attrs:{perm:h}}),u=Jt(u.length,a)),Mn("all",u,a);const[f,m]=In(p.shape,u),y=fe(m),x=Te({inputs:{x:p},backend:t,attrs:{shape:[-1,y]}}),v=Xa(x,x.dtype,"all",t);let w;if(i){const S=Zt(f,l);w=Te({inputs:{x:v},backend:t,attrs:{shape:S}})}else w=Te({inputs:{x:v},backend:t,attrs:{shape:f}});return t.disposeIntermediateTensorInfo(x),t.disposeIntermediateTensorInfo(v),h!=null&&t.disposeIntermediateTensorInfo(p),w}const Bre={kernelName:Tw,backendName:"webgl",kernelFunc:Vre};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Wre(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{axis:o,keepDims:i}=s,a=r.shape.length,l=it(o,r.shape);let u=l;const h=zt(u,a);let p=r;h!=null&&(p=rs({inputs:{x:r},backend:t,attrs:{perm:h}}),u=Jt(u.length,a)),Mn("any",u,a);const[f,m]=In(p.shape,u),y=fe(m),x=Te({inputs:{x:p},backend:t,attrs:{shape:[-1,y]}}),v=Xa(x,x.dtype,"any",t);let w;if(i){const S=Zt(f,l);w=Te({inputs:{x:v},backend:t,attrs:{shape:S}})}else w=Te({inputs:{x:v},backend:t,attrs:{shape:f}});return t.disposeIntermediateTensorInfo(x),t.disposeIntermediateTensorInfo(v),h!=null&&t.disposeIntermediateTensorInfo(p),w}const Ure={kernelName:Nw,backendName:"webgl",kernelFunc:Wre};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Gre{constructor(e,t,s){this.variableNames=["A"];const{windowSize:r,batchSize:o,outSize:i}=e;s||this.variableNames.push("bestIndicesA"),this.outputShape=[o,i];const a=t==="max"?">":"<",l=s?"inOffset + i;":"round(getBestIndicesA(batch, inOffset + i));";this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * ${r};

        int bestIndex = inOffset;
        float bestValue = getA(batch, bestIndex);

        for (int i = 0; i < ${r}; i++) {
          int inIdx = ${l};
          float candidate = getA(batch, inIdx);
          if (candidate ${a} bestValue) {
            bestValue = candidate;
            bestIndex = inIdx;
          }
        }
        setOutput(float(bestIndex));
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class jre{constructor(e,t,s,r){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,L(e.length>2,()=>`Packed arg${s.charAt(0).toUpperCase()+s.slice(1)} supports only inputs with rank above 2.`);const o=e[e.length-1],i=Math.ceil(o/t);this.outputShape=e.slice(0,-1),i>1&&this.outputShape.push(i),r||this.variableNames.push("bestIndicesA");const a=this.outputShape,l=a.length,u=St(l),h=ns("coords",l);let p,f;if(i===1){f=l+1;const O=St(f);p=`
        ${O} sourceLocR = ${O}(${h.join()}, 0);
        ++${h[l-1]};
        ${O} sourceLocG = ${O}(${h.join()}, 0);
        ++${h[l-2]};
        ${O} sourceLocA = ${O}(${h.join()}, 0);
        --${h[l-1]};
        ${O} sourceLocB = ${O}(${h.join()}, 0);
        --${h[l-2]};`}else f=l,p=`
        ${u} sourceLocR = coords;
        ++${h[l-1]};
        ${u} sourceLocG = coords;
        ++${h[l-2]};
        ${u} sourceLocA = coords;
        --${h[l-1]};
        ${u} sourceLocB = coords;
        --${h[l-2]};`;const m=["x","y","z","w","u","v"].slice(0,f),y="."+m[f-1],x=m.map(O=>"int "+O),v=ns("sourceLocR",f-1).concat("inIdx.r"),w=ns("sourceLocG",f-1).concat("inIdx.g"),S=ns("sourceLocB",f-1).concat("inIdx.b"),k=ns("sourceLocA",f-1).concat("inIdx.a"),T=s==="max"?"greaterThan":"lessThan",I=r?"":`
          inIdx = round(vec4(getBestIndicesAChannel(${v.join()}),
                             getBestIndicesAChannel(${w.join()}),
                             getBestIndicesAChannel(${S.join()}),
                             getBestIndicesAChannel(${k.join()})));`,E=`vec4(
            getAChannel(${v.join()}),
            hasNextCol ? getAChannel(${w.join()}) : 0.,
            hasNextRow ? getAChannel(${S.join()}) : 0.,
            hasNextRow && hasNextCol ? getAChannel(${k.join()}) : 0.)`,D=r?"":`
      float getBestIndicesAChannel(${x.join()}) {
        return getChannel(getBestIndicesA(${m.join()}),
                                          vec2(${m.slice(-2).join()}));
      }`;this.userCode=`
      float getAChannel(${x.join()}) {
        return getChannel(getA(${m.join()}),
                               vec2(${m.slice(-2).join()}));
      }
      ${D}
      void main() {
        ${u} coords = getOutputCoords();
        bool hasNextCol = ${h[l-1]} < ${a[l-1]-1};
        bool hasNextRow = ${h[l-2]} < ${a[l-2]-1};
        ${p}
        ivec4 srcIdx = ivec4(sourceLocR${y}, sourceLocG${y},
          sourceLocB${y}, sourceLocA${y}) * ${t};
        ivec4 inIdx = srcIdx;
        vec4 bestIndex = vec4(inIdx);
        vec4 bestValue = ${E};

        for (int i = 0; i < ${t}; i++) {
          inIdx = srcIdx;
          ${I}
          vec4 candidate = ${E};
          bvec4 nan = isnan(candidate);
          bvec4 replace = bvec4(
            vec4(${T}(candidate, bestValue)) * (vec4(1.0) - vec4(nan)));

          bestValue = vec4(replace.x  ? candidate.x : bestValue.x,
                           replace.y  ? candidate.y : bestValue.y,
                           replace.z  ? candidate.z : bestValue.z,
                           replace.w  ? candidate.w : bestValue.w);
          bestIndex = mix(bestIndex, vec4(inIdx), vec4(replace));
          srcIdx++;
        }
        setOutput(bestIndex);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kF(n,e,t,s=null){let r=e.shape[0],o=e.shape[1];s!=null&&(r=s.shape[0],o=s.shape[1]);const i=Mg(o),a={windowSize:i,inSize:o,batchSize:r,outSize:Math.ceil(o/i)},l=new Gre(a,t,s==null),u=[e];s!=null&&u.push(s);const h=n.runWebGLProgram(l,u,"int32");if(h.shape[1]===1)return h;const p=kF(n,e,t,h);return n.disposeIntermediateTensorInfo(h),p}function TF(n,e,t,s=null){const r=s!=null?s.shape:e.shape,o=r[r.length-1],i=Mg(o),a=new jre(r,i,t,s==null),l=s==null?[e]:[e,s],u=n.runWebGLProgram(a,l,"int32");if(u.shape.length===e.shape.length){const h=TF(n,e,t,u);return n.disposeIntermediateTensorInfo(u),h}return u}function NF(n,e,t,s){const r=[t];if(Mn("arg"+s.charAt(0).toUpperCase()+s.slice(1),r,e.shape.length),!ae().getBool("WEBGL_PACK_REDUCE")||e.shape.length<=2){const o=[],i=n.texData.get(e.dataId),a=i!==null&&i.isPacked;let l=e;a&&(l=n.unpackTensor(e),o.push(l));const[u,h]=In(l.shape,r),p=fe(h),f=Te({inputs:{x:l},backend:n,attrs:{shape:[-1,p]}});o.push(f);const m=kF(n,f,s);o.push(m);const y=Te({inputs:{x:m},backend:n,attrs:{shape:u}});return o.forEach(x=>n.disposeIntermediateTensorInfo(x)),y}return TF(n,e,s)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hre(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{axis:o}=s;let i=it(o,r.shape);const a=zt(i,r.shape.length);let l=r;const u=[];a!=null&&(l=rs({inputs:{x:r},backend:t,attrs:{perm:a}}),u.push(l),i=Jt(i.length,l.shape.length)),Mn("argMax",[i[0]],l.shape.length);const h=NF(t,l,i[0],"max");return u.forEach(p=>t.disposeIntermediateTensorInfo(p)),h}const Kre={kernelName:fm,backendName:"webgl",kernelFunc:Hre};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qre(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{axis:o}=s;let i=it(o,r.shape);const a=zt(i,r.shape.length);let l=r;const u=[];a!=null&&(l=rs({inputs:{x:r},backend:t,attrs:{perm:a}}),u.push(l),i=Jt(i.length,l.shape.length)),Mn("argMin",[i[0]],l.shape.length);const h=NF(t,l,i[0],"min");return u.forEach(p=>t.disposeIntermediateTensorInfo(p)),h}const Xre={kernelName:mm,backendName:"webgl",kernelFunc:qre};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Yre=vr+`
  if (abs(x) > 1.) {
    return NAN;
  }
  return asin(x);
`,Qre=pt({opSnippet:Yre}),Zre={kernelName:rh,backendName:"webgl",kernelFunc:Qre};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Jre=vr+"return log(x + sqrt(x * x + 1.0));",eoe=pt({opSnippet:Jre}),toe={kernelName:oh,backendName:"webgl",kernelFunc:eoe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const noe=vr+`
  return atan(x);
`,soe=pt({opSnippet:noe}),roe={kernelName:ih,backendName:"webgl",kernelFunc:soe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ooe=CS+`
  return atan(a, b);
`,ioe=`
  vec4 result = atan(a, b);
  bvec4 isNaNA = isnan(a);
  bvec4 isNaNB = isnan(b);
  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);
  `+qa+`
  return result;
`,aoe=Vn({opSnippet:ooe,packedOpSnippet:ioe}),loe={kernelName:lh,backendName:"webgl",kernelFunc:aoe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const uoe=vr+`
  if ((x < -1.0) || (x > 1.0)) return NAN;
return (log(1.0 + x) - log(1.0 - x)) / 2.0;`,coe=pt({opSnippet:uoe}),hoe={kernelName:ah,backendName:"webgl",kernelFunc:coe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Gc{constructor(e,t,s,r=!1,o=!1){if(this.variableNames=["x"],t==="avg"&&s)throw new Error("Cannot compute positions for average pool.");const i=e.filterWidth,a=e.strideHeight,l=e.strideWidth,u=e.dilationHeight,h=e.dilationWidth,p=e.effectiveFilterHeight,f=e.effectiveFilterWidth,m=e.padInfo.top,y=e.padInfo.left;this.outputShape=e.outShape;const x=t==="avg",v=`((batch  * ${e.inHeight} + xR) * ${e.inWidth} + xC) * ${e.inChannels} + d`,w=`(xR * ${e.inWidth} + xC) * ${e.inChannels} + d`;let S="0.0";if(x||(S="-1.0 / 1e-20"),s){this.userCode=`
        const ivec2 strides = ivec2(${a}, ${l});
        const ivec2 pads = ivec2(${m}, ${y});

        void main() {
          ivec4 coords = getOutputCoords();
          int batch = coords[0];
          int d = coords[3];

          ivec2 xRCCorner = coords.yz * strides - pads;
          int xRCorner = xRCCorner.x;
          int xCCorner = xRCCorner.y;

          // max/min x(?, ?, d) to get y(yR, yC, d).
          // ? = to be determined
          float minMaxValue = 0.0;
          float minMaxValueFound = 0.0;
          int minMaxPosition = 0;
          float avgValue = 0.0;

          for (int wR = 0; wR < ${p};
              wR += ${u}) {
            int xR = xRCorner + wR;

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int wC = 0; wC < ${f};
                wC += ${h}) {
              int xC = xCCorner + wC;

              if (xC < 0 || xC >= ${e.inWidth}) {
                continue;
              }

              float value = getX(batch, xR, xC, d);

              // If a min / max value has already been found, use it. If not,
              // use the current value.
              float currMinMaxValue = mix(
                  value, minMaxValue, minMaxValueFound);
              if (value >= currMinMaxValue) {
                minMaxValue = value;
                minMaxValueFound = 1.0;
                minMaxPosition = ${r?o?v:w:`wR * ${f} + wC`};
              }
            }
          }
          setOutput(float(minMaxPosition));
        }
      `;return}const k="max";let T=`${t}(${t}(${t}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;t==="avg"&&(T="avgValue / max(count, 1.0)");const I=Math.floor(i/4)*4,E=i%4,D=`
      if (${x}) {
        avgValue += dot(values, ones);
      } else {
        minMaxValue = ${k}(values, minMaxValue);
      }
    `;this.userCode=`
      const ivec2 strides = ivec2(${a}, ${l});
      const ivec2 pads = ivec2(${m}, ${y});
      const float initializationValue = ${S};
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float count = 0.0;

      float getValue(int batch, int xR, int xC, int d) {
        if (xC < 0 || xC >= ${e.inWidth}) {
          return initializationValue;
        }
        count += 1.0;
        return getX(batch, xR, xC, d);
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d = coords[3];

        ivec2 xRCCorner = coords.yz * strides - pads;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // max/min x(?, ?, d) to get y(yR, yC, d).
        // ? = to be determined
        vec4 minMaxValue = vec4(${S});
        float avgValue = 0.0;
        count = 0.0;

        for (int wR = 0; wR < ${p};
            wR += ${u}) {
          int xR = xRCorner + wR;

          if (xR < 0 || xR >= ${e.inHeight}) {
            continue;
          }

          for (int wC = 0; wC < ${I}; wC += 4) {
            int xC = xCCorner + wC * ${h};

            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + ${h}, d),
              getValue(batch, xR, xC + 2 * ${h}, d),
              getValue(batch, xR, xC + 3 * ${h}, d)
            );

            ${D}
          }

          int xC = xCCorner + ${I};
          if (${E===1}) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              initializationValue,
              initializationValue,
              initializationValue
            );

            ${D}
          } else if (${E===2}) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + ${h}, d),
              initializationValue,
              initializationValue
            );

            ${D}
          } else if (${E===3}) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + ${h}, d),
              getValue(batch, xR, xC + 2 * ${h}, d),
              initializationValue
            );

            ${D}
          }
        }
        setOutput(${T});
      }
    `}}class TS{constructor(e,t,s,r=!1,o=!1){if(this.variableNames=["x"],t==="avg"&&s)throw new Error("Cannot compute positions for average pool.");const i=e.filterWidth,a=e.strideDepth,l=e.strideHeight,u=e.strideWidth,h=e.dilationDepth,p=e.dilationHeight,f=e.dilationWidth,m=e.effectiveFilterDepth,y=e.effectiveFilterHeight,x=e.effectiveFilterWidth,v=e.padInfo.front,w=e.padInfo.top,S=e.padInfo.left;this.outputShape=e.outShape;const k=t==="avg";let T="0.0";if(k||(T="-1.0 / 1e-20"),s){this.userCode=`
        const ivec3 strides =
            ivec3(${a}, ${l}, ${u});
        const ivec3 pads = ivec3(${v}, ${w}, ${S});

        void main() {
          ivec5 coords = getOutputCoords();
          int batch = coords.x;
          int ch = coords.u;

          ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
          int xDCorner = xCorner.x;
          int xRCorner = xCorner.y;
          int xCCorner = xCorner.z;

          // max/min x(?, ?, ?, ch) to get y(yD, yR, yC, ch).
          // ? = to be determined
          float minMaxValue = 0.0;
          float minMaxValueFound = 0.0;
          int minMaxPosition = 0;

          for (int wD = 0; wD < ${m};
              wD += ${h}) {
            int xD = xDCorner + wD;

            if (xD < 0 || xD >= ${e.inDepth}) {
              continue;
            }

            for (int wR = 0; wR < ${y};
                wR += ${p}) {
              int xR = xRCorner + wR;

              if (xR < 0 || xR >= ${e.inHeight}) {
                continue;
              }

              for (int wC = 0; wC < ${x};
                  wC += ${f}) {
                int xC = xCCorner + wC;

                if (xC < 0 || xC >= ${e.inWidth}) {
                  continue;
                }

                float value = getX(batch, xD, xR, xC, ch);

                // If a min / max value has already been found, use it. If not,
                // use the current value.
                float currMinMaxValue = mix(
                    value, minMaxValue, minMaxValueFound);
                if (value >= currMinMaxValue) {
                  minMaxValue = value;
                  minMaxValueFound = 1.0;
                  minMaxPosition = ${r?o?`(((batch * ${e.inDepth} + xD) * ${e.inHeight} + xR) * ${e.inWidth} + xC) * ${e.inChannels} + ch`:`((xD * ${e.inHeight} + xR) * ${e.inWidth} + xC) * ${e.inChannels} + ch`:`wD * ${y} * ${x} +
                      wR * ${x} + wC`};
                }
              }
            }
          }
          setOutput(float(minMaxPosition));
        }
      `;return}const I="max";let E=`${t}(${t}(${t}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;t==="avg"&&(E="avgValue / max(count, 1.0)");const D=Math.floor(i/4)*4,O=i%4,_=`
      if (${k}) {
        avgValue += dot(values, ones);
      } else {
        minMaxValue = ${I}(values, minMaxValue);
      }
    `;this.userCode=`
      const ivec3 strides =
        ivec3(${a}, ${l}, ${u});
      const ivec3 pads = ivec3(${v}, ${w}, ${S});
      const float initializationValue = ${T};
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float count = 0.0;

      float getValue(int batch, int xD, int xR, int xC, int ch) {
        if (xC < 0 || xC >= ${e.inWidth}) {
          return initializationValue;
        }
        count += 1.0;
        return getX(batch, xD, xR, xC, ch);
      }

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
        int xDCorner = xCorner.x;
        int xRCorner = xCorner.y;
        int xCCorner = xCorner.z;

        // max/min x(?, ?, ?, d) to get y(yD, yR, yC, ch).
        // ? = to be determined
        vec4 minMaxValue = vec4(${T});
        float avgValue = 0.0;
        count = 0.0;

        for (int wD = 0; wD < ${m};
            wD += ${h}) {
          int xD = xDCorner + wD;

          if (xD < 0 || xD >= ${e.inDepth}) {
            continue;
          }

          for (int wR = 0; wR < ${y};
            wR += ${p}) {
            int xR = xRCorner + wR;

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int wC = 0; wC < ${D}; wC += 4) {
              int xC = xCCorner + wC * ${f};

              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + ${f}, ch),
                getValue(batch, xD, xR, xC + 2 * ${f}, ch),
                getValue(batch, xD, xR, xC + 3 * ${f}, ch)
              );

              ${_}
            }

            int xC = xCCorner + ${D};
            if (${O===1}) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                initializationValue,
                initializationValue,
                initializationValue
              );

              ${_}
            } else if (${O===2}) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + ${f}, ch),
                initializationValue,
                initializationValue
              );

              ${_}
            } else if (${O===3}) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + ${f}, ch),
                getValue(batch, xD, xR, xC + 2 * ${f}, ch),
                initializationValue
              );

              ${_}
            }
          }
        }
        setOutput(${E});
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function doe(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e;xd(r,"avgPool");const{filterSize:o,strides:i,pad:a,dimRoundingMode:l}=s,u=1;L(Ln(i,u),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${i} and dilations '${u}'`);const h=yr(r.shape,o,i,u,a,l);if(h.filterWidth===1&&h.filterHeight===1&&ct(h.inShape,h.outShape))return Ps({inputs:{x:r},backend:t});const p=new Gc(h,"avg",!1);return t.runWebGLProgram(p,[r],"float32")}const poe={kernelName:gm,backendName:"webgl",kernelFunc:doe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function foe(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{filterSize:o,strides:i,pad:a,dimRoundingMode:l,dataFormat:u}=s,h=[1,1,1],p=Lo(r.shape,o,i,h,a,l,u),f=new TS(p,"avg",!1);return t.runWebGLProgram(f,[r],"float32")}const moe={kernelName:ym,backendName:"webgl",kernelFunc:foe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class goe{constructor(e){this.variableNames=["dy"],this.outputShape=e.inShape;const t=e.filterHeight,s=e.filterWidth,r=e.strideHeight,o=e.strideWidth,i=e.dilationHeight,a=e.dilationWidth,l=e.effectiveFilterHeight,u=e.effectiveFilterWidth,h=l-1-e.padInfo.top,p=u-1-e.padInfo.left,f=1/(t*s);this.userCode=`
      const ivec2 pads = ivec2(${h}, ${p});
      const float avgMultiplier = float(${f});

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];

        ivec2 dyRCCorner = coords.yz - pads;
        int dyRCorner = dyRCCorner.x;
        int dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${l};
            wR += ${i}) {
          float dyR = float(dyRCorner + wR) / ${r}.0;

          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          for (int wC = 0; wC < ${u};
            wC+= ${a}) {
            float dyC = float(dyCCorner + wC) / ${o}.0;

            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            float dyValue = getDy(b, idyR, idyC, d);

            dotProd += dyValue * avgMultiplier;
          }
        }
        setOutput(dotProd);
      }
    `}}class yoe{constructor(e){this.variableNames=["dy"],this.outputShape=e.inShape;const t=e.filterDepth,s=e.filterHeight,r=e.filterWidth,o=e.strideDepth,i=e.strideHeight,a=e.strideWidth,l=e.dilationDepth,u=e.dilationHeight,h=e.dilationWidth,p=e.effectiveFilterDepth,f=e.effectiveFilterHeight,m=e.effectiveFilterWidth,y=p-1-e.padInfo.front,x=f-1-e.padInfo.top,v=m-1-e.padInfo.left,w=1/(t*s*r);this.userCode=`
      const ivec3 pads = ivec3(${y}, ${x}, ${v});
      const float avgMultiplier = float(${w});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyDCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, d) with pos mask(:, :, :, ch) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int wD = 0; wD < ${p};
            wD += ${l}) {
          float dyD = float(dyDCorner + wD) / ${o}.0;

          if (dyD < 0.0 || dyD >= ${e.outDepth}.0 || fract(dyD) > 0.0) {
            continue;
          }
          int idyD = int(dyD);

          for (int wR = 0; wR < ${f};
              wR += ${u}) {
            float dyR = float(dyRCorner + wR) / ${i}.0;

            if (dyR < 0.0 || dyR >= ${e.outHeight}.0 ||
                fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            for (int wC = 0; wC < ${m};
                wC += ${h}) {
              float dyC = float(dyCCorner + wC) / ${a}.0;

              if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              float dyValue = getDy(batch, idyD, idyR, idyC, ch);

              dotProd += dyValue * avgMultiplier;
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xoe(n){const{inputs:e,backend:t,attrs:s}=n,{dy:r,input:o}=e,i=o,{filterSize:a,strides:l,pad:u,dimRoundingMode:h}=s,p=[1,1,1],f=Lo(i.shape,a,l,p,u,h),m=new yoe(f);return t.runWebGLProgram(m,[r],i.dtype)}const voe={kernelName:$w,backendName:"webgl",kernelFunc:xoe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function woe(n){const{inputs:e,backend:t,attrs:s}=n,{dy:r,input:o}=e,i=o;xd([r,o],"avgPoolGrad");const{filterSize:a,strides:l,pad:u}=s,h=yr(i.shape,a,l,1,u),p=new goe(h);return t.runWebGLProgram(p,[r],i.dtype)}const boe={kernelName:Iw,backendName:"webgl",kernelFunc:woe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Soe(n){const{inputs:e,backend:t,attrs:s}=n,{a:r,b:o}=e,{transposeA:i,transposeB:a}=s;return Yf({a:r,b:o,transposeA:i,transposeB:a,backend:t})}const Coe={kernelName:xm,backendName:"webgl",kernelFunc:Soe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class koe{constructor(e,t,s,r,o,i){this.outputShape=[],this.variableNames=["x","mean","variance"],Ze(e,t),Ze(e,s);let a="0.0";r!=null&&(Ze(e,r),this.variableNames.push("offset"),a="getOffsetAtOutCoords()");let l="1.0";o!=null&&(Ze(e,o),this.variableNames.push("scale"),l="getScaleAtOutCoords()"),this.outputShape=e,this.userCode=`
      void main() {
        float x = getXAtOutCoords();
        float mean = getMeanAtOutCoords();
        float variance = getVarianceAtOutCoords();
        float offset = ${a};
        float scale = ${l};
        float inv = scale * inversesqrt(variance + float(${i}));
        setOutput(dot(vec3(x, -mean, offset), vec3(inv, inv, 1)));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Toe{constructor(e,t,s,r,o,i){this.packedInputs=!0,this.packedOutput=!0,this.variableNames=["x","mean","variance"],Ze(e,t),Ze(e,s);let a="vec4(0.0)";r!=null&&(Ze(e,r),this.variableNames.push("offset"),a="getOffsetAtOutCoords()");let l="vec4(1.0)";o!=null&&(Ze(e,o),this.variableNames.push("scale"),l="getScaleAtOutCoords()"),this.outputShape=e,this.userCode=`
      void main() {
        vec4 offset = ${a};
        vec4 scale = ${l};

        vec4 x = getXAtOutCoords();
        vec4 mean = getMeanAtOutCoords();
        vec4 variance = getVarianceAtOutCoords();

        vec4 inv = scale * inversesqrt(variance + vec4(${i}));

        setOutput((x - mean) * inv + offset);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Noe=({inputs:n,backend:e,attrs:t})=>{const{x:s,mean:r,variance:o,offset:i,scale:a}=n;L(r.shape.length===o.shape.length,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),L(i==null||r.shape.length===i.shape.length,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),L(a==null||r.shape.length===a.shape.length,()=>"Batch normalization gradient requires mean and scale to have equal ranks.");let{varianceEpsilon:l}=t;l==null&&(l=.001);const u=[s,r,o];let h=null;i!=null&&(h=i.shape,u.push(i));let p=null;a!=null&&(p=a.shape,u.push(a));const f=ae().getBool("WEBGL_PACK_NORMALIZATION")?new Toe(s.shape,r.shape,o.shape,h,p,l):new koe(s.shape,r.shape,o.shape,h,p,l);return e.runWebGLProgram(f,u,u[0].dtype)},Ioe={kernelName:Dm,backendName:"webgl",kernelFunc:Noe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class $oe{constructor(e){this.variableNames=["source"],this.outputShape=e,this.rank=e.length;const t=St(this.rank);this.customUniforms=[{name:"start",arrayIndex:this.rank,type:"int"}];const s=Eoe(this.rank);let r;const o=e.map((i,a)=>`sourceLoc.${Wv[a]} = start[${a}] + coords.${Wv[a]};`);r=`
        ${t} sourceLoc;
        ${t} coords = getOutputCoords();
        ${o.join(`
`)}
      `,this.userCode=`
      void main() {
        ${r}
        setOutput(getSource(${s}));
      }
    `}}const Wv=["x","y","z","w","u","v"];function Eoe(n){if(n===1)return"sourceLoc";if(n<=6)return Wv.slice(0,n).map(e=>"sourceLoc."+e).join(",");throw Error(`Slicing for rank ${n} is not yet supported`)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Roe{constructor(e){this.variableNames=["source"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.rank=e.length,this.customUniforms=[{name:"start",arrayIndex:this.rank,type:"int"}];const t=St(this.rank),s=ns("coords",this.rank),r=ns("sourceLoc",this.rank),o=this.rank===1?"sourceLoc":`vec2(${r.slice(-2).join()})`,i=`getChannel(getSource(${r.join()}), ${o})`,a=`
      result.x = ${i};
      if (++${s[this.rank-1]} < ${e[this.rank-1]}) {
        ++${r[this.rank-1]};
        result.y = ${i};
        --${r[this.rank-1]};
      }
    `,l=this.rank===1?"":`
      --${s[this.rank-1]};
      if (++${s[this.rank-2]} < ${e[this.rank-2]}) {
        ++${r[this.rank-2]};
        result.z = ${i};
        if (++${s[this.rank-1]} < ${e[this.rank-1]}) {
          ++${r[this.rank-1]};
          result.w = ${i};
        }
      }
    `,u=this.rank<=4?`sourceLoc = coords +
            ${t}(${e.map((h,p)=>`start[${p}]`).join()});`:e.map((h,p)=>`${r[p]} = ${s[p]} + start[${p}];`).join(`
`);this.userCode=`
      void main() {
        ${t} coords = getOutputCoords();
        ${t} sourceLoc;
        ${u}
        vec4 result = vec4(0.);
        ${a}
        ${l}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Doe(n,e,t,s){const r=s.texData.get(n.dataId),o=s.makeTensorInfo(t,n.dtype),i=s.texData.get(o.dataId);Object.assign(i,r),i.refCount=1,i.shape=t,i.dtype=n.dtype;let a=JR(e,Be(n.shape));r.slice&&(a+=r.slice.flatOffset),i.slice={flatOffset:a,origDataId:r.slice&&r.slice.origDataId||n.dataId};const l=s.dataRefCount.get(i.slice.origDataId)||1;return s.dataRefCount.set(i.slice.origDataId,l+1),o}function ku(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{begin:o,size:i}=s,[a,l]=bb(r,o,i);if(YR(r,a,l),fe(l)===0)return t.makeTensorInfo(l,r.dtype,[]);if(t.shouldExecuteOnCPU([r])||r.dtype==="string"){const p=t.texData.get(r.dataId),f=Cse(p.values,a,l,r.shape,r.dtype);return t.makeTensorInfo(l,r.dtype,f)}const{isPacked:u}=t.texData.get(r.dataId),h=ZR(r.shape,a,l);if(u||!h){const p=ae().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new Roe(l):new $oe(l),f=[a];return t.runWebGLProgram(p,[r],r.dtype,f)}return t.uploadToGPU(r.dataId),Doe(r,a,l,t)}const Aoe={kernelName:ig,backendName:"webgl",kernelFunc:ku};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ooe=n=>{const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{blockShape:o,crops:i}=s;L(r.shape.length<=4,()=>"batchToSpaceND for rank > 4 with a WebGL backend not implemented yet");const a=o.reduce((S,k)=>S*k),l=od(r.shape,o,a),u=id(l.length,o.length),h=ad(r.shape,o,a),p=Tb(i,o.length),f=Nb(h,i,o.length),m=[],y=Te({inputs:{x:r},backend:t,attrs:{shape:l}}),x=rs({inputs:{x:y},backend:t,attrs:{perm:u}}),v=Te({inputs:{x},backend:t,attrs:{shape:h}}),w=ku({inputs:{x:v},backend:t,attrs:{begin:p,size:f}});return m.push(y),m.push(x),m.push(v),m.forEach(S=>t.disposeIntermediateTensorInfo(S)),w},_oe={kernelName:vm,backendName:"webgl",kernelFunc:Ooe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Foe(n){const{inputs:e,backend:t,attrs:s}=n,{x:r,weights:o}=e,{size:i}=s,a=t.readSync(r.dataId),l=t.readSync(o.dataId),u=pF(a,l,o.dtype,o.shape,i);return t.makeTensorInfo([i],o.dtype,u)}const Poe={kernelName:Ew,backendName:"webgl",kernelFunc:Foe};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Loe=`
  int r = int(a.r) & int(b.r);
  int g = int(a.g) & int(b.g);
  int rb = int(a.b) & int(b.b);
  int ra = int(a.a) & int(b.a);
  return vec4(r, g, rb, ra);
`,Moe=`
  return float(int(a.r) & int(b.r));
`;function zoe(n){const{inputs:e,backend:t}=n,{a:s,b:r}=e,o=ae().getBool("WEBGL_PACK_BINARY_OPERATIONS"),i=ae().getNumber("WEBGL_VERSION");if(t.shouldExecuteOnCPU([s,r])||i===1){const l=t.texData.get(s.dataId).values,u=t.texData.get(r.dataId).values,[h,p]=Kne(s.shape,r.shape,l,u,s.dtype),f=t.makeTensorInfo(p,s.dtype),m=t.texData.get(f.dataId);return m.values=h,f}let a;return o?a=new Su(Loe,s.shape,r.shape,!1):a=new Pa(Moe,s.shape,r.shape),t.runWebGLProgram(a,[s,r],s.dtype)}const Voe={kernelName:wm,backendName:"webgl",kernelFunc:zoe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Boe(n){const{inputs:e,backend:t}=n,{s0:s,s1:r}=e,o=t.readSync(s.dataId),i=t.readSync(r.dataId),a=Ze(Array.from(o),Array.from(i));return t.makeTensorInfo([a.length],"int32",Int32Array.from(a))}const Woe={kernelName:Rw,backendName:"webgl",kernelFunc:Boe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Uoe="return float(a != b);",IF=Vn({opSnippet:Uoe,cpuKernelImpl:fse,dtype:"bool"}),Goe={kernelName:qm,backendName:"webgl",kernelFunc:IF};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wd(n){const{inputs:e,backend:t}=n,{input:s}=e,r=t.texData.get(s.dataId);return Ps({inputs:{x:r.complexTensorInfos.real},backend:t})}const joe={kernelName:u1,backendName:"webgl",kernelFunc:wd};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Hoe="return float(int(x));";function Koe(n,e){const t=new Jr(n.shape,Hoe),s=e.runWebGLProgram(t,[n],"int32");return{dataId:s.dataId,shape:s.shape,dtype:s.dtype}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Uv(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{dtype:o}=s;if(o==="complex64"){if(r.dtype==="complex64")return Ps({inputs:{x:r},backend:t});const i=dn(r.shape),a=Uv({inputs:{x:r},backend:t,attrs:{dtype:"float32"}}),l=Gi({inputs:{real:a,imag:i},backend:t});return i.dispose(),t.disposeIntermediateTensorInfo(a),l}if(r.dtype==="complex64"){const i=wd({inputs:{input:r},backend:t}),a=Uv({inputs:{x:i},backend:t,attrs:{dtype:o}});return t.disposeIntermediateTensorInfo(i),a}if(!q2(r.dtype,o)){const i=Ps({inputs:{x:r},backend:t});return{dataId:i.dataId,shape:i.shape,dtype:o}}if(t.shouldExecuteOnCPU([r])){const i=t.texData.get(r.dataId).values,[a,l,u]=qne(i,r.shape,r.dtype,o);return t.makeTensorInfo(a,l,u)}if(o==="int32")return Koe(r,t);if(o==="bool"){const i=t.makeTensorInfo([],"bool",Fn("bool",1)),l=IF({inputs:{a:r,b:i},backend:t});return t.disposeIntermediateTensorInfo(i),l}throw new Error(`Error in Cast: failed to cast ${r.dtype} to ${o}`)}const qoe={kernelName:uh,backendName:"webgl",kernelFunc:Uv};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const BI="return ceil(x);",Xoe=pt({opSnippet:BI,packedOpSnippet:BI,cpuKernelImpl:Xne}),Yoe={kernelName:ch,backendName:"webgl",kernelFunc:Xoe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Qoe{constructor(e){this.variableNames=["A"],this.customUniforms=[{name:"minVal",type:"float"},{name:"maxVal",type:"float"}],this.outputShape=e,this.userCode=`

      void main() {
        float value = getAAtOutCoords();
        if (isnan(value)) {
          setOutput(value);
          return;
        }

        setOutput(clamp(value, minVal, maxVal));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Zoe{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"minVal",type:"float"},{name:"maxVal",type:"float"}],this.outputShape=e,this.userCode=`
      void main() {
        vec4 value = getAAtOutCoords();

        if (any(isnan(value))) {
          setOutput(value);
          return;
        }

        setOutput(clamp(value, vec4(minVal), vec4(maxVal)));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Joe(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{clipValueMin:o,clipValueMax:i}=s;let a;ae().getBool("WEBGL_PACK_CLIP")?a=new Zoe(r.shape):a=new Qoe(r.shape);const l=[[o],[i]];return t.runWebGLProgram(a,[r],r.dtype,l)}const eie={kernelName:hh,backendName:"webgl",kernelFunc:Joe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class tie{constructor(e){this.variableNames=["real","imag"],this.outputShape=e,this.userCode=`
      void main() {
        float re = abs(getRealAtOutCoords());
        float im = abs(getImagAtOutCoords());
        float mx = max(re, im);

        // sadly the length function in glsl is not underflow-safe
        // (at least not on Intel GPUs). So the safe solution is
        // to ensure underflow-safety in all cases.
        setOutput(
          mx == 0.0 ? 0.0 : mx * length(vec2(1, min(re, im)/mx))
        );
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function WI(n,e){return{dataId:e.dataId,dtype:e.dtype,shape:n.shape}}function nie(n){const{inputs:e,backend:t}=n,{x:s}=e,r=t.texData.get(s.dataId),o=new tie(s.shape),i=[WI(s,r.complexTensorInfos.real),WI(s,r.complexTensorInfos.imag)];return t.runWebGLProgram(o,i,i[0].dtype)}const sie={kernelName:bm,backendName:"webgl",kernelFunc:nie};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class rie{constructor(e){this.outputShape=[],this.outputShape=to(e,1),this.variableNames=e.map((i,a)=>`T${a}`);const t=new Array(e.length-1);t[0]=e[0][1];for(let i=1;i<t.length;i++)t[i]=t[i-1]+e[i][1];const s=[`if (yC < ${t[0]}) setOutput(getT0(yR, yC));`];for(let i=1;i<t.length;i++){const a=t[i-1];s.push(`else if (yC < ${t[i]}) setOutput(getT${i}(yR, yC-${a}));`)}const r=t.length,o=t[t.length-1];s.push(`else setOutput(getT${r}(yR, yC-${o}));`),this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int yR = coords.x;
        int yC = coords.y;

        ${s.join(`
        `)}
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class oie{constructor(e,t){this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[],this.outputShape=to(e,t);const s=this.outputShape,r=s.length,o=St(r),i=ns("coords",r),a=["x","y","z","w","u","v"].slice(0,r);this.variableNames=e.map((x,v)=>`T${v}`);const l=new Array(e.length-1);l[0]=e[0][t];for(let x=1;x<l.length;x++)l[x]=l[x-1]+e[x][t];const u=a[t],h=a.slice(-2),p=a.join();let f=`if (${u} < ${l[0]}) {
        return getChannel(
            getT0(${p}), vec2(${h.join()}));
        }`;for(let x=1;x<l.length;x++){const v=l[x-1];f+=`
        if (${u} < ${l[x]}  && ${u} >= ${l[x-1]}) {
          return getChannel(
            getT${x}(${Xp(a,u,v)}),
            vec2(${Xp(h,u,v)}));
        }`}const m=l.length,y=l[l.length-1];f+=`
        return getChannel(
          getT${m}(${Xp(a,u,y)}),
          vec2(${Xp(h,u,y)}));`,this.userCode=`
      float getValue(${a.map(x=>"int "+x)}) {
        ${f}
      }

      void main() {
        ${o} coords = getOutputCoords();
        vec4 result = vec4(getValue(${i}), 0., 0., 0.);

        ${i[r-1]} = ${i[r-1]} + 1;
        if (${i[r-1]} < ${s[r-1]}) {
          result.g = getValue(${i});
        }

        ${i[r-2]} = ${i[r-2]} + 1;
        if (${i[r-2]} < ${s[r-2]}) {
          result.a = getValue(${i});
        }

        ${i[r-1]} = ${i[r-1]} - 1;
        if (${i[r-2]} < ${s[r-2]} &&
            ${i[r-1]} < ${s[r-1]}) {
          result.b = getValue(${i});
        }
        setOutput(result);
      }
    `}}function Xp(n,e,t){const s=n.indexOf(e);return n.map((o,i)=>i===s?`${o} - ${t}`:o).join()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sy(n){const{inputs:e,backend:t}=n,{input:s}=e,r=t.texData.get(s.dataId);return Ps({inputs:{x:r.complexTensorInfos.imag},backend:t})}const iie={kernelName:Xw,backendName:"webgl",kernelFunc:sy};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Cc(n,e,t){const s=n[0].dtype;if(s==="complex64"){const m=n.map(S=>wd({inputs:{input:S},backend:t})),y=n.map(S=>sy({inputs:{input:S},backend:t})),x=Cc(m,e,t),v=Cc(y,e,t),w=Gi({inputs:{real:x,imag:v},backend:t});return m.forEach(S=>t.disposeIntermediateTensorInfo(S)),y.forEach(S=>t.disposeIntermediateTensorInfo(S)),t.disposeIntermediateTensorInfo(x),t.disposeIntermediateTensorInfo(v),w}let r=t.shouldExecuteOnCPU(n);if(s==="string"&&(r=!0),r){const m=n.map(T=>{const E=[-1,fe(T.shape.slice(e))];return Te({inputs:{x:T},backend:t,attrs:{shape:E}})}),y=m.map(T=>({vals:t.readSync(T.dataId),shape:T.shape})),x=to(m.map(T=>T.shape),1),v=m[0].shape[0]===1,w=Yne(y,x,s,v),S=to(n.map(T=>T.shape),e),k=t.makeTensorInfo(S,s,w);return m.forEach(T=>t.disposeIntermediateTensorInfo(T)),k}const o=n.filter(m=>fe(m.shape)>0),i=ae().getBool("WEBGL_PACK_ARRAY_OPERATIONS")&&o[0].shape.length>1;if(o.length===1){const m=i?new Jr(n[0].shape,ui):new di(n[0].shape,ui);return t.runWebGLProgram(m,n,s)}const a=ae().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER");if(o.length>a){const m=[];for(let x=0;x<o.length;x+=a){const v=o.slice(x,x+a);m.push(Cc(v,e,t))}const y=Cc(m,e,t);for(const x of m)t.disposeIntermediateTensorInfo(x);return y}if(i){const m=new oie(o.map(y=>y.shape),e);return t.runWebGLProgram(m,o,s)}const{tensors2D:l,outShape:u}=aie(o,e,t),h=new rie(l.map(m=>m.shape)),p=t.runWebGLProgram(h,l,s);l.forEach(m=>t.disposeIntermediateTensorInfo(m));const f=Te({inputs:{x:p},attrs:{shape:u},backend:t});return t.disposeIntermediateTensorInfo(p),f}function aie(n,e,t){const s=to(n.map(o=>o.shape),e);return{tensors2D:n.map(o=>Te({inputs:{x:o},attrs:{shape:[-1,fe(o.shape.slice(e))]},backend:t})),outShape:s}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $F(n){const{inputs:e,backend:t,attrs:s}=n,{axis:r}=s,o=it(r,e[0].shape)[0],i=e.map(u=>u.shape);Sb(i,o);const a=to(e.map(u=>u.shape),o);if(fe(a)===0)return t.makeTensorInfo(a,e[0].dtype,[]);const l=e.filter(u=>fe(u.shape)>0);return l.length===1?Ps({inputs:{x:l[0]},backend:t}):Cc(l,o,t)}const lie={kernelName:Sm,backendName:"webgl",kernelFunc:$F};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class EF{constructor(e,t=!1,s=null,r=!1,o=!1){this.variableNames=["x","W"],this.outputShape=e.outShape;const i=e.padInfo.top,a=e.padInfo.left,l=e.strideHeight,u=e.strideWidth,h=e.dilationHeight,p=e.dilationWidth,f=e.filterHeight,m=e.filterWidth,y=Math.floor(e.inChannels/4)*4,x=e.inChannels%4,v=e.dataFormat==="channelsLast",w=v?1:2,S=v?2:3,k=v?3:1;let T="",I="";s&&(r?T=`float activation(float a) {
          float b = getPreluActivationWeightsAtOutCoords();
          ${s}
        }`:o?T=`float activation(float a) {
          float b = getLeakyreluAlphaAtOutCoords();
          ${s}
        }`:T=`
          float activation(float x) {
            ${s}
          }
        `,I="result = activation(result);");const E=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),o&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
      ${T}

      const ivec2 strides = ivec2(${l}, ${u});
      const ivec2 pads = ivec2(${i}, ${a});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d2 = coords[${k}];

        ivec2 xRCCorner =
            ivec2(coords[${w}], coords[${S}]) * strides - pads;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // Convolve x(?, ?, d1) with w(:, :, d1, d2) to get y(yR, yC, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${f}; wR++) {
          int xR = xRCorner + wR * ${h};

          if (xR < 0 || xR >= ${e.inHeight}) {
            continue;
          }

          for (int wC = 0; wC < ${m}; wC++) {
            int xC = xCCorner + wC * ${p};

            if (xC < 0 || xC >= ${e.inWidth}) {
              continue;
            }

            for (int d1 = 0; d1 < ${y}; d1 += 4) {
              vec4 wValues = vec4(
                getW(wR, wC, d1, d2),
                getW(wR, wC, d1 + 1, d2),
                getW(wR, wC, d1 + 2, d2),
                getW(wR, wC, d1 + 3, d2)
              );

              if (${v}) {
                vec4 xValues = vec4(
                  getX(batch, xR, xC, d1),
                  getX(batch, xR, xC, d1 + 1),
                  getX(batch, xR, xC, d1 + 2),
                  getX(batch, xR, xC, d1 + 3)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec4 xValues = vec4(
                  getX(batch, d1, xR, xC),
                  getX(batch, d1 + 1, xR, xC),
                  getX(batch, d1 + 2, xR, xC),
                  getX(batch, d1 + 3, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }
            }

            if (${x===1}) {

              if (${v}) {
                dotProd +=
                    getX(batch, xR, xC, ${y}) *
                    getW(wR, wC, ${y}, d2);
              } else {
                dotProd +=
                    getX(batch, ${y}, xR, xC) *
                    getW(wR, wC, ${y}, d2);
              }

            } else if (${x===2}) {
              vec2 wValues = vec2(
                getW(wR, wC, ${y}, d2),
                getW(wR, wC, ${y} + 1, d2)
              );

              if (${v}) {
                vec2 xValues = vec2(
                  getX(batch, xR, xC, ${y}),
                  getX(batch, xR, xC, ${y} + 1)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec2 xValues = vec2(
                  getX(batch, ${y}, xR, xC),
                  getX(batch, ${y} + 1, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }

            } else if (${x===3}) {
              vec3 wValues = vec3(
                getW(wR, wC, ${y}, d2),
                getW(wR, wC, ${y} + 1, d2),
                getW(wR, wC, ${y} + 2, d2)
              );

              if (${v}) {
                vec3 xValues = vec3(
                  getX(batch, xR, xC, ${y}),
                  getX(batch, xR, xC, ${y} + 1),
                  getX(batch, xR, xC, ${y} + 2)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec3 xValues = vec3(
                  getX(batch, ${y}, xR, xC),
                  getX(batch, ${y} + 1, xR, xC),
                  getX(batch, ${y} + 2, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }

            }
          }
        }

        float result = dotProd;
        ${E}
        ${I}
        setOutput(result);
      }
    `}}class uie{constructor(e){this.variableNames=["x","W"],this.outputShape=e.outShape;const t=e.padInfo.front,s=e.padInfo.top,r=e.padInfo.left,o=e.strideDepth,i=e.strideHeight,a=e.strideWidth,l=e.dilationDepth,u=e.dilationHeight,h=e.dilationWidth,p=e.filterDepth,f=e.filterHeight,m=e.filterWidth,y=Math.floor(e.inChannels/4)*4,x=e.inChannels%4;this.userCode=`
      const ivec3 strides = ivec3(${o}, ${i}, ${a});
      const ivec3 pads = ivec3(${t}, ${s}, ${r});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int d2 = coords.u;

        ivec3 xFRCCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
        int xFCorner = xFRCCorner.x;
        int xRCorner = xFRCCorner.y;
        int xCCorner = xFRCCorner.z;

        // Convolve x(?, ?, ?, d1) with w(:, :, :, d1, d2) to get
        // y(yF, yR, yC, d2). ? = to be determined. : = across all
        // values in that axis.
        float dotProd = 0.0;
        for (int wF = 0; wF < ${p}; wF++) {
          int xF = xFCorner + wF * ${l};

          if (xF < 0 || xF >= ${e.inDepth}) {
            continue;
          }

          for (int wR = 0; wR < ${f}; wR++) {
            int xR = xRCorner + wR * ${u};

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int wC = 0; wC < ${m}; wC++) {
              int xC = xCCorner + wC * ${h};

              if (xC < 0 || xC >= ${e.inWidth}) {
                continue;
              }

              for (int d1 = 0; d1 < ${y}; d1 += 4) {
                vec4 xValues = vec4(
                  getX(batch, xF, xR, xC, d1),
                  getX(batch, xF, xR, xC, d1 + 1),
                  getX(batch, xF, xR, xC, d1 + 2),
                  getX(batch, xF, xR, xC, d1 + 3)
                );
                vec4 wValues = vec4(
                  getW(wF, wR, wC, d1, d2),
                  getW(wF, wR, wC, d1 + 1, d2),
                  getW(wF, wR, wC, d1 + 2, d2),
                  getW(wF, wR, wC, d1 + 3, d2)
                );

                dotProd += dot(xValues, wValues);
              }

              if (${x===1}) {
                dotProd +=
                  getX(batch, xF, xR, xC, ${y}) *
                  getW(wF, wR, wC, ${y}, d2);
              } else if (${x===2}) {
                vec2 xValues = vec2(
                  getX(batch, xF, xR, xC, ${y}),
                  getX(batch, xF, xR, xC, ${y} + 1)
                );
                vec2 wValues = vec2(
                  getW(wF, wR, wC, ${y}, d2),
                  getW(wF, wR, wC, ${y} + 1, d2)
                );
                dotProd += dot(xValues, wValues);
              } else if (${x===3}) {
                vec3 xValues = vec3(
                  getX(batch, xF, xR, xC, ${y}),
                  getX(batch, xF, xR, xC, ${y} + 1),
                  getX(batch, xF, xR, xC, ${y} + 2)
                );
                vec3 wValues = vec3(
                  getW(wF, wR, wC, ${y}, d2),
                  getW(wF, wR, wC, ${y} + 1, d2),
                  getW(wF, wR, wC, ${y} + 2, d2)
                );
                dotProd += dot(xValues, wValues);
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class RF{constructor(e,t=!1,s=null,r=!1,o=!1){this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=e.outShape,this.enableShapeUniforms=Xn(this.outputShape.length);const i=e.padInfo.left,a=e.strideWidth,l=e.dilationWidth,u=e.filterHeight,h=e.filterWidth,p=h;let f=`
       int xR; int xC; int xCOffset;
       vec4 wTexel; vec4 previous; vec4 final;`;for(let v=0;v<h;v++)f+=`
           vec4 xTexelC${v*2};
           int xTexelC${v*2}Ready;
           vec4 xTexelC${v*2+1};
           int xTexelC${v*2+1}Ready;
           vec4 xC${v};`;f+=`
     for (int r = 0; r < ${u}; r++) {
      for (int d1 = 0; d1 < ${e.inChannels}; d1 += 2) {
       `;for(let v=0;v<h;v++)f+=`
           xTexelC${v*2} = vec4(0.0);
           xTexelC${v*2}Ready = 0;
           xTexelC${v*2+1} = vec4(0.0);
           xTexelC${v*2+1}Ready = 0;
           xC${v} = vec4(0.0);`;f+=`
         xR = xRCorner + r * dilations[0];
         if (xR >=0 && xR < inDims[0]) {
       `;for(let v=0;v<(p+1)/2;v++){const w=v*2;if(f+=`
           xC = xCCorner + ${w*l};
           `,a===1){if(w<h&&(i%2===1?(f+=`
                 xCOffset = xC + 1;
                 if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${w}Ready == 0) {
                   xTexelC${w} = getX(batch, xR, xCOffset, d1);

                   // Need to manually clear unused channels in case
                   // we're reading from recycled texture.
                   if (xCOffset + 1 >= inDims[1]) {
                     xTexelC${w}.zw = vec2(0.0);
                   }
                   xTexelC${w}Ready = 1;
                 }
               `,l===1&&w>0?f+=`
                 xC${w} = vec4(xTexelC${w-2}.zw, xTexelC${w}.xy);
                 `:f+=`
                   xCOffset = xC + 1 - 2;

                   if (xCOffset >= 0 && xCOffset < inDims[1]) {
                     previous = getX(batch, xR, xCOffset, d1);

                     // Need to manually clear unused channels in case
                     // we're reading from recycled texture.
                     if (xCOffset + 1 >= inDims[1]) {
                       previous.zw = vec2(0.0);
                     }

                     xC${w} = vec4(previous.zw, xTexelC${w}.xy);
                   } else {
                     xC${w} = vec4(0.0, 0.0, xTexelC${w}.xy);
                   }
                   `):f+=`
                 if (xC >= 0 && xC < inDims[1] && xTexelC${w}Ready == 0) {
                   xTexelC${w} = getX(batch, xR, xC, d1);
                   if (xC + 1 >= inDims[1]) {
                     xTexelC${w}.zw = vec2(0.0);
                   }
                   xTexelC${w}Ready = 1;
                 }

                 xC${w} = xTexelC${w};
                 `,w+1<h)){const S=i%2===0?Sw(l):l;l%2===0&&i%2===1||l%2!==0&&i%2!==1?(f+=`
                   xCOffset = xC + imod(pads[1], 2) + ${S};

                   if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${w+1}Ready == 0) {
                     xTexelC${w+1} = getX(batch, xR, xCOffset, d1);

                     // Need to manually clear unused channels in case
                     // we're reading from recycled texture.
                     if (xCOffset + 1 >= inDims[1]) {
                       xTexelC${w+1}.zw = vec2(0.0);
                     }
                     xTexelC${w+1}Ready = 1;
                   }
                   `,l>1?f+=`
                     xCOffset -= 2;
                     if (xCOffset >= 0 && xCOffset < inDims[1]) {
                      previous = getX(batch, xR, xCOffset, d1);
                      xC${w+1} = vec4(previous.zw, xTexelC${w+1}.xy);
                     } else {
                      xC${w+1} = vec4(0.0, 0.0, xTexelC${w+1}.xy);
                     }
                     `:f+=`
                     xC${w+1} = vec4(xTexelC${w}.zw, xTexelC${w+1}.xy);
                     `):S===1?f+=`
                     xC${w+1} = xTexelC${w};
                     `:f+=`
                     xCOffset = xC + ${S};

                     if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${w+1}Ready == 0) {
                       xTexelC${w+1} = getX(batch, xR, xCOffset, d1);
                       if (xCOffset + 1 >= inDims[1]) {
                         xTexelC${w+1}.zw = vec2(0.0);
                       }
                       xTexelC${w+1}Ready = 1;
                     }

                     xC${w+1} = xTexelC${w+1};
                     `}}else w<h&&(i%2===1?(f+=`
                 xCOffset = xC + 1 - strides[1];
                 if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${w}Ready == 0) {
                   xTexelC${w} = getX(batch, xR, xCOffset, d1);
                   // Need to manually clear unused channels in case
                   // we're reading from recycled texture.
                   if (xCOffset + 1 >= inDims[1]) {
                     xTexelC${w}.zw = vec2(0.0);
                   }
                   xTexelC${w}Ready = 1;
                 }

                 if(xC + 1 >= 0 && xC + 1 < inDims[1] && xTexelC${w+1}Ready == 0) {
                   xTexelC${w+1} = getX(batch, xR, xC + 1, d1);
                   // Need to manually clear unused channels in case
                   // we're reading from recycled texture.
                   if (xC + 2 >= inDims[1]) {
                     xTexelC${w+1}.zw = vec2(0.0);
                   }
                   xTexelC${w+1}Ready = 1;
                 }

                 xC${w} = vec4(xTexelC${w}.zw, xTexelC${w+1}.zw);
               `,w+1<h&&(f+=`
                   final = vec4(0.0);
                   xCOffset = xC + 1 + strides[1];
                   if(xCOffset >= 0 && xCOffset < inDims[1]) {
                     final = getX(batch, xR, xCOffset, d1);
                   }
                   xC${w+1} = vec4(xTexelC${w+1}.xy, final.xy);
                 `)):(f+=`
                 if(xC >= 0 && xC < inDims[1] && xTexelC${w}Ready == 0) {
                   xTexelC${w} = getX(batch, xR, xC, d1);
                   if (xC + 1 >= inDims[1]) {
                     xTexelC${w}.zw = vec2(0.0);
                   }
                   xTexelC${w}Ready = 1;
                 }

                 xCOffset = xC + strides[1];
                 if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${w+1}Ready == 0) {
                   xTexelC${w+1} = getX(batch, xR, xCOffset, d1);
                   if (xCOffset + 1 >= inDims[1]) {
                     xTexelC${w+1}.zw = vec2(0.);
                   }
                   xTexelC${w+1}Ready = 1;
                 }

                 xC${w} = vec4(
                   xTexelC${w}.xy, xTexelC${w+1}.xy);
               `,w+1<h&&(f+=`
                   xC${w+1} = vec4(xTexelC${w}.zw, xTexelC${w+1}.zw);
                 `)));w<h&&(f+=`
             wTexel = getW(r, ${w}, d1, d2);
             dotProd += xC${w}.xxzz * vec4(wTexel.xy, wTexel.xy);
             if(d1 + 1 < ${e.inChannels}) {
               dotProd += xC${w}.yyww * vec4(wTexel.zw, wTexel.zw);
             }
           `,w+1<h&&(f+=`
               wTexel = getW(r, ${w+1}, d1, d2);
               dotProd += xC${w+1}.xxzz * vec4(wTexel.xy, wTexel.xy);
               if(d1 + 1 < ${e.inChannels}) {
                 dotProd += xC${w+1}.yyww * vec4(wTexel.zw, wTexel.zw);
               }
             `))}f+=`
     }
   `,f+=`
     }
   `,f+=`
     }
   `;let m="",y="";s&&(r?m=`vec4 activation(vec4 a) {
           vec4 b = getPreluActivationWeightsAtOutCoords();
           ${s}
         }`:o?m=`vec4 activation(vec4 a) {
           vec4 b = getLeakyreluAlphaAtOutCoords();
           ${s}
         }`:m=`vec4 activation(vec4 x) {
           ${s}
         }`,y="result = activation(result);");const x=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),o&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
       ${m}

       void main() {
         ivec4 coords = getOutputCoords();
         int batch = coords.x;
         ivec2 xRCCorner = coords.yz * strides - pads;
         int d2 = coords.w;
         int xRCorner = xRCCorner.x;
         int xCCorner = xRCCorner.y;

         //intialize dotProd with a small epsilon seems to reduce GPU accuracy loss.
         vec4 dotProd = vec4(0.000000000000001);

         ${f}

         vec4 result = dotProd - vec4(0.000000000000001);
         ${x}
         ${y}
         setOutput(result);
       }
     `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class cie{constructor(e,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"inputShape",type:"ivec4"},{name:"pad",type:"ivec2"},{name:"stride",type:"ivec2"},{name:"dilation",type:"ivec2"},{name:"inChannels",type:"int"},{name:"itemsPerBlockRow",type:"int"},{name:"outWidth",type:"int"}],this.outputShape=e,this.enableShapeUniforms=Xn(this.outputShape.length);const{dataFormat:s}=t,r=is(),o=s==="channelsLast",i=o?1:2,a=o?2:3,l=this.enableShapeUniforms?"if(blockIndex < outShape[2] && pos < outShape[1]) {":`if(blockIndex < ${e[2]} && pos < ${e[1]}) {`;let u="";for(let h=0;h<=1;h++)for(let p=0;p<=1;p++)u+=`
          blockIndex = rc.z + ${p};
          pos = rc.y + ${h};

          ${l}
            offsetY = int(blockIndex / outWidth) * stride[0] - pad[0];
            d0 = offsetY + dilation[0] * (pos / itemsPerBlockRow);

            if(d0 < inputShape[${i}] && d0 >= 0) {
              // Use custom imod instead mod. On Intel GPU, mod may generate
              // unexpected value.
              // https://github.com/tensorflow/tfjs/issues/5447
              offsetX = imod(blockIndex, outWidth) * stride[1] - pad[1];
              d1 = offsetX + dilation[1] * (imod(pos, itemsPerBlockRow) /
                  inChannels);

              if(d1 < inputShape[${a}] && d1 >= 0) {

                ch = imod(pos, inChannels);

                if (${o}) {
                  innerDims = vec2(d1, ch);
                  result[${h*2+p}] = getChannel(
                    getA(rc.x, d0, int(innerDims.x),
                    int(innerDims.y)), innerDims);
                } else {
                  innerDims = vec2(d0, d1);
                  result[${h*2+p}] = getChannel(
                    getA(rc.x, ch, int(innerDims.x),
                    int(innerDims.y)), innerDims);
                }
              }
            }
          }
        `;this.userCode=`
      void main() {
        ivec3 rc = getOutputCoords();

        vec4 result = vec4(0);

        int blockIndex, pos, offsetY, d0, offsetX, d1, ch;
        vec2 innerDims;

        ${u}

        ${r.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qf(n,e){const t=n.length;return t>=3?e?[...n.slice(0,-3),n[t-3]*n[t-2],n[t-1]]:[...n.slice(0,-3),n[t-3],n[t-2]*n[t-1]]:!e&&t===1&&n[0]>1?[n[0],1]:null}function DF({x:n,filter:e,convInfo:t,backend:s,bias:r=null,preluActivationWeights:o=null,leakyreluAlpha:i=0,activation:a=null}){const l=n.shape,u=s.texData.get(n.dataId),h=t.inChannels,p=l[0]*l[1]*l[2],f=t.outChannels,m=t.dataFormat==="channelsLast",y=!1,x=!1;let v;const w=[];if(o!=null){const T=Qf(o.shape,m);T!=null&&(o=Te({inputs:{x:o},backend:s,attrs:{shape:T}}),w.push(o))}if(r!=null){const T=Qf(r.shape,m);T!=null&&(r=Te({inputs:{x:r},backend:s,attrs:{shape:T}}),w.push(r))}if(!((p===1||f===1)&&h>CF)&&u.isPacked&&m&&u.texture!=null&&l[2]%2!==0&&ct(u.shape.slice(-3),l.slice(-3))){const T=l[0]*l[1]*(l[2]+1),I={dataId:n.dataId,shape:[1,T,t.inChannels],dtype:n.dtype},E=u.shape;u.shape=u.shape.slice(),u.shape[u.shape.length-2]++,L(Xf(u.shape,I.shape),()=>`packed reshape ${u.shape} to ${I.shape} isn't free`);const D=Te({inputs:{x:e},backend:s,attrs:{shape:[1,t.inChannels,t.outChannels]}});w.push(D);const O=Yf({a:I,b:D,backend:s,transposeA:y,transposeB:x,bias:r,activation:a,preluActivationWeights:o,leakyreluAlpha:i}),_=s.texData.get(O.dataId);L(_.isPacked,()=>"batchMatMul result is expected to be packed"),u.shape=E,_.shape=t.outShape,v=Ps({inputs:{x:O},backend:s}),v.shape=t.outShape,w.push(O)}else{const T=t.outHeight*t.outWidth,I=Te({inputs:{x:n},backend:s,attrs:{shape:m?[t.batchSize,T,t.inChannels]:[t.batchSize,t.inChannels,T]}}),E=Te({inputs:{x:e},backend:s,attrs:{shape:[1,t.inChannels,t.outChannels]}}),D=Yf({a:m?I:E,b:m?E:I,transposeA:!m,transposeB:x,backend:s,bias:r,activation:a,preluActivationWeights:o,leakyreluAlpha:i});v=Te({inputs:{x:D},backend:s,attrs:{shape:t.outShape}}),w.push(I),w.push(E),w.push(D)}for(const T of w)s.disposeIntermediateTensorInfo(T);return v}function AF({x:n,filter:e,convInfo:t,backend:s,bias:r=null,preluActivationWeights:o=null,leakyreluAlpha:i=0,activation:a=null}){const{filterWidth:l,filterHeight:u,inChannels:h,outWidth:p,outHeight:f,dataFormat:m}=t,y=m==="channelsLast",x=l*u*h,v=f*p,w=[t.batchSize,x,v],S=!0,k=!1,T=[];if(o!=null){const G=Qf(o.shape,y);G!=null&&(o=Te({inputs:{x:o},backend:s,attrs:{shape:G}}),T.push(o))}if(r!=null){const G=Qf(r.shape,y);G!=null&&(r=Te({inputs:{x:r},backend:s,attrs:{shape:G}}),T.push(r))}const I=Te({inputs:{x:e},backend:s,attrs:{shape:[1,x,fe(e.shape)/x]}});T.push(I);const E=new cie(w,t),D=[n.shape,[t.padInfo.top,t.padInfo.left],[t.strideHeight,t.strideWidth],[t.dilationHeight,t.dilationWidth],[t.inChannels],[t.filterWidth*t.inChannels],[t.outWidth]],O=s.runWebGLProgram(E,[n],"float32",D),_=Te({inputs:{x:O},backend:s,attrs:{shape:w}});T.push(O),T.push(_);const P=r!=null,R=o!=null,W=a==="leakyrelu",Q=a?Uc(a,!0):null,ee=new SF(y?_.shape:I.shape,y?I.shape:_.shape,y?[t.batchSize,v,t.outChannels]:[t.batchSize,t.outChannels,v],S,k,P,Q,R,W),te=y?[_,I]:[I,_];if(r&&te.push(r),R&&te.push(o),W){const G=s.makeTensorInfo([],"float32",_i(i,"float32"));te.push(G),T.push(G)}const oe=s.runWebGLProgram(ee,te,"float32"),se=Te({inputs:{x:oe},backend:s,attrs:{shape:t.outShape}});T.push(oe);for(const G of T)s.disposeIntermediateTensorInfo(G);return se}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hie(n){const{inputs:e,backend:t,attrs:s}=n,{x:r,filter:o}=e,{strides:i,pad:a,dataFormat:l,dilations:u,dimRoundingMode:h}=s,p=Mo(l),f=Nn(r.shape,o.shape,i,u,a,h,!1,p);let m;if(f.filterHeight===1&&f.filterWidth===1&&f.dilationHeight===1&&f.dilationWidth===1&&f.strideHeight===1&&f.strideWidth===1&&(f.padInfo.type==="SAME"||f.padInfo.type==="VALID"))m=DF({x:r,filter:o,convInfo:f,backend:t});else if(f.strideWidth<=2&&p==="channelsLast"&&ae().getBool("WEBGL_EXP_CONV")){const x=new RF(f),v=[[f.padInfo.top,f.padInfo.left],[f.strideHeight,f.strideWidth],[f.dilationHeight,f.dilationWidth],[f.inHeight,f.inWidth]];m=t.runWebGLProgram(x,[r,o],"float32",v)}else if(ae().getBool("WEBGL_CONV_IM2COL"))m=AF({x:r,filter:o,convInfo:f,backend:t});else{const x=new EF(f);m=t.runWebGLProgram(x,[r,o],"float32")}const y=Te({inputs:{x:m},backend:t,attrs:{shape:f.outShape}});return t.disposeIntermediateTensorInfo(m),y}const die={kernelName:Cm,backendName:"webgl",kernelFunc:hie};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class pie{constructor(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;const t=e.strideHeight,s=e.strideWidth,r=e.padInfo.top,o=e.padInfo.left,i=e.dataFormat==="channelsLast";this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int wR = coords.x;
        int wC = coords.y;
        int d1 = coords.z;
        int d2 = coords.w;

        // Convolve x(?, ?, d1) with dy(:, :, d2) to get dw(wR, wC, d1, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int b = 0; b < ${e.batchSize}; b++) {
          for (int yR = 0; yR < ${e.outHeight}; yR++) {
            int xR = wR + yR * ${t} - ${r};

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int yC = 0; yC < ${e.outWidth}; yC++) {
              int xC = wC + yC * ${s} - ${o};

              if (xC < 0 || xC >= ${e.inWidth}) {
                continue;
              }

              ${i?`float dyValue = getDy(b, yR, yC, d2);
              float xValue = getX(b, xR, xC, d1);
              dotProd += (xValue * dyValue);`:`float dyValue = getDy(b, d2, yR, yC);
              float xValue = getX(b, d1, xR, xC);
              dotProd += (xValue * dyValue);`}
            }
          }
        }
        setOutput(dotProd);
      }
    `}}class fie{constructor(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;const t=e.filterHeight,s=e.filterWidth,r=e.strideHeight,o=e.strideWidth,i=e.dataFormat==="channelsLast",a=t-1-e.padInfo.top,l=s-1-e.padInfo.left,u=i?1:2,h=i?2:3,p=i?3:1;this.userCode=`
      const ivec2 pads = ivec2(${a}, ${l});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[${p}];

        ivec2 dyCorner = ivec2(coords[${u}], coords[${h}]) - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${t}; wR++) {
          float dyR = float(dyRCorner + wR) / ${r}.0;

          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          int wRPerm = ${t} - 1 - wR;

          for (int wC = 0; wC < ${s}; wC++) {
            float dyC = float(dyCCorner + wC) / ${o}.0;

            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            int wCPerm = ${s} - 1 - wC;

            for (int d2 = 0; d2 < ${e.outChannels}; d2++) {

              if (${i}) {
                float xValue = getDy(batch, idyR, idyC, d2);
                float wValue = getW(wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              } else {
                float xValue = getDy(batch, d2, idyR, idyC);
                float wValue = getW(wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              }

            }
          }
        }
        setOutput(dotProd);
      }
    `}}class mie{constructor(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;const t=e.strideDepth,s=e.strideHeight,r=e.strideWidth,o=e.padInfo.front,i=e.padInfo.top,a=e.padInfo.left;this.userCode=`
      void main() {
        ivec5 coords = getOutputCoords();
        int wF = coords.x;
        int wR = coords.y;
        int wC = coords.z;
        int d1 = coords.w;
        int d2 = coords.u;

        float dotProd = 0.0;

        for (int b = 0; b < ${e.batchSize}; b++) {
          for (int yF = 0; yF < ${e.outDepth}; yF++) {
            int xF = wF + yF * ${t} - ${o};

            if (xF < 0 || xF >= ${e.inDepth}) {
              continue;
            }

            for (int yR = 0; yR < ${e.outHeight}; yR++) {
              int xR = wR + yR * ${s} - ${i};

              if (xR < 0 || xR >= ${e.inHeight}) {
                continue;
              }

              for (int yC = 0; yC < ${e.outWidth}; yC++) {
                int xC = wC + yC * ${r} - ${a};

                if (xC < 0 || xC >= ${e.inWidth}) {
                  continue;
                }

                float dyValue = getDy(b, yF, yR, yC, d2);
                float xValue = getX(b, xF, xR, xC, d1);
                dotProd += (xValue * dyValue);
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}}class gie{constructor(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;const t=e.filterDepth,s=e.filterHeight,r=e.filterWidth,o=e.strideDepth,i=e.strideHeight,a=e.strideWidth,l=t-1-e.padInfo.front,u=s-1-e.padInfo.top,h=r-1-e.padInfo.left;this.userCode=`
      const ivec3 pads = ivec3(${l}, ${u}, ${h});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int d1 = coords.u;


        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyFCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        float dotProd = 0.0;
        for (int wF = 0; wF < ${t}; wF++) {
          float dyF = float(dyFCorner + wF) / ${o}.0;

          if (dyF < 0.0 || dyF >= ${e.outDepth}.0 || fract(dyF) > 0.0) {
            continue;
          }
          int idyF = int(dyF);

          int wFPerm = ${t} - 1 - wF;

          for (int wR = 0; wR < ${s}; wR++) {
            float dyR = float(dyRCorner + wR) / ${i}.0;

            if (dyR < 0.0 || dyR >= ${e.outHeight}.0 ||
              fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            int wRPerm = ${s} - 1 - wR;

            for (int wC = 0; wC < ${r}; wC++) {
              float dyC = float(dyCCorner + wC) / ${a}.0;

              if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              int wCPerm = ${r} - 1 - wC;

              for (int d2 = 0; d2 < ${e.outChannels}; d2++) {
                float xValue = getDy(batch, idyF, idyR, idyC, d2);
                float wValue = getW(wFPerm, wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yie(n){const{inputs:e,backend:t,attrs:s}=n,{x:r,dy:o}=e,{strides:i,pad:a,dataFormat:l,dimRoundingMode:u,filterShape:h}=s,p=Mo(l),f=Nn(r.shape,h,i,1,a,u,!1,p),m=new pie(f);return t.runWebGLProgram(m,[r,o],"float32")}const xie={kernelName:Aw,backendName:"webgl",kernelFunc:yie};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class vie{constructor(e){this.variableNames=["dy","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"strides",type:"vec2"}],this.outputShape=e.inShape,this.enableShapeUniforms=Xn(this.outputShape.length);const t=e.filterHeight,s=e.filterWidth,r=t-1-e.padInfo.top,o=s-1-e.padInfo.left;this.userCode=`
      const ivec2 pads = ivec2(${r}, ${o});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[3];

        ivec2 dyCorner = ivec2(coords[1], coords[2]) - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        vec4 result = vec4(0.);
        for (int wR = 0; wR < ${t}; wR++) {
          float dyR = float(dyRCorner + wR) / strides[0];
          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);
          int wRPerm = ${t} - 1 - wR;

          for (int wC = 0; wC < ${s}; wC++) {
            int wCPerm = ${s} - 1 - wC;

            float dyC = float(dyCCorner + wC) / strides[1];
            bool idyCVal = (dyC >= 0.0) && (dyC < ${e.outWidth}.0)
              && (fract(dyC) == 0.0);
            int idyC = int(dyC);

            float dyC2 = float(dyCCorner + wC + 1) / strides[1];
            bool idyCVal2 = (dyC2 >= 0.0) && (dyC2 < ${e.outWidth}.0)
              && (fract(dyC2) == 0.0);
            int idyC2 = int(dyC2);

            if (idyCVal && idyCVal2) {
              for (int d2 = 0; d2 < ${e.outChannels}; d2 += 2) {
                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);
                vec4 dySample = getDy(batch, idyR, idyC, d2);
                vec4 dySample2 = (idyC / 2 == idyC2 / 2) ?
                  dySample : getDy(batch, idyR, idyC2, d2);

                vec2 dyValue = mod(float(idyC), 2.) == 0. ?
                  dySample.xy : dySample.zw;
                result.xy += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));

                dyValue = mod(float(idyC2), 2.) == 0. ?
                  dySample2.xy : dySample2.zw;
                result.zw += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));
              }
            } else if (idyCVal) {
              for (int d2 = 0; d2 < ${e.outChannels}; d2 += 2) {
                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);
                vec4 dySample = getDy(batch, idyR, idyC, d2);
                vec2 dyValue = mod(float(idyC), 2.) == 0. ?
                  dySample.xy : dySample.zw;
                result.xy += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));
              }
            } else if (idyCVal2) {
              for (int d2 = 0; d2 < ${e.outChannels}; d2 += 2) {
                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);
                vec4 dySample = getDy(batch, idyR, idyC2, d2);
                vec2 dyValue = mod(float(idyC2), 2.) == 0. ?
                  dySample.xy : dySample.zw;
                result.zw += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));
              }
            }
          }
        }
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wie(n){const{inputs:e,backend:t,attrs:s}=n,{dy:r,filter:o}=e,{inputShape:i,strides:a,pad:l,dataFormat:u,dimRoundingMode:h}=s,p=Mo(u),f=Nn(i,o.shape,a,1,l,h,!1,p);if(ae().getBool("WEBGL_PACK_CONV2DTRANSPOSE")&&p==="channelsLast"){const m=[[f.strideHeight,f.strideWidth]],y=new vie(f);return t.runWebGLProgram(y,[r,o],"float32",m)}else{const m=new fie(f);return t.runWebGLProgram(m,[r,o],"float32")}}const bie={kernelName:km,backendName:"webgl",kernelFunc:wie};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Sie(n){const{inputs:e,backend:t,attrs:s}=n,{x:r,filter:o}=e,{strides:i,pad:a,dilations:l}=s,u=Li(r.shape,o.shape,i,l,a),h=new uie(u);return t.runWebGLProgram(h,[r,o],"float32")}const Cie={kernelName:Tm,backendName:"webgl",kernelFunc:Sie};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kie(n){const{inputs:e,backend:t,attrs:s}=n,{x:r,dy:o}=e,{strides:i,pad:a,filterShape:l}=s,u=Li(r.shape,l,i,1,a),h=new mie(u);return t.runWebGLProgram(h,[r,o],"float32")}const Tie={kernelName:Ow,backendName:"webgl",kernelFunc:kie};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Nie(n){const{inputs:e,backend:t,attrs:s}=n,{dy:r,filter:o}=e,{pad:i,strides:a,inputShape:l}=s,u=Li(l,o.shape,a,1,i),h=new gie(u);return t.runWebGLProgram(h,[r,o],"float32")}const Iie={kernelName:_w,backendName:"webgl",kernelFunc:Nie};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $ie=Cu+`
  return cos(x);
`,Eie=`
  vec4 result = cos(x);
  bvec4 isNaN = isnan(x);
  ${qa}
  return result;
`,Rie=pt({opSnippet:$ie,packedOpSnippet:Eie}),Die={kernelName:dh,backendName:"webgl",kernelFunc:Rie};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Aie=`
  float e2x = exp(-x);
  return (e2x + 1.0 / e2x) / 2.0;
`,Oie=pt({opSnippet:Aie}),_ie={kernelName:ph,backendName:"webgl",kernelFunc:Oie};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Fie{constructor(e,t,s,r,o){this.variableNames=["Image","Boxes","BoxInd"],this.outputShape=[];const[i,a,l,u]=e,[h]=t,[p,f]=s;this.outputShape=[h,p,f,u];const m=r==="bilinear"?1:0,[y,x]=[`${a-1}.0`,`${l-1}.0`],[v,w,S]=p>1?[`${(a-1)/(p-1)}`,"(y2-y1) * height_ratio",`y1*${y} + float(y)*(height_scale)`]:["0.0","0.0",`0.5 * (y1+y2) * ${y}`],[k,T,I]=f>1?[`${(l-1)/(f-1)}`,"(x2-x1) * width_ratio",`x1*${x} + float(x)*(width_scale)`]:["0.0","0.0",`0.5 * (x1+x2) * ${x}`];this.userCode=`
      const float height_ratio = float(${v});
      const float width_ratio = float(${k});
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int y = coords[1];
        int x = coords[2];
        int d = coords[3];

        // get box vals
        float y1 = getBoxes(b,0);
        float x1 = getBoxes(b,1);
        float y2 = getBoxes(b,2);
        float x2 = getBoxes(b,3);

        // get image in batch index
        int bInd = round(getBoxInd(b));
        if(bInd < 0 || bInd >= ${i}) {
          return;
        }

        float height_scale = ${w};
        float width_scale = ${T};

        float in_y = ${S};
        if( in_y < 0.0 || in_y > ${y} ) {
          setOutput(float(${o}));
          return;
        }
        float in_x = ${I};
        if( in_x < 0.0 || in_x > ${x} ) {
          setOutput(float(${o}));
          return;
        }

        vec2 sourceFracIndexCR = vec2(in_x,in_y);
        if(${m} == 1) {
          // Compute the four integer indices.
          ivec2 sourceFloorCR = ivec2(sourceFracIndexCR);
          ivec2 sourceCeilCR = ivec2(ceil(sourceFracIndexCR));

          float topLeft = getImage(b, sourceFloorCR.y, sourceFloorCR.x, d);
          float bottomLeft = getImage(b, sourceCeilCR.y, sourceFloorCR.x, d);
          float topRight = getImage(b, sourceFloorCR.y, sourceCeilCR.x, d);
          float bottomRight = getImage(b, sourceCeilCR.y, sourceCeilCR.x, d);

          vec2 fracCR = sourceFracIndexCR - vec2(sourceFloorCR);

          float top = topLeft + (topRight - topLeft) * fracCR.x;
          float bottom = bottomLeft + (bottomRight - bottomLeft) * fracCR.x;
          float newValue = top + (bottom - top) * fracCR.y;
          setOutput(newValue);
        } else {
          // Compute the coordinators of nearest neighbor point.
          ivec2 sourceNearestCR = ivec2(floor(
            sourceFracIndexCR + vec2(0.5,0.5)));
          float newValue = getImage(b, sourceNearestCR.y, sourceNearestCR.x, d);
          setOutput(newValue);
        }
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Pie=n=>{const{inputs:e,backend:t,attrs:s}=n,{image:r,boxes:o,boxInd:i}=e,{cropSize:a,method:l,extrapolationValue:u}=s,h=new Fie(r.shape,o.shape,a,l,u);return t.runWebGLProgram(h,[r,o,i],"float32")},Lie={kernelName:Pw,backendName:"webgl",kernelFunc:Pie};var jc;(function(n){n.Prod="*",n.Sum="+"})(jc||(jc={}));class UI{constructor(e,t,s,r){this.op=e,this.outputShape=t,this.variableNames=["x"],this.customUniforms=[{name:"index",type:"float"}];const o=this.outputShape.length,i=this.op===jc.Prod?"1.0":"0.0",a=s?i:`getX(${GI(o,"coords",this.op)})`,l=this.outputShape[this.outputShape.length-1];let u="",h="";s?(u=r?`end != ${l-1}`:"end != 0",h=r?"end + 1":"end - 1"):(u=r?`end + pow2 < ${l}`:"end >= pow2",h=r?"end + pow2":"end - pow2"),this.userCode=`
      void main() {
        ${St(o)} coords = getOutputCoords();
        int end = ${jI(o,"coords",this.op)};
        float val = ${a};
        int pow2 = int(pow(2.0, index));
        if (${u}) {
          int idx = ${h};
          ${jI(o,"coords",this.op)} = idx;
          val ${this.op}= getX(${GI(o,"coords",this.op)});
        }
        setOutput(val);
      }
    `}}function GI(n,e,t){if(n===1)return`${e}`;if(n===2)return`${e}.x, ${e}.y`;if(n===3)return`${e}.x, ${e}.y, ${e}.z`;if(n===4)return`${e}.x, ${e}.y, ${e}.z, ${e}.w`;throw new Error(`Cumulative ${t} for rank ${n} is not yet supported`)}function jI(n,e,t){if(n===1)return`${e}`;if(n===2)return`${e}.y`;if(n===3)return`${e}.z`;if(n===4)return`${e}.w`;throw new Error(`Cumulative ${t} for rank ${n} is not yet supported`)}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function OF(n,e,t,s,r,o){const i=e.shape.length,a=zt([s],i);let l=e;a!=null&&(l=rs({inputs:{x:e},backend:t,attrs:{perm:a}}));const u=Jt(1,i)[0];if(u!==i-1)throw new Error(`WebGL cumprod shader expects an inner-most axis=${e.shape.length-1} but got axis=${s}`);const h=l.shape[u];let p=Ps({inputs:{x:l},backend:t});for(let f=0;f<=Math.ceil(Math.log2(h))-1;f++){const m=new UI(n,l.shape,!1,o),y=[[f]],x=p;p=t.runWebGLProgram(m,[p],p.dtype,y),t.disposeIntermediateTensorInfo(x)}if(r){const f=new UI(n,l.shape,r,o),m=p;p=t.runWebGLProgram(f,[p],p.dtype),t.disposeIntermediateTensorInfo(m)}if(a!=null){const f=Mi(a),m=rs({inputs:{x:p},backend:t,attrs:{perm:f}});return t.disposeIntermediateTensorInfo(p),t.disposeIntermediateTensorInfo(l),m}return p}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mie(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{axis:o,exclusive:i,reverse:a}=s;return OF(jc.Prod,r,t,o,i,a)}const zie={kernelName:Fw,backendName:"webgl",kernelFunc:Mie};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vie(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{axis:o,exclusive:i,reverse:a}=s;return OF(jc.Sum,r,t,o,i,a)}const Bie={kernelName:Nm,backendName:"webgl",kernelFunc:Vie};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Wie(n){const{inputs:e,backend:t,attrs:s}=n,{x:r,weights:o}=e,{size:i,binaryOutput:a}=s;if(r.shape.length===1){const l=t.readSync(r.dataId),u=t.readSync(o.dataId),h=pF(l,u,o.dtype,o.shape,i);return t.makeTensorInfo([i],o.dtype,h)}else if(r.shape.length===2){const l=t.bufferSync(r),u=t.bufferSync(o),h=Hne(l,u,i,a);return t.makeTensorInfo(h.shape,o.dtype,h.values)}throw new Error(`Error in denseBincount: input must be at most rank 2, but got rank${r.shape.length}.`)}const Uie={kernelName:Lw,backendName:"webgl",kernelFunc:Wie};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Gie{constructor(e,t,s){this.variableNames=["x"],this.outputShape=[],this.outputShape=e,this.blockSize=t,this.dataFormat=s,this.userCode=`
    void main() {
      ivec4 coords = getOutputCoords();
      int b = coords[0];
      int h = ${this.getHeightCoordString()};
      int w = ${this.getWidthCoordString()};
      int d = ${this.getDepthCoordString()};

      int in_h = h / ${t};
      int offset_h = imod(h, ${t});
      int in_w = w / ${t};
      int offset_w = imod(w, ${t});
      int offset_d = (offset_h * ${t} + offset_w) *
        ${this.getOutputDepthSize()};
      int in_d = d + offset_d;

      float result = ${this.getInputSamplingString()};
      setOutput(result);
    }
  `}getHeightCoordString(){return this.dataFormat==="NHWC"?"coords[1]":"coords[2]"}getWidthCoordString(){return this.dataFormat==="NHWC"?"coords[2]":"coords[3]"}getDepthCoordString(){return this.dataFormat==="NHWC"?"coords[3]":"coords[1]"}getOutputDepthSize(){return this.dataFormat==="NHWC"?this.outputShape[3]:this.outputShape[1]}getInputSamplingString(){return this.dataFormat==="NHWC"?"getX(b, in_h, in_w, in_d)":"getX(b, in_d, in_h, in_w)"}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jie(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{blockSize:o,dataFormat:i}=s,a=r.shape[0],l=i==="NHWC"?r.shape[1]:r.shape[2],u=i==="NHWC"?r.shape[2]:r.shape[3],h=i==="NHWC"?r.shape[3]:r.shape[1],p=l*o,f=u*o,m=h/(o*o),y=i==="NHWC"?[a,p,f,m]:[a,m,p,f],x=new Gie(y,o,i);return t.runWebGLProgram(x,[r],r.dtype)}const Hie={kernelName:Mw,backendName:"webgl",kernelFunc:jie};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class _F{constructor(e,t=!1,s=null,r=!1,o=!1){this.variableNames=["x","W"],this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=e.outShape,this.enableShapeUniforms=Xn(this.outputShape.length);const i=e.filterHeight,a=e.filterWidth,l=e.outChannels/e.inChannels;let u="",h="";s&&(r?u=`float activation(float a) {
          float b = getPreluActivationWeightsAtOutCoords();
          ${s}
        }`:o?u=`float activation(float a) {
          float b = getLeakyreluAlphaAtOutCoords();
          ${s}
        }`:u=`
          float activation(float x) {
            ${s}
          }
        `,h="result = activation(result);");const p=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),o&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
      ${u}

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        ivec2 xRCCorner = coords.yz * strides - pads;
        int d2 = coords.w;
        int d1 = d2 / ${l};
        int q = d2 - d1 * ${l};

        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // Convolve x(?, ?, d1) with w(:, :, d1, q) to get y(yR, yC, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        // TO DO(dsmilkov): Flatten the two for loops and vec4 the operations.
        for (int wR = 0; wR < ${i}; wR++) {
          int xR = xRCorner + wR * dilations[0];

          if (xR < 0 || xR >= inDims[0]) {
            continue;
          }

          for (int wC = 0; wC < ${a}; wC++) {
            int xC = xCCorner + wC * dilations[1];

            if (xC < 0 || xC >= inDims[1]) {
              continue;
            }

            float xVal = getX(batch, xR, xC, d1);
            float wVal = getW(wR, wC, d1, q);
            dotProd += xVal * wVal;
          }
        }

        float result = dotProd;
        ${p}
        ${h}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class FF{constructor(e,t=!1,s=null,r=!1,o=!1){this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=e.outShape,this.enableShapeUniforms=Xn(this.outputShape.length);const i=e.outChannels/e.inChannels,a=e.padInfo.left,l=e.strideWidth,u=e.dilationWidth,h=e.filterHeight,p=e.filterWidth,f=p;let m=`
      int xR; int xC; int xCOffset;
      vec4 wTexel; vec4 previous; vec4 final;`;for(let w=0;w<p;w++)m+=`
          vec4 xTexelC${w*2};
          int xTexelC${w*2}Ready;
          vec4 xTexelC${w*2+1};
          int xTexelC${w*2+1}Ready;
          vec4 xC${w};`;m+=`
    for (int r = 0; r < ${h}; r++) {
      `;for(let w=0;w<p;w++)m+=`
          xTexelC${w*2} = vec4(0.0);
          xTexelC${w*2}Ready = 0;
          xTexelC${w*2+1} = vec4(0.0);
          xTexelC${w*2+1}Ready = 0;
          xC${w} = vec4(0.0);`;m+=`
        xR = xRCorner + r * dilations[0];
        if (xR >=0 && xR < inDims[0]) {
      `;for(let w=0;w<(f+1)/2;w++){const S=w*2;if(m+=`
          xC = xCCorner + ${S*u};
          `,l===1){if(S<p&&(a%2===1?(m+=`
                xCOffset = xC + 1;
                if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${S}Ready == 0) {
                  xTexelC${S} = getX(batch, xR, xCOffset, d1);

                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if (xCOffset + 1 >= inDims[1]) {
                    xTexelC${S}.zw = vec2(0.0);
                  }
                  xTexelC${S}Ready = 1;
                }
              `,u===1&&S>0?m+=`
                xC${S} = vec4(xTexelC${S-2}.zw, xTexelC${S}.xy);
                `:m+=`
                  xCOffset = xC + 1 - 2;

                  if (xCOffset >= 0 && xCOffset < inDims[1]) {
                    previous = getX(batch, xR, xCOffset, d1);

                    // Need to manually clear unused channels in case
                    // we're reading from recycled texture.
                    if (xCOffset + 1 >= inDims[1]) {
                      previous.zw = vec2(0.0);
                    }

                    xC${S} = vec4(previous.zw, xTexelC${S}.xy);
                  } else {
                    xC${S} = vec4(0.0, 0.0, xTexelC${S}.xy);
                  }
                  `):m+=`
                if (xC >= 0 && xC < inDims[1] && xTexelC${S}Ready == 0) {
                  xTexelC${S} = getX(batch, xR, xC, d1);
                  if (xC + 1 >= inDims[1]) {
                    xTexelC${S}.zw = vec2(0.0);
                  }
                  xTexelC${S}Ready = 1;
                }

                xC${S} = xTexelC${S};
                `,S+1<p)){const k=a%2===0?Sw(u):u;u%2===0&&a%2===1||u%2!==0&&a%2!==1?(m+=`
                  xCOffset = xC + imod(pads[1], 2) + ${k};

                  if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${S+1}Ready == 0) {
                    xTexelC${S+1} = getX(batch, xR, xCOffset, d1);

                    // Need to manually clear unused channels in case
                    // we're reading from recycled texture.
                    if (xCOffset + 1 >= inDims[1]) {
                      xTexelC${S+1}.zw = vec2(0.0);
                    }
                    xTexelC${S+1}Ready = 1;
                  }
                  `,u>1?m+=`
                    xCOffset -= 2;
                    if (xCOffset >= 0 && xCOffset < inDims[1]) {
                     previous = getX(batch, xR, xCOffset, d1);
                     xC${S+1} = vec4(previous.zw, xTexelC${S+1}.xy);
                    } else {
                     xC${S+1} = vec4(0.0, 0.0, xTexelC${S+1}.xy);
                    }
                    `:m+=`
                    xC${S+1} = vec4(xTexelC${S}.zw, xTexelC${S+1}.xy);
                    `):k===1?m+=`
                    xC${S+1} = xTexelC${S};
                    `:m+=`
                    xCOffset = xC + ${k};

                    if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${S+1}Ready == 0) {
                      xTexelC${S+1} = getX(batch, xR, xCOffset, d1);
                      if (xCOffset + 1 >= inDims[1]) {
                        xTexelC${S+1}.zw = vec2(0.0);
                      }
                      xTexelC${S+1}Ready = 1;
                    }

                    xC${S+1} = xTexelC${S+1};
                    `}}else S<p&&(a%2===1?(m+=`
                xCOffset = xC + 1 - strides[1];
                if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${S}Ready == 0) {
                  xTexelC${S} = getX(batch, xR, xCOffset, d1);
                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if (xCOffset + 1 >= inDims[1]) {
                    xTexelC${S}.zw = vec2(0.0);
                  }
                  xTexelC${S}Ready = 1;
                }

                if(xC + 1 >= 0 && xC + 1 < inDims[1] && xTexelC${S+1}Ready == 0) {
                  xTexelC${S+1} = getX(batch, xR, xC + 1, d1);
                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if (xC + 2 >= inDims[1]) {
                    xTexelC${S+1}.zw = vec2(0.0);
                  }
                  xTexelC${S+1}Ready = 1;
                }

                xC${S} = vec4(xTexelC${S}.zw, xTexelC${S+1}.zw);
              `,S+1<p&&(m+=`
                  final = vec4(0.0);
                  xCOffset = xC + 1 + strides[1];
                  if(xCOffset >= 0 && xCOffset < inDims[1]) {
                    final = getX(batch, xR, xCOffset, d1);
                  }
                  xC${S+1} = vec4(xTexelC${S+1}.xy, final.xy);
                `)):(m+=`
                if(xC >= 0 && xC < inDims[1] && xTexelC${S}Ready == 0) {
                  xTexelC${S} = getX(batch, xR, xC, d1);
                  if (xC + 1 >= inDims[1]) {
                    xTexelC${S}.zw = vec2(0.0);
                  }
                  xTexelC${S}Ready = 1;
                }

                xCOffset = xC + strides[1];
                if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${S+1}Ready == 0) {
                  xTexelC${S+1} = getX(batch, xR, xCOffset, d1);
                  if (xCOffset + 1 >= inDims[1]) {
                    xTexelC${S+1}.zw = vec2(0.);
                  }
                  xTexelC${S+1}Ready = 1;
                }

                xC${S} = vec4(
                  xTexelC${S}.xy, xTexelC${S+1}.xy);
              `,S+1<p&&(m+=`
                  xC${S+1} = vec4(xTexelC${S}.zw, xTexelC${S+1}.zw);
                `)));S<p&&(m+=`
            wTexel = getW(r, ${S}, d1, q);
            dotProd += xC${S} * vec4(wTexel.xz, wTexel.xz);
          `,S+1<p&&(m+=`
              wTexel = getW(r, ${S+1}, d1, q);
              dotProd += xC${S+1} * vec4(wTexel.xz, wTexel.xz);
            `))}m+=`
    }
  `,m+=`
      }
    `;let y="",x="";s&&(r?y=`vec4 activation(vec4 a) {
          vec4 b = getPreluActivationWeightsAtOutCoords();
          ${s}
        }`:o?y=`vec4 activation(vec4 a) {
          vec4 b = getLeakyreluAlphaAtOutCoords();
          ${s}
        }`:y=`vec4 activation(vec4 x) {
          ${s}
        }`,x="result = activation(result);");const v=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),o&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
      ${y}

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        ivec2 xRCCorner = coords.yz * strides - pads;
        int d2 = coords.w;
        int d1 = d2 / ${i};
        int q = d2 - d1 * ${i};
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        //intialize dotProd with a small epsilon seems to reduce GPU accuracy loss.
        vec4 dotProd = vec4(0.000000000000001);

        ${m}

        vec4 result = dotProd - vec4(0.000000000000001);
        ${v}
        ${x}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Kie(n){const{inputs:e,backend:t,attrs:s}=n,{x:r,filter:o}=e,{strides:i,pad:a,dilations:l,dimRoundingMode:u}=s;let h=l;h==null&&(h=[1,1]),L(Ln(i,h),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${i} and dilations '${h}'`);const p=Nn(r.shape,o.shape,i,h,a,u,!0);let f;ae().getBool("WEBGL_PACK_DEPTHWISECONV")&&p.strideWidth<=2&&p.outChannels/p.inChannels===1?f=new FF(p):f=new _F(p);const m=[[p.padInfo.top,p.padInfo.left],[p.strideHeight,p.strideWidth],[p.dilationHeight,p.dilationWidth],[p.inHeight,p.inWidth]];return t.runWebGLProgram(f,[r,o],"float32",m)}const qie={kernelName:Im,backendName:"webgl",kernelFunc:Kie};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Xie{constructor(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;const t=e.strideHeight,s=e.strideWidth,r=e.padInfo.top,o=e.padInfo.left,i=e.outChannels/e.inChannels;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int wR = coords.x;
        int wC = coords.y;
        int d1 = coords.z;
        int dm = coords.w;
        int d2 = d1 * ${i} + dm;

        float dotProd = 0.0;

        // TO DO: Vec4 over the batch size
        for (int b = 0; b < ${e.batchSize}; b++) {
          for (int yR = 0; yR < ${e.outHeight}; yR++) {
            int xR = wR + yR * ${t} - ${r};

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int yC = 0; yC < ${e.outWidth}; yC++) {
              int xC = wC + yC * ${s} - ${o};

              if (xC < 0 || xC >= ${e.inWidth}) {
                continue;
              }

              float dyValue = getDy(b, yR, yC, d2);
              float xValue = getX(b, xR, xC, d1);
              dotProd += (xValue * dyValue);
            }
          }
        }
        setOutput(dotProd);
      }
    `}}class Yie{constructor(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;const t=e.filterHeight,s=e.filterWidth,r=e.strideHeight,o=e.strideWidth,i=t-1-e.padInfo.top,a=s-1-e.padInfo.left,l=e.outChannels/e.inChannels;this.userCode=`
      const ivec2 pads = ivec2(${i}, ${a});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[3];
        ivec2 dyCorner = coords.yz - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        float dotProd = 0.0;

        for (int wR = 0; wR < ${t}; wR++) {
          float dyR = float(dyRCorner + wR) / ${r}.0;

          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          int wRPerm = ${t} - 1 - wR;

          for (int wC = 0; wC < ${s}; wC++) {
            float dyC = float(dyCCorner + wC) / ${o}.0;

            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            int wCPerm = ${s} - 1 - wC;

            // TO DO: Vec4 over the channelMul
            for (int dm = 0; dm < ${l}; dm++) {
              int d2 = d1 * ${l} + dm;
              float xValue = getDy(batch, idyR, idyC, d2);
              float wValue = getW(wRPerm, wCPerm, d1, dm);
              dotProd += xValue * wValue;
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qie(n){const{inputs:e,backend:t,attrs:s}=n,{x:r,dy:o}=e,{strides:i,dilations:a,pad:l,dimRoundingMode:u,filterShape:h}=s,p=Nn(r.shape,h,i,a,l,u,!0),f=new Xie(p);return t.runWebGLProgram(f,[r,o],"float32")}const Zie={kernelName:zw,backendName:"webgl",kernelFunc:Qie};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jie(n){const{inputs:e,backend:t,attrs:s}=n,{dy:r,filter:o}=e,{strides:i,dilations:a,pad:l,dimRoundingMode:u,inputShape:h}=s,p=Nn(h,o.shape,i,a,l,u,!0),f=new Yie(p);return t.runWebGLProgram(f,[r,o],"float32")}const eae={kernelName:Vw,backendName:"webgl",kernelFunc:Jie};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class tae{constructor(e){this.variableNames=["X"],this.outputShape=[e,e],this.userCode=`
      void main() {
          ivec2 coords = getOutputCoords();
          float val = coords[0] == coords[1] ? getX(coords[0]) : 0.0;
          setOutput(val);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nae(n){const{inputs:e,backend:t}=n,{x:s}=e,r=[...s.shape,...s.shape],o=fe(s.shape),i=Te({inputs:{x:s},backend:t,attrs:{shape:[o]}}),a=new tae(o),l=t.runWebGLProgram(a,[i],i.dtype),u=Te({inputs:{x:l},backend:t,attrs:{shape:r}});return t.disposeIntermediateTensorInfo(i),t.disposeIntermediateTensorInfo(l),u}const sae={kernelName:Bw,backendName:"webgl",kernelFunc:nae};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class rae{constructor(e){this.variableNames=["x","W"],this.outputShape=e.outShape;const{inHeight:t,inWidth:s,padInfo:r,strideHeight:o,strideWidth:i,filterHeight:a,filterWidth:l,dilationHeight:u,dilationWidth:h}=e,{top:p,left:f}=r;this.userCode=`
      const ivec2 strides = ivec2(${o}, ${i});
      const ivec2 pads = ivec2(${p}, ${f});
      const float neg_infinity = -3.4e38;

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        int d1 = coords.w;
        ivec2 outTopLeftCorner =
            coords.yz * strides - pads;
        int hBeg = outTopLeftCorner.x;
        int wBeg = outTopLeftCorner.y;

        float curVal = neg_infinity;
        for (int h = 0; h < ${a}; h++) {
          int hIn = hBeg + h * ${u};

          if (hIn >= 0 && hIn < ${t}) {
            for (int w = 0; w < ${l}; w++) {
              int wIn = wBeg + w * ${h};

              if (wIn >= 0 && wIn < ${s}) {
                float xVal = getX(batch, hIn, wIn, d1);
                float wVal = getW(h, w, d1);

                float val = xVal + wVal;
                if (val > curVal) {
                  curVal = val;
                }
              }
            }
          }
        }

        float result = curVal;
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oae(n){const{inputs:e,backend:t,attrs:s}=n,{x:r,filter:o}=e,{strides:i,pad:a,dilations:l}=s,u=Zh(r.shape,o.shape,i,a,"NHWC",l);let h;const p=new rae(u);h=t.runWebGLProgram(p,[r,o],"float32");const f=Te({inputs:{x:h},backend:t,attrs:{shape:u.outShape}});return t.disposeIntermediateTensorInfo(h),f}const iae={kernelName:$m,backendName:"webgl",kernelFunc:oae};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aae(n){const{inputs:e,backend:t,attrs:s}=n,{equation:r}=s,o=e,{allDims:i,summedDims:a,idDims:l}=_b(r,o.length);Pb(i.length,l,o);const{path:u,steps:h}=Lb(a,l),p=h.length;let f=null,m=i.length;const y=[];for(let x=0;x<p;++x){for(const v of h[x]){const{permutationIndices:w,expandDims:S}=Fb(m,l[v]);let k;Mb(w)?k=o[v]:(k=rs({inputs:{x:o[v]},backend:t,attrs:{perm:w}}),y.push(k));const T=k.shape.slice();for(let I=0;I<S.length;++I)T.splice(S[I],0,1);ct(k.shape,T)||(k=Te({inputs:{x:k},backend:t,attrs:{shape:T}}),y.push(k)),f===null?f=k:(f=kS({inputs:{a:k,b:f},backend:t}),y.push(f))}x<p-1&&(u[x]>=0&&(f=ny({inputs:{x:f},backend:t,attrs:{axis:u[x]-(i.length-m),keepDims:!1}}),y.push(f)),m--)}for(const x of y)x!==f&&t.disposeIntermediateTensorInfo(x);return f}const lae={kernelName:Ww,backendName:"webgl",kernelFunc:aae};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const uae="return (x >= 0.0) ? x : (exp(x) - 1.0);",cae=`
  vec4 result;

  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);
  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);
  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);
  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);

  return result;
`,hae=pt({opSnippet:uae,packedOpSnippet:cae}),dae={kernelName:mh,backendName:"webgl",kernelFunc:hae};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pae="return (b >= 0.0) ? a : a * (b + 1.0);",fae=`
  vec4 bGTEZero = vec4(greaterThanEqual(b, vec4(0.)));
  return (bGTEZero * a) + ((vec4(1.0) - bGTEZero) * (a * (b + vec4(1.0))));
`,mae=n=>{const{inputs:e,backend:t}=n,{dy:s,y:r}=e,o=ae().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Su(fae,s.shape,r.shape):new Pa(pae,s.shape,r.shape);return t.runWebGLProgram(o,[s,r],s.dtype)},gae={kernelName:Uw,backendName:"webgl",kernelFunc:mae};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yae=`
  return vec4(equal(a, b));
`,xae="return float(a == b);",vae=Vn({opSnippet:xae,packedOpSnippet:yae,dtype:"bool",cpuKernelImpl:Qne}),wae={kernelName:Em,backendName:"webgl",kernelFunc:vae};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bae=`
  // Error function is calculated approximately with elementary function.
  // See "Handbook of Mathematical Functions with Formulas,
  // Graphs, and Mathematical Tables", Abramowitz and Stegun.
  float p = ${Ib};
  float a1 = ${$b};
  float a2 = ${Eb};
  float a3 = ${Rb};
  float a4 = ${Db};
  float a5 = ${Ab};

  float sign = sign(x);
  x = abs(x);
  float t = 1.0 / (1.0 + p * x);
  return sign * (1.0 - (((((a5*t + a4)*t) + a3)*t + a2)*t + a1)*t*exp(-x*x));
`,Sae=pt({opSnippet:bae}),Cae={kernelName:gh,backendName:"webgl",kernelFunc:Sae};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kae=Cu+`
  return exp(x);
`,Tae=`
  vec4 result = exp(x);
  bvec4 isNaN = isnan(x);
  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,PF=pt({opSnippet:kae,packedOpSnippet:Tae,cpuKernelImpl:Zne,dtype:"float32"}),Nae={kernelName:yh,backendName:"webgl",kernelFunc:PF};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Gv(n){const{inputs:e,attrs:t,backend:s}=n,{dim:r}=t,{input:o}=e,i=o.shape.length,a=o.shape.slice();let l=r;return r<0&&(L(-(i+1)<=r,()=>`Axis must be in the interval [${-(i+1)}, ${i}]`),l=i+r+1),a.splice(l,0,1),Te({inputs:{x:o},backend:s,attrs:{shape:a}})}const Iae={kernelName:Rm,backendName:"webgl",kernelFunc:Gv};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const HI="return exp(x) - 1.0;",$ae=pt({opSnippet:HI,packedOpSnippet:HI,cpuKernelImpl:Jne}),Eae={kernelName:xh,backendName:"webgl",kernelFunc:$ae};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class KI{constructor(e,t,s){this.variableNames=["real","imag"];const r=t[1];this.outputShape=t;const o=s?`2.0 * ${Math.PI}`:`-2.0 * ${Math.PI}`,i=s?`${r}.0`:"1.0";let a;if(e==="real")a="return real * expR - imag * expI;";else if(e==="imag")a="return real * expI + imag * expR;";else throw new Error(`FFT component must be either "real" or "imag", got ${e}.`);this.userCode=`
      const float exponentMultiplier = ${o};

      float unaryOpComplex(float real, float expR, float imag, float expI) {
        ${a}
      }

      float mulMatDFT(int batch, int index) {
        float indexRatio = float(index) / float(${r});
        float exponentMultiplierTimesIndexRatio =
            exponentMultiplier * indexRatio;

        float result = 0.0;

        for (int i = 0; i < ${r}; i++) {
          // x = (-2|2 * PI / N) * index * i;
          float x = exponentMultiplierTimesIndexRatio * float(i);
          float expR = cos(x);
          float expI = sin(x);
          float real = getReal(batch, i);
          float imag = getImag(batch, i);

          result +=
              unaryOpComplex(real, expR, imag, expI) / ${i};
        }

        return result;
      }

      void main() {
        ivec2 coords = getOutputCoords();
        setOutput(mulMatDFT(coords[0], coords[1]));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function LF(n,e,t){const s=t.texData.get(n.dataId),r=fe(n.shape),o=n.shape[n.shape.length-1],i=r/o,a=Te({inputs:{x:n},backend:t,attrs:{shape:[i,o]}}),l=a.shape,u=new KI("real",l,e),h=new KI("imag",l,e),p=[{dataId:s.complexTensorInfos.real.dataId,dtype:s.complexTensorInfos.real.dtype,shape:l},{dataId:s.complexTensorInfos.imag.dataId,dtype:s.complexTensorInfos.imag.dtype,shape:l}],f=t.runWebGLProgram(u,p,"float32"),m=t.runWebGLProgram(h,p,"float32"),y=Gi({inputs:{real:f,imag:m},backend:t});t.disposeIntermediateTensorInfo(f),t.disposeIntermediateTensorInfo(m);const x=Te({inputs:{x:y},backend:t,attrs:{shape:n.shape}});return t.disposeIntermediateTensorInfo(a),t.disposeIntermediateTensorInfo(y),x}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rae(n){const{inputs:e,backend:t}=n,{input:s}=e;return LF(s,!1,t)}const Dae={kernelName:Gw,backendName:"webgl",kernelFunc:Rae};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Aae{constructor(e,t){this.outputShape=[],this.customUniforms=[{name:"value",type:"float"}],this.variableNames=["x"],this.outputShape=e,this.userCode=`
      void main() {
        // Input can be obtained from uniform value.
        setOutput(value);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bd(n){const{backend:e,attrs:t}=n,{shape:s,value:r}=t;let{dtype:o}=t;if(o=o||lu(r),o==="string"){const i=Qt(o,fe(s));return i.fill(r),e.makeTensorInfo(s,o,i)}else{const i=new Aae(s,r),a=[[r]];return e.runWebGLProgram(i,[],o,a)}}const Oae={kernelName:jw,backendName:"webgl",kernelFunc:bd};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class _ae{constructor(e){this.variableNames=["Image"],this.outputShape=[];const t=e[2];this.outputShape=e,this.userCode=`
        void main() {
          ivec4 coords = getOutputCoords();
          int x = coords[2];

          int coordX = ${t} - x - 1;
          float outputValue;
          if(coordX >= 0 && coordX < ${t}) {
            outputValue = getImage(coords[0], coords[1], coordX, coords[3]);
          } else {
            outputValue = getImage(coords[0], coords[1], coords[2], coords[3]);
          }
          setOutput(outputValue);
        }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Fae={kernelName:Hw,backendName:"webgl",kernelFunc:({inputs:n,backend:e})=>{const{image:t}=n,s=e,r=new _ae(t.shape);return s.runWebGLProgram(r,[t],t.dtype)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qI="return floor(x);",Pae=pt({opSnippet:qI,packedOpSnippet:qI,cpuKernelImpl:ese}),Lae={kernelName:vh,backendName:"webgl",kernelFunc:Pae};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Mae=`
  float s = sign(a) * sign(b);
  int ia = round(a);
  int ib = round(b);
  if (ib != 0) {
    // Windows (D3D) wants guaranteed non-zero int division at compile-time.
    return float(idiv(ia, ib, s));
  } else {
    return NAN;
  }
`,zae=`
  ivec4 ia = round(a);
  ivec4 ib = round(b);
  bvec4 cond = notEqual(ib, ivec4(0));
  ivec4 result = ivec4(0);
  vec4 s = sign(a) * sign(b);

  // Windows (D3D) wants guaranteed non-zero int division at compile-time.
  if (cond[0]) {
    result[0] = idiv(ia[0], ib[0], s[0]);
  }
  if (cond[1]) {
    result[1] = idiv(ia[1], ib[1], s[1]);
  }
  if (cond[2]) {
    result[2] = idiv(ia[2], ib[2], s[2]);
  }
  if (cond[3]) {
    result[3] = idiv(ia[3], ib[3], s[3]);
  }
  return vec4(result);
`,Vae=Vn({opSnippet:Mae,packedOpSnippet:zae,dtype:"int32"}),Bae={kernelName:wh,backendName:"webgl",kernelFunc:Vae};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Wae{constructor(e){this.variableNames=["A"];const t=is(),[s,r]=e;this.outputShape=e,this.userCode=`
      void main() {
        ivec3 coords = getOutputCoords();
        int texR = coords[0];
        int texC = coords[1];
        int depth = coords[2];
        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${r}.0, ${s}.0);

        vec4 values = ${t.texture2D}(A, uv);
        float value;
        if (depth == 0) {
          value = values.r;
        } else if (depth == 1) {
          value = values.g;
        } else if (depth == 2) {
          value = values.b;
        } else if (depth == 3) {
          value = values.a;
        }

        setOutput(floor(value * 255.0 + 0.5));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Uae{constructor(e){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;const t=is(),[s,r]=e;this.outputShape=e,this.userCode=`
      void main() {
        ivec3 coords = getOutputCoords();
        int texR = coords[0];
        int texC = coords[1];
        int depth = coords[2];

        vec4 result = vec4(0.);

        for(int row=0; row<=1; row++) {
          for(int col=0; col<=1; col++) {
            texC = coords[1] + row;
            depth = coords[2] + col;

            vec2 uv = (vec2(texC, texR) + halfCR) /
                       vec2(${r}.0, ${s}.0);
            vec4 values = ${t.texture2D}(A, uv);
            float value;
            if (depth == 0) {
              value = values.r;
            } else if (depth == 1) {
              value = values.g;
            } else if (depth == 2) {
              value = values.b;
            } else if (depth == 3) {
              value = values.a;
            }

            result[row * 2 + col] = floor(value * 255.0 + 0.5);
          }
        }

        ${t.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Gae={kernelName:Jx,backendName:"webgl",kernelFunc:jae};let Cl,Tx=ae().getBool("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU");function jae(n){const{inputs:e,backend:t,attrs:s}=n;let{pixels:r}=e;const{numChannels:o}=s,i=typeof HTMLVideoElement<"u"&&r instanceof HTMLVideoElement,a=typeof HTMLImageElement<"u"&&r instanceof HTMLImageElement,[l,u]=i?[r.videoWidth,r.videoHeight]:[r.width,r.height],h=[u,l],p=[u,l,o];if(a||i){const x=ae().getBool("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU");(Cl==null||x!==Tx)&&(Tx=x,Cl=document.createElement("canvas").getContext("2d",{willReadFrequently:Tx})),Cl.canvas.width=l,Cl.canvas.height=u,Cl.drawImage(r,0,0,l,u),r=Cl.canvas}const f=t.makeTensorInfo(h,"int32");t.texData.get(f.dataId).usage=Gs.PIXELS,t.gpgpu.uploadPixelDataToTexture(t.getTexture(f.dataId),r);const m=ae().getBool("WEBGL_PACK")?new Uae(p):new Wae(p),y=t.runWebGLProgram(m,[f],"int32");return t.disposeData(f.dataId),y}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hae(n){const{inputs:e,backend:t,attrs:s}=n,{x:r,filter:o,bias:i,preluActivationWeights:a}=e,{strides:l,pad:u,dataFormat:h,dilations:p,dimRoundingMode:f,activation:m,leakyreluAlpha:y}=s,x=Mo(h),v=Nn(r.shape,o.shape,l,p,u,f,!1,x);let w;const S=[],k=i!=null,T=a!=null,I=m==="leakyrelu",E=()=>{const O=[r,o],_=(P,R)=>{if(R==="NCHW"&&P.shape.length===1&&P.shape[0]!==1){const W=Te({inputs:{x:P},backend:t,attrs:{shape:[P.shape[0],1,1]}});return S.push(W),W}return P};if(k&&O.push(_(i,h)),T&&O.push(_(a,h)),I){const P=t.makeTensorInfo([],"float32",_i(y,"float32"));O.push(P),S.push(P)}return O};if(v.filterHeight===1&&v.filterWidth===1&&v.dilationHeight===1&&v.dilationWidth===1&&v.strideHeight===1&&v.strideWidth===1&&(v.padInfo.type==="SAME"||v.padInfo.type==="VALID"))w=DF({x:r,filter:o,convInfo:v,backend:t,bias:i,activation:m,preluActivationWeights:a,leakyreluAlpha:y});else if(v.strideWidth<=2&&x==="channelsLast"&&ae().getBool("WEBGL_EXP_CONV")){const O=m?Uc(m,!0):null,_=new RF(v,k,O,T,I),P=[[v.padInfo.top,v.padInfo.left],[v.strideHeight,v.strideWidth],[v.dilationHeight,v.dilationWidth],[v.inHeight,v.inWidth]],R=E();w=t.runWebGLProgram(_,R,"float32",P)}else if(ae().getBool("WEBGL_CONV_IM2COL"))w=AF({x:r,filter:o,convInfo:v,backend:t,bias:i,activation:m,preluActivationWeights:a,leakyreluAlpha:y});else{const O=m?Uc(m,!1):null,_=new EF(v,k,O,T,I),P=E();w=t.runWebGLProgram(_,P,"float32")}const D=Te({inputs:{x:w},backend:t,attrs:{shape:v.outShape}});return S.push(w),S.forEach(O=>t.disposeIntermediateTensorInfo(O)),D}const Kae={kernelName:Nf,backendName:"webgl",kernelFunc:Hae};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qae(n){const{inputs:e,backend:t,attrs:s}=n,{x:r,filter:o,bias:i,preluActivationWeights:a}=e,{strides:l,pad:u,dilations:h,dimRoundingMode:p,activation:f,leakyreluAlpha:m}=s,y=[];let x=h;x==null&&(x=[1,1]),L(Ln(l,x),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${l} and dilations '${x}'`);const v=Nn(r.shape,o.shape,l,x,u,p,!0),w=ae().getBool("WEBGL_PACK_DEPTHWISECONV")&&v.strideWidth<=2&&v.outChannels/v.inChannels===1,S=f?Uc(f,w):null,k=[r,o],T=i!=null,I=a!=null,E=f==="leakyrelu";if(T&&k.push(i),I&&k.push(a),E){const P=t.makeTensorInfo([],"float32",_i(m,"float32"));k.push(P),y.push(P)}let D;w?D=new FF(v,T,S,I,E):D=new _F(v,T,S,I,E);const O=[[v.padInfo.top,v.padInfo.left],[v.strideHeight,v.strideWidth],[v.dilationHeight,v.dilationWidth],[v.inHeight,v.inWidth]],_=t.runWebGLProgram(D,k,"float32",O);return y.forEach(P=>t.disposeIntermediateTensorInfo(P)),_}const Xae={kernelName:If,backendName:"webgl",kernelFunc:qae};class Yae{constructor(e,t,s,r){this.sliceDim=e,this.strides=t,this.paramsShape=r,this.variableNames=["x","indices"],this.outputShape=s;const o=St(s.length);let i=`
    int index;`;for(let a=0;a<this.sliceDim;a++)i+=`
          index = round(getIndices(coords[0], ${a}));
          out_of_bounds = out_of_bounds || index < 0;
          out_of_bounds = out_of_bounds || index >= ${this.paramsShape[a]};
          flattenIndex += index * ${this.strides[a]};`;this.userCode=`
         void main() {
          ${o} coords = getOutputCoords();
          int flattenIndex = 0;
          bool out_of_bounds = false;

          ${i}

          setOutput(out_of_bounds ? 0.0 : getX(flattenIndex, coords[1]));
        }
      `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qae(n){const{inputs:e,backend:t}=n,{params:s,indices:r}=e,o=r.shape,i=o[o.length-1],a=fe(s.shape),[l,u,h,p]=wb(s,r),f=Te({inputs:{x:r},backend:t,attrs:{shape:[u,i]}}),m=Te({inputs:{x:s},backend:t,attrs:{shape:[fe(s.shape)/h,h]}});if(t.shouldExecuteOnCPU([s,r])||s.dtype==="string"){const w=t.readSync(r.dataId),S=t.bufferSync(s),k=tse(w,S,s.dtype,u,i,h,p,s.shape,a);return t.makeTensorInfo(l,s.dtype,k.values)}const y=new Yae(i,p,[u,h],s.shape),x=t.runWebGLProgram(y,[m,f],m.dtype),v=Te({inputs:{x},backend:t,attrs:{shape:l}});return t.disposeIntermediateTensorInfo(f),t.disposeIntermediateTensorInfo(m),t.disposeIntermediateTensorInfo(x),v}const Zae={kernelName:Kw,backendName:"webgl",kernelFunc:Qae};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Jae{constructor(e,t){this.variableNames=["A","indices"],this.outputShape=t,this.rank=t.length;const s=St(this.rank),r=ele(e);this.userCode=`
      void main() {
        ${s} resRC = getOutputCoords();
        int index = int(getIndices(resRC.x, resRC.z));
        float inBounds = (index >= 0) && (index < ${e[2]}) ? 1.0 : 0.0;
        setOutput(inBounds * getA(${r}));
      }
    `}}function ele(n,e){const t=["resRC.x","resRC.y","resRC.z","resRC.w"],s=[];for(let r=0;r<n.length;r++)r===2?s.push("index"):s.push(`${t[r]}`);return s.join()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function MF(n){const{inputs:e,backend:t,attrs:s}=n,{x:r,indices:o}=e,{axis:i,batchDims:a}=s,l=it(i,r.shape)[0];if(ae().get("DEBUG")){const S=t.readSync(o.dataId),k=r.shape[l];for(let T=0;T<S.length;++T){const I=S[T];L(I<=k-1&&I>=0,()=>`GatherV2: the index value ${I} is not in [0, ${k-1}]`)}}const u=CD(r,o,l,a),h=fe(o.shape),p=[],f=Te({inputs:{x:r},backend:t,attrs:{shape:[u.batchSize,u.outerSize,u.dimSize,u.sliceSize]}}),m=Te({inputs:{x:o},backend:t,attrs:{shape:[u.batchSize,h/u.batchSize]}});p.push(f),p.push(m);const y=[u.batchSize,u.outerSize,h/u.batchSize,u.sliceSize];if(t.shouldExecuteOnCPU([r,o])||r.dtype==="string"){const S=t.bufferSync(m),k=t.bufferSync(f),T=nse(k,S,y);return p.forEach(I=>t.disposeIntermediateTensorInfo(I)),t.makeTensorInfo(u.outputShape,T.dtype,T.values)}const x=new Jae(f.shape,y),v=t.runWebGLProgram(x,[f,m],f.dtype);p.push(v);const w=Te({inputs:{x:v},backend:t,attrs:{shape:u.outputShape}});return p.forEach(S=>t.disposeIntermediateTensorInfo(S)),w}const tle={kernelName:Am,backendName:"webgl",kernelFunc:MF};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nle="return float(a > b);",sle=`
  return vec4(greaterThan(a, b));
`,rle=Vn({opSnippet:nle,packedOpSnippet:sle,cpuKernelImpl:sse,dtype:"bool"}),ole={kernelName:Om,backendName:"webgl",kernelFunc:rle};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ile="return float(a >= b);",ale=`
  return vec4(greaterThanEqual(a, b));
`,lle=Vn({opSnippet:ile,packedOpSnippet:ale,dtype:"bool",cpuKernelImpl:rse}),ule={kernelName:bh,backendName:"webgl",kernelFunc:lle};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cle(n){const{inputs:e,backend:t}=n,{input:s}=e;return LF(s,!0,t)}const hle={kernelName:qw,backendName:"webgl",kernelFunc:cle};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dle="return float(!isnan(x) && !isinf(x));",ple=pt({opSnippet:dle,dtype:"bool"}),fle={kernelName:Ch,backendName:"webgl",kernelFunc:ple};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mle="return float(isinf(x));",gle=pt({opSnippet:mle,dtype:"bool"}),yle={kernelName:kh,backendName:"webgl",kernelFunc:gle};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xle="return float(isnan(x));",vle=pt({opSnippet:xle,dtype:"bool"}),wle={kernelName:Th,backendName:"webgl",kernelFunc:vle};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ble="return float(a < b);",Sle=`
  return vec4(lessThan(a, b));
`,Cle=Vn({opSnippet:ble,packedOpSnippet:Sle,cpuKernelImpl:ose,dtype:"bool"}),kle={kernelName:Fm,backendName:"webgl",kernelFunc:Cle};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Tle="return float(a <= b);",Nle=`
  return vec4(lessThanEqual(a, b));
`,Ile=Vn({opSnippet:Tle,packedOpSnippet:Nle,cpuKernelImpl:ise,dtype:"bool"}),$le={kernelName:Pm,backendName:"webgl",kernelFunc:Ile};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ele(n){const{backend:e,attrs:t}=n,{start:s,stop:r,num:o}=t,i=ase(s,r,o);return e.makeTensorInfo([i.length],"float32",i)}const Rle={kernelName:Yw,backendName:"webgl",kernelFunc:Ele};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Dle=Cu+`
  return x < 0.0 ? 0./0. : log(x);
`,Ale=`
  vec4 result = log(x);
  bvec4 isNaN = isnan(x);
  result.r = isNaN.r ? x.r : (x.r < 0.0 ? 0./0. : result.r);
  result.g = isNaN.g ? x.g : (x.g < 0.0 ? 0./0. : result.g);
  result.b = isNaN.b ? x.b : (x.b < 0.0 ? 0./0. : result.b);
  result.a = isNaN.a ? x.a : (x.a < 0.0 ? 0./0. : result.a);
  return result;
`,Ole=pt({opSnippet:Dle,packedOpSnippet:Ale,cpuKernelImpl:lse}),_le={kernelName:Nh,backendName:"webgl",kernelFunc:Ole};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Fle=Cu+`
  return log(1.0 + x);
`,Ple=pt({opSnippet:Fle}),Lle={kernelName:Ih,backendName:"webgl",kernelFunc:Ple};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Mle="return float(a >= 1.0 && b >= 1.0);",zle=`
  return vec4(
    vec4(greaterThanEqual(a, vec4(1.0))) *
    vec4(greaterThanEqual(b, vec4(1.0))));
`,Vle=Vn({opSnippet:Mle,packedOpSnippet:zle,dtype:"bool"}),Ble={kernelName:Lm,backendName:"webgl",kernelFunc:Vle};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Wle="return float(!(x >= 1.0));",Ule=pt({opSnippet:Wle}),Gle={kernelName:Mm,backendName:"webgl",kernelFunc:Ule};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jle="return float(a >= 1.0 || b >= 1.0);",Hle=`
  return min(
    vec4(greaterThanEqual(a, vec4(1.0))) +
    vec4(greaterThanEqual(b, vec4(1.0))),
    vec4(1.0));
`,Kle=Vn({opSnippet:jle,packedOpSnippet:Hle,dtype:"bool"}),qle={kernelName:zm,backendName:"webgl",kernelFunc:Kle};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Xle{constructor(e,t,s,r,o){this.variableNames=["x"],this.outputShape=[];const i=t,a=e[3]-1;this.outputShape=e;let l;const u=`float(${s}) + float(${r}) * sum`;o===.5?l=`inversesqrt(${u})`:o===1?l=`1.0/(${u})`:l=`exp(log(${u}) * float(-${o}));`,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int r = coords[1];
        int c = coords[2];
        int d = coords[3];
        float x = getX(b, r, c, d);
        float sum = 0.0;
        for (int j = -${i}; j <= ${i}; j++) {
          int idx = d + j;
          if (idx >= 0 && idx <=  ${a}) {
            float z = getX(b, r, c, idx);
            sum += z * z;
          }
        }
        float val = x * ${l};
        setOutput(val);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Yle{constructor(e,t,s,r,o){this.variableNames=["x"],this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0;const i=t,a=e[3]-1;this.outputShape=e;let l;const u=`float(${s}) + float(${r}) * sum`;o===.5?l=`inversesqrt(${u})`:o===1?l=`1.0/(${u})`:l=`exp(log(${u}) * float(-${o}));`,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords.x;
        int r = coords.y;
        int c = coords.z;
        int d = coords.w;

        bool hasNextCol = d < ${this.outputShape[3]};
        bool hasNextRow = c < ${this.outputShape[2]};

        vec4 sum = vec4(0.);
        vec4 xFragAtOutputCoords = getX(b, r, c, d);

        vec4 xAtOutputCoords = vec4(
          getChannel(xFragAtOutputCoords, vec2(c, d)),
          hasNextCol ?
            getChannel(xFragAtOutputCoords, vec2(c, d + 1)) : 0.0,
          hasNextRow ?
            getChannel(xFragAtOutputCoords , vec2(c + 1, d)) : 0.0,
          (hasNextRow && hasNextCol) ?
            getChannel(xFragAtOutputCoords, vec2(c + 1, d + 1)) : 0.0
        );

        int firstChannel = d - ${i};
        vec2 cache = vec2(0.);
        if(firstChannel >= 0){
          vec4 firstChannelFrag = getX(b, r, c, firstChannel);
          cache.x = getChannel(firstChannelFrag, vec2(c, firstChannel));
            if(hasNextRow){
              cache.y = getChannel(firstChannelFrag, vec2(c + 1, firstChannel));
            }
        }

        ivec2 depth = ivec2(d, d + 1);
        for (int j = - ${i}; j <= ${i}; j++) {
          ivec2 idx = depth + j;
          bvec2 aboveLowerBound = greaterThanEqual(idx, ivec2(0));
          bvec2 belowUpperBound = lessThanEqual(idx, ivec2(${a}));

          bool depthInRange = aboveLowerBound.x && belowUpperBound.x;
          bool depthPlusOneInRange = aboveLowerBound.y && belowUpperBound.y;

          if(depthInRange || depthPlusOneInRange){
            vec4 z = vec4(0.);
            vec4 xFragAtCurrentDepth;
            z.xz = cache.xy;
            if(depthPlusOneInRange && hasNextCol){
              xFragAtCurrentDepth = idx.y != d ?
                getX(b, r, c, idx.y) : xFragAtOutputCoords;
              z.y = getChannel(xFragAtCurrentDepth, vec2(c, idx.y));
              if(hasNextRow){
                z.w = getChannel(xFragAtCurrentDepth, vec2(c + 1, idx.y));
              }
            }
            cache.xy = z.yw;
            sum += z * z;
          }
        }
        vec4 result = xAtOutputCoords * ${l};
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Qle=n=>{const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{depthRadius:o,bias:i,alpha:a,beta:l}=s,u=ae().getBool("WEBGL_PACK_NORMALIZATION")?new Yle(r.shape,o,i,a,l):new Xle(r.shape,o,i,a,l);return t.runWebGLProgram(u,[r],r.dtype)},Zle={kernelName:Vm,backendName:"webgl",kernelFunc:Qle};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Jle{constructor(e,t,s,r,o){this.variableNames=["inputImage","outputImage","dy"],this.outputShape=[],this.outputShape=e,this.depth=e[3],this.depthRadius=t,this.bias=s,this.alpha=r,this.beta=o,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int r = coords[1];
        int c = coords[2];

        float result = 0.0;
        for (int d = 0; d < ${this.depth}; ++d) {
          int depthBegin = int(max(0.0, float(d - ${t})));
          int depthEnd = int(min(float(${this.depth}),
              float(d + ${t} + 1)));

          const int MIN_DEPTH_BEGIN = 0;
          const int MAX_DEPTH_END = ${this.depth};

          float norm = 0.0;
          for (int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k) {
            if (k < depthBegin){
              continue;
            }
            else if (k >= depthBegin && k < depthEnd) {
              norm += getInputImage(b, r, c, k) * getInputImage(b, r, c, k);
            }
            else {
              break;
            }
          }

          norm = float(${r}) * norm + float(${s});

          for(int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k){
            if (k < depthBegin){
              continue;
            }
            else if (k >= depthBegin && k < depthEnd){
              float dyi = -2.0 * float(${r})
                * float(${o})
                * getInputImage(b, r, c, k) * getOutputImage(b, r, c, d)
                / norm;
              if (k == d) {
                dyi += pow(norm, -1.0 * ${o});
              }
              if (k == coords[3]) {
                dyi *= getDy(b, r, c, d);
                result += dyi;
              }
            }
            else {
              break;
            }
          }
      }
      setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const eue=n=>{const{inputs:e,backend:t,attrs:s}=n,{x:r,y:o,dy:i}=e,{depthRadius:a,bias:l,alpha:u,beta:h}=s,p=new Jle(r.shape,a,l,u,h);return t.runWebGLProgram(p,[r,o,i],r.dtype)},tue={kernelName:Qw,backendName:"webgl",kernelFunc:eue};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nue(n,e,t,s){const r=fe(e),i=fe(n.shape)/r,a=Te({inputs:{x:n},attrs:{shape:[i,r]},backend:s}),l=Xa(a,n.dtype,"max",s),u=Te({inputs:{x:l},attrs:{shape:t},backend:s});return s.disposeIntermediateTensorInfo(a),s.disposeIntermediateTensorInfo(l),u}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zF(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{reductionIndices:o,keepDims:i}=s,a=r.shape.length,l=it(o,r.shape);let u=l;const h=zt(u,a),p=h!=null,f=t.shouldExecuteOnCPU([r]);let m=r;if(p){if(f){const k=t.texData.get(m.dataId).values,T=new Array(a);for(let D=0;D<T.length;D++)T[D]=r.shape[h[D]];const I=SS(k,r.shape,r.dtype,h,T);m=t.makeTensorInfo(T,r.dtype);const E=t.texData.get(m.dataId);E.values=I}else m=ty(r,h,t);u=Jt(u.length,a)}Mn("max",u,a);const[y,x]=In(m.shape,u);let v=y;i&&(v=Zt(y,l));let w;if(f){const k=t.texData.get(m.dataId).values,T=use(k,fe(x),v,r.dtype);w=t.makeTensorInfo(v,r.dtype);const I=t.texData.get(w.dataId);I.values=T}else w=nue(m,x,v,t);return p&&t.disposeIntermediateTensorInfo(m),w}const sue={kernelName:Bm,backendName:"webgl",kernelFunc:zF};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rue=CS+`
  return max(a, b);
`,oue=`
  vec4 result = vec4(max(a, b));
  bvec4 isNaNA = isnan(a);
  bvec4 isNaNB = isnan(b);
  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);
  `+qa+`
  return result;
`,iue=Vn({opSnippet:rue,packedOpSnippet:oue,cpuKernelImpl:cse}),aue={kernelName:$h,backendName:"webgl",kernelFunc:iue};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lue(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e;xd(r,"maxPool");const{filterSize:o,strides:i,pad:a,dimRoundingMode:l}=s,u=1;L(Ln(i,u),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${i} and dilations '${u}'`);const h=yr(r.shape,o,i,u,a,l);if(h.filterWidth===1&&h.filterHeight===1&&ct(h.inShape,h.outShape))return Ps({inputs:{x:r},backend:t});const p=new Gc(h,"max",!1);return t.runWebGLProgram(p,[r],r.dtype)}const uue={kernelName:Wm,backendName:"webgl",kernelFunc:lue};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cue(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{filterSize:o,strides:i,pad:a,dataFormat:l,dimRoundingMode:u}=s,h=[1,1,1],p=Lo(r.shape,o,i,h,a,u,l),f=new TS(p,"max",!1);return t.runWebGLProgram(f,[r],r.dtype)}const hue={kernelName:Um,backendName:"webgl",kernelFunc:cue};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class due{constructor(e){this.variableNames=["dy","maxPos"],this.outputShape=e.inShape;const t=e.strideHeight,s=e.strideWidth,r=e.dilationHeight,o=e.effectiveFilterHeight,i=e.effectiveFilterWidth,a=o-1-e.padInfo.top,l=i-1-e.padInfo.left,u=o*i-1;this.userCode=`
      const ivec2 pads = ivec2(${a}, ${l});

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];

        ivec2 dyRCCorner = coords.yz - pads;
        int dyRCorner = dyRCCorner.x;
        int dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${o};
          wR += ${r}) {
          float dyR = float(dyRCorner + wR) / ${t}.0;

          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          for (int wC = 0; wC < ${i}; wC++) {
            float dyC = float(dyCCorner + wC) / ${s}.0;

            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            float dyValue = getDy(b, idyR, idyC, d);
            int maxPosValue = ${u} - int(getMaxPos(b, idyR, idyC, d));

            // Get the current value, check it against the value from the
            // position matrix.
            int curPosValue = wR * ${i} + wC;
            float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);

            dotProd += dyValue * mask;
          }
        }
        setOutput(dotProd);
      }
    `}}class pue{constructor(e){this.variableNames=["dy","maxPos"],this.outputShape=e.inShape;const t=e.strideDepth,s=e.strideHeight,r=e.strideWidth,o=e.dilationDepth,i=e.dilationHeight,a=e.dilationWidth,l=e.effectiveFilterDepth,u=e.effectiveFilterHeight,h=e.effectiveFilterWidth,p=l-1-e.padInfo.front,f=u-1-e.padInfo.top,m=h-1-e.padInfo.left,y=l*u*h-1;this.userCode=`
      const ivec3 pads = ivec3(${p}, ${f}, ${m});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyDCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, ch) with pos mask(:, :, :, d) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int wD = 0; wD < ${l};
           wD += ${o}) {
          float dyD = float(dyDCorner + wD) / ${t}.0;

          if (dyD < 0.0 || dyD >= ${e.outDepth}.0 || fract(dyD) > 0.0) {
            continue;
          }
          int idyD = int(dyD);

          for (int wR = 0; wR < ${u};
              wR += ${i}) {
            float dyR = float(dyRCorner + wR) / ${s}.0;

            if (dyR < 0.0 || dyR >= ${e.outHeight}.0 ||
                fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            for (int wC = 0; wC < ${h};
                wC += ${a}) {
              float dyC = float(dyCCorner + wC) / ${r}.0;

              if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              float dyValue = getDy(batch, idyD, idyR, idyC, ch);
              int maxPosValue = ${y} -
                  int(getMaxPos(batch, idyD, idyR, idyC, ch));

              // Get the current value, check it against the value from the
              // position matrix.
              int curPosValue =
                  wD * ${u} * ${h} +
                  wR * ${h} + wC;
              float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);

              dotProd += dyValue * mask;
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fue(n){const{inputs:e,backend:t,attrs:s}=n,{dy:r,input:o}=e,i=o,{filterSize:a,strides:l,pad:u,dimRoundingMode:h}=s,p=[1,1,1],f=Lo(i.shape,a,l,p,u,h),m=new TS(f,"max",!0),y=t.runWebGLProgram(m,[i],i.dtype),x=new pue(f),v=t.runWebGLProgram(x,[r,y],i.dtype);return t.disposeIntermediateTensorInfo(y),v}const mue={kernelName:Jw,backendName:"webgl",kernelFunc:fue};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gue(n){const{inputs:e,backend:t,attrs:s}=n,{dy:r,input:o,output:i}=e,a=o;xd([o,i],"maxPoolGrad");const{filterSize:l,strides:u,pad:h,dimRoundingMode:p}=s,f=yr(a.shape,l,u,1,h,p),m=!0,y=new Gc(f,"max",m),x=t.runWebGLProgram(y,[a],a.dtype),v=new due(f),w=t.runWebGLProgram(v,[r,x],a.dtype);return t.disposeIntermediateTensorInfo(x),w}const yue={kernelName:Zw,backendName:"webgl",kernelFunc:gue};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xue(n,e,t,s){let r=new Gc(t,"max",!1);const o=s.runWebGLProgram(r,[n],"float32");r=new Gc(t,"max",!0,!0,e);const i=s.runWebGLProgram(r,[n],"float32");return[o,i]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vue={kernelName:e1,backendName:"webgl",kernelFunc:({inputs:n,attrs:e,backend:t})=>{const{x:s}=n,{filterSize:r,strides:o,pad:i,includeBatchInIndex:a}=e,l=t;L(s.shape.length===4,()=>`Error in maxPool: input must be rank 4 but got rank ${s.shape.length}.`);const u=[1,1];L(Ln(o,u),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${o} and dilations '${u}'`);const h=yr(s.shape,r,o,u,i),[p,f]=xue(s,a,h,l);return[p,f]}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wue(n,e,t,s){const r=fe(e),i=fe(n.shape)/r,a=Te({inputs:{x:n},attrs:{shape:[i,r]},backend:s}),l=Xa(a,"float32","mean",s),u=Te({inputs:{x:l},attrs:{shape:t},backend:s});return s.disposeIntermediateTensorInfo(a),s.disposeIntermediateTensorInfo(l),u}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bue={kernelName:Gm,backendName:"webgl",kernelFunc:({inputs:n,attrs:e,backend:t})=>{const{x:s}=n,{keepDims:r,axis:o}=e,i=t,a=s.shape.length,l=it(o,s.shape);let u=l;const h=zt(u,a),p=h!=null,f=i.shouldExecuteOnCPU([s]),m=[];let y=s;if(p){if(f){const T=i.texData.get(y.dataId).values,I=new Array(a);for(let O=0;O<I.length;O++)I[O]=s.shape[h[O]];const E=SS(T,s.shape,s.dtype,h,I);y=i.makeTensorInfo(I,s.dtype);const D=i.texData.get(y.dataId);D.values=E}else y=ty(s,h,i);m.push(y),u=Jt(u.length,a)}Mn("sum",u,a);const[x,v]=In(y.shape,u);let w=x;r&&(w=Zt(x,l));const S=wue(y,v,w,i);for(const k of m)i.disposeIntermediateTensorInfo(k);return S}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Sue(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{axis:o,keepDims:i}=s,a=r.shape.length,l=it(o,r.shape);let u=l;const h=zt(u,a);let p=r;h!=null&&(p=rs({inputs:{x:r},backend:t,attrs:{perm:h}}),u=Jt(u.length,r.shape.length)),Mn("min",u,a);const[f,m]=In(p.shape,u),y=fe(m),x=Te({inputs:{x:p},backend:t,attrs:{shape:[-1,y]}}),v=Xa(x,x.dtype,"min",t);let w;if(i){const S=Zt(f,l);w=Te({inputs:{x:v},backend:t,attrs:{shape:S}})}else w=Te({inputs:{x:v},backend:t,attrs:{shape:f}});return t.disposeIntermediateTensorInfo(x),t.disposeIntermediateTensorInfo(v),h!=null&&t.disposeIntermediateTensorInfo(p),w}const Cue={kernelName:jm,backendName:"webgl",kernelFunc:Sue};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kue=CS+`
  return min(a, b);
`,Tue=`
  vec4 result = vec4(min(a, b));
  bvec4 isNaNA = isnan(a);
  bvec4 isNaNB = isnan(b);
  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);
  `+qa+`
  return result;
`,Nue=Vn({opSnippet:kue,packedOpSnippet:Tue,cpuKernelImpl:hse}),Iue={kernelName:Eh,backendName:"webgl",kernelFunc:Nue};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class $ue{constructor(e,t,s){this.variableNames=["x"],this.outputShape=t.map((h,p)=>h[0]+e[p]+h[1]);const r=e.length,o=St(r),i=t.map(h=>h[0]).join(","),a=t.map((h,p)=>h[0]+e[p]).join(","),l=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,r),u=s==="reflect"?0:1;if(r===1){this.userCode=`
        int start = ${i};
        int end = ${a};

        void main() {
          int outC = getOutputCoords();
          if (outC < start) {
            outC = start * 2 - outC - ${u};
          } else if(outC >= end) {
            outC = (end - 1) * 2 - outC + ${u};
          }
          setOutput(getX(outC - start));
        }
      `;return}this.userCode=`
      ${o} start = ${o}(${i});
      ${o} end = ${o}(${a});

      void main() {
        ${o} outC = getOutputCoords();
        for (int i = 0; i < ${r}; i++) {
          if (outC[i] < start[i]) {
            outC[i] = start[i] * 2 - outC[i] - ${u};
          } else if(outC[i] >= end[i]) {
            outC[i] = (end[i] - 1) * 2 - outC[i] + ${u};
          }
        }
        ${o} coords = outC - start;
        setOutput(getX(${l}));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Eue{constructor(e,t,s){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t.map((y,x)=>y[0]+e[x]+y[1]);const r=e.length,o=St(r),i=t.map(y=>y[0]).join(","),a=t.map((y,x)=>y[0]+e[x]).join(","),l=ns("rc",r),u=ns("source",r),h=`${l[r-1]} < ${this.outputShape[r-1]}`,p=r===1?"source":`vec2(${u.slice(-2).join()})`,f=s==="reflect"?0:1;let m="";if(r===1){const y=`
        ${o} source = rc;
        if (source < start) {
          source = start * 2 - source - ${f};
        } else if (source >= end) {
          source = (end - 1) * 2 - source + ${f};
        }
        source -= start;
      `;m=`
        ${o} rc = outputLoc;
        ${y}
        result[0] = getChannel(getX(${u.join()}), ${p});
        ${l[r-1]} += 1;
        if(${h}) {
          ${y}
          result[1] = getChannel(getX(${u.join()}), ${p});
        }
      `}else{const y=`
        ${o} source = rc;
        ${o} lt = ${o}(lessThan(source, start));
        ${o} gte = ${o}(greaterThanEqual(source, end));
        ${o} orig = 1 - (lt + gte);
        source = orig * source +
                lt * (start * 2 - source - ${f}) +
                gte * ((end - 1) * 2 - source + ${f});
        source -= start;
      `;m=`
        ${o} rc = outputLoc;
        ${y}
        result[0] = getChannel(getX(${u.join()}), ${p});
        ${l[r-1]} += 1;
        if(${h}) {
          ${y}
          result[1] = getChannel(getX(${u.join()}), ${p});
        }
        rc = outputLoc;
        ${l[r-2]} += 1;
        if(${l[r-2]} < ${this.outputShape[r-2]}) {
          ${y}
          result[2] = getChannel(getX(${u.join()}), ${p});
          ${l[r-1]} += 1;
          if(${h}) {
            ${y}
            result[3] = getChannel(getX(${u.join()}), ${p});
          }
        }
      `}this.userCode=`
      const ${o} start = ${o}(${i});
      const ${o} end = ${o}(${a});

      void main() {
        ${o} outputLoc = getOutputCoords();
        vec4 result = vec4(0.);
        ${m}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Rue=({inputs:n,backend:e,attrs:t})=>{const{x:s}=n,{paddings:r,mode:o}=t,i=ae().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new Eue(s.shape,r,o):new $ue(s.shape,r,o);return e.runWebGLProgram(i,[s],s.dtype)},Due={kernelName:Hm,backendName:"webgl",kernelFunc:Rue};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Aue=`if (b == 0.0) return NAN;
  return mod(a, b);`,Oue=`
  vec4 result = mod(a, b);
  bvec4 isNaN = equal(b, vec4(0.0));
  `+qa+`
  return result;
`,_ue=Vn({opSnippet:Aue,packedOpSnippet:Oue}),Fue={kernelName:Rh,backendName:"webgl",kernelFunc:_ue};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Pue{constructor(e,t,s){this.variableNames=["probs"],this.customUniforms=[{name:"seed",type:"float"}],this.outputShape=[e,s],this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];

        float r = random(seed);
        float cdf = 0.0;

        for (int i = 0; i < ${t-1}; i++) {
          cdf += getProbs(batch, i);

          if (r < cdf) {
            setOutput(float(i));
            return;
          }
        }

        // If no other event happened, last event happened.
        setOutput(float(${t-1}));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Lue=`
if (a == b) {
  return 1.0;
};
return a / b;`,Mue=`
  // vec4 one = vec4(equal(a, b));
  // return one + (vec4(1.0) - one) * a / b;
  vec4 result = a / b;
  if(a.x == b.x) {
    result.x = 1.;
  }
  if(a.y == b.y) {
    result.y = 1.;
  }
  if(a.z == b.z) {
    result.z = 1.;
  }
  if(a.w == b.w) {
    result.w = 1.;
  }

  return result;
`,VF=Vn({opSnippet:Lue,packedOpSnippet:Mue,checkOutOfBounds:!0}),zue={kernelName:fh,backendName:"webgl",kernelFunc:VF};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const XI="return a - b;",BF=Vn({opSnippet:XI,packedOpSnippet:XI,supportsComplex:!0,cpuKernelImpl:Ase}),Vue={kernelName:Hh,backendName:"webgl",kernelFunc:BF};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function WF(n){const{inputs:e,backend:t,attrs:s}=n,{logits:r}=e,{dim:o}=s,i=it([o],r.shape),a=zF({inputs:{x:r},backend:t,attrs:{reductionIndices:i,keepDims:!1}}),l=Zt(a.shape,i),u=Te({inputs:{x:a},backend:t,attrs:{shape:l}}),h=BF({inputs:{a:r,b:u},backend:t}),p=PF({inputs:{x:h},backend:t}),f=ny({inputs:{x:p},backend:t,attrs:{axis:i,keepDims:!1}}),m=Te({inputs:{x:f},backend:t,attrs:{shape:l}}),y=VF({inputs:{a:p,b:m},backend:t});return t.disposeIntermediateTensorInfo(a),t.disposeIntermediateTensorInfo(u),t.disposeIntermediateTensorInfo(h),t.disposeIntermediateTensorInfo(p),t.disposeIntermediateTensorInfo(f),t.disposeIntermediateTensorInfo(m),y}const Bue={kernelName:cg,backendName:"webgl",kernelFunc:WF};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Wue(n){const{inputs:e,backend:t,attrs:s}=n,{logits:r}=e,{numSamples:o,seed:i,normalized:a}=s,l=a?r:WF({inputs:{logits:r},backend:t,attrs:{dim:r.shape.length-1}}),u=l.shape[0],h=l.shape[1],p=new Pue(u,h,o),f=[[i]],m=t.runWebGLProgram(p,[l],"int32",f);return a||t.disposeIntermediateTensorInfo(l),m}const Uue={kernelName:t1,backendName:"webgl",kernelFunc:Wue};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Gue=vr+`
  return -x;
`,jue=`
  vec4 result = -x;
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`;function Hue(n){const{inputs:e,backend:t}=n,{x:s}=e;if(t.shouldExecuteOnCPU([s])){const o=t.texData.get(s.dataId),[i,a]=pse(o.values,s.shape,s.dtype);return t.makeTensorInfo(a,s.dtype,i)}let r;return ae().getBool("WEBGL_PACK_UNARY_OPERATIONS")?r=new di(s.shape,jue):r=new Jr(s.shape,Gue),t.runWebGLProgram(r,[s],s.dtype)}const Kue={kernelName:Km,backendName:"webgl",kernelFunc:Hue};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const que=pb;function Xue(n){Us("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:e,backend:t,attrs:s}=n,{boxes:r,scores:o}=e,{maxOutputSize:i,iouThreshold:a,scoreThreshold:l}=s,u=t.readSync(r.dataId),h=t.readSync(o.dataId),{selectedIndices:p}=que(u,h,i,a,l);return t.makeTensorInfo([p.length],"int32",new Int32Array(p))}const Yue={kernelName:n1,backendName:"webgl",kernelFunc:Xue};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Que=fb;function Zue(n){Us("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:e,backend:t,attrs:s}=n,{boxes:r,scores:o}=e,{maxOutputSize:i,iouThreshold:a,scoreThreshold:l,padToMaxOutputSize:u}=s,h=t.readSync(r.dataId),p=t.readSync(o.dataId),{selectedIndices:f,validOutputs:m}=Que(h,p,i,a,l,u);return[t.makeTensorInfo([f.length],"int32",new Int32Array(f)),t.makeTensorInfo([],"int32",new Int32Array([m]))]}const Jue={kernelName:s1,backendName:"webgl",kernelFunc:Zue};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ece=mb;function tce(n){Us("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:e,backend:t,attrs:s}=n,{boxes:r,scores:o}=e,{maxOutputSize:i,iouThreshold:a,scoreThreshold:l,softNmsSigma:u}=s,h=t.readSync(r.dataId),p=t.readSync(o.dataId),f=i,m=a,y=l,x=u,{selectedIndices:v,selectedScores:w}=ece(h,p,f,m,y,x);return[t.makeTensorInfo([v.length],"int32",new Int32Array(v)),t.makeTensorInfo([w.length],"float32",new Float32Array(w))]}const nce={kernelName:r1,backendName:"webgl",kernelFunc:tce};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class sce{constructor(e,t,s,r){this.variableNames=["indices"],this.outputShape=[e,t],this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int index = round(getIndices(coords.x));
        setOutput(mix(float(${r}), float(${s}),
                      float(index == coords.y)));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rce=n=>{const{inputs:e,backend:t,attrs:s}=n,{indices:r}=e,{dtype:o,depth:i,onValue:a,offValue:l}=s,u=fe(r.shape),h=new sce(u,i,a,l),p=Te({inputs:{x:r},backend:t,attrs:{shape:[u]}}),f=t.runWebGLProgram(h,[p],o);t.disposeIntermediateTensorInfo(p);const m=[...r.shape,i],y=Te({inputs:{x:f},backend:t,attrs:{shape:m}});return t.disposeIntermediateTensorInfo(f),y},oce={kernelName:Ym,backendName:"webgl",kernelFunc:rce};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zf(n){const{inputs:e,backend:t}=n,{x:s}=e;if(s.dtype==="complex64"){const r=wd({inputs:{input:s},backend:t}),o=Zf({inputs:{x:r},backend:t}),i=sy({inputs:{input:s},backend:t}),a=Zf({inputs:{x:i},backend:t}),l=Gi({inputs:{real:o,imag:a},backend:t});return t.disposeIntermediateTensorInfo(r),t.disposeIntermediateTensorInfo(o),t.disposeIntermediateTensorInfo(i),t.disposeIntermediateTensorInfo(a),l}else return bd({attrs:{shape:s.shape,dtype:s.dtype,value:s.dtype==="string"?"":0},backend:t})}const ice={kernelName:fg,backendName:"webgl",kernelFunc:Zf};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function UF(n){const{inputs:e,backend:t}=n,{x:s}=e;if(s.dtype==="string")throw new Error("onesLike is not supported under string dtype");if(s.dtype==="complex64"){const r=wd({inputs:{input:s},backend:t}),o=UF({inputs:{x:r},backend:t}),i=sy({inputs:{input:s},backend:t}),a=Zf({inputs:{x:i},backend:t}),l=Gi({inputs:{real:o,imag:a},backend:t});return t.disposeIntermediateTensorInfo(r),t.disposeIntermediateTensorInfo(o),t.disposeIntermediateTensorInfo(i),t.disposeIntermediateTensorInfo(a),l}else return bd({attrs:{shape:s.shape,dtype:s.dtype,value:1},backend:t})}const ace={kernelName:Xm,backendName:"webgl",kernelFunc:UF};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lce(n){const{inputs:e,backend:t,attrs:s}=n,{axis:r}=s;if(e.length===1)return Gv({inputs:{input:e[0]},backend:t,attrs:{dim:r}});const o=e[0].shape,i=e[0].dtype;e.forEach(h=>{Ls(o,h.shape,"All tensors passed to stack must have matching shapes"),L(i===h.dtype,()=>"All tensors passed to stack must have matching dtypes")});const a=[],l=e.map(h=>{const p=Gv({inputs:{input:h},backend:t,attrs:{dim:r}});return a.push(p),p}),u=$F({inputs:l,backend:t,attrs:{axis:r}});return a.forEach(h=>t.disposeIntermediateTensorInfo(h)),u}const uce={kernelName:Qm,backendName:"webgl",kernelFunc:lce};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class cce{constructor(e,t,s){this.variableNames=["x"],this.customUniforms=[{name:"value",type:"float"}],this.outputShape=t.map((u,h)=>u[0]+e[h]+u[1]);const r=e.length,o=St(r),i=t.map(u=>u[0]).join(","),a=t.map((u,h)=>u[0]+e[h]).join(","),l=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,r);if(r===1){this.userCode=`
        int start = ${i};
        int end = ${a};

        void main() {
          int outC = getOutputCoords();
          if (outC < start || outC >= end) {
            setOutput(value);
          } else {
            setOutput(getX(outC - start));
          }
        }
      `;return}this.userCode=`
      ${o} start = ${o}(${i});
      ${o} end = ${o}(${a});

      void main() {
        ${o} outC = getOutputCoords();
        if (any(lessThan(outC, start)) || any(greaterThanEqual(outC, end))) {
          setOutput(value);
        } else {
          ${o} coords = outC - start;
          setOutput(getX(${l}));
        }
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class hce{constructor(e,t,s){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"value",type:"float"}],this.outputShape=t.map((x,v)=>x[0]+e[v]+x[1]);const r=e.length,o=St(r),i=t.map(x=>x[0]).join(","),a=t.map((x,v)=>x[0]+e[v]).join(","),l=ns("rc",r),u=ns("source",r),h=`${l[r-1]} < ${this.outputShape[r-1]}`,p=r===1?"source":`vec2(${u.slice(-2).join()})`,f=[`${o} rc = outputLoc;`,`${l[r-1]} += 1;
       if(${h}) {
      `,r===1?"":`}
       rc = outputLoc;
       ${l[r-2]} += 1;
       if(${l[r-2]} < ${this.outputShape[r-2]}) {`,r===1?"":`  ${l[r-1]} += 1;
         if(${h}) {`],m=r===1?"rc < start || rc >= end":"any(lessThan(rc, start)) || any(greaterThanEqual(rc, end))";let y="";for(let x=0,v=r===1?2:4;x<v;x++)y+=`
        ${f[x]}
        if (${m}) {
          result[${x}] = float(value);
        } else {
          ${o} source = rc - start;
          result[${x}] = getChannel(getX(${u.join()}), ${p});
        }
      `;y+=r===1?"} ":"}}",this.userCode=`
      const ${o} start = ${o}(${i});
      const ${o} end = ${o}(${a});

      void main() {
        ${o} outputLoc = getOutputCoords();
        vec4 result = vec4(0.);
        ${y}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const GF=n=>{const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{paddings:o,constantValue:i}=s;if(fe(r.shape)===0){const u=o.map((h,p)=>h[0]+r.shape[p]+h[1]);return bd({backend:t,attrs:{shape:u,value:i,dtype:r.dtype}})}const a=ae().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new hce(r.shape,o,i):new cce(r.shape,o,i),l=[[i]];return t.runWebGLProgram(a,[r],r.dtype,l)},dce={kernelName:Zm,backendName:"webgl",kernelFunc:GF};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pce=`
  if(a < 0.0 && floor(b) < b){
    return NAN;
  }
  if (b == 0.0) {
    return 1.0;
  }
  return (round(mod(b, 2.0)) != 1) ?
      pow(abs(a), b) : sign(a) * pow(abs(a), b);
`,fce=`
  // isModRound1 has 1 for components with round(mod(b, 2.0)) == 1, 0 otherwise.
  vec4 isModRound1 = vec4(equal(round(mod(b, 2.0)), ivec4(1)));
  vec4 multiplier = sign(a) * isModRound1 + (vec4(1.0) - isModRound1);
  vec4 result = multiplier * pow(abs(a), b);

  // Ensure that a^0 = 1, including 0^0 = 1 as this correspond to TF and JS
  bvec4 isExpZero = equal(b, vec4(0.0));
  result.r = isExpZero.r ? 1.0 : result.r;
  result.g = isExpZero.g ? 1.0 : result.g;
  result.b = isExpZero.b ? 1.0 : result.b;
  result.a = isExpZero.a ? 1.0 : result.a;

  bvec4 isNaN1 = lessThan(a, vec4(0.0));
  bvec4 isNaN2 = lessThan(floor(b), b);
  bvec4 isNaN = bvec4(isNaN1.x && isNaN2.x, isNaN1.y && isNaN2.y, isNaN1.z && isNaN2.z, isNaN1.w && isNaN2.w);
  `+qa+`
  return result;
`,mce=Vn({opSnippet:pce,packedOpSnippet:fce}),gce={kernelName:Ah,backendName:"webgl",kernelFunc:mce};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yce(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{axis:o,keepDims:i}=s,a=r.shape.length,l=[],u=it(o,r.shape);let h=u;const p=zt(h,a);let f=r;p!=null&&(f=rs({inputs:{x:r},backend:t,attrs:{perm:p}}),h=Jt(h.length,a),l.push(f)),Mn("prod",h,a);let m;if(t.shouldExecuteOnCPU([f])){const y=t.texData.get(f.dataId).values,{outVals:x,outShape:v,outDtype:w}=mse(f.shape,f.dtype,y,h);m=t.makeTensorInfo(v,w,x)}else{const[y,x]=In(f.shape,h),v=fe(x),w=Te({inputs:{x:f},backend:t,attrs:{shape:[-1,v]}}),S=E1(r.dtype),k=Xa(w,S,"prod",t);m=Te({inputs:{x:k},backend:t,attrs:{shape:y}}),l.push(w),l.push(k)}if(i){l.push(m);const y=Zt(m.shape,u);m=Te({inputs:{x:m},backend:t,attrs:{shape:y}})}return l.forEach(y=>t.disposeIntermediateTensorInfo(y)),m}const xce={kernelName:eg,backendName:"webgl",kernelFunc:yce};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vce(n){const{inputs:e,backend:t,attrs:s}=n,{paramsNestedSplits:r,paramsDenseValues:o,indices:i}=e,{outputRaggedRank:a}=s,l=r.map(w=>t.readSync(w.dataId)),u=r.map(w=>w.shape),h=t.readSync(o.dataId),p=t.readSync(i.dataId),[f,m,y]=gse(l,u,h,o.shape,o.dtype,p,i.shape,a),x=f.map(w=>t.makeTensorInfo([w.length],"int32",w)),v=t.makeTensorInfo(y,o.dtype,m);return x.concat([v])}const wce={kernelName:o1,backendName:"webgl",kernelFunc:vce};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bce(n){const{inputs:e,backend:t}=n,{starts:s,limits:r,deltas:o}=e,i=t.readSync(s.dataId),a=t.readSync(r.dataId),l=t.readSync(o.dataId),[u,h]=yse(i,s.shape,s.dtype,a,r.shape,l,o.shape),p=t.makeTensorInfo([u.length],"int32",u),f=t.makeTensorInfo([h.length],s.dtype,h);return[p,f]}const Sce={kernelName:i1,backendName:"webgl",kernelFunc:bce};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Cce(n){const{inputs:e,backend:t,attrs:s}=n,{shape:r,values:o,defaultValue:i,rowPartitionTensors:a}=e,{rowPartitionTypes:l}=s,u=t.readSync(r.dataId),h=t.readSync(o.dataId),p=t.readSync(i.dataId),f=a.map(v=>t.readSync(v.dataId)),m=a.map(v=>v.shape),[y,x]=xse(u,r.shape,h,o.shape,o.dtype,p,i.shape,f,m,l);return t.makeTensorInfo(y,o.dtype,x)}const kce={kernelName:a1,backendName:"webgl",kernelFunc:Cce};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jF=n=>{const{backend:e,attrs:t}=n,{start:s,stop:r,step:o,dtype:i}=t,a=vse(s,r,o,i);return e.makeTensorInfo([a.length],i,a)},Tce={kernelName:l1,backendName:"webgl",kernelFunc:jF};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Nce="return 1.0 / x;",Ice=pt({opSnippet:Nce}),$ce={kernelName:Oh,backendName:"webgl",kernelFunc:Ice};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ece=vr+`
  return (x < 0.0) ? 0.0 : x;
`,Rce=`
  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,Dce=pt({opSnippet:Ece,packedOpSnippet:Rce}),Ace={kernelName:_h,backendName:"webgl",kernelFunc:Dce};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Oce=vr+`
  return (x < 0.0) ? 0.0 : min(6.0, x);
`,_ce=`
  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,Fce=pt({opSnippet:Oce,packedOpSnippet:_ce}),Pce={kernelName:Fh,backendName:"webgl",kernelFunc:Fce};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Lce{constructor(e,t,s,r,o){this.variableNames=["A"],this.outputShape=[];const[i,a,l,u]=e;this.outputShape=[i,t,s,u];const h=[r&&t>1?a-1:a,r&&s>1?l-1:l],p=[r&&t>1?t-1:t,r&&s>1?s-1:s];let f;o?f="(vec2(yRC) + vec2(0.5)) * effectiveInputOverOutputRatioRC - vec2(0.5)":f="vec2(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec2 effectiveInputOverOutputRatioRC = vec2(
          ${h[0]/p[0]},
          ${h[1]/p[1]});
      const vec2 inputShapeRC = vec2(${a}.0, ${l}.0);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        ivec2 yRC = coords.yz;

        // Fractional source index.
        vec2 sourceFracIndexRC = ${f};

        // Compute the four integer indices.
        ivec2 sourceFloorRC = ivec2(max(sourceFracIndexRC, vec2(0.0)));
        ivec2 sourceCeilRC = ivec2(
          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));

        float topLeft = getA(b, sourceFloorRC.x, sourceFloorRC.y, d);
        float bottomLeft = getA(b, sourceCeilRC.x, sourceFloorRC.y, d);
        float topRight = getA(b, sourceFloorRC.x, sourceCeilRC.y, d);
        float bottomRight = getA(b, sourceCeilRC.x, sourceCeilRC.y, d);

        vec2 fracRC = sourceFracIndexRC - vec2(sourceFloorRC);

        float top = topLeft + (topRight - topLeft) * fracRC.y;
        float bottom = bottomLeft + (bottomRight - bottomLeft) * fracRC.y;
        float newValue = top + (bottom - top) * fracRC.x;

        setOutput(newValue);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Mce{constructor(e,t,s,r,o){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];const[i,a,l,u]=e;this.outputShape=[i,t,s,u];const h=[r&&t>1?a-1:a,r&&s>1?l-1:l],p=[r&&t>1?t-1:t,r&&s>1?s-1:s];let f;o?f="(vec3(yRC) + vec3(0.5)) * effectiveInputOverOutputRatioRC - vec3(0.5)":f="vec3(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec3 effectiveInputOverOutputRatioRC = vec3(
          ${h[0]/p[0]},
          ${h[1]/p[1]},
          ${h[1]/p[1]});
      const vec3 inputShapeRC = vec3(${a}.0, ${l}.0,
                                     ${l}.0);

      float getAValue(int b, int r, int c, int d) {
        return getChannel(getA(b, r, c, d), vec2(c, d));
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        // Calculate values for next column in yRC.z.
        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);

        // Fractional source index.
        vec3 sourceFracIndexRC = ${f};

        // Compute the four integer indices.
        ivec3 sourceFloorRC = ivec3(max(sourceFracIndexRC, vec3(0.0)));
        ivec3 sourceCeilRC = ivec3(
          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));

        // Should we calculate next column and row elements in 2x2 packed cell.
        bool hasNextCol = d < ${u-1};
        bool hasNextRow = coords.z < ${s-1};

        // In parallel, construct four corners for all four components in
        // packed 2x2 cell.
        vec4 topLeft = vec4(
          getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d),
          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d + 1) : 0.0);

        vec4 bottomLeft = vec4(
          getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d),
          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d + 1) : 0.0);

        vec4 topRight = vec4(
          getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d),
          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d + 1) : 0.0);

        vec4 bottomRight = vec4(
          getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d),
          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d + 1) : 0.0);

        vec3 fracRC = sourceFracIndexRC - vec3(sourceFloorRC);

        vec4 top = mix(topLeft, topRight, fracRC.yyzz);
        vec4 bottom = mix(bottomLeft, bottomRight, fracRC.yyzz);
        vec4 newValue = mix(top, bottom, fracRC.x);

        setOutput(newValue);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zce(n){const{inputs:e,backend:t,attrs:s}=n,{images:r}=e,{alignCorners:o,halfPixelCenters:i,size:a}=s,[l,u]=a,h=ae().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new Mce(r.shape,l,u,o,i):new Lce(r.shape,l,u,o,i);return t.runWebGLProgram(h,[r],"float32")}const Vce={kernelName:sg,backendName:"webgl",kernelFunc:zce};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Bce{constructor(e,t,s){this.variableNames=["dy"],this.outputShape=[],this.outputShape=t;const[,r,o]=t,[,i,a]=e,l=[s&&i>1?r-1:r,s&&a>1?o-1:o],u=[s&&i>1?i-1:i,s&&a>1?a-1:a],h=l[0]/u[0],p=l[1]/u[1],f=1/h,m=1/p,y=Math.ceil(f)*2+2,x=Math.ceil(m)*2+2;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        int r = coords[1];
        int c = coords[2];

        float accumulator = 0.0;

        const float heightScale = float(${h});
        const float widthScale = float(${p});

        const float invHeightScale = float(${f});
        const float invWidthScale = float(${m});

        const int winHeight = int(${y});
        const int winWidth = int(${x});

        // Compute bounds for where in dy we will look
        float startRLerp = floor(float(r) * invHeightScale);
        int startDyR = int(startRLerp - float(winHeight / 2));

        float startCLerp = floor(float(c) * invWidthScale);
        int startDyC = int(startCLerp - float(winWidth / 2));

        // Loop over dy
        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {
          int dyR = dyROffset + startDyR;

          // Guard against the window exceeding the bounds of dy
          if (dyR < 0 || dyR >= ${i}) {
            continue;
          }

          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {
            int dyC = dyCOffset + startDyC;

            // Guard against the window exceeding the bounds of dy
            if (dyC < 0 || dyC >= ${a}) {
              continue;
            }

            float dxR = float(dyR) * heightScale;
            int topDxRIndex = int(floor(dxR));
            int bottomDxRIndex = int(min(ceil(dxR), ${r-1}.0));
            float dxRLerp = dxR - float(topDxRIndex);
            float inverseDxRLerp = 1.0 - dxRLerp;

            float dxC = float(dyC) * widthScale;
            int leftDxCIndex = int(floor(dxC));
            int rightDxCIndex = int(min(ceil(dxC), ${o-1}.0));
            float dxCLerp = dxC - float(leftDxCIndex);
            float inverseDxCLerp = 1.0 - dxCLerp;

            if (r == topDxRIndex && c == leftDxCIndex) {
              // topLeft
              accumulator +=
                getDy(b, dyR, dyC, d) * inverseDxRLerp * inverseDxCLerp;
            }

            if (r == topDxRIndex && c == rightDxCIndex) {
              // topRight
              accumulator += getDy(b, dyR, dyC, d) * inverseDxRLerp * dxCLerp;
            }

            if (r == bottomDxRIndex && c == leftDxCIndex) {
              // bottomLeft
              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * inverseDxCLerp;
            }

            if (r == bottomDxRIndex && c == rightDxCIndex) {
              // bottomRight
              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * dxCLerp;
            }
          }
        }
        // End loop over dy

        setOutput(accumulator);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Wce(n){const{inputs:e,backend:t,attrs:s}=n,{images:r,dy:o}=e,{alignCorners:i}=s,a=new Bce(o.shape,r.shape,i);return t.runWebGLProgram(a,[o],o.dtype)}const Uce={kernelName:h1,backendName:"webgl",kernelFunc:Wce};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Gce{constructor(e,t,s,r,o){this.variableNames=["A"],this.outputShape=[];const[i,a,l,u]=e;this.outputShape=[i,t,s,u];const h=[r&&t>1?a-1:a,r&&s>1?l-1:l],p=[r&&t>1?t-1:t,r&&s>1?s-1:s],f=r?"0.5":"0.0";let m;o?m="max((vec2(yRC) + vec2(0.5)) * effectiveInputOverOutputRatioRC, vec2(0.0))":m="vec2(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec2 effectiveInputOverOutputRatioRC = vec2(
          ${h[0]/p[0]},
          ${h[1]/p[1]});
      const vec2 inputShapeRC = vec2(${a}.0, ${l}.0);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        ivec2 yRC = coords.yz;

        // Fractional source index.
        vec2 sourceFracIndexRC = ${m};

        // Compute the coordinators of nearest neighbor point.
        ivec2 sourceNearestRC = ivec2(
          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + ${f})));
        float newValue = getA(b, sourceNearestRC.x, sourceNearestRC.y, d);

        setOutput(newValue);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class jce{constructor(e,t,s,r,o){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];const[i,a,l,u]=e;this.outputShape=[i,t,s,u];const h=[r&&t>1?a-1:a,r&&s>1?l-1:l],p=[r&&t>1?t-1:t,r&&s>1?s-1:s],f=r?"0.5":"0.0";let m;o?m="max((vec3(yRC) + vec3(0.5)) * effectiveInputOverOutputRatioRC, vec3(0.0))":m="vec3(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec3 effectiveInputOverOutputRatioRC = vec3(
          ${h[0]/p[0]},
          ${h[1]/p[1]},
          ${h[1]/p[1]});
      const vec3 inputShapeRC = vec3(${a}.0, ${l}.0,
                                     ${l}.0);

      float getAValue(int b, int r, int c, int d) {
        return getChannel(getA(b, r, c, d), vec2(c, d));
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        // Calculate values for next column in yRC.z.
        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);

        // Fractional source index.
        vec3 sourceFracIndexRC = ${m};

        // Compute the coordinators of nearest neighbor point.
        ivec3 sourceNearestRC = ivec3(
          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + ${f})));

        // Should we calculate next column and row elements in 2x2 packed cell.
        bool hasNextCol = d < ${u-1};
        bool hasNextRow = coords.z < ${s-1};

        vec4 newValue = vec4(
          getAValue(b, sourceNearestRC.x, sourceNearestRC.y, d),
          hasNextCol ? getAValue(b, sourceNearestRC.x, sourceNearestRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceNearestRC.x, sourceNearestRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceNearestRC.x, sourceNearestRC.z, d + 1) : 0.0);

        setOutput(newValue);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hce(n){const{inputs:e,backend:t,attrs:s}=n,{images:r}=e,{alignCorners:o,halfPixelCenters:i,size:a}=s,[l,u]=a,h=ae().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new jce(r.shape,l,u,o,i):new Gce(r.shape,l,u,o,i);return t.runWebGLProgram(h,[r],r.dtype)}const Kce={kernelName:ng,backendName:"webgl",kernelFunc:Hce};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class qce{constructor(e,t,s){this.variableNames=["dy"],this.outputShape=[],this.outputShape=t;const[,r,o]=t,[,i,a]=e,l=[s&&i>1?r-1:r,s&&a>1?o-1:o],u=[s&&i>1?i-1:i,s&&a>1?a-1:a],h=l[0]/u[0],p=l[1]/u[1],f=1/h,m=1/p,y=Math.ceil(f)*2+2,x=Math.ceil(m)*2+2;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        int r = coords[1];
        int c = coords[2];

        float accumulator = 0.0;

        const float heightScale = float(${h});
        const float widthScale = float(${p});

        const float invHeightScale = float(${f});
        const float invWidthScale = float(${m});

        const int winHeight = int(${y});
        const int winWidth = int(${x});

        // Compute bounds for where in dy we will look
        float startRLerp = floor(float(r) * invHeightScale);
        int startDyR = int(floor(startRLerp - float(winHeight / 2)));

        float startCLerp = floor(float(c) * invWidthScale);
        int startDyC = int(floor(startCLerp - float(winWidth / 2)));

        // Loop over dy
        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {
          int dyR = dyROffset + startDyR;

          // Guard against the window exceeding the bounds of dy
          if (dyR < 0 || dyR >= ${i}) {
            continue;
          }

          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {
            int dyC = dyCOffset + startDyC;

            // Guard against the window exceeding the bounds of dy
            if (dyC < 0 || dyC >= ${a}) {
              continue;
            }

            float sourceFracRow =
              float(${l[0]}) *
                (float(dyR) / float(${u[0]}));

            float sourceFracCol =
                float(${l[1]}) *
                  (float(dyC) / float(${u[1]}));

            int sourceNearestRow = int(min(
                float(int(${r}) - 1),
                ${s} ? float(round(sourceFracRow)) :
                                  float(floor(sourceFracRow))));

            int sourceNearestCol = int(min(
                float(int(${o}) - 1),
                ${s} ? float(round(sourceFracCol)) :
                                  float(floor(sourceFracCol))));

            if (r == sourceNearestRow && c == sourceNearestCol) {
              accumulator += getDy(b, dyR, dyC, d);
            }
          }
        }
        // End loop over dy

        setOutput(accumulator);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xce(n){const{inputs:e,backend:t,attrs:s}=n,{images:r,dy:o}=e,{alignCorners:i}=s,a=new qce(o.shape,r.shape,i);return t.runWebGLProgram(a,[o],o.dtype)}const Yce={kernelName:c1,backendName:"webgl",kernelFunc:Xce};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Qce{constructor(e,t){this.variableNames=["x"];const s=e.length;if(s>4)throw new Error(`WebGL backend: Reverse of rank-${s} tensor is not yet supported`);if(this.outputShape=e,s===1){this.userCode=`
        void main() {
          int coord = getOutputCoords();
          setOutput(getX(${e[0]} - coord - 1));
        }
      `;return}const r=a=>t.indexOf(a)!==-1&&e[a]!==1?`${e[a]} - coords[${a}] - 1`:`coords[${a}]`,o=e.map((a,l)=>r(l)).join(","),i=St(s);this.userCode=`
      void main() {
        ${i} coords = getOutputCoords();
        setOutput(getX(${o}));
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Zce{constructor(e,t){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0;const s=e.length;if(s>4)throw new Error(`WebGL backend: Reverse of rank-${s} tensor is not yet supported`);this.outputShape=e;const r=ns("rc",s),o=`${r[s-1]} + 1 < ${this.outputShape[s-1]}`,i=`${r[s-2]} + 1 < ${this.outputShape[s-2]}`,a=St(s);s===1?this.userCode=`
        void main(){
          int rc = getOutputCoords();
          vec4 result = vec4(0.);
          result.r = getChannel(getX(${e[0]} - rc - 1),
            ${e[0]} - rc - 1);
          if(${o}){
              result.g = getChannel(getX(${e[0]} - (rc  + 1) - 1),
                ${e[0]} - (rc  + 1) - 1);
          }
          setOutput(result);
        }
      `:this.userCode=`
        void main() {
          ${a} rc = getOutputCoords();
          vec4 result = vec4(0.);
          result.r = ${l(r.slice())};
          if(${o}){
            result.g = ${u(r.slice())};
          }
          if(${i}) {
            result.b = ${h(r.slice())};
            if(${o}) {
              result.a = ${p(r.slice())};
            }
          }
          setOutput(result);
        }
    `;function l(y){return f(y)}function u(y){return y[s-1]="("+y[s-1]+" + 1)",f(y)}function h(y){return y[s-2]="("+y[s-2]+" + 1)",f(y)}function p(y){return y[s-1]="("+y[s-1]+" + 1)",y[s-2]="("+y[s-2]+" + 1)",f(y)}function f(y){const x=e.map((S,k)=>m(k,y)),v=x.join(","),w=x.slice(-2).join(",");return`getChannel(getX(${v}), vec2(${w}))`}function m(y,x){return t.indexOf(y)!==-1&&e[y]!==1?`${e[y]} - ${x[y]} - 1`:`${x[y]}`}}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jce(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{dims:o}=s,i=r.shape.length,a=it(o,r.shape);if(i===0)return Ps({inputs:{x:r},backend:t});const l=ae().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new Zce(r.shape,a):new Qce(r.shape,a);return t.runWebGLProgram(l,[r],r.dtype)}const ehe={kernelName:rg,backendName:"webgl",kernelFunc:Jce};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class the{constructor(e,t){this.variableNames=["Image"],this.outputShape=[],this.customUniforms=[{name:"params",type:"vec4"}];const s=e[1],r=e[2];this.outputShape=e;let o="";typeof t=="number"?o=`float outputValue = ${t.toFixed(2)};`:o=`
        vec3 fill = vec3(${t.join(",")});
        float outputValue = fill[coords[3]];`,this.userCode=`
        void main() {
          ivec4 coords = getOutputCoords();
          int x = coords[2];
          int y = coords[1];
          float coordXFloat = (float(x) - params[0]) * params[3] -
            (float(y) - params[1]) * params[2];
          float coordYFloat = (float(x) - params[0]) * params[2] +
            (float(y) - params[1]) * params[3];
          int coordX = int(round(coordXFloat + params[0]));
          int coordY = int(round(coordYFloat + params[1]));
          ${o}
          if(coordX >= 0 && coordX < ${r} && coordY >= 0 && coordY < ${s}) {
            outputValue = getImage(coords[0], coordY, coordX, coords[3]);
          }
          setOutput(outputValue);
        }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nhe={kernelName:$1,backendName:"webgl",kernelFunc:({inputs:n,attrs:e,backend:t})=>{const{image:s}=n,{radians:r,fillValue:o,center:i}=e,a=t,l=new the(s.shape,o),[u,h]=kb(i,s.shape[1],s.shape[2]),p=[[u,h,Math.sin(r),Math.cos(r)]];return a.runWebGLProgram(l,[s],s.dtype,p)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const she=`
  // OpenGL ES does not support round function.
  // The algorithm is based on banker's rounding.
  float base = floor(x);
  if ((x - base) < 0.5) {
    return floor(x);
  } else if ((x - base) > 0.5) {
    return ceil(x);
  } else {
    if (mod(base, 2.0) == 0.0) {
      return base;
    } else {
      return base + 1.0;
    }
  }
`,rhe=pt({opSnippet:she}),ohe={kernelName:Ph,backendName:"webgl",kernelFunc:rhe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ihe="return inversesqrt(x);",ahe=pt({opSnippet:ihe,cpuKernelImpl:wse}),lhe={kernelName:Lh,backendName:"webgl",kernelFunc:ahe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class NS{constructor(e,t,s,r,o,i,a=!0,l=!1){this.variableNames=["updates","indices","defaultValue"],this.outputShape=i;const u=St(o.length),h=St(i.length);let p="";s===1?p="i":s===2&&(p="i, j");const f=`getIndices(${p})`;let m="";r===1?m="i":r===2&&(m="i, coords[1]");const y=`getUpdates(${m})`;let x="";l&&(x="coords[0], coords[1]");const v=`getDefaultValue(${x})`,w=t>1?"strides[j]":"strides";this.userCode=`
        ${u} strides = ${u}(${o});

        void main() {
          ${h} coords = getOutputCoords();
          float sum = 0.0;
          bool found = false;
          for (int i = 0; i < ${e}; i++) {
            int flattenedIndex = 0;
            for (int j = 0; j < ${t}; j++) {
              int index = round(${f});
              flattenedIndex += index * ${w};
            }
            if (flattenedIndex == coords[0]) {
              sum += ${y};
              found = true;
            }
          }
          setOutput(mix(${v}, sum, float(found)));
        }
      `}}/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class uhe{constructor(e,t,s,r,o,i,a=!0,l=!1){this.variableNames=["updates","indices","defaultValue"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=i;const u=St(o.length),h=St(i.length);let p="";s===1?p="i":s===2&&(p="i, j");const f=`getIndices(${p})`;let m="";r===1?m="i":r===2&&(m="i, coords[1]");const y=`getUpdates(${m})`;let x="";l&&(x="coords[0], coords[1]");const v=`getDefaultValue(${x})`,w=t>1?"strides[j]":"strides",S=t>1?"strides[j + 1]":"strides";this.userCode=`
        ${u} strides = ${u}(${o});

        void main() {
          ${h} coords = getOutputCoords();
          vec4 sum = vec4(0.);
          vec4 found = vec4(0.);
          for (int i = 0; i < ${e}; i+=2) {
            ivec2 flattenedIndex = ivec2(0);
            for (int j = 0; j < ${t}; j+=2) {
              ivec4 index = round(${f});
              flattenedIndex += index.xz * ${w};
              if (j + 1 < ${t}) {
                flattenedIndex += index.yw * ${S};
              }
            }
            if (flattenedIndex[0] == coords[0] || flattenedIndex[1] == coords[0] ||
                flattenedIndex[0] == coords[0] + 1 || flattenedIndex[1] == coords[0] + 1) {
              vec4 updVals = ${y};
              if (flattenedIndex[0] == coords[0]) {
                sum.xy += updVals.xy;
                found.xy = vec2(1.);
              } else if (flattenedIndex[0] == coords[0] + 1) {
                sum.zw += updVals.xy;
                found.zw = vec2(1.);
              }
              if (flattenedIndex[1] == coords[0]) {
                sum.xy += updVals.zw;
                found.xy = vec2(1.);
              } else if (flattenedIndex[1] == coords[0] + 1) {
                sum.zw += updVals.zw;
                found.zw = vec2(1.);
              }
            }
          }
          setOutput(mix(${v}, sum, found));
        }
      `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function che(n){const{inputs:e,backend:t,attrs:s}=n,{indices:r,updates:o}=e,{shape:i}=s,{sliceRank:a,numUpdates:l,sliceSize:u,strides:h,outputSize:p}=Ua(o,r,i),f=[p/u,u];if(p===0)return t.makeTensorInfo(i,r.dtype);const m=Te({inputs:{x:r},backend:t,attrs:{shape:[l,a]}}),y=Te({inputs:{x:o},backend:t,attrs:{shape:[l,u]}}),x=t.makeTensorInfo([],"float32",new Float32Array([0]));let v;ae().getBool("WEBGL_PACK")?v=new uhe(l,a,m.shape.length,y.shape.length,h,f):v=new NS(l,a,m.shape.length,y.shape.length,h,f);const w=t.runWebGLProgram(v,[y,m,x],y.dtype),S=Te({inputs:{x:w},backend:t,attrs:{shape:i}});return t.disposeIntermediateTensorInfo(m),t.disposeIntermediateTensorInfo(y),t.disposeIntermediateTensorInfo(w),t.disposeIntermediateTensorInfo(x),S}const hhe={kernelName:d1,backendName:"webgl",kernelFunc:che};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class dhe{constructor(e,t,s,r){this.variableNames=["sortedSequence","values"],this.customUniforms=[{name:"numInputs",type:"int"}],this.outputShape=[e,s];const o="while (left < right) {",i=`for (int i = 0; i < ${Math.ceil(Math.log2(t+1))}; ++i) { if (left >= right) break;`,a=ae().getNumber("WEBGL_VERSION")===2?o:i,l=r==="left"?"<":"<=";this.userCode=`
       int findBound(int batch, float value) {
         int left = 0;
         int right = numInputs;
         int mid;
         ${a}
           mid = (left + right) / 2;
           if (getSortedSequence(batch, mid) ${l} value) {
             left = mid + 1;
           } else {
             right = mid;
           }
         }
         return right;
       }

       void main() {
         ivec2 coords = getOutputCoords();
         int batch = coords[0];
         int valueIndex = coords[1];

         float value = getValues(batch, valueIndex);

         setOutput(float(findBound(batch, value)));
       }
     `}}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function phe(n){const{inputs:e,backend:t,attrs:s}=n,{sortedSequence:r,values:o}=e,{side:i}=s,a=new dhe(r.shape[0],r.shape[1],o.shape[1],i),l=[[r.shape[1]]];return t.runWebGLProgram(a,[r,o],"int32",l)}const fhe={kernelName:f1,backendName:"webgl",kernelFunc:phe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class mhe{constructor(e,t,s){this.variableNames=["c","a","b"],this.outputShape=t;let r,o;if(s>4)throw Error(`Where for rank ${s} is not yet supported`);if(s===1)o="resRC",r="resRC";else{const a=["resRC.x","resRC.y","resRC.z","resRC.w"],l=[],u=[];for(let h=0;h<t.length;h++)u.push(`${a[h]}`),h<e&&l.push(`${a[h]}`);r=l.join(),o=u.join()}const i=St(s);this.userCode=`
      void main() {
        ${i} resRC = getOutputCoords();
        float cVal = getC(${r});
        if (cVal >= 1.0) {
          setOutput(getA(${o}));
        } else {
          setOutput(getB(${o}));
        }
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ghe(n){const{inputs:e,backend:t}=n,{condition:s,t:r,e:o}=e,i=new mhe(s.shape.length,r.shape,r.shape.length);return t.runWebGLProgram(i,[s,r,o],Ds(r.dtype,o.dtype))}const yhe={kernelName:og,backendName:"webgl",kernelFunc:ghe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xhe=`
  // Stable and Attracting Fixed Point (0, 1) for Normalized Weights.
  // see: https://arxiv.org/abs/1706.02515
  float scaleAlpha = ${zg};
  float scale = ${Vg};
  return (x >= 0.0) ? scale * x : scaleAlpha * (exp(x) - 1.0);
`,vhe=pt({opSnippet:xhe}),whe={kernelName:Mh,backendName:"webgl",kernelFunc:vhe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bhe=Cu+`
  return 1.0 / (1.0 + exp(-1.0 * x));
`,She=`
  vec4 result = 1.0 / (1.0 + exp(-1.0 * x));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,Che=pt({opSnippet:bhe,packedOpSnippet:She,cpuKernelImpl:Sse}),khe={kernelName:Wh,backendName:"webgl",kernelFunc:Che};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const The=`
  if (isnan(x)) { return 0.0; }
  return sign(x);
`,Nhe=pt({opSnippet:The}),Ihe={kernelName:Bh,backendName:"webgl",kernelFunc:Nhe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $he=Cu+`
  return sin(x);
`,Ehe=`
  vec4 result = sin(x);
  bvec4 isNaN = isnan(x);
  ${qa}
  return result;
`,Rhe=pt({opSnippet:$he,packedOpSnippet:Ehe}),Dhe={kernelName:zh,backendName:"webgl",kernelFunc:Rhe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ahe=`
  float e2x = exp(x);
  return (e2x - 1.0 / e2x) / 2.0;
`,Ohe=pt({opSnippet:Ahe}),_he={kernelName:Vh,backendName:"webgl",kernelFunc:Ohe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Fhe=`
  float epsilon = 1.1920928955078125e-7;
  float threshold = log(epsilon) + 2.0;

  bool too_large = x > -threshold;
  bool too_small = x < threshold;

  float result;
  float exp_x = exp(x);

  if (too_large){
    result = x;
  }
  else if (too_small){
    result = exp_x;
  }
  else{
    result = log(exp_x + 1.0);
  }
  return result;
`,Phe=pt({opSnippet:Fhe}),Lhe={kernelName:Uh,backendName:"webgl",kernelFunc:Phe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Mhe=n=>{const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{blockShape:o,paddings:i}=s;L(r.shape.length<=4,()=>"spaceToBatchND for rank > 4 with a WebGL backend not implemented yet");const a=o.reduce((w,S)=>w*S),l=[[0,0]];l.push(...i);for(let w=1+o.length;w<r.shape.length;++w)l.push([0,0]);const u=[],h=GF({inputs:{x:r},backend:t,attrs:{paddings:l,constantValue:0}}),p=od(h.shape,o,a,!1),f=id(p.length,o.length,!1),m=ad(h.shape,o,a,!1),y=Te({inputs:{x:h},backend:t,attrs:{shape:p}}),x=rs({inputs:{x:y},backend:t,attrs:{perm:f}}),v=Te({inputs:{x},backend:t,attrs:{shape:m}});return u.push(h),u.push(y),u.push(x),u.forEach(w=>t.disposeIntermediateTensorInfo(w)),v},zhe={kernelName:lg,backendName:"webgl",kernelFunc:Mhe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vhe(n){const{inputs:e,backend:t}=n,{indices:s,values:r,denseShape:o,defaultValue:i}=e;if(o.shape.length!==1)throw new Error(`Dense shape must be a vector, saw:
         ${o.shape}`);if(s.shape.length!==2)throw new Error(`Indices must be a matrix, saw:
         ${s.shape}`);if(r.shape.length!==1)throw new Error(`Values must be a vector, saw:
         ${r.shape}`);if(i.shape.length!==0)throw new Error(`Default value must be a scalar, saw:
        ${i.shape}`);const a=t.readSync(s.dataId),l=t.readSync(r.dataId),u=t.readSync(o.dataId),h=t.readSync(i.dataId)[0],[p,f,m,y,x]=kse(a,s.shape,s.dtype,l,r.dtype,u,h);return[t.makeTensorInfo(f,s.dtype,p),t.makeTensorInfo([f[0]],r.dtype,m),t.makeTensorInfo([y.length],"bool",new Uint8Array(y.map(v=>Number(v)))),t.makeTensorInfo([x.length],s.dtype,new Int32Array(x))]}const Bhe={kernelName:m1,backendName:"webgl",kernelFunc:Vhe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Whe(n){const{inputs:e,backend:t}=n,{inputIndices:s,inputShape:r,newShape:o}=e;if(s.shape.length!==2)throw new Error(`Input indices should be a matrix but received shape ${s.shape}`);if(r.shape.length!==1)throw new Error(`Input shape should be a vector but received shape ${r.shape}`);if(o.shape.length!==1)throw new Error(`Target shape should be a vector but received shape ${o.shape}`);const i=Array.from(t.readSync(r.dataId)),a=t.readSync(s.dataId),l=Array.from(t.readSync(o.dataId)),[u,h,p]=Tse(a,s.shape,s.dtype,i,l);return[t.makeTensorInfo(h,s.dtype,u),t.makeTensorInfo([p.length],o.dtype,new Int32Array(p))]}const Uhe={kernelName:g1,backendName:"webgl",kernelFunc:Whe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ghe(n){const{inputs:e,backend:t}=n,{data:s,indices:r,segmentIds:o}=e;if(s.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(r.shape.length!==1)throw new Error(`Indices should be a vector but received shape
              ${r.shape}`);if(o.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
              ${o.shape}`);const i=t.readSync(s.dataId),a=t.readSync(r.dataId),l=t.readSync(o.dataId),[u,h]=mF(i,s.shape,s.dtype,a,l,!0);return t.makeTensorInfo(h,s.dtype,u)}const jhe={kernelName:y1,backendName:"webgl",kernelFunc:Ghe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hhe(n){const{inputs:e,backend:t}=n,{data:s,indices:r,segmentIds:o}=e;if(s.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(r.shape.length!==1)throw new Error(`Indices should be a vector but received shape
             ${r.shape}`);if(o.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
             ${o.shape}`);const i=t.readSync(s.dataId),a=t.readSync(r.dataId),l=t.readSync(o.dataId),[u,h]=mF(i,s.shape,s.dtype,a,l);return t.makeTensorInfo(h,s.dtype,u)}const Khe={kernelName:x1,backendName:"webgl",kernelFunc:Hhe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qhe(n){const{inputs:e,backend:t,attrs:s}=n,{sparseIndices:r,sparseValues:o,defaultValue:i}=e,{outputShape:a}=s,{sliceRank:l,numUpdates:u,sliceSize:h,strides:p,outputSize:f}=Ua(o,r,a),m=!1;if(o.dtype==="string"){const w=t.bufferSync(r),S=t.bufferSync(o),k=vi(t.readSync(i.dataId)[0]),T=bse(w,S,a,f,h,u,l,p,k,m);return t.makeTensorInfo(a,T.dtype,T.values)}const y=new NS(u,l,r.shape.length,o.shape.length,p,[f,1],m),x=t.runWebGLProgram(y,[o,r,i],o.dtype),v=Te({inputs:{x},backend:t,attrs:{shape:a}});return t.disposeIntermediateTensorInfo(x),v}const Xhe={kernelName:v1,backendName:"webgl",kernelFunc:qhe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Yhe(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{numOrSizeSplits:o,axis:i}=s,a=it(i,r.shape)[0],l=zb(r,o,a),u=r.shape.length,h=new Array(u).fill(0),p=r.shape.slice();return l.map(f=>{const m=[...p];m[a]=f;const y=ku({inputs:{x:r},backend:t,attrs:{begin:h,size:m}});return h[a]+=f,y})}const Qhe={kernelName:ug,backendName:"webgl",kernelFunc:Yhe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const YI="return sqrt(x);",Zhe=pt({opSnippet:YI,packedOpSnippet:YI,cpuKernelImpl:Nse}),Jhe={kernelName:Gh,backendName:"webgl",kernelFunc:Zhe};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ede="return x * x;",tde=pt({opSnippet:ede}),nde={kernelName:w1,backendName:"webgl",kernelFunc:tde};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const QI="return (a - b) * (a - b);",sde=Vn({opSnippet:QI,packedOpSnippet:QI}),rde={kernelName:jh,backendName:"webgl",kernelFunc:sde};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ode(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e;if(r.dtype!=="string")throw new Error("Input must be of datatype string");const o=t.readSync(r.dataId),i=_o(o),a=Ise(i,"string",s);return t.makeTensorInfo(r.shape,"string",a)}const ide={kernelName:hg,backendName:"webgl",kernelFunc:ode};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ade({inputs:n,attrs:e,backend:t}){const{x:s}=n,r=vr+`
    return x > 0.0 ? 1.0 : float(${e.alpha});
  `,o=new Jr(s.shape,r);return t.runWebGLProgram(o,[s],s.dtype)}const lde={kernelName:Yh,backendName:"webgl",kernelFunc:ade};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ude{constructor(e,t,s){this.variableNames=["x"],this.outputShape=s;const r=s.length,o=St(s.length),i=St(s.length);let a="";if(r===1)a="coords * strides + begin";else{let l=0;a=s.map((u,h)=>(l++,s.length===1?`coords * strides[${h}] + begin[${h}]`:`coords[${l-1}] * strides[${h}] + begin[${h}]`)).join(",")}this.userCode=`
      ${o} begin = ${o}(${e});
      ${o} strides = ${o}(${t});

      void main() {
        ${i} coords = getOutputCoords();
        setOutput(getX(${a}));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cde(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{begin:o,end:i,strides:a,beginMask:l,endMask:u,ellipsisMask:h,newAxisMask:p,shrinkAxisMask:f}=s,{finalShapeSparse:m,finalShape:y,isIdentity:x,sliceDim0:v,isSimpleSlice:w,begin:S,end:k,strides:T}=eD(r.shape,o,i,a,l,u,h,p,f);let I;if(x)I=Te({inputs:{x:r},backend:t,attrs:{shape:y}});else if(v||w){L(r.shape.length>=1,()=>`Input must have rank at least 1, got: ${r.shape.length}`);const D=QR(S,k,T),O=ku({inputs:{x:r},backend:t,attrs:{begin:S,size:D}});I=Te({inputs:{x:O},backend:t,attrs:{shape:y}}),t.disposeIntermediateTensorInfo(O)}else if(t.shouldExecuteOnCPU([r])){const O=t.readSync(r.dataId),_=nt(r.shape,r.dtype,O),P=$se(m,_,T,S);I=t.makeTensorInfo(y,r.dtype,P.values)}else{const O=new ude(S,T,m);I=t.runWebGLProgram(O,[r],r.dtype)}const E=Te({inputs:{x:I},backend:t,attrs:{shape:y}});return t.disposeIntermediateTensorInfo(I),E}const hde={kernelName:b1,backendName:"webgl",kernelFunc:cde};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dde(n){const{inputs:e,backend:t,attrs:s}=n,{separator:r,nGramWidths:o,leftPad:i,rightPad:a,padWidth:l,preserveShortSequences:u}=s,{data:h,dataSplits:p}=e,f=t.readSync(h.dataId),m=t.readSync(p.dataId),[y,x]=Ese(f,m,r,o,i,a,l,u);return[t.makeTensorInfo([y.length],"string",y),t.makeTensorInfo(p.shape,"int32",x)]}const pde={kernelName:S1,backendName:"webgl",kernelFunc:dde};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fde(n){const{inputs:e,backend:t,attrs:s}=n,{skipEmpty:r}=s,{input:o,delimiter:i}=e;if(o.dtype!=="string")throw new Error("Input must be of datatype string");if(o.shape.length!==1)throw new Error(`Input must be a vector, got shape: ${o.shape}`);if(i.shape.length!==0)throw new Error(`Delimiter must be a scalar, got shape: ${i.shape}`);const a=t.readSync(o.dataId),l=t.readSync(i.dataId)[0],[u,h,p]=Rse(a,l,r),f=h.length;return[t.makeTensorInfo([f,2],"int32",u),t.makeTensorInfo([f],"string",h),t.makeTensorInfo([2],"int32",new Int32Array(p))]}const mde={kernelName:C1,backendName:"webgl",kernelFunc:fde};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gde(n){const{inputs:e,backend:t,attrs:s}=n,{numBuckets:r}=s,{input:o}=e;if(o.dtype!=="string")throw new Error("Input must be of datatype string");if(r<=0)throw new Error("Number of buckets must be at least 1");const i=t.readSync(o.dataId),a=Dse(i,r);return t.makeTensorInfo(o.shape,"int32",a)}const yde={kernelName:k1,backendName:"webgl",kernelFunc:gde};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xde="return tan(x);",vde=pt({opSnippet:xde}),wde={kernelName:Kh,backendName:"webgl",kernelFunc:vde};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bde=`
  float e2x = exp(-2.0 * abs(x));
  return sign(x) * (1.0 - e2x) / (1.0 + e2x);
`,Sde=pt({opSnippet:bde}),Cde={kernelName:qh,backendName:"webgl",kernelFunc:Sde};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kde(n){const{inputs:e,backend:t,attrs:s}=n,{tensor:r,indices:o,updates:i}=e,{sliceRank:a,numUpdates:l,sliceSize:u,strides:h,outputSize:p}=Ua(i,o,r.shape),f=[p/u,u];if(p===0)return t.makeTensorInfo(r.shape,o.dtype);const m=Te({inputs:{x:o},backend:t,attrs:{shape:[l,a]}}),y=Te({inputs:{x:i},backend:t,attrs:{shape:[l,u]}}),x=Te({inputs:{x:r},backend:t,attrs:{shape:f}}),v=new NS(l,a,m.shape.length,y.shape.length,h,f,!1,!0),w=t.runWebGLProgram(v,[y,m,x],x.dtype),S=Te({inputs:{x:w},backend:t,attrs:{shape:r.shape}});return t.disposeIntermediateTensorInfo(m),t.disposeIntermediateTensorInfo(y),t.disposeIntermediateTensorInfo(x),t.disposeIntermediateTensorInfo(w),S}const Tde={kernelName:p1,backendName:"webgl",kernelFunc:kde};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Nde{constructor(e,t){this.variableNames=["A"];const s=new Array(e.length);for(let i=0;i<s.length;i++)s[i]=e[i]*t[i];this.outputShape=s,this.rank=s.length;const r=St(this.rank),o=Ide(e);this.userCode=`
      void main() {
        ${r} resRC = getOutputCoords();
        setOutput(getA(${o}));
      }
    `}}function Ide(n){const e=n.length;if(e>5)throw Error(`Tile for rank ${e} is not yet supported`);if(e===1)return`imod(resRC, ${n[0]})`;const t=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u"],s=[];for(let r=0;r<n.length;r++)s.push(`imod(${t[r]}, ${n[r]})`);return s.join()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function HF(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{reps:o}=s;if(r.dtype==="string"||r.shape.length>5){const l=t.readSync(r.dataId),u=r.dtype==="string"?l.map(f=>vi(f)):l,h=nt(r.shape,r.dtype,u),p=Ose(h,o);return t.makeTensorInfo(p.shape,p.dtype,p.values)}const i=new Nde(r.shape,o);return t.runWebGLProgram(i,[r],r.dtype)}const $de={kernelName:Xh,backendName:"webgl",kernelFunc:HF};class Ede{constructor(e){this.variableNames=["x","indices"],this.customUniforms=[{name:"n",type:"int"},{name:"firstPass",type:"int"},{name:"negativeInf",type:"float"},{name:"dir",type:"int"},{name:"inc",type:"int"}],this.outputShape=e,this.userCode=`
       void main() {
         ivec2 coords = getOutputCoords();
         int batch = coords[0];
         int elemIdx = coords[1];

         // We compare elements pair-wise within a group of size 2 * inc.
         // The comparing rule for each group alternates between ascending
         // and descending. Within each group, we compare each pair at
         // positions i and i+inc. To decide whether an element at position i
         // is x0 or x1, we mod it by 2 * inc, if the result is smaller than
         // inc, it is in the first half of the group, we denote it as x0,
         // otherwise we denote it as x1.
         // For example, as shown in the Bitonic top K paper referenced above,
         // Figure5(a) shows that element[1] is in the
         // second half of the group when group size is 2, but it is in the
         // first half of the group when group size is 4.

         bool isFirstInPair = imod(elemIdx, 2 * inc) < inc;
         int i = isFirstInPair ? elemIdx : elemIdx - inc;

         int i0 = firstPass == 1 ? i : int(getIndices(batch, i));
         int i1 = firstPass == 1 ? i + inc : int(getIndices(batch, i + inc));
         float x0 = i0 < n ? getX(batch, i0) : negativeInf;
         float x1 = i1 < n ? getX(batch, i1) : negativeInf;

         // Denotes which direction indices are in (ascending or descending).
         bool reverse = imod(elemIdx, 2 * dir) >= dir;
         bool isGreater = x0 > x1 || (x0 == x1 && i1 > i0);
         if (reverse == isGreater) { // Elements in opposite order of direction
           int iTemp = i0;
           i0 = i1;
           i1 = iTemp;
         }
         if (isFirstInPair) {
            setOutput(float(i0));
         } else {
            setOutput(float(i1));
         }
       }
     `}}class Rde{constructor(e){this.variableNames=["x","indices"],this.customUniforms=[{name:"n",type:"int"},{name:"firstPass",type:"int"},{name:"k",type:"int"}],this.outputShape=e,this.userCode=`
    void main() {
         // Takes max of indices (0, k), (1, k + 1), (2, k + 2) ...
         ivec2 coords = getOutputCoords();
         int batch = coords[0];
         int elemIdx = coords[1];

         // The output size is half of the previous size.
         // If the previous sequence is | | | | _ _ _ _  | | | |  _ _ _ _ (k=4),
         // we only need to output the indices at positions |, the indices at
         // positions _ can be thrown away, see Figure5(b) After Phase 2
         // (Merge phase) in the Bitonic Top K paper referenced above.
         // For example, the paper shows we only need to output the orange bars.
         // The output sequence should look like this | | | | | | | |.
         // Because the sequence is halved, to map the output index back
         // to the previous sequence to find the corresponding value,
         // we need to double the index. When we double the index,
         // we basically interpolate a position, so 2i looks like
         // | _ | _ | _ | _ | _ | _ | _. We move the | to the first k position
         // of each 2k positions by - elemIdx % k. E.g. for output at
         // index 4,5,6,7, we want to get the corresponding element at
         // original index 8,9,10,11, for output at index 8,9,10,11,
         // we want to get the corresponding element at original index
         // 16,17,18,19, so on and so forth.

         int i = elemIdx < k ? elemIdx : (elemIdx * 2 - imod(elemIdx, k));
         int i0 = firstPass == 1 ? i : int(getIndices(batch, i));
         int i1 = firstPass == 1 ? i + k : int(getIndices(batch, i + k));

         float x0 = getX(batch, i0);
         float x1 = i1 < n ? getX(batch, i1) : x0;

         setOutput(x0 >= x1 ? float(i0) : float(i1));
       }
     `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aa(n,e){e!==null&&n.disposeIntermediateTensorInfo(e)}function ZI(n){let e=1;for(;e<n;)e*=2;return e}function Dde(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{k:o,sorted:i}=s,a=ae().getNumber("TOPK_LAST_DIM_CPU_HANDOFF_SIZE_THRESHOLD"),l=ae().getNumber("TOPK_K_CPU_HANDOFF_THRESHOLD"),u=r.shape,h=u[u.length-1];if(t.shouldExecuteOnCPU([r])||h<a||o>l){const P=t.readSync(r.dataId),[R,W]=_se(P,u,r.dtype,o,i);return[t.makeTensorInfo(R.shape,R.dtype,R.values),t.makeTensorInfo(W.shape,W.dtype,W.values)]}if(o===0)return u[u.length-1]=0,[t.makeTensorInfo(u,r.dtype,[]),t.makeTensorInfo(u,"int32",[])];if(h===1)return[r,bd({attrs:{shape:u,dtype:"int32",value:0},backend:t})];const p=t.texData.get(r.dataId),f=p!==null&&p.isPacked,m=f?t.unpackTensor(r):r,x=fe(u)/h,v=Te({inputs:{x:m},attrs:{shape:[x,h]},backend:t});f&&aa(t,m);const w=ZI(o),S=ZI(h);let k=null;const T=()=>k===null?[v,v]:[v,k],I=(P,R,W)=>{const Q=T(),ee=new Ede(W),oe=[[h],[k===null?1:0],[Number.NEGATIVE_INFINITY],[P],[R]],se=k;k=t.runWebGLProgram(ee,Q,"int32",oe),aa(t,se)};for(let P=1;P<w;P*=2){const R=P*2;for(let W=P;W>=1;W/=2)I(R,W,[x,S])}for(let P=S;P>w;P/=2){const R=T(),W=new Rde([x,P/2]),ee=[[h],[k===null?1:0],[w]],te=k;k=t.runWebGLProgram(W,R,"int32",ee),aa(t,te);const oe=w/2,se=oe*2;for(let G=oe;G>=1;G/=2)I(se,G,k.shape)}let E=k;k=ku({inputs:{x:k},backend:t,attrs:{begin:0,size:[x,o]}}),aa(t,E);let D=MF({inputs:{x:v,indices:k},backend:t,attrs:{axis:1,batchDims:1}});aa(t,v);const O=u.slice(0,-1);O.push(o),E=k,k=Te({inputs:{x:k},attrs:{shape:O},backend:t}),aa(t,E);const _=D;return D=Te({inputs:{x:D},attrs:{shape:O},backend:t}),aa(t,_),[D,k]}const Ade={kernelName:T1,backendName:"webgl",kernelFunc:Dde};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Ode{constructor(e,t,s,r,o,i){this.variableNames=["Image","Transforms"],this.outputShape=i;const a=s==="nearest"?1:2;let l;switch(r){case"constant":l=1;break;case"reflect":l=2;break;case"wrap":l=3;break;case"nearest":l=4;break;default:l=1;break}this.userCode=`
            float mapCoord(float outCoord, float len) {
              float inCoord = outCoord;
              if(${l} == 2) {
                if (inCoord < 0.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz2 = 2.0 * len;
                    if (inCoord < sz2) {
                      inCoord = sz2 * float(int(float(-inCoord / sz2))) +
                      inCoord;
                    }
                    inCoord = inCoord < -len ? inCoord + sz2 : -inCoord - 1.0;
                  }
                } else if (inCoord > len - 1.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz2 = 2.0 * len;
                    inCoord -= sz2 * float(int(float(inCoord / sz2)));
                    if (inCoord >= len) {
                      inCoord = sz2 - inCoord - 1.0;
                    }
                  }
                }
                return clamp(inCoord, 0.0, len - 1.0);
              } else if (${l} == 3) {
                if (inCoord < 0.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz = len - 1.0;
                    inCoord += len * (float(int(float(-inCoord / sz))) + 1.0);
                  }
                } else if (inCoord > len - 1.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz = len - 1.0;
                    inCoord -= len * float(int(float(inCoord / sz)));
                  }
                }
                return clamp(inCoord, 0.0, len - 1.0);
              } else if (${l} == 4) {
                return clamp(outCoord, 0.0, len - 1.0);
              } else {
                return outCoord;
              }
            }

            float readWithFillValue(int batch, int coordY, int coordX,
              int channel) {
              float outputValue;
              if (0 <= coordY && coordY < ${e} && 0 <= coordX && coordX < ${t}) {
                  outputValue = getImage(batch, coordY, coordX, channel);
              } else {
                outputValue = float(${o});
              }
              return outputValue;
            }

            void main() {
              ivec4 coords = getOutputCoords();
              float outputValue;
              int batch = coords[0];
              int x = coords[2];
              int y = coords[1];
              int channel = coords[3];
              float xf = float(x);
              float yf = float(y);
              float a1 = getTransforms(batch, 0);
              float a2 = getTransforms(batch, 1);
              float a3 = getTransforms(batch, 2);
              float b1 = getTransforms(batch, 3);
              float b2 = getTransforms(batch, 4);
              float b3 = getTransforms(batch, 5);
              float c1 = getTransforms(batch, 6);
              float c2 = getTransforms(batch, 7);
              float projection = c1 * xf + c2 * yf + 1.0;
              if (projection == 0.0) {
                outputValue = float(${o});
              } else {
                float inX = (a1 * xf + a2 * yf + a3) / projection;
                float inY = (b1 * xf + b2 * yf + b3) / projection;
                float mapX = mapCoord(inX, float(${t}));
                float mapY = mapCoord(inY, float(${e}));

                if (${a} == 1) {
                  int coordY = int(round(mapY));
                  int coordX = int(round(mapX));
                  outputValue = readWithFillValue(batch, coordY, coordX,
                    channel);
                } else {
                  float yFloor = floor(mapY);
                  float xFloor = floor(mapX);
                  float yCeil = yFloor + 1.0;
                  float xCeil = xFloor + 1.0;
                  float valueYFloor = (xCeil - mapX) *
                  readWithFillValue(batch, int(yFloor), int(xFloor), channel) +
                  (mapX - xFloor) *
                  readWithFillValue(batch, int(yFloor), int(xCeil), channel);
                  float valueYCeil = (xCeil - mapX) *
                  readWithFillValue(batch, int(yCeil), int(xFloor), channel) +
                  (mapX - xFloor) *
                  readWithFillValue(batch, int(yCeil), int(xCeil), channel);
                  outputValue = (yCeil - mapY) * valueYFloor +
                  (mapY - yFloor) * valueYCeil;
                }
              }
              setOutput(outputValue);
            }
        `}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _de(n){const{inputs:e,backend:t,attrs:s}=n,{image:r,transforms:o}=e,{interpolation:i,fillMode:a,fillValue:l,outputShape:u}=s,[h,p,f,m]=r.shape,[y,x]=u??[p,f],v=[h,y,x,m],w=new Ode(p,f,i,a,l,v);return t.runWebGLProgram(w,[r,o],"float32")}const Fde={kernelName:N1,backendName:"webgl",kernelFunc:_de};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pde(n){const{inputs:e,attrs:t,backend:s}=n,{axis:r}=t,{x:o}=e;xd(o,"unique"),console.warn("WARNING: ","UI might be locked temporarily as data is being downloaded");const i=s.readSync(o.dataId),{outputValues:a,outputShape:l,indices:u}=Fse(i,r,o.shape,o.dtype);return[s.makeTensorInfo(l,o.dtype,a),s.makeTensorInfo([u.length],"int32",u)]}const Lde={kernelName:I1,backendName:"webgl",kernelFunc:Pde};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mde(n){const{inputs:e,backend:t,attrs:s}=n,{value:r}=e;let{axis:o}=s;o<0&&(o+=r.shape.length);const i=r,a=i.shape.length,l=r.shape[o],u=new Array(a-1);let h=0;for(let x=0;x<a;x++)x!==o&&(u[h++]=i.shape[x]);const p=[],f=new Array(a).fill(0),m=i.shape.slice();m[o]=1;const y=new Array(l);for(let x=0;x<y.length;x++){f[o]=x;const v=ku({inputs:{x:i},backend:t,attrs:{begin:f,size:m}}),w=Te({inputs:{x:v},backend:t,attrs:{shape:u}});y[x]=w,p.push(v)}return p.forEach(x=>t.disposeIntermediateTensorInfo(x)),y}const zde={kernelName:dg,backendName:"webgl",kernelFunc:Mde};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Vde{constructor(e,t){this.variableNames=["x","segmentIds"];const s=e.windowSize,r=e.batchSize,o=e.inSize,i=e.numSegments,a=i*Math.ceil(o/s);this.outputShape=[r,a];const l="0.0",u="sumValue",h=Math.floor(s/4)*4,p=s%4,f=`
        sumValue += dot(values, segFilter);
    `;let m="";o%s>0&&(m=`
        if (inIdx < 0 || inIdx >= ${o}) {
          return initializationValue;
        }
      `);let y="";o%s>0&&(y=`
        if (inIdx < 0 || inIdx >= ${o}) {
          return -1.0;
        }
      `),this.userCode=`
      const float initializationValue = ${l};

      float getValue(int batch, int inIdx) {
        ${m}
        return getX(batch, inIdx);
      }

      float getSegmentIdAtIndex(int inIdx) {
        ${y}
        return getSegmentIds(inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = int(floor(float(outIdx) / float(
          ${i})) * float(${s}));
        int currentSeg = int(mod(float(outIdx), float(${i})));

        float sumValue = 0.0;

        for (int i = 0; i < ${h}; i += 4) {
          int inIdx = inOffset + i;
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 3)) == currentSeg ? 1 : 0
          );

          ${f}
        }

        int inIdx = inOffset + ${h};
        if (${p===1}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            initializationValue,
            initializationValue,
            initializationValue
          );

          int inIdxSeg = int(getSegmentIdAtIndex(inIdx));

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            0,
            0,
            0
          );

          ${f}
        } else if (${p===2}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            initializationValue,
            initializationValue
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
              0,
              0
          );

          ${f}
        } else if (${p===3}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            initializationValue
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,
            0
          );

          ${f}
        }
        setOutput(${u});
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bde(n){const{inputs:e,backend:t,attrs:s}=n,{x:r,segmentIds:o}=e,{numSegments:i}=s,a=r.shape.length,l=[];let u=0;const h=zt([u],a);let p=r;h!=null&&(p=rs({inputs:{x:r},backend:t,attrs:{perm:h}}),l.push(p),u=Jt(1,a)[0]);const f=Z6(p.shape,u,i),m=fe([p.shape[u]]),y=Te({inputs:{x:p},backend:t,attrs:{shape:[-1,m]}});l.push(y);const x=E1(r.dtype),v=(T,I,E,D,O)=>{const _=T.shape[0],P=T.shape[1],R=Q6(P,O),W={windowSize:R,inSize:P,batchSize:_,numSegments:O},Q=new Vde(W,I),ee=t.compileAndRun(Q,[T,E],D);if(l.push(ee),ee.shape[1]===O)return ee;const te=jF({backend:t,attrs:{start:0,stop:O,step:1,dtype:"float32"}}),oe=HF({inputs:{x:te},backend:t,attrs:{reps:[P/R]}});return l.push(te),l.push(oe),v(ee,I,oe,D,O)},w=v(y,"unsortedSegmentSum",o,x,i),S=Te({inputs:{x:w},backend:t,attrs:{shape:f}});let k=S;if(h!=null){l.push(S);const T=Mi(h);k=rs({inputs:{x:k},backend:t,attrs:{perm:T}})}return l.forEach(T=>t.disposeIntermediateTensorInfo(T)),k}const Wde={kernelName:pg,backendName:"webgl",kernelFunc:Bde};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ude=[Nre,$re,Dre,_re,Pre,zre,Bre,Ure,Kre,Xre,Zre,toe,roe,loe,hoe,poe,moe,voe,boe,Coe,Ioe,_oe,Poe,Voe,Woe,qoe,Yoe,eie,ure,sie,lie,die,xie,bie,Cie,Tie,Iie,Die,_ie,Lie,zie,Bie,Uie,Hie,qie,Zie,eae,sae,iae,lae,dae,gae,wae,Cae,Nae,Iae,Eae,Dae,Oae,Fae,Lae,Bae,Gae,Kae,Xae,Zae,tle,ole,ule,lre,hle,iie,fle,yle,wle,hre,kle,$le,Rle,_le,Lle,Ble,Gle,qle,Zle,tue,sue,aue,uue,hue,mue,yue,vue,bue,Cue,Iue,Due,Fue,Uue,fre,Kue,Yue,Jue,nce,Goe,oce,ace,uce,dce,gce,pre,xce,wce,Sce,kce,Tce,joe,zue,$ce,Ace,Pce,gre,Vce,Uce,Kce,Yce,ehe,nhe,ohe,lhe,hhe,fhe,yhe,whe,khe,Ihe,Dhe,_he,Aoe,Bue,Lhe,zhe,Bhe,Uhe,jhe,Khe,Xhe,Qhe,Jhe,nde,rde,ide,lde,hde,pde,mde,yde,Vue,Cre,wde,Cde,Tde,$de,Ade,Fde,kre,Lde,zde,Wde,ice];for(const n of Ude)J2(n);/**
    * @license
    * Copyright 2023 Google LLC. All Rights Reserved.
    * Licensed under the Apache License, Version 2.0 (the "License");
    * you may not use this file except in compliance with the License.
    * You may obtain a copy of the License at
    *
    * http://www.apache.org/licenses/LICENSE-2.0
    *
    * Unless required by applicable law or agreed to in writing, software
    * distributed under the License is distributed on an "AS IS" BASIS,
    * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    * See the License for the specific language governing permissions and
    * limitations under the License.
    * =============================================================================
    */function Ei(n,e,t,s){return new(t||(t=Promise))((function(r,o){function i(u){try{l(s.next(u))}catch(h){o(h)}}function a(u){try{l(s.throw(u))}catch(h){o(h)}}function l(u){var h;u.done?r(u.value):(h=u.value,h instanceof t?h:new t((function(p){p(h)}))).then(i,a)}l((s=s.apply(n,[])).next())}))}function Ri(n,e){var t,s,r,o,i={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function a(l){return function(u){return(function(h){if(t)throw new TypeError("Generator is already executing.");for(;o&&(o=0,h[0]&&(i=0)),i;)try{if(t=1,s&&(r=2&h[0]?s.return:h[0]?s.throw||((r=s.return)&&r.call(s),0):s.next)&&!(r=r.call(s,h[1])).done)return r;switch(s=0,r&&(h=[2&h[0],r.value]),h[0]){case 0:case 1:r=h;break;case 4:return i.label++,{value:h[1],done:!1};case 5:i.label++,s=h[1],h=[0];continue;case 7:h=i.ops.pop(),i.trys.pop();continue;default:if(r=i.trys,!((r=r.length>0&&r[r.length-1])||h[0]!==6&&h[0]!==2)){i=0;continue}if(h[0]===3&&(!r||h[1]>r[0]&&h[1]<r[3])){i.label=h[1];break}if(h[0]===6&&i.label<r[1]){i.label=r[1],r=h;break}if(r&&i.label<r[2]){i.label=r[2],i.ops.push(h);break}r[2]&&i.ops.pop(),i.trys.pop();continue}h=e.call(n,i)}catch(p){h=[6,p],s=0}finally{t=r=0}if(5&h[0])throw h[1];return{value:h[0]?h[1]:void 0,done:!0}})([l,u])}}}function kl(n,e,t){if(t||arguments.length===2)for(var s,r=0,o=e.length;r<o;r++)!s&&r in e||(s||(s=Array.prototype.slice.call(e,0,r)),s[r]=e[r]);return n.concat(s||Array.prototype.slice.call(e))}function IS(n){return[Math.abs(n.endPoint[0]-n.startPoint[0]),Math.abs(n.endPoint[1]-n.startPoint[1])]}function Jf(n){return[n.startPoint[0]+(n.endPoint[0]-n.startPoint[0])/2,n.startPoint[1]+(n.endPoint[1]-n.startPoint[1])/2]}function JI(n,e){e===void 0&&(e=1.5);var t=Jf(n),s=IS(n),r=[e*s[0]/2,e*s[1]/2];return{startPoint:[t[0]-r[0],t[1]-r[1]],endPoint:[t[0]+r[0],t[1]+r[1]],palmLandmarks:n.palmLandmarks}}function e$(n){var e=Jf(n),t=IS(n),s=Math.max.apply(Math,t)/2;return{startPoint:[e[0]-s,e[1]-s],endPoint:[e[0]+s,e[1]+s],palmLandmarks:n.palmLandmarks}}function t$(n,e){var t=[n.endPoint[0]-n.startPoint[0],n.endPoint[1]-n.startPoint[1]],s=[t[0]*e[0],t[1]*e[1]];return{startPoint:[n.startPoint[0]+s[0],n.startPoint[1]+s[1]],endPoint:[n.endPoint[0]+s[0],n.endPoint[1]+s[1]],palmLandmarks:n.palmLandmarks}}var Gde=(function(){function n(e,t,s,r,o,i){this.model=e,this.width=t,this.height=s,this.iouThreshold=o,this.scoreThreshold=i,this.anchors=r.map((function(a){return[a.x_center,a.y_center]})),this.anchorsTensor=Bl(this.anchors),this.inputSizeTensor=_n([t,s]),this.doubleInputSizeTensor=_n([2*t,2*s])}return n.prototype.normalizeBoxes=function(e){var t=this;return ie((function(){var s=et(e,[0,0],[-1,2]),r=et(e,[0,2],[-1,2]),o=ye(Ae(s,t.inputSizeTensor),t.anchorsTensor),i=Ae(r,t.doubleInputSizeTensor),a=H(Ee(o,i),t.inputSizeTensor),l=H(ye(o,i),t.inputSizeTensor);return P1([a,l],1)}))},n.prototype.normalizeLandmarks=function(e,t){var s=this;return ie((function(){var r=ye(Ae(X(e,[-1,7,2]),s.inputSizeTensor),s.anchors[t]);return H(r,s.inputSizeTensor)}))},n.prototype.getBoundingBoxes=function(e){return Ei(this,void 0,void 0,(function(){var t,s,r,o,i,a,l,u,h,p,f,m,y,x,v,w=this;return Ri(this,(function(S){switch(S.label){case 0:return t=ie((function(){return H(Ee(e,.5),2)})),R1()==="webgl"?(r=ae().get("WEBGL_PACK_DEPTHWISECONV"),ae().set("WEBGL_PACK_DEPTHWISECONV",!0),s=this.model.predict(t),ae().set("WEBGL_PACK_DEPTHWISECONV",r)):s=this.model.predict(t),o=Ao(s),i=ie((function(){return Ao(Fr(et(o,[0,0],[-1,1])))})),a=et(o,[0,1],[-1,4]),l=this.normalizeBoxes(a),u=console.warn,console.warn=function(){},h=Es.nonMaxSuppression(l,i,1,this.iouThreshold,this.scoreThreshold),console.warn=u,[4,h.array()];case 1:return p=S.sent(),f=[t,s,h,o,l,a,i],p.length===0?(f.forEach((function(k){return k.dispose()})),[2,null]):(m=p[0],y=et(l,[m,0],[1,-1]),x=et(o,[m,5],[1,14]),v=ie((function(){return X(w.normalizeLandmarks(x,m),[-1,2])})),f.push(x),f.forEach((function(k){return k.dispose()})),[2,{boxes:y,palmLandmarks:v}])}}))}))},n.prototype.estimateHandBounds=function(e){return Ei(this,void 0,void 0,(function(){var t,s,r,o,i,a,l,u,h=this;return Ri(this,(function(p){switch(p.label){case 0:return t=e.shape[1],s=e.shape[2],r=ie((function(){return Ae(Es.resizeBilinear(e,[h.width,h.height]),255)})),[4,this.getBoundingBoxes(r)];case 1:return(o=p.sent())===null?(r.dispose(),[2,null]):(i=o.boxes.arraySync(),a=i[0].slice(0,2),l=i[0].slice(2,4),u=o.palmLandmarks.arraySync(),r.dispose(),o.boxes.dispose(),o.palmLandmarks.dispose(),[2,(f={startPoint:a,endPoint:l,palmLandmarks:u},m=[s/this.width,t/this.height],{startPoint:[f.startPoint[0]*m[0],f.startPoint[1]*m[1]],endPoint:[f.endPoint[0]*m[0],f.endPoint[1]*m[1]],palmLandmarks:f.palmLandmarks.map((function(y){return[y[0]*m[0],y[1]*m[1]]}))})])}var f,m}))}))},n})(),Nx={thumb:[1,2,3,4],indexFinger:[5,6,7,8],middleFinger:[9,10,11,12],ringFinger:[13,14,15,16],pinky:[17,18,19,20],palmBase:[0]};function jde(n,e){var t,s=Math.PI/2-Math.atan2(-(e[1]-n[1]),e[0]-n[0]);return(t=s)-2*Math.PI*Math.floor((t+Math.PI)/(2*Math.PI))}var n$=function(n,e){return[[1,0,n],[0,1,e],[0,0,1]]};function ya(n,e){for(var t=0,s=0;s<n.length;s++)t+=n[s]*e[s];return t}function Hde(n,e){for(var t=[],s=0;s<n.length;s++)t.push(n[s][e]);return t}function s$(n,e){for(var t=[],s=n.length,r=0;r<s;r++){t.push([]);for(var o=0;o<s;o++)t[r].push(ya(n[r],Hde(e,o)))}return t}function r$(n,e){var t=Math.cos(n),s=Math.sin(n),r=[[t,-s,0],[s,t,0],[0,0,1]],o=s$(n$(e[0],e[1]),r);return s$(o,n$(-e[0],-e[1]))}function o$(n,e){return[ya(n,e[0]),ya(n,e[1])]}var Kde=[0,-.4],qde=[0,-.1],i$=[0,5,9,13,17,1,2],Xde=(function(){function n(e,t,s,r,o,i){this.boundingBoxDetector=e,this.meshDetector=t,this.meshWidth=s,this.meshHeight=r,this.maxContinuousChecks=o,this.detectionConfidence=i,this.regionsOfInterest=[],this.runsWithoutHandDetector=0,this.maxHandsNumber=1}return n.prototype.getBoxForPalmLandmarks=function(e,t){var s=e.map((function(r){return o$(kl(kl([],r,!0),[1],!1),t)}));return JI(e$(t$(this.calculateLandmarksBoundingBox(s),Kde)),3)},n.prototype.getBoxForHandLandmarks=function(e){for(var t=JI(e$(t$(this.calculateLandmarksBoundingBox(e),qde)),1.65),s=[],r=0;r<i$.length;r++)s.push(e[i$[r]].slice(0,2));return t.palmLandmarks=s,t},n.prototype.transformRawCoords=function(e,t,s,r){var o,i,a,l,u=this,h=IS(t),p=[h[0]/this.meshWidth,h[1]/this.meshHeight],f=e.map((function(S){return[p[0]*(S[0]-u.meshWidth/2),p[1]*(S[1]-u.meshHeight/2),S[2]]})),m=r$(s,[0,0]),y=f.map((function(S){return kl(kl([],o$(S,m),!0),[S[2]],!1)})),x=(i=[[(o=r)[0][0],o[1][0]],[o[0][1],o[1][1]]],a=[o[0][2],o[1][2]],l=[-ya(i[0],a),-ya(i[1],a)],[i[0].concat(l[0]),i[1].concat(l[1]),[0,0,1]]),v=kl(kl([],Jf(t),!0),[1],!1),w=[ya(v,x[0]),ya(v,x[1])];return y.map((function(S){return[S[0]+w[0],S[1]+w[1],S[2]]}))},n.prototype.estimateHand=function(e){return Ei(this,void 0,void 0,(function(){var t,s,r,o,i,a,l,u,h,p,f,m,y,x,v,w,S,k,T,I;return Ri(this,(function(E){switch(E.label){case 0:return(t=this.shouldUpdateRegionsOfInterest())!==!0?[3,2]:[4,this.boundingBoxDetector.estimateHandBounds(e)];case 1:return(s=E.sent())===null?(e.dispose(),this.regionsOfInterest=[],[2,null]):(this.updateRegionsOfInterest(s,!0),this.runsWithoutHandDetector=0,[3,3]);case 2:this.runsWithoutHandDetector++,E.label=3;case 3:return r=this.regionsOfInterest[0],o=jde(r.palmLandmarks[0],r.palmLandmarks[2]),i=Jf(r),a=[i[0]/e.shape[2],i[1]/e.shape[1]],l=Es.rotateWithOffset(e,o,0,a),u=r$(-o,i),h=t===!0?this.getBoxForPalmLandmarks(r.palmLandmarks,u):r,p=(function(D,O,_){var P=O.shape[1],R=O.shape[2],W=[[D.startPoint[1]/P,D.startPoint[0]/R,D.endPoint[1]/P,D.endPoint[0]/R]];return Es.cropAndResize(O,W,[0],_)})(h,l,[this.meshWidth,this.meshHeight]),f=Ae(p,255),p.dispose(),l.dispose(),R1()==="webgl"?(y=ae().get("WEBGL_PACK_DEPTHWISECONV"),ae().set("WEBGL_PACK_DEPTHWISECONV",!0),m=this.meshDetector.predict(f),ae().set("WEBGL_PACK_DEPTHWISECONV",y)):m=this.meshDetector.predict(f),x=m[0],v=m[1],f.dispose(),w=x.dataSync()[0],x.dispose(),w<this.detectionConfidence?(v.dispose(),this.regionsOfInterest=[],[2,null]):(S=X(v,[-1,3]),k=S.arraySync(),v.dispose(),S.dispose(),T=this.transformRawCoords(k,h,o,u),I=this.getBoxForHandLandmarks(T),this.updateRegionsOfInterest(I,!1),[2,{landmarks:T,handInViewConfidence:w,boundingBox:{topLeft:I.startPoint,bottomRight:I.endPoint}}])}}))}))},n.prototype.calculateLandmarksBoundingBox=function(e){var t=e.map((function(r){return r[0]})),s=e.map((function(r){return r[1]}));return{startPoint:[Math.min.apply(Math,t),Math.min.apply(Math,s)],endPoint:[Math.max.apply(Math,t),Math.max.apply(Math,s)]}},n.prototype.updateRegionsOfInterest=function(e,t){if(t)this.regionsOfInterest=[e];else{var s=this.regionsOfInterest[0],r=0;if(s!=null&&s.startPoint!=null){var o=e.startPoint,i=o[0],a=o[1],l=e.endPoint,u=l[0],h=l[1],p=s.startPoint,f=p[0],m=p[1],y=s.endPoint,x=y[0],v=y[1],w=Math.max(i,f),S=Math.max(a,m),k=(Math.min(u,x)-w)*(Math.min(h,v)-S);r=k/((u-i)*(h-a)+(x-f)*(v-a)-k)}this.regionsOfInterest[0]=r>.8?s:e}},n.prototype.shouldUpdateRegionsOfInterest=function(){return this.regionsOfInterest.length!==this.maxHandsNumber||this.runsWithoutHandDetector>=this.maxContinuousChecks},n})();function Yde(){return Ei(this,void 0,void 0,(function(){return Ri(this,(function(n){return[2,jO("https://tfhub.dev/mediapipe/tfjs-model/handdetector/1/default/1",{fromTFHub:!0})]}))}))}function Qde(){return Ei(this,void 0,void 0,(function(){return Ri(this,(function(n){return[2,jO("https://tfhub.dev/mediapipe/tfjs-model/handskeleton/1/default/1",{fromTFHub:!0})]}))}))}function Zde(){return Ei(this,void 0,void 0,(function(){return Ri(this,(function(n){return[2,ZV("https://tfhub.dev/mediapipe/tfjs-model/handskeleton/1/default/1/anchors.json?tfjs-format=file").then((function(e){return e.json()}))]}))}))}function Jde(n){var e={},t=e.maxContinuousChecks,s=t===void 0?1/0:t,r=e.detectionConfidence,o=r===void 0?.8:r,i=e.iouThreshold,a=i===void 0?.3:i,l=e.scoreThreshold,u=l===void 0?.5:l;return Ei(this,void 0,void 0,(function(){var h,p,f,m,y,x;return Ri(this,(function(v){switch(v.label){case 0:return[4,Promise.all([Zde(),Yde(),Qde()])];case 1:return h=v.sent(),p=h[0],f=h[1],m=h[2],y=new Gde(f,256,256,p,a,u),x=new Xde(y,m,256,256,s,o),[2,new epe(x)]}}))}))}var epe=(function(){function n(e){this.pipeline=e}return n.getAnnotations=function(){return Nx},n.prototype.estimateHands=function(e,t){return t===void 0&&(t=!1),Ei(this,void 0,void 0,(function(){var s,r,o,i,a,l,u,h,p;return Ri(this,(function(f){switch(f.label){case 0:return s=(function(m){return m instanceof $t?[m.shape[0],m.shape[1]]:[m.height,m.width]})(e),r=s[1],o=ie((function(){return e instanceof $t||(e=G6(e)),jn(Ne(e,"float32"))})),[4,this.pipeline.estimateHand(o)];case 1:if(i=f.sent(),o.dispose(),i===null)return[2,[]];for(a=i,t===!0&&(a=(function(m,y){var x=m.handInViewConfidence,v=m.landmarks,w=m.boundingBox;return{handInViewConfidence:x,landmarks:v.map((function(S){return[y-1-S[0],S[1],S[2]]})),boundingBox:{topLeft:[y-1-w.topLeft[0],w.topLeft[1]],bottomRight:[y-1-w.bottomRight[0],w.bottomRight[1]]}}})(i,r)),l={},u=0,h=Object.keys(Nx);u<h.length;u++)p=h[u],l[p]=Nx[p].map((function(m){return a.landmarks[m]}));return[2,[{handInViewConfidence:a.handInViewConfidence,boundingBox:a.boundingBox,landmarks:a.landmarks,annotations:l}]]}}))}))},n})(),gf={exports:{}},tpe=gf.exports,a$;function npe(){return a$||(a$=1,(function(n,e){(function(t,s){n.exports=s()})(typeof self<"u"?self:tpe,(function(){return(function(t){var s={};function r(o){if(s[o])return s[o].exports;var i=s[o]={i:o,l:!1,exports:{}};return t[o].call(i.exports,i,i.exports,r),i.l=!0,i.exports}return r.m=t,r.c=s,r.d=function(o,i,a){r.o(o,i)||Object.defineProperty(o,i,{enumerable:!0,get:a})},r.r=function(o){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(o,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(o,"__esModule",{value:!0})},r.t=function(o,i){if(1&i&&(o=r(o)),8&i||4&i&&typeof o=="object"&&o&&o.__esModule)return o;var a=Object.create(null);if(r.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:o}),2&i&&typeof o!="string")for(var l in o)r.d(a,l,(function(u){return o[u]}).bind(null,l));return a},r.n=function(o){var i=o&&o.__esModule?function(){return o.default}:function(){return o};return r.d(i,"a",i),i},r.o=function(o,i){return Object.prototype.hasOwnProperty.call(o,i)},r.p="",r(r.s=0)})([function(t,s,r){r.r(s);var o={};function i(V){return(i=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(B){return typeof B}:function(B){return B&&typeof Symbol=="function"&&B.constructor===Symbol&&B!==Symbol.prototype?"symbol":typeof B})(V)}r.r(o),r.d(o,"VictoryGesture",(function(){return Q})),r.d(o,"ThumbsUpGesture",(function(){return G}));var a={Thumb:0,Index:1,Middle:2,Ring:3,Pinky:4,all:[0,1,2,3,4],nameMapping:{0:"Thumb",1:"Index",2:"Middle",3:"Ring",4:"Pinky"},pointsMapping:{0:[[0,1],[1,2],[2,3],[3,4]],1:[[0,5],[5,6],[6,7],[7,8]],2:[[0,9],[9,10],[10,11],[11,12]],3:[[0,13],[13,14],[14,15],[15,16]],4:[[0,17],[17,18],[18,19],[19,20]]},getName:function(V){return i(this.nameMapping[V])!==void 0&&this.nameMapping[V]},getPoints:function(V){return i(this.pointsMapping[V])!==void 0&&this.pointsMapping[V]}},l={NoCurl:0,HalfCurl:1,FullCurl:2,nameMapping:{0:"No Curl",1:"Half Curl",2:"Full Curl"},getName:function(V){return i(this.nameMapping[V])!==void 0&&this.nameMapping[V]}},u={VerticalUp:0,VerticalDown:1,HorizontalLeft:2,HorizontalRight:3,DiagonalUpRight:4,DiagonalUpLeft:5,DiagonalDownRight:6,DiagonalDownLeft:7,nameMapping:{0:"Vertical Up",1:"Vertical Down",2:"Horizontal Left",3:"Horizontal Right",4:"Diagonal Up Right",5:"Diagonal Up Left",6:"Diagonal Down Right",7:"Diagonal Down Left"},getName:function(V){return i(this.nameMapping[V])!==void 0&&this.nameMapping[V]}};function h(V,B){var F=typeof Symbol<"u"&&V[Symbol.iterator]||V["@@iterator"];if(!F){if(Array.isArray(V)||(F=(function(he,xe){if(he){if(typeof he=="string")return p(he,xe);var ge=Object.prototype.toString.call(he).slice(8,-1);if(ge==="Object"&&he.constructor&&(ge=he.constructor.name),ge==="Map"||ge==="Set")return Array.from(he);if(ge==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(ge))return p(he,xe)}})(V))||B){F&&(V=F);var z=0,q=function(){};return{s:q,n:function(){return z>=V.length?{done:!0}:{done:!1,value:V[z++]}},e:function(he){throw he},f:q}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var re,ue=!0,pe=!1;return{s:function(){F=F.call(V)},n:function(){var he=F.next();return ue=he.done,he},e:function(he){pe=!0,re=he},f:function(){try{ue||F.return==null||F.return()}finally{if(pe)throw re}}}}function p(V,B){(B==null||B>V.length)&&(B=V.length);for(var F=0,z=new Array(B);F<B;F++)z[F]=V[F];return z}function f(V,B){var F=Object.keys(V);if(Object.getOwnPropertySymbols){var z=Object.getOwnPropertySymbols(V);B&&(z=z.filter((function(q){return Object.getOwnPropertyDescriptor(V,q).enumerable}))),F.push.apply(F,z)}return F}function m(V){for(var B=1;B<arguments.length;B++){var F=arguments[B]!=null?arguments[B]:{};B%2?f(Object(F),!0).forEach((function(z){y(V,z,F[z])})):Object.getOwnPropertyDescriptors?Object.defineProperties(V,Object.getOwnPropertyDescriptors(F)):f(Object(F)).forEach((function(z){Object.defineProperty(V,z,Object.getOwnPropertyDescriptor(F,z))}))}return V}function y(V,B,F){return B in V?Object.defineProperty(V,B,{value:F,enumerable:!0,configurable:!0,writable:!0}):V[B]=F,V}function x(V,B){for(var F=0;F<B.length;F++){var z=B[F];z.enumerable=z.enumerable||!1,z.configurable=!0,"value"in z&&(z.writable=!0),Object.defineProperty(V,z.key,z)}}var v=(function(){function V(z){(function(q,re){if(!(q instanceof re))throw new TypeError("Cannot call a class as a function")})(this,V),this.options=m(m({},{HALF_CURL_START_LIMIT:60,NO_CURL_START_LIMIT:130,DISTANCE_VOTE_POWER:1.1,SINGLE_ANGLE_VOTE_POWER:.9,TOTAL_ANGLE_VOTE_POWER:1.6}),z)}var B,F;return B=V,(F=[{key:"estimate",value:function(z){var q,re=[],ue=[],pe=h(a.all);try{for(pe.s();!(q=pe.n()).done;){var he,xe=q.value,ge=a.getPoints(xe),Ie=[],Re=[],Ue=h(ge);try{for(Ue.s();!(he=Ue.n()).done;){var qe=he.value,Qe=z[qe[0]],Je=z[qe[1]],Ke=this.getSlopes(Qe,Je),st=Ke[0],rt=Ke[1];Ie.push(st),Re.push(rt)}}catch(ln){Ue.e(ln)}finally{Ue.f()}re.push(Ie),ue.push(Re)}}catch(ln){pe.e(ln)}finally{pe.f()}var nn,mt=[],Dt=[],xt=h(a.all);try{for(xt.s();!(nn=xt.n()).done;){var Kt=nn.value,Vt=Kt==a.Thumb?1:0,qt=a.getPoints(Kt),an=z[qt[Vt][0]],Bn=z[qt[Vt+1][1]],$n=z[qt[3][1]],gs=this.estimateFingerCurl(an,Bn,$n),ys=this.calculateFingerDirection(an,Bn,$n,re[Kt].slice(Vt));mt[Kt]=gs,Dt[Kt]=ys}}catch(ln){xt.e(ln)}finally{xt.f()}return{curls:mt,directions:Dt}}},{key:"getSlopes",value:function(z,q){var re=this.calculateSlope(z[0],z[1],q[0],q[1]);return z.length==2?re:[re,this.calculateSlope(z[1],z[2],q[1],q[2])]}},{key:"angleOrientationAt",value:function(z){var q=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,re=0,ue=0,pe=0;return z>=75&&z<=105?re=1*q:z>=25&&z<=155?ue=1*q:pe=1*q,[re,ue,pe]}},{key:"estimateFingerCurl",value:function(z,q,re){var ue=z[0]-q[0],pe=z[0]-re[0],he=q[0]-re[0],xe=z[1]-q[1],ge=z[1]-re[1],Ie=q[1]-re[1],Re=z[2]-q[2],Ue=z[2]-re[2],qe=q[2]-re[2],Qe=Math.sqrt(ue*ue+xe*xe+Re*Re),Je=Math.sqrt(pe*pe+ge*ge+Ue*Ue),Ke=Math.sqrt(he*he+Ie*Ie+qe*qe),st=(Ke*Ke+Qe*Qe-Je*Je)/(2*Ke*Qe);st>1?st=1:st<-1&&(st=-1);var rt=Math.acos(st);return(rt=57.2958*rt%180)>this.options.NO_CURL_START_LIMIT?l.NoCurl:rt>this.options.HALF_CURL_START_LIMIT?l.HalfCurl:l.FullCurl}},{key:"estimateHorizontalDirection",value:function(z,q,re,ue){return ue==Math.abs(z)?z>0?u.HorizontalLeft:u.HorizontalRight:ue==Math.abs(q)?q>0?u.HorizontalLeft:u.HorizontalRight:re>0?u.HorizontalLeft:u.HorizontalRight}},{key:"estimateVerticalDirection",value:function(z,q,re,ue){return ue==Math.abs(z)?z<0?u.VerticalDown:u.VerticalUp:ue==Math.abs(q)?q<0?u.VerticalDown:u.VerticalUp:re<0?u.VerticalDown:u.VerticalUp}},{key:"estimateDiagonalDirection",value:function(z,q,re,ue,pe,he,xe,ge){var Ie=this.estimateVerticalDirection(z,q,re,ue),Re=this.estimateHorizontalDirection(pe,he,xe,ge);return Ie==u.VerticalUp?Re==u.HorizontalLeft?u.DiagonalUpLeft:u.DiagonalUpRight:Re==u.HorizontalLeft?u.DiagonalDownLeft:u.DiagonalDownRight}},{key:"calculateFingerDirection",value:function(z,q,re,ue){var pe=z[0]-q[0],he=z[0]-re[0],xe=q[0]-re[0],ge=z[1]-q[1],Ie=z[1]-re[1],Re=q[1]-re[1],Ue=Math.max(Math.abs(pe),Math.abs(he),Math.abs(xe)),qe=Math.max(Math.abs(ge),Math.abs(Ie),Math.abs(Re)),Qe=0,Je=0,Ke=0,st=qe/(Ue+1e-5);st>1.5?Qe+=this.options.DISTANCE_VOTE_POWER:st>.66?Je+=this.options.DISTANCE_VOTE_POWER:Ke+=this.options.DISTANCE_VOTE_POWER;var rt=Math.sqrt(pe*pe+ge*ge),nn=Math.sqrt(he*he+Ie*Ie),mt=Math.sqrt(xe*xe+Re*Re),Dt=Math.max(rt,nn,mt),xt=z[0],Kt=z[1],Vt=re[0],qt=re[1];Dt==rt?(Vt=re[0],qt=re[1]):Dt==mt&&(xt=q[0],Kt=q[1]);var an=[xt,Kt],Bn=[Vt,qt],$n=this.getSlopes(an,Bn),gs=this.angleOrientationAt($n,this.options.TOTAL_ANGLE_VOTE_POWER);Qe+=gs[0],Je+=gs[1],Ke+=gs[2];var ys,ln=h(ue);try{for(ln.s();!(ys=ln.n()).done;){var $u=ys.value,wr=this.angleOrientationAt($u,this.options.SINGLE_ANGLE_VOTE_POWER);Qe+=wr[0],Je+=wr[1],Ke+=wr[2]}}catch(Ya){ln.e(Ya)}finally{ln.f()}return Qe==Math.max(Qe,Je,Ke)?this.estimateVerticalDirection(Ie,ge,Re,qe):Ke==Math.max(Je,Ke)?this.estimateHorizontalDirection(he,pe,xe,Ue):this.estimateDiagonalDirection(Ie,ge,Re,qe,he,pe,xe,Ue)}},{key:"calculateSlope",value:function(z,q,re,ue){var pe=(q-ue)/(z-re),he=180*Math.atan(pe)/Math.PI;return he<=0?he=-he:he>0&&(he=180-he),he}}])&&x(B.prototype,F),V})();function w(V,B){var F=typeof Symbol<"u"&&V[Symbol.iterator]||V["@@iterator"];if(!F){if(Array.isArray(V)||(F=(function(he,xe){if(he){if(typeof he=="string")return S(he,xe);var ge=Object.prototype.toString.call(he).slice(8,-1);if(ge==="Object"&&he.constructor&&(ge=he.constructor.name),ge==="Map"||ge==="Set")return Array.from(he);if(ge==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(ge))return S(he,xe)}})(V))||B){F&&(V=F);var z=0,q=function(){};return{s:q,n:function(){return z>=V.length?{done:!0}:{done:!1,value:V[z++]}},e:function(he){throw he},f:q}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var re,ue=!0,pe=!1;return{s:function(){F=F.call(V)},n:function(){var he=F.next();return ue=he.done,he},e:function(he){pe=!0,re=he},f:function(){try{ue||F.return==null||F.return()}finally{if(pe)throw re}}}}function S(V,B){(B==null||B>V.length)&&(B=V.length);for(var F=0,z=new Array(B);F<B;F++)z[F]=V[F];return z}function k(V,B){if(!(V instanceof B))throw new TypeError("Cannot call a class as a function")}function T(V,B){for(var F=0;F<B.length;F++){var z=B[F];z.enumerable=z.enumerable||!1,z.configurable=!0,"value"in z&&(z.writable=!0),Object.defineProperty(V,z.key,z)}}var I=(function(){function V(z){var q=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};k(this,V),this.estimator=new v(q),this.gestures=z}var B,F;return B=V,(F=[{key:"estimate",value:function(z,q){var re,ue=[],pe=this.estimator.estimate(z),he=[],xe=w(a.all);try{for(xe.s();!(re=xe.n()).done;){var ge=re.value;he.push([a.getName(ge),l.getName(pe.curls[ge]),u.getName(pe.directions[ge])])}}catch(Qe){xe.e(Qe)}finally{xe.f()}var Ie,Re=w(this.gestures);try{for(Re.s();!(Ie=Re.n()).done;){var Ue=Ie.value,qe=Ue.matchAgainst(pe.curls,pe.directions);qe>=q&&ue.push({name:Ue.name,score:qe})}}catch(Qe){Re.e(Qe)}finally{Re.f()}return{poseData:he,gestures:ue}}}])&&T(B.prototype,F),V})();function E(V,B){return(function(F){if(Array.isArray(F))return F})(V)||(function(F,z){var q=F==null?null:typeof Symbol<"u"&&F[Symbol.iterator]||F["@@iterator"];if(q!=null){var re,ue,pe=[],he=!0,xe=!1;try{for(q=q.call(F);!(he=(re=q.next()).done)&&(pe.push(re.value),!z||pe.length!==z);he=!0);}catch(ge){xe=!0,ue=ge}finally{try{he||q.return==null||q.return()}finally{if(xe)throw ue}}return pe}})(V,B)||O(V,B)||(function(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)})()}function D(V,B){var F=typeof Symbol<"u"&&V[Symbol.iterator]||V["@@iterator"];if(!F){if(Array.isArray(V)||(F=O(V))||B){F&&(V=F);var z=0,q=function(){};return{s:q,n:function(){return z>=V.length?{done:!0}:{done:!1,value:V[z++]}},e:function(he){throw he},f:q}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var re,ue=!0,pe=!1;return{s:function(){F=F.call(V)},n:function(){var he=F.next();return ue=he.done,he},e:function(he){pe=!0,re=he},f:function(){try{ue||F.return==null||F.return()}finally{if(pe)throw re}}}}function O(V,B){if(V){if(typeof V=="string")return _(V,B);var F=Object.prototype.toString.call(V).slice(8,-1);return F==="Object"&&V.constructor&&(F=V.constructor.name),F==="Map"||F==="Set"?Array.from(V):F==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(F)?_(V,B):void 0}}function _(V,B){(B==null||B>V.length)&&(B=V.length);for(var F=0,z=new Array(B);F<B;F++)z[F]=V[F];return z}function P(V,B){for(var F=0;F<B.length;F++){var z=B[F];z.enumerable=z.enumerable||!1,z.configurable=!0,"value"in z&&(z.writable=!0),Object.defineProperty(V,z.key,z)}}var R=(function(){function V(z){(function(q,re){if(!(q instanceof re))throw new TypeError("Cannot call a class as a function")})(this,V),this.name=z,this.curls={},this.directions={}}var B,F;return B=V,(F=[{key:"addCurl",value:function(z,q){var re=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;this.curls[z]===void 0&&(this.curls[z]=[]),this.curls[z].push([q,re])}},{key:"addDirection",value:function(z,q){var re=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;this.directions[z]===void 0&&(this.directions[z]=[]),this.directions[z].push([q,re])}},{key:"matchAgainst",value:function(z,q){var re=0,ue=0;for(var pe in z){var he=z[pe],xe=this.curls[pe];if(xe!==void 0){ue++;var ge,Ie=!1,Re=0,Ue=D(xe);try{for(Ue.s();!(ge=Ue.n()).done;){var qe=E(ge.value,2),Qe=qe[0],Je=qe[1];if(he==Qe){re+=Je,Re=Math.max(Re,Je),Ie=!0;break}}}catch(an){Ue.e(an)}finally{Ue.f()}Ie||(re-=Re)}}for(var Ke in q){var st=q[Ke],rt=this.directions[Ke];if(rt!==void 0){ue++;var nn,mt=!1,Dt=0,xt=D(rt);try{for(xt.s();!(nn=xt.n()).done;){var Kt=E(nn.value,2),Vt=Kt[0],qt=Kt[1];if(st==Vt){re+=qt,Dt=Math.max(Dt,qt),mt=!0;break}}}catch(an){xt.e(an)}finally{xt.f()}mt||(re-=Dt)}}return re/ue*10}}])&&P(B.prototype,F),V})(),W=new R("victory");W.addDirection(a.Thumb,u.VerticalUp,1),W.addDirection(a.Thumb,u.DiagonalUpLeft,1),W.addDirection(a.Thumb,u.DiagonalUpRight,1),W.addCurl(a.Index,l.NoCurl,1),W.addDirection(a.Index,u.VerticalUp,1),W.addDirection(a.Index,u.DiagonalUpLeft,1),W.addDirection(a.Index,u.DiagonalUpRight,1),W.addDirection(a.Index,u.HorizontalLeft,1),W.addDirection(a.Index,u.HorizontalRight,1),W.addCurl(a.Middle,l.NoCurl,1),W.addDirection(a.Middle,u.VerticalUp,1),W.addDirection(a.Middle,u.DiagonalUpLeft,1),W.addDirection(a.Middle,u.DiagonalUpRight,1),W.addDirection(a.Middle,u.HorizontalLeft,1),W.addDirection(a.Middle,u.HorizontalRight,1),W.addCurl(a.Ring,l.FullCurl,1),W.addCurl(a.Ring,l.HalfCurl,.9),W.addCurl(a.Pinky,l.FullCurl,1),W.addCurl(a.Pinky,l.HalfCurl,.9);var Q=W,ee=new R("thumbs_up");ee.addCurl(a.Thumb,l.NoCurl,1),ee.addDirection(a.Thumb,u.VerticalUp,1),ee.addDirection(a.Thumb,u.DiagonalUpLeft,.9),ee.addDirection(a.Thumb,u.DiagonalUpRight,.9);for(var te=0,oe=[a.Index,a.Middle,a.Ring,a.Pinky];te<oe.length;te++){var se=oe[te];ee.addCurl(se,l.FullCurl,1),ee.addCurl(se,l.HalfCurl,.9)}ee.addDirection(a.Index,u.DiagonalUpLeft,1),ee.addDirection(a.Index,u.HorizontalLeft,1),ee.addDirection(a.Index,u.HorizontalRight,1),ee.addDirection(a.Index,u.DiagonalUpRight,1);var G=ee;s.default={GestureEstimator:I,GestureDescription:R,Finger:a,FingerCurl:l,FingerDirection:u,Gestures:o}}]).default}))})(gf)),gf.exports}var Xe=npe();const pi={},La=new Xe.GestureDescription("thumbs_up");La.addCurl(Xe.Finger.Thumb,Xe.FingerCurl.NoCurl,1);La.addDirection(Xe.Finger.Thumb,Xe.FingerDirection.VerticalUp,1);La.addDirection(Xe.Finger.Thumb,Xe.FingerDirection.DiagonalUpLeft,.9);La.addDirection(Xe.Finger.Thumb,Xe.FingerDirection.DiagonalUpRight,.9);for(let n of[Xe.Finger.Index,Xe.Finger.Middle,Xe.Finger.Ring,Xe.Finger.Pinky])La.addCurl(n,Xe.FingerCurl.FullCurl,1),La.addCurl(n,Xe.FingerCurl.HalfCurl,.9);pi.thumbs_up=La;const KF=new Xe.GestureDescription("open_hand");for(let n of[Xe.Finger.Thumb,Xe.Finger.Index,Xe.Finger.Middle,Xe.Finger.Ring,Xe.Finger.Pinky])KF.addCurl(n,Xe.FingerCurl.NoCurl,1);pi.open_hand=KF;const Hc=new Xe.GestureDescription("pointing_up");Hc.addCurl(Xe.Finger.Index,Xe.FingerCurl.NoCurl,1);Hc.addDirection(Xe.Finger.Index,Xe.FingerDirection.VerticalUp,1);for(let n of[Xe.Finger.Thumb,Xe.Finger.Middle,Xe.Finger.Ring,Xe.Finger.Pinky])Hc.addCurl(n,Xe.FingerCurl.FullCurl,1),Hc.addCurl(n,Xe.FingerCurl.HalfCurl,.9);pi.pointing_up=Hc;const Ma=new Xe.GestureDescription("victory");Ma.addCurl(Xe.Finger.Index,Xe.FingerCurl.NoCurl,1);Ma.addCurl(Xe.Finger.Middle,Xe.FingerCurl.NoCurl,1);Ma.addDirection(Xe.Finger.Index,Xe.FingerDirection.VerticalUp,1);Ma.addDirection(Xe.Finger.Middle,Xe.FingerDirection.VerticalUp,1);for(let n of[Xe.Finger.Thumb,Xe.Finger.Ring,Xe.Finger.Pinky])Ma.addCurl(n,Xe.FingerCurl.FullCurl,1),Ma.addCurl(n,Xe.FingerCurl.HalfCurl,.9);pi.victory=Ma;function spe(){const{dispatch:n,ACTIONS:e}=hm(),[t,s]=J.useState(null),[r,o]=J.useState(!0);return J.useRef(),J.useEffect(()=>{(async()=>{console.log("Loading Handpose model...");try{await gB();const l=await Jde();s(l),o(!1),console.log("Handpose model loaded.")}catch(l){console.error("Failed to load handpose model",l)}})()},[]),{model:t,loading:r,detect:async a=>{if(!t||!a||a.readyState!==4)return;const l=await t.estimateHands(a);if(l.length>0){const h=await new Xe.GestureEstimator([pi.thumbs_up,pi.open_hand,pi.pointing_up,pi.victory]).estimate(l[0].landmarks,7.5);if(h.gestures.length>0){const p=h.gestures.reduce((f,m)=>f.score>m.score?f:m);p.score>8&&(console.log("Detected:",p.name),n({type:e.SET_TRANSLATION,payload:p.name}),n({type:e.UPDATE_MOOD_SCORE,payload:10}),n({type:e.SET_MOOD,payload:"happy"}))}}}}}const rpe={width:640,height:480,facingMode:"user"};function ope({onFrame:n}){const e=J.useRef(null),{model:t,loading:s,detect:r}=spe(),o=J.useRef();return J.useEffect(()=>{const i=async()=>{e.current&&e.current.video&&e.current.video.readyState===4&&t&&await r(e.current.video),o.current=requestAnimationFrame(i)};return!s&&t&&i(),()=>{o.current&&cancelAnimationFrame(o.current)}},[s,t,r]),ke.jsxs("div",{className:"relative border-4 border-yellow-400 rounded-lg overflow-hidden shadow-2xl",children:[s&&ke.jsx("div",{className:"absolute inset-0 bg-black flex items-center justify-center z-10 text-white",children:"Loading AI Model..."}),ke.jsx(CV,{ref:e,audio:!1,width:640,height:480,screenshotFormat:"image/jpeg",videoConstraints:rpe,className:"transform scale-x-[-1]"})]})}const $S=J.createContext({});function ES(n){const e=J.useRef(null);return e.current===null&&(e.current=n()),e.current}const qF=typeof window<"u",XF=qF?J.useLayoutEffect:J.useEffect,ry=J.createContext(null);function RS(n,e){n.indexOf(e)===-1&&n.push(e)}function DS(n,e){const t=n.indexOf(e);t>-1&&n.splice(t,1)}const co=(n,e,t)=>t>e?e:t<n?n:t;let AS=()=>{};const Fo={},YF=n=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(n);function QF(n){return typeof n=="object"&&n!==null}const ZF=n=>/^0[^.\s]+$/u.test(n);function OS(n){let e;return()=>(e===void 0&&(e=n()),e)}const dr=n=>n,ipe=(n,e)=>t=>e(n(t)),Sd=(...n)=>n.reduce(ipe),Kc=(n,e,t)=>{const s=e-n;return s===0?1:(t-n)/s};class _S{constructor(){this.subscriptions=[]}add(e){return RS(this.subscriptions,e),()=>DS(this.subscriptions,e)}notify(e,t,s){const r=this.subscriptions.length;if(r)if(r===1)this.subscriptions[0](e,t,s);else for(let o=0;o<r;o++){const i=this.subscriptions[o];i&&i(e,t,s)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}const ro=n=>n*1e3,ur=n=>n/1e3;function JF(n,e){return e?n*(1e3/e):0}const eP=(n,e,t)=>(((1-3*t+3*e)*n+(3*t-6*e))*n+3*e)*n,ape=1e-7,lpe=12;function upe(n,e,t,s,r){let o,i,a=0;do i=e+(t-e)/2,o=eP(i,s,r)-n,o>0?t=i:e=i;while(Math.abs(o)>ape&&++a<lpe);return i}function Cd(n,e,t,s){if(n===e&&t===s)return dr;const r=o=>upe(o,0,1,n,t);return o=>o===0||o===1?o:eP(r(o),e,s)}const tP=n=>e=>e<=.5?n(2*e)/2:(2-n(2*(1-e)))/2,nP=n=>e=>1-n(1-e),sP=Cd(.33,1.53,.69,.99),FS=nP(sP),rP=tP(FS),oP=n=>(n*=2)<1?.5*FS(n):.5*(2-Math.pow(2,-10*(n-1))),PS=n=>1-Math.sin(Math.acos(n)),iP=nP(PS),aP=tP(PS),cpe=Cd(.42,0,1,1),hpe=Cd(0,0,.58,1),lP=Cd(.42,0,.58,1),dpe=n=>Array.isArray(n)&&typeof n[0]!="number",uP=n=>Array.isArray(n)&&typeof n[0]=="number",ppe={linear:dr,easeIn:cpe,easeInOut:lP,easeOut:hpe,circIn:PS,circInOut:aP,circOut:iP,backIn:FS,backInOut:rP,backOut:sP,anticipate:oP},fpe=n=>typeof n=="string",l$=n=>{if(uP(n)){AS(n.length===4);const[e,t,s,r]=n;return Cd(e,t,s,r)}else if(fpe(n))return ppe[n];return n},Yp=["setup","read","resolveKeyframes","preUpdate","update","preRender","render","postRender"];function mpe(n,e){let t=new Set,s=new Set,r=!1,o=!1;const i=new WeakSet;let a={delta:0,timestamp:0,isProcessing:!1};function l(h){i.has(h)&&(u.schedule(h),n()),h(a)}const u={schedule:(h,p=!1,f=!1)=>{const y=f&&r?t:s;return p&&i.add(h),y.has(h)||y.add(h),h},cancel:h=>{s.delete(h),i.delete(h)},process:h=>{if(a=h,r){o=!0;return}r=!0,[t,s]=[s,t],t.forEach(l),t.clear(),r=!1,o&&(o=!1,u.process(h))}};return u}const gpe=40;function cP(n,e){let t=!1,s=!0;const r={delta:0,timestamp:0,isProcessing:!1},o=()=>t=!0,i=Yp.reduce((k,T)=>(k[T]=mpe(o),k),{}),{setup:a,read:l,resolveKeyframes:u,preUpdate:h,update:p,preRender:f,render:m,postRender:y}=i,x=()=>{const k=Fo.useManualTiming?r.timestamp:performance.now();t=!1,Fo.useManualTiming||(r.delta=s?1e3/60:Math.max(Math.min(k-r.timestamp,gpe),1)),r.timestamp=k,r.isProcessing=!0,a.process(r),l.process(r),u.process(r),h.process(r),p.process(r),f.process(r),m.process(r),y.process(r),r.isProcessing=!1,t&&e&&(s=!1,n(x))},v=()=>{t=!0,s=!0,r.isProcessing||n(x)};return{schedule:Yp.reduce((k,T)=>{const I=i[T];return k[T]=(E,D=!1,O=!1)=>(t||v(),I.schedule(E,D,O)),k},{}),cancel:k=>{for(let T=0;T<Yp.length;T++)i[Yp[T]].cancel(k)},state:r,steps:i}}const{schedule:Et,cancel:Di,state:Gn,steps:Ix}=cP(typeof requestAnimationFrame<"u"?requestAnimationFrame:dr,!0);let yf;function ype(){yf=void 0}const ds={now:()=>(yf===void 0&&ds.set(Gn.isProcessing||Fo.useManualTiming?Gn.timestamp:performance.now()),yf),set:n=>{yf=n,queueMicrotask(ype)}},hP=n=>e=>typeof e=="string"&&e.startsWith(n),dP=hP("--"),xpe=hP("var(--"),LS=n=>xpe(n)?vpe.test(n.split("/*")[0].trim()):!1,vpe=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu;function u$(n){return typeof n!="string"?!1:n.split("/*")[0].includes("var(--")}const Tu={test:n=>typeof n=="number",parse:parseFloat,transform:n=>n},qc={...Tu,transform:n=>co(0,1,n)},Qp={...Tu,default:1},Nc=n=>Math.round(n*1e5)/1e5,MS=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu;function wpe(n){return n==null}const bpe=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,zS=(n,e)=>t=>!!(typeof t=="string"&&bpe.test(t)&&t.startsWith(n)||e&&!wpe(t)&&Object.prototype.hasOwnProperty.call(t,e)),pP=(n,e,t)=>s=>{if(typeof s!="string")return s;const[r,o,i,a]=s.match(MS);return{[n]:parseFloat(r),[e]:parseFloat(o),[t]:parseFloat(i),alpha:a!==void 0?parseFloat(a):1}},Spe=n=>co(0,255,n),$x={...Tu,transform:n=>Math.round(Spe(n))},xa={test:zS("rgb","red"),parse:pP("red","green","blue"),transform:({red:n,green:e,blue:t,alpha:s=1})=>"rgba("+$x.transform(n)+", "+$x.transform(e)+", "+$x.transform(t)+", "+Nc(qc.transform(s))+")"};function Cpe(n){let e="",t="",s="",r="";return n.length>5?(e=n.substring(1,3),t=n.substring(3,5),s=n.substring(5,7),r=n.substring(7,9)):(e=n.substring(1,2),t=n.substring(2,3),s=n.substring(3,4),r=n.substring(4,5),e+=e,t+=t,s+=s,r+=r),{red:parseInt(e,16),green:parseInt(t,16),blue:parseInt(s,16),alpha:r?parseInt(r,16)/255:1}}const jv={test:zS("#"),parse:Cpe,transform:xa.transform},kd=n=>({test:e=>typeof e=="string"&&e.endsWith(n)&&e.split(" ").length===1,parse:parseFloat,transform:e=>`${e}${n}`}),ai=kd("deg"),oo=kd("%"),Le=kd("px"),kpe=kd("vh"),Tpe=kd("vw"),c$={...oo,parse:n=>oo.parse(n)/100,transform:n=>oo.transform(n*100)},Dl={test:zS("hsl","hue"),parse:pP("hue","saturation","lightness"),transform:({hue:n,saturation:e,lightness:t,alpha:s=1})=>"hsla("+Math.round(n)+", "+oo.transform(Nc(e))+", "+oo.transform(Nc(t))+", "+Nc(qc.transform(s))+")"},cn={test:n=>xa.test(n)||jv.test(n)||Dl.test(n),parse:n=>xa.test(n)?xa.parse(n):Dl.test(n)?Dl.parse(n):jv.parse(n),transform:n=>typeof n=="string"?n:n.hasOwnProperty("red")?xa.transform(n):Dl.transform(n),getAnimatableNone:n=>{const e=cn.parse(n);return e.alpha=0,cn.transform(e)}},Npe=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu;function Ipe(n){var e,t;return isNaN(n)&&typeof n=="string"&&(((e=n.match(MS))==null?void 0:e.length)||0)+(((t=n.match(Npe))==null?void 0:t.length)||0)>0}const fP="number",mP="color",$pe="var",Epe="var(",h$="${}",Rpe=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function Xc(n){const e=n.toString(),t=[],s={color:[],number:[],var:[]},r=[];let o=0;const a=e.replace(Rpe,l=>(cn.test(l)?(s.color.push(o),r.push(mP),t.push(cn.parse(l))):l.startsWith(Epe)?(s.var.push(o),r.push($pe),t.push(l)):(s.number.push(o),r.push(fP),t.push(parseFloat(l))),++o,h$)).split(h$);return{values:t,split:a,indexes:s,types:r}}function gP(n){return Xc(n).values}function yP(n){const{split:e,types:t}=Xc(n),s=e.length;return r=>{let o="";for(let i=0;i<s;i++)if(o+=e[i],r[i]!==void 0){const a=t[i];a===fP?o+=Nc(r[i]):a===mP?o+=cn.transform(r[i]):o+=r[i]}return o}}const Dpe=n=>typeof n=="number"?0:cn.test(n)?cn.getAnimatableNone(n):n;function Ape(n){const e=gP(n);return yP(n)(e.map(Dpe))}const Ai={test:Ipe,parse:gP,createTransformer:yP,getAnimatableNone:Ape};function Ex(n,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?n+(e-n)*6*t:t<1/2?e:t<2/3?n+(e-n)*(2/3-t)*6:n}function Ope({hue:n,saturation:e,lightness:t,alpha:s}){n/=360,e/=100,t/=100;let r=0,o=0,i=0;if(!e)r=o=i=t;else{const a=t<.5?t*(1+e):t+e-t*e,l=2*t-a;r=Ex(l,a,n+1/3),o=Ex(l,a,n),i=Ex(l,a,n-1/3)}return{red:Math.round(r*255),green:Math.round(o*255),blue:Math.round(i*255),alpha:s}}function em(n,e){return t=>t>0?e:n}const Gt=(n,e,t)=>n+(e-n)*t,Rx=(n,e,t)=>{const s=n*n,r=t*(e*e-s)+s;return r<0?0:Math.sqrt(r)},_pe=[jv,xa,Dl],Fpe=n=>_pe.find(e=>e.test(n));function d$(n){const e=Fpe(n);if(!e)return!1;let t=e.parse(n);return e===Dl&&(t=Ope(t)),t}const p$=(n,e)=>{const t=d$(n),s=d$(e);if(!t||!s)return em(n,e);const r={...t};return o=>(r.red=Rx(t.red,s.red,o),r.green=Rx(t.green,s.green,o),r.blue=Rx(t.blue,s.blue,o),r.alpha=Gt(t.alpha,s.alpha,o),xa.transform(r))},Hv=new Set(["none","hidden"]);function Ppe(n,e){return Hv.has(n)?t=>t<=0?n:e:t=>t>=1?e:n}function Lpe(n,e){return t=>Gt(n,e,t)}function VS(n){return typeof n=="number"?Lpe:typeof n=="string"?LS(n)?em:cn.test(n)?p$:Vpe:Array.isArray(n)?xP:typeof n=="object"?cn.test(n)?p$:Mpe:em}function xP(n,e){const t=[...n],s=t.length,r=n.map((o,i)=>VS(o)(o,e[i]));return o=>{for(let i=0;i<s;i++)t[i]=r[i](o);return t}}function Mpe(n,e){const t={...n,...e},s={};for(const r in t)n[r]!==void 0&&e[r]!==void 0&&(s[r]=VS(n[r])(n[r],e[r]));return r=>{for(const o in s)t[o]=s[o](r);return t}}function zpe(n,e){const t=[],s={color:0,var:0,number:0};for(let r=0;r<e.values.length;r++){const o=e.types[r],i=n.indexes[o][s[o]],a=n.values[i]??0;t[r]=a,s[o]++}return t}const Vpe=(n,e)=>{const t=Ai.createTransformer(e),s=Xc(n),r=Xc(e);return s.indexes.var.length===r.indexes.var.length&&s.indexes.color.length===r.indexes.color.length&&s.indexes.number.length>=r.indexes.number.length?Hv.has(n)&&!r.values.length||Hv.has(e)&&!s.values.length?Ppe(n,e):Sd(xP(zpe(s,r),r.values),t):em(n,e)};function vP(n,e,t){return typeof n=="number"&&typeof e=="number"&&typeof t=="number"?Gt(n,e,t):VS(n)(n,e)}const Bpe=n=>{const e=({timestamp:t})=>n(t);return{start:(t=!0)=>Et.update(e,t),stop:()=>Di(e),now:()=>Gn.isProcessing?Gn.timestamp:ds.now()}},wP=(n,e,t=10)=>{let s="";const r=Math.max(Math.round(e/t),2);for(let o=0;o<r;o++)s+=Math.round(n(o/(r-1))*1e4)/1e4+", ";return`linear(${s.substring(0,s.length-2)})`},tm=2e4;function BS(n){let e=0;const t=50;let s=n.next(e);for(;!s.done&&e<tm;)e+=t,s=n.next(e);return e>=tm?1/0:e}function Wpe(n,e=100,t){const s=t({...n,keyframes:[0,e]}),r=Math.min(BS(s),tm);return{type:"keyframes",ease:o=>s.next(r*o).value/e,duration:ur(r)}}const Upe=5;function bP(n,e,t){const s=Math.max(e-Upe,0);return JF(t-n(s),e-s)}const Yt={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1},Dx=.001;function Gpe({duration:n=Yt.duration,bounce:e=Yt.bounce,velocity:t=Yt.velocity,mass:s=Yt.mass}){let r,o,i=1-e;i=co(Yt.minDamping,Yt.maxDamping,i),n=co(Yt.minDuration,Yt.maxDuration,ur(n)),i<1?(r=u=>{const h=u*i,p=h*n,f=h-t,m=Kv(u,i),y=Math.exp(-p);return Dx-f/m*y},o=u=>{const p=u*i*n,f=p*t+t,m=Math.pow(i,2)*Math.pow(u,2)*n,y=Math.exp(-p),x=Kv(Math.pow(u,2),i);return(-r(u)+Dx>0?-1:1)*((f-m)*y)/x}):(r=u=>{const h=Math.exp(-u*n),p=(u-t)*n+1;return-Dx+h*p},o=u=>{const h=Math.exp(-u*n),p=(t-u)*(n*n);return h*p});const a=5/n,l=Hpe(r,o,a);if(n=ro(n),isNaN(l))return{stiffness:Yt.stiffness,damping:Yt.damping,duration:n};{const u=Math.pow(l,2)*s;return{stiffness:u,damping:i*2*Math.sqrt(s*u),duration:n}}}const jpe=12;function Hpe(n,e,t){let s=t;for(let r=1;r<jpe;r++)s=s-n(s)/e(s);return s}function Kv(n,e){return n*Math.sqrt(1-e*e)}const Kpe=["duration","bounce"],qpe=["stiffness","damping","mass"];function f$(n,e){return e.some(t=>n[t]!==void 0)}function Xpe(n){let e={velocity:Yt.velocity,stiffness:Yt.stiffness,damping:Yt.damping,mass:Yt.mass,isResolvedFromDuration:!1,...n};if(!f$(n,qpe)&&f$(n,Kpe))if(n.visualDuration){const t=n.visualDuration,s=2*Math.PI/(t*1.2),r=s*s,o=2*co(.05,1,1-(n.bounce||0))*Math.sqrt(r);e={...e,mass:Yt.mass,stiffness:r,damping:o}}else{const t=Gpe(n);e={...e,...t,mass:Yt.mass},e.isResolvedFromDuration=!0}return e}function nm(n=Yt.visualDuration,e=Yt.bounce){const t=typeof n!="object"?{visualDuration:n,keyframes:[0,1],bounce:e}:n;let{restSpeed:s,restDelta:r}=t;const o=t.keyframes[0],i=t.keyframes[t.keyframes.length-1],a={done:!1,value:o},{stiffness:l,damping:u,mass:h,duration:p,velocity:f,isResolvedFromDuration:m}=Xpe({...t,velocity:-ur(t.velocity||0)}),y=f||0,x=u/(2*Math.sqrt(l*h)),v=i-o,w=ur(Math.sqrt(l/h)),S=Math.abs(v)<5;s||(s=S?Yt.restSpeed.granular:Yt.restSpeed.default),r||(r=S?Yt.restDelta.granular:Yt.restDelta.default);let k;if(x<1){const I=Kv(w,x);k=E=>{const D=Math.exp(-x*w*E);return i-D*((y+x*w*v)/I*Math.sin(I*E)+v*Math.cos(I*E))}}else if(x===1)k=I=>i-Math.exp(-w*I)*(v+(y+w*v)*I);else{const I=w*Math.sqrt(x*x-1);k=E=>{const D=Math.exp(-x*w*E),O=Math.min(I*E,300);return i-D*((y+x*w*v)*Math.sinh(O)+I*v*Math.cosh(O))/I}}const T={calculatedDuration:m&&p||null,next:I=>{const E=k(I);if(m)a.done=I>=p;else{let D=I===0?y:0;x<1&&(D=I===0?ro(y):bP(k,I,E));const O=Math.abs(D)<=s,_=Math.abs(i-E)<=r;a.done=O&&_}return a.value=a.done?i:E,a},toString:()=>{const I=Math.min(BS(T),tm),E=wP(D=>T.next(I*D).value,I,30);return I+"ms "+E},toTransition:()=>{}};return T}nm.applyToOptions=n=>{const e=Wpe(n,100,nm);return n.ease=e.ease,n.duration=ro(e.duration),n.type="keyframes",n};function qv({keyframes:n,velocity:e=0,power:t=.8,timeConstant:s=325,bounceDamping:r=10,bounceStiffness:o=500,modifyTarget:i,min:a,max:l,restDelta:u=.5,restSpeed:h}){const p=n[0],f={done:!1,value:p},m=O=>a!==void 0&&O<a||l!==void 0&&O>l,y=O=>a===void 0?l:l===void 0||Math.abs(a-O)<Math.abs(l-O)?a:l;let x=t*e;const v=p+x,w=i===void 0?v:i(v);w!==v&&(x=w-p);const S=O=>-x*Math.exp(-O/s),k=O=>w+S(O),T=O=>{const _=S(O),P=k(O);f.done=Math.abs(_)<=u,f.value=f.done?w:P};let I,E;const D=O=>{m(f.value)&&(I=O,E=nm({keyframes:[f.value,y(f.value)],velocity:bP(k,O,f.value),damping:r,stiffness:o,restDelta:u,restSpeed:h}))};return D(0),{calculatedDuration:null,next:O=>{let _=!1;return!E&&I===void 0&&(_=!0,T(O),D(O)),I!==void 0&&O>=I?E.next(O-I):(!_&&T(O),f)}}}function Ype(n,e,t){const s=[],r=t||Fo.mix||vP,o=n.length-1;for(let i=0;i<o;i++){let a=r(n[i],n[i+1]);if(e){const l=Array.isArray(e)?e[i]||dr:e;a=Sd(l,a)}s.push(a)}return s}function Qpe(n,e,{clamp:t=!0,ease:s,mixer:r}={}){const o=n.length;if(AS(o===e.length),o===1)return()=>e[0];if(o===2&&e[0]===e[1])return()=>e[1];const i=n[0]===n[1];n[0]>n[o-1]&&(n=[...n].reverse(),e=[...e].reverse());const a=Ype(e,s,r),l=a.length,u=h=>{if(i&&h<n[0])return e[0];let p=0;if(l>1)for(;p<n.length-2&&!(h<n[p+1]);p++);const f=Kc(n[p],n[p+1],h);return a[p](f)};return t?h=>u(co(n[0],n[o-1],h)):u}function Zpe(n,e){const t=n[n.length-1];for(let s=1;s<=e;s++){const r=Kc(0,e,s);n.push(Gt(t,1,r))}}function Jpe(n){const e=[0];return Zpe(e,n.length-1),e}function efe(n,e){return n.map(t=>t*e)}function tfe(n,e){return n.map(()=>e||lP).splice(0,n.length-1)}function Ic({duration:n=300,keyframes:e,times:t,ease:s="easeInOut"}){const r=dpe(s)?s.map(l$):l$(s),o={done:!1,value:e[0]},i=efe(t&&t.length===e.length?t:Jpe(e),n),a=Qpe(i,e,{ease:Array.isArray(r)?r:tfe(e,r)});return{calculatedDuration:n,next:l=>(o.value=a(l),o.done=l>=n,o)}}const nfe=n=>n!==null;function WS(n,{repeat:e,repeatType:t="loop"},s,r=1){const o=n.filter(nfe),a=r<0||e&&t!=="loop"&&e%2===1?0:o.length-1;return!a||s===void 0?o[a]:s}const sfe={decay:qv,inertia:qv,tween:Ic,keyframes:Ic,spring:nm};function SP(n){typeof n.type=="string"&&(n.type=sfe[n.type])}class US{constructor(){this.updateFinished()}get finished(){return this._finished}updateFinished(){this._finished=new Promise(e=>{this.resolve=e})}notifyFinished(){this.resolve()}then(e,t){return this.finished.then(e,t)}}const rfe=n=>n/100;class GS extends US{constructor(e){super(),this.state="idle",this.startTime=null,this.isStopped=!1,this.currentTime=0,this.holdTime=null,this.playbackSpeed=1,this.stop=()=>{var s,r;const{motionValue:t}=this.options;t&&t.updatedAt!==ds.now()&&this.tick(ds.now()),this.isStopped=!0,this.state!=="idle"&&(this.teardown(),(r=(s=this.options).onStop)==null||r.call(s))},this.options=e,this.initAnimation(),this.play(),e.autoplay===!1&&this.pause()}initAnimation(){const{options:e}=this;SP(e);const{type:t=Ic,repeat:s=0,repeatDelay:r=0,repeatType:o,velocity:i=0}=e;let{keyframes:a}=e;const l=t||Ic;l!==Ic&&typeof a[0]!="number"&&(this.mixKeyframes=Sd(rfe,vP(a[0],a[1])),a=[0,100]);const u=l({...e,keyframes:a});o==="mirror"&&(this.mirroredGenerator=l({...e,keyframes:[...a].reverse(),velocity:-i})),u.calculatedDuration===null&&(u.calculatedDuration=BS(u));const{calculatedDuration:h}=u;this.calculatedDuration=h,this.resolvedDuration=h+r,this.totalDuration=this.resolvedDuration*(s+1)-r,this.generator=u}updateTime(e){const t=Math.round(e-this.startTime)*this.playbackSpeed;this.holdTime!==null?this.currentTime=this.holdTime:this.currentTime=t}tick(e,t=!1){const{generator:s,totalDuration:r,mixKeyframes:o,mirroredGenerator:i,resolvedDuration:a,calculatedDuration:l}=this;if(this.startTime===null)return s.next(0);const{delay:u=0,keyframes:h,repeat:p,repeatType:f,repeatDelay:m,type:y,onUpdate:x,finalKeyframe:v}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,e):this.speed<0&&(this.startTime=Math.min(e-r/this.speed,this.startTime)),t?this.currentTime=e:this.updateTime(e);const w=this.currentTime-u*(this.playbackSpeed>=0?1:-1),S=this.playbackSpeed>=0?w<0:w>r;this.currentTime=Math.max(w,0),this.state==="finished"&&this.holdTime===null&&(this.currentTime=r);let k=this.currentTime,T=s;if(p){const O=Math.min(this.currentTime,r)/a;let _=Math.floor(O),P=O%1;!P&&O>=1&&(P=1),P===1&&_--,_=Math.min(_,p+1),!!(_%2)&&(f==="reverse"?(P=1-P,m&&(P-=m/a)):f==="mirror"&&(T=i)),k=co(0,1,P)*a}const I=S?{done:!1,value:h[0]}:T.next(k);o&&(I.value=o(I.value));let{done:E}=I;!S&&l!==null&&(E=this.playbackSpeed>=0?this.currentTime>=r:this.currentTime<=0);const D=this.holdTime===null&&(this.state==="finished"||this.state==="running"&&E);return D&&y!==qv&&(I.value=WS(h,this.options,v,this.speed)),x&&x(I.value),D&&this.finish(),I}then(e,t){return this.finished.then(e,t)}get duration(){return ur(this.calculatedDuration)}get iterationDuration(){const{delay:e=0}=this.options||{};return this.duration+ur(e)}get time(){return ur(this.currentTime)}set time(e){var t;e=ro(e),this.currentTime=e,this.startTime===null||this.holdTime!==null||this.playbackSpeed===0?this.holdTime=e:this.driver&&(this.startTime=this.driver.now()-e/this.playbackSpeed),(t=this.driver)==null||t.start(!1)}get speed(){return this.playbackSpeed}set speed(e){this.updateTime(ds.now());const t=this.playbackSpeed!==e;this.playbackSpeed=e,t&&(this.time=ur(this.currentTime))}play(){var r,o;if(this.isStopped)return;const{driver:e=Bpe,startTime:t}=this.options;this.driver||(this.driver=e(i=>this.tick(i))),(o=(r=this.options).onPlay)==null||o.call(r);const s=this.driver.now();this.state==="finished"?(this.updateFinished(),this.startTime=s):this.holdTime!==null?this.startTime=s-this.holdTime:this.startTime||(this.startTime=t??s),this.state==="finished"&&this.speed<0&&(this.startTime+=this.calculatedDuration),this.holdTime=null,this.state="running",this.driver.start()}pause(){this.state="paused",this.updateTime(ds.now()),this.holdTime=this.currentTime}complete(){this.state!=="running"&&this.play(),this.state="finished",this.holdTime=null}finish(){var e,t;this.notifyFinished(),this.teardown(),this.state="finished",(t=(e=this.options).onComplete)==null||t.call(e)}cancel(){var e,t;this.holdTime=null,this.startTime=0,this.tick(0),this.teardown(),(t=(e=this.options).onCancel)==null||t.call(e)}teardown(){this.state="idle",this.stopDriver(),this.startTime=this.holdTime=null}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(e){return this.startTime=0,this.tick(e,!0)}attachTimeline(e){var t;return this.options.allowFlatten&&(this.options.type="keyframes",this.options.ease="linear",this.initAnimation()),(t=this.driver)==null||t.stop(),e.observe(this)}}function ofe(n){for(let e=1;e<n.length;e++)n[e]??(n[e]=n[e-1])}const va=n=>n*180/Math.PI,Xv=n=>{const e=va(Math.atan2(n[1],n[0]));return Yv(e)},ife={x:4,y:5,translateX:4,translateY:5,scaleX:0,scaleY:3,scale:n=>(Math.abs(n[0])+Math.abs(n[3]))/2,rotate:Xv,rotateZ:Xv,skewX:n=>va(Math.atan(n[1])),skewY:n=>va(Math.atan(n[2])),skew:n=>(Math.abs(n[1])+Math.abs(n[2]))/2},Yv=n=>(n=n%360,n<0&&(n+=360),n),m$=Xv,g$=n=>Math.sqrt(n[0]*n[0]+n[1]*n[1]),y$=n=>Math.sqrt(n[4]*n[4]+n[5]*n[5]),afe={x:12,y:13,z:14,translateX:12,translateY:13,translateZ:14,scaleX:g$,scaleY:y$,scale:n=>(g$(n)+y$(n))/2,rotateX:n=>Yv(va(Math.atan2(n[6],n[5]))),rotateY:n=>Yv(va(Math.atan2(-n[2],n[0]))),rotateZ:m$,rotate:m$,skewX:n=>va(Math.atan(n[4])),skewY:n=>va(Math.atan(n[1])),skew:n=>(Math.abs(n[1])+Math.abs(n[4]))/2};function Qv(n){return n.includes("scale")?1:0}function Zv(n,e){if(!n||n==="none")return Qv(e);const t=n.match(/^matrix3d\(([-\d.e\s,]+)\)$/u);let s,r;if(t)s=afe,r=t;else{const a=n.match(/^matrix\(([-\d.e\s,]+)\)$/u);s=ife,r=a}if(!r)return Qv(e);const o=s[e],i=r[1].split(",").map(ufe);return typeof o=="function"?o(i):i[o]}const lfe=(n,e)=>{const{transform:t="none"}=getComputedStyle(n);return Zv(t,e)};function ufe(n){return parseFloat(n.trim())}const Nu=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],Iu=new Set(Nu),x$=n=>n===Tu||n===Le,cfe=new Set(["x","y","z"]),hfe=Nu.filter(n=>!cfe.has(n));function dfe(n){const e=[];return hfe.forEach(t=>{const s=n.getValue(t);s!==void 0&&(e.push([t,s.get()]),s.set(t.startsWith("scale")?1:0))}),e}const fi={width:({x:n},{paddingLeft:e="0",paddingRight:t="0"})=>n.max-n.min-parseFloat(e)-parseFloat(t),height:({y:n},{paddingTop:e="0",paddingBottom:t="0"})=>n.max-n.min-parseFloat(e)-parseFloat(t),top:(n,{top:e})=>parseFloat(e),left:(n,{left:e})=>parseFloat(e),bottom:({y:n},{top:e})=>parseFloat(e)+(n.max-n.min),right:({x:n},{left:e})=>parseFloat(e)+(n.max-n.min),x:(n,{transform:e})=>Zv(e,"x"),y:(n,{transform:e})=>Zv(e,"y")};fi.translateX=fi.x;fi.translateY=fi.y;const Sa=new Set;let Jv=!1,ew=!1,tw=!1;function CP(){if(ew){const n=Array.from(Sa).filter(s=>s.needsMeasurement),e=new Set(n.map(s=>s.element)),t=new Map;e.forEach(s=>{const r=dfe(s);r.length&&(t.set(s,r),s.render())}),n.forEach(s=>s.measureInitialState()),e.forEach(s=>{s.render();const r=t.get(s);r&&r.forEach(([o,i])=>{var a;(a=s.getValue(o))==null||a.set(i)})}),n.forEach(s=>s.measureEndState()),n.forEach(s=>{s.suspendedScrollY!==void 0&&window.scrollTo(0,s.suspendedScrollY)})}ew=!1,Jv=!1,Sa.forEach(n=>n.complete(tw)),Sa.clear()}function kP(){Sa.forEach(n=>{n.readKeyframes(),n.needsMeasurement&&(ew=!0)})}function pfe(){tw=!0,kP(),CP(),tw=!1}class jS{constructor(e,t,s,r,o,i=!1){this.state="pending",this.isAsync=!1,this.needsMeasurement=!1,this.unresolvedKeyframes=[...e],this.onComplete=t,this.name=s,this.motionValue=r,this.element=o,this.isAsync=i}scheduleResolve(){this.state="scheduled",this.isAsync?(Sa.add(this),Jv||(Jv=!0,Et.read(kP),Et.resolveKeyframes(CP))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:e,name:t,element:s,motionValue:r}=this;if(e[0]===null){const o=r==null?void 0:r.get(),i=e[e.length-1];if(o!==void 0)e[0]=o;else if(s&&t){const a=s.readValue(t,i);a!=null&&(e[0]=a)}e[0]===void 0&&(e[0]=i),r&&o===void 0&&r.set(e[0])}ofe(e)}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(e=!1){this.state="complete",this.onComplete(this.unresolvedKeyframes,this.finalKeyframe,e),Sa.delete(this)}cancel(){this.state==="scheduled"&&(Sa.delete(this),this.state="pending")}resume(){this.state==="pending"&&this.scheduleResolve()}}const ffe=n=>n.startsWith("--");function mfe(n,e,t){ffe(e)?n.style.setProperty(e,t):n.style[e]=t}const gfe=OS(()=>window.ScrollTimeline!==void 0),yfe={};function xfe(n,e){const t=OS(n);return()=>yfe[e]??t()}const TP=xfe(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch{return!1}return!0},"linearEasing"),kc=([n,e,t,s])=>`cubic-bezier(${n}, ${e}, ${t}, ${s})`,v$={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:kc([0,.65,.55,1]),circOut:kc([.55,0,1,.45]),backIn:kc([.31,.01,.66,-.59]),backOut:kc([.33,1.53,.69,.99])};function NP(n,e){if(n)return typeof n=="function"?TP()?wP(n,e):"ease-out":uP(n)?kc(n):Array.isArray(n)?n.map(t=>NP(t,e)||v$.easeOut):v$[n]}function vfe(n,e,t,{delay:s=0,duration:r=300,repeat:o=0,repeatType:i="loop",ease:a="easeOut",times:l}={},u=void 0){const h={[e]:t};l&&(h.offset=l);const p=NP(a,r);Array.isArray(p)&&(h.easing=p);const f={delay:s,duration:r,easing:Array.isArray(p)?"linear":p,fill:"both",iterations:o+1,direction:i==="reverse"?"alternate":"normal"};return u&&(f.pseudoElement=u),n.animate(h,f)}function IP(n){return typeof n=="function"&&"applyToOptions"in n}function wfe({type:n,...e}){return IP(n)&&TP()?n.applyToOptions(e):(e.duration??(e.duration=300),e.ease??(e.ease="easeOut"),e)}class bfe extends US{constructor(e){if(super(),this.finishedTime=null,this.isStopped=!1,this.manualStartTime=null,!e)return;const{element:t,name:s,keyframes:r,pseudoElement:o,allowFlatten:i=!1,finalKeyframe:a,onComplete:l}=e;this.isPseudoElement=!!o,this.allowFlatten=i,this.options=e,AS(typeof e.type!="string");const u=wfe(e);this.animation=vfe(t,s,r,u,o),u.autoplay===!1&&this.animation.pause(),this.animation.onfinish=()=>{if(this.finishedTime=this.time,!o){const h=WS(r,this.options,a,this.speed);this.updateMotionValue?this.updateMotionValue(h):mfe(t,s,h),this.animation.cancel()}l==null||l(),this.notifyFinished()}}play(){this.isStopped||(this.manualStartTime=null,this.animation.play(),this.state==="finished"&&this.updateFinished())}pause(){this.animation.pause()}complete(){var e,t;(t=(e=this.animation).finish)==null||t.call(e)}cancel(){try{this.animation.cancel()}catch{}}stop(){if(this.isStopped)return;this.isStopped=!0;const{state:e}=this;e==="idle"||e==="finished"||(this.updateMotionValue?this.updateMotionValue():this.commitStyles(),this.isPseudoElement||this.cancel())}commitStyles(){var t,s,r;const e=(t=this.options)==null?void 0:t.element;!this.isPseudoElement&&(e!=null&&e.isConnected)&&((r=(s=this.animation).commitStyles)==null||r.call(s))}get duration(){var t,s;const e=((s=(t=this.animation.effect)==null?void 0:t.getComputedTiming)==null?void 0:s.call(t).duration)||0;return ur(Number(e))}get iterationDuration(){const{delay:e=0}=this.options||{};return this.duration+ur(e)}get time(){return ur(Number(this.animation.currentTime)||0)}set time(e){this.manualStartTime=null,this.finishedTime=null,this.animation.currentTime=ro(e)}get speed(){return this.animation.playbackRate}set speed(e){e<0&&(this.finishedTime=null),this.animation.playbackRate=e}get state(){return this.finishedTime!==null?"finished":this.animation.playState}get startTime(){return this.manualStartTime??Number(this.animation.startTime)}set startTime(e){this.manualStartTime=this.animation.startTime=e}attachTimeline({timeline:e,observe:t}){var s;return this.allowFlatten&&((s=this.animation.effect)==null||s.updateTiming({easing:"linear"})),this.animation.onfinish=null,e&&gfe()?(this.animation.timeline=e,dr):t(this)}}const $P={anticipate:oP,backInOut:rP,circInOut:aP};function Sfe(n){return n in $P}function Cfe(n){typeof n.ease=="string"&&Sfe(n.ease)&&(n.ease=$P[n.ease])}const Ax=10;class kfe extends bfe{constructor(e){Cfe(e),SP(e),super(e),e.startTime!==void 0&&(this.startTime=e.startTime),this.options=e}updateMotionValue(e){const{motionValue:t,onUpdate:s,onComplete:r,element:o,...i}=this.options;if(!t)return;if(e!==void 0){t.set(e);return}const a=new GS({...i,autoplay:!1}),l=Math.max(Ax,ds.now()-this.startTime),u=co(0,Ax,l-Ax);t.setWithVelocity(a.sample(Math.max(0,l-u)).value,a.sample(l).value,u),a.stop()}}const w$=(n,e)=>e==="zIndex"?!1:!!(typeof n=="number"||Array.isArray(n)||typeof n=="string"&&(Ai.test(n)||n==="0")&&!n.startsWith("url("));function Tfe(n){const e=n[0];if(n.length===1)return!0;for(let t=0;t<n.length;t++)if(n[t]!==e)return!0}function Nfe(n,e,t,s){const r=n[0];if(r===null)return!1;if(e==="display"||e==="visibility")return!0;const o=n[n.length-1],i=w$(r,e),a=w$(o,e);return!i||!a?!1:Tfe(n)||(t==="spring"||IP(t))&&s}function nw(n){n.duration=0,n.type="keyframes"}const Ife=new Set(["opacity","clipPath","filter","transform"]),$fe=OS(()=>Object.hasOwnProperty.call(Element.prototype,"animate"));function Efe(n){var h;const{motionValue:e,name:t,repeatDelay:s,repeatType:r,damping:o,type:i}=n;if(!(((h=e==null?void 0:e.owner)==null?void 0:h.current)instanceof HTMLElement))return!1;const{onUpdate:l,transformTemplate:u}=e.owner.getProps();return $fe()&&t&&Ife.has(t)&&(t!=="transform"||!u)&&!l&&!s&&r!=="mirror"&&o!==0&&i!=="inertia"}const Rfe=40;class Dfe extends US{constructor({autoplay:e=!0,delay:t=0,type:s="keyframes",repeat:r=0,repeatDelay:o=0,repeatType:i="loop",keyframes:a,name:l,motionValue:u,element:h,...p}){var y;super(),this.stop=()=>{var x,v;this._animation&&(this._animation.stop(),(x=this.stopTimeline)==null||x.call(this)),(v=this.keyframeResolver)==null||v.cancel()},this.createdAt=ds.now();const f={autoplay:e,delay:t,type:s,repeat:r,repeatDelay:o,repeatType:i,name:l,motionValue:u,element:h,...p},m=(h==null?void 0:h.KeyframeResolver)||jS;this.keyframeResolver=new m(a,(x,v,w)=>this.onKeyframesResolved(x,v,f,!w),l,u,h),(y=this.keyframeResolver)==null||y.scheduleResolve()}onKeyframesResolved(e,t,s,r){var v,w;this.keyframeResolver=void 0;const{name:o,type:i,velocity:a,delay:l,isHandoff:u,onUpdate:h}=s;this.resolvedAt=ds.now(),Nfe(e,o,i,a)||((Fo.instantAnimations||!l)&&(h==null||h(WS(e,s,t))),e[0]=e[e.length-1],nw(s),s.repeat=0);const f={startTime:r?this.resolvedAt?this.resolvedAt-this.createdAt>Rfe?this.resolvedAt:this.createdAt:this.createdAt:void 0,finalKeyframe:t,...s,keyframes:e},m=!u&&Efe(f),y=(w=(v=f.motionValue)==null?void 0:v.owner)==null?void 0:w.current,x=m?new kfe({...f,element:y}):new GS(f);x.finished.then(()=>{this.notifyFinished()}).catch(dr),this.pendingTimeline&&(this.stopTimeline=x.attachTimeline(this.pendingTimeline),this.pendingTimeline=void 0),this._animation=x}get finished(){return this._animation?this.animation.finished:this._finished}then(e,t){return this.finished.finally(e).then(()=>{})}get animation(){var e;return this._animation||((e=this.keyframeResolver)==null||e.resume(),pfe()),this._animation}get duration(){return this.animation.duration}get iterationDuration(){return this.animation.iterationDuration}get time(){return this.animation.time}set time(e){this.animation.time=e}get speed(){return this.animation.speed}get state(){return this.animation.state}set speed(e){this.animation.speed=e}get startTime(){return this.animation.startTime}attachTimeline(e){return this._animation?this.stopTimeline=this.animation.attachTimeline(e):this.pendingTimeline=e,()=>this.stop()}play(){this.animation.play()}pause(){this.animation.pause()}complete(){this.animation.complete()}cancel(){var e;this._animation&&this.animation.cancel(),(e=this.keyframeResolver)==null||e.cancel()}}function EP(n,e,t,s=0,r=1){const o=Array.from(n).sort((u,h)=>u.sortNodePosition(h)).indexOf(e),i=n.size,a=(i-1)*s;return typeof t=="function"?t(o,i):r===1?o*s:a-o*s}const Afe=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function Ofe(n){const e=Afe.exec(n);if(!e)return[,];const[,t,s,r]=e;return[`--${t??s}`,r]}function RP(n,e,t=1){const[s,r]=Ofe(n);if(!s)return;const o=window.getComputedStyle(e).getPropertyValue(s);if(o){const i=o.trim();return YF(i)?parseFloat(i):i}return LS(r)?RP(r,e,t+1):r}const _fe={type:"spring",stiffness:500,damping:25,restSpeed:10},Ffe=n=>({type:"spring",stiffness:550,damping:n===0?2*Math.sqrt(550):30,restSpeed:10}),Pfe={type:"keyframes",duration:.8},Lfe={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},Mfe=(n,{keyframes:e})=>e.length>2?Pfe:Iu.has(n)?n.startsWith("scale")?Ffe(e[1]):_fe:Lfe,zfe=n=>n!==null;function Vfe(n,{repeat:e,repeatType:t="loop"},s){const r=n.filter(zfe),o=e&&t!=="loop"&&e%2===1?0:r.length-1;return r[o]}function DP(n,e){if(n!=null&&n.inherit&&e){const{inherit:t,...s}=n;return{...e,...s}}return n}function HS(n,e){const t=(n==null?void 0:n[e])??(n==null?void 0:n.default)??n;return t!==n?DP(t,n):t}function Bfe({when:n,delay:e,delayChildren:t,staggerChildren:s,staggerDirection:r,repeat:o,repeatType:i,repeatDelay:a,from:l,elapsed:u,...h}){return!!Object.keys(h).length}const KS=(n,e,t,s={},r,o)=>i=>{const a=HS(s,n)||{},l=a.delay||s.delay||0;let{elapsed:u=0}=s;u=u-ro(l);const h={keyframes:Array.isArray(t)?t:[null,t],ease:"easeOut",velocity:e.getVelocity(),...a,delay:-u,onUpdate:f=>{e.set(f),a.onUpdate&&a.onUpdate(f)},onComplete:()=>{i(),a.onComplete&&a.onComplete()},name:n,motionValue:e,element:o?void 0:r};Bfe(a)||Object.assign(h,Mfe(n,h)),h.duration&&(h.duration=ro(h.duration)),h.repeatDelay&&(h.repeatDelay=ro(h.repeatDelay)),h.from!==void 0&&(h.keyframes[0]=h.from);let p=!1;if((h.type===!1||h.duration===0&&!h.repeatDelay)&&(nw(h),h.delay===0&&(p=!0)),(Fo.instantAnimations||Fo.skipAnimations||r!=null&&r.shouldSkipAnimations)&&(p=!0,nw(h),h.delay=0),h.allowFlatten=!a.type&&!a.ease,p&&!o&&e.get()!==void 0){const f=Vfe(h.keyframes,a);if(f!==void 0){Et.update(()=>{h.onUpdate(f),h.onComplete()});return}}return a.isSync?new GS(h):new Dfe(h)};function b$(n){const e=[{},{}];return n==null||n.values.forEach((t,s)=>{e[0][s]=t.get(),e[1][s]=t.getVelocity()}),e}function qS(n,e,t,s){if(typeof e=="function"){const[r,o]=b$(s);e=e(t!==void 0?t:n.custom,r,o)}if(typeof e=="string"&&(e=n.variants&&n.variants[e]),typeof e=="function"){const[r,o]=b$(s);e=e(t!==void 0?t:n.custom,r,o)}return e}function Gl(n,e,t){const s=n.getProps();return qS(s,e,t!==void 0?t:s.custom,n)}const AP=new Set(["width","height","top","left","right","bottom",...Nu]),S$=30,Wfe=n=>!isNaN(parseFloat(n));class Ufe{constructor(e,t={}){this.canTrackVelocity=null,this.events={},this.updateAndNotify=s=>{var o;const r=ds.now();if(this.updatedAt!==r&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(s),this.current!==this.prev&&((o=this.events.change)==null||o.notify(this.current),this.dependents))for(const i of this.dependents)i.dirty()},this.hasAnimated=!1,this.setCurrent(e),this.owner=t.owner}setCurrent(e){this.current=e,this.updatedAt=ds.now(),this.canTrackVelocity===null&&e!==void 0&&(this.canTrackVelocity=Wfe(this.current))}setPrevFrameValue(e=this.current){this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt}onChange(e){return this.on("change",e)}on(e,t){this.events[e]||(this.events[e]=new _S);const s=this.events[e].add(t);return e==="change"?()=>{s(),Et.read(()=>{this.events.change.getSize()||this.stop()})}:s}clearListeners(){for(const e in this.events)this.events[e].clear()}attach(e,t){this.passiveEffect=e,this.stopPassiveEffect=t}set(e){this.passiveEffect?this.passiveEffect(e,this.updateAndNotify):this.updateAndNotify(e)}setWithVelocity(e,t,s){this.set(t),this.prev=void 0,this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt-s}jump(e,t=!0){this.updateAndNotify(e),this.prev=e,this.prevUpdatedAt=this.prevFrameValue=void 0,t&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}dirty(){var e;(e=this.events.change)==null||e.notify(this.current)}addDependent(e){this.dependents||(this.dependents=new Set),this.dependents.add(e)}removeDependent(e){this.dependents&&this.dependents.delete(e)}get(){return this.current}getPrevious(){return this.prev}getVelocity(){const e=ds.now();if(!this.canTrackVelocity||this.prevFrameValue===void 0||e-this.updatedAt>S$)return 0;const t=Math.min(this.updatedAt-this.prevUpdatedAt,S$);return JF(parseFloat(this.current)-parseFloat(this.prevFrameValue),t)}start(e){return this.stop(),new Promise(t=>{this.hasAnimated=!0,this.animation=e(t),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){var e,t;(e=this.dependents)==null||e.clear(),(t=this.events.destroy)==null||t.notify(),this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function ru(n,e){return new Ufe(n,e)}const sw=n=>Array.isArray(n);function Gfe(n,e,t){n.hasValue(e)?n.getValue(e).set(t):n.addValue(e,ru(t))}function jfe(n){return sw(n)?n[n.length-1]||0:n}function Hfe(n,e){const t=Gl(n,e);let{transitionEnd:s={},transition:r={},...o}=t||{};o={...o,...s};for(const i in o){const a=jfe(o[i]);Gfe(n,i,a)}}const ss=n=>!!(n&&n.getVelocity);function Kfe(n){return!!(ss(n)&&n.add)}function rw(n,e){const t=n.getValue("willChange");if(Kfe(t))return t.add(e);if(!t&&Fo.WillChange){const s=new Fo.WillChange("auto");n.addValue("willChange",s),s.add(e)}}function XS(n){return n.replace(/([A-Z])/g,e=>`-${e.toLowerCase()}`)}const qfe="framerAppearId",OP="data-"+XS(qfe);function _P(n){return n.props[OP]}function Xfe({protectedKeys:n,needsAnimating:e},t){const s=n.hasOwnProperty(t)&&e[t]!==!0;return e[t]=!1,s}function FP(n,e,{delay:t=0,transitionOverride:s,type:r}={}){let{transition:o,transitionEnd:i,...a}=e;const l=n.getDefaultTransition();o=o?DP(o,l):l;const u=o==null?void 0:o.reduceMotion;s&&(o=s);const h=[],p=r&&n.animationState&&n.animationState.getState()[r];for(const f in a){const m=n.getValue(f,n.latestValues[f]??null),y=a[f];if(y===void 0||p&&Xfe(p,f))continue;const x={delay:t,...HS(o||{},f)},v=m.get();if(v!==void 0&&!m.isAnimating&&!Array.isArray(y)&&y===v&&!x.velocity)continue;let w=!1;if(window.MotionHandoffAnimation){const T=_P(n);if(T){const I=window.MotionHandoffAnimation(T,f,Et);I!==null&&(x.startTime=I,w=!0)}}rw(n,f);const S=u??n.shouldReduceMotion;m.start(KS(f,m,y,S&&AP.has(f)?{type:!1}:x,n,w));const k=m.animation;k&&h.push(k)}if(i){const f=()=>Et.update(()=>{i&&Hfe(n,i)});h.length?Promise.all(h).then(f):f()}return h}function ow(n,e,t={}){var l;const s=Gl(n,e,t.type==="exit"?(l=n.presenceContext)==null?void 0:l.custom:void 0);let{transition:r=n.getDefaultTransition()||{}}=s||{};t.transitionOverride&&(r=t.transitionOverride);const o=s?()=>Promise.all(FP(n,s,t)):()=>Promise.resolve(),i=n.variantChildren&&n.variantChildren.size?(u=0)=>{const{delayChildren:h=0,staggerChildren:p,staggerDirection:f}=r;return Yfe(n,e,u,h,p,f,t)}:()=>Promise.resolve(),{when:a}=r;if(a){const[u,h]=a==="beforeChildren"?[o,i]:[i,o];return u().then(()=>h())}else return Promise.all([o(),i(t.delay)])}function Yfe(n,e,t=0,s=0,r=0,o=1,i){const a=[];for(const l of n.variantChildren)l.notify("AnimationStart",e),a.push(ow(l,e,{...i,delay:t+(typeof s=="function"?0:s)+EP(n.variantChildren,l,s,r,o)}).then(()=>l.notify("AnimationComplete",e)));return Promise.all(a)}function Qfe(n,e,t={}){n.notify("AnimationStart",e);let s;if(Array.isArray(e)){const r=e.map(o=>ow(n,o,t));s=Promise.all(r)}else if(typeof e=="string")s=ow(n,e,t);else{const r=typeof e=="function"?Gl(n,e,t.custom):e;s=Promise.all(FP(n,r,t))}return s.then(()=>{n.notify("AnimationComplete",e)})}const Zfe={test:n=>n==="auto",parse:n=>n},PP=n=>e=>e.test(n),LP=[Tu,Le,oo,ai,Tpe,kpe,Zfe],C$=n=>LP.find(PP(n));function Jfe(n){return typeof n=="number"?n===0:n!==null?n==="none"||n==="0"||ZF(n):!0}const eme=new Set(["brightness","contrast","saturate","opacity"]);function tme(n){const[e,t]=n.slice(0,-1).split("(");if(e==="drop-shadow")return n;const[s]=t.match(MS)||[];if(!s)return n;const r=t.replace(s,"");let o=eme.has(e)?1:0;return s!==t&&(o*=100),e+"("+o+r+")"}const nme=/\b([a-z-]*)\(.*?\)/gu,iw={...Ai,getAnimatableNone:n=>{const e=n.match(nme);return e?e.map(tme).join(" "):n}},k$={...Tu,transform:Math.round},sme={rotate:ai,rotateX:ai,rotateY:ai,rotateZ:ai,scale:Qp,scaleX:Qp,scaleY:Qp,scaleZ:Qp,skew:ai,skewX:ai,skewY:ai,distance:Le,translateX:Le,translateY:Le,translateZ:Le,x:Le,y:Le,z:Le,perspective:Le,transformPerspective:Le,opacity:qc,originX:c$,originY:c$,originZ:Le},YS={borderWidth:Le,borderTopWidth:Le,borderRightWidth:Le,borderBottomWidth:Le,borderLeftWidth:Le,borderRadius:Le,borderTopLeftRadius:Le,borderTopRightRadius:Le,borderBottomRightRadius:Le,borderBottomLeftRadius:Le,width:Le,maxWidth:Le,height:Le,maxHeight:Le,top:Le,right:Le,bottom:Le,left:Le,inset:Le,insetBlock:Le,insetBlockStart:Le,insetBlockEnd:Le,insetInline:Le,insetInlineStart:Le,insetInlineEnd:Le,padding:Le,paddingTop:Le,paddingRight:Le,paddingBottom:Le,paddingLeft:Le,paddingBlock:Le,paddingBlockStart:Le,paddingBlockEnd:Le,paddingInline:Le,paddingInlineStart:Le,paddingInlineEnd:Le,margin:Le,marginTop:Le,marginRight:Le,marginBottom:Le,marginLeft:Le,marginBlock:Le,marginBlockStart:Le,marginBlockEnd:Le,marginInline:Le,marginInlineStart:Le,marginInlineEnd:Le,fontSize:Le,backgroundPositionX:Le,backgroundPositionY:Le,...sme,zIndex:k$,fillOpacity:qc,strokeOpacity:qc,numOctaves:k$},rme={...YS,color:cn,backgroundColor:cn,outlineColor:cn,fill:cn,stroke:cn,borderColor:cn,borderTopColor:cn,borderRightColor:cn,borderBottomColor:cn,borderLeftColor:cn,filter:iw,WebkitFilter:iw},MP=n=>rme[n];function zP(n,e){let t=MP(n);return t!==iw&&(t=Ai),t.getAnimatableNone?t.getAnimatableNone(e):void 0}const ome=new Set(["auto","none","0"]);function ime(n,e,t){let s=0,r;for(;s<n.length&&!r;){const o=n[s];typeof o=="string"&&!ome.has(o)&&Xc(o).values.length&&(r=n[s]),s++}if(r&&t)for(const o of e)n[o]=zP(t,r)}class ame extends jS{constructor(e,t,s,r,o){super(e,t,s,r,o,!0)}readKeyframes(){const{unresolvedKeyframes:e,element:t,name:s}=this;if(!t||!t.current)return;super.readKeyframes();for(let h=0;h<e.length;h++){let p=e[h];if(typeof p=="string"&&(p=p.trim(),LS(p))){const f=RP(p,t.current);f!==void 0&&(e[h]=f),h===e.length-1&&(this.finalKeyframe=p)}}if(this.resolveNoneKeyframes(),!AP.has(s)||e.length!==2)return;const[r,o]=e,i=C$(r),a=C$(o),l=u$(r),u=u$(o);if(l!==u&&fi[s]){this.needsMeasurement=!0;return}if(i!==a)if(x$(i)&&x$(a))for(let h=0;h<e.length;h++){const p=e[h];typeof p=="string"&&(e[h]=parseFloat(p))}else fi[s]&&(this.needsMeasurement=!0)}resolveNoneKeyframes(){const{unresolvedKeyframes:e,name:t}=this,s=[];for(let r=0;r<e.length;r++)(e[r]===null||Jfe(e[r]))&&s.push(r);s.length&&ime(e,s,t)}measureInitialState(){const{element:e,unresolvedKeyframes:t,name:s}=this;if(!e||!e.current)return;s==="height"&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=fi[s](e.measureViewportBox(),window.getComputedStyle(e.current)),t[0]=this.measuredOrigin;const r=t[t.length-1];r!==void 0&&e.getValue(s,r).jump(r,!1)}measureEndState(){var a;const{element:e,name:t,unresolvedKeyframes:s}=this;if(!e||!e.current)return;const r=e.getValue(t);r&&r.jump(this.measuredOrigin,!1);const o=s.length-1,i=s[o];s[o]=fi[t](e.measureViewportBox(),window.getComputedStyle(e.current)),i!==null&&this.finalKeyframe===void 0&&(this.finalKeyframe=i),(a=this.removedTransforms)!=null&&a.length&&this.removedTransforms.forEach(([l,u])=>{e.getValue(l).set(u)}),this.resolveNoneKeyframes()}}function VP(n,e,t){if(n==null)return[];if(n instanceof EventTarget)return[n];if(typeof n=="string"){let s=document;const r=(t==null?void 0:t[n])??s.querySelectorAll(n);return r?Array.from(r):[]}return Array.from(n).filter(s=>s!=null)}const BP=(n,e)=>e&&typeof n=="number"?e.transform(n):n;function aw(n){return QF(n)&&"offsetHeight"in n}const{schedule:QS}=cP(queueMicrotask,!1),Dr={x:!1,y:!1};function WP(){return Dr.x||Dr.y}function lme(n){return n==="x"||n==="y"?Dr[n]?null:(Dr[n]=!0,()=>{Dr[n]=!1}):Dr.x||Dr.y?null:(Dr.x=Dr.y=!0,()=>{Dr.x=Dr.y=!1})}function UP(n,e){const t=VP(n),s=new AbortController,r={passive:!0,...e,signal:s.signal};return[t,r,()=>s.abort()]}function ume(n){return!(n.pointerType==="touch"||WP())}function cme(n,e,t={}){const[s,r,o]=UP(n,t);return s.forEach(i=>{let a=!1,l=!1,u;const h=()=>{i.removeEventListener("pointerleave",y)},p=v=>{u&&(u(v),u=void 0),h()},f=v=>{a=!1,window.removeEventListener("pointerup",f),window.removeEventListener("pointercancel",f),l&&(l=!1,p(v))},m=()=>{a=!0,window.addEventListener("pointerup",f,r),window.addEventListener("pointercancel",f,r)},y=v=>{if(v.pointerType!=="touch"){if(a){l=!0;return}p(v)}},x=v=>{if(!ume(v))return;l=!1;const w=e(i,v);typeof w=="function"&&(u=w,i.addEventListener("pointerleave",y,r))};i.addEventListener("pointerenter",x,r),i.addEventListener("pointerdown",m,r)}),o}const GP=(n,e)=>e?n===e?!0:GP(n,e.parentElement):!1,ZS=n=>n.pointerType==="mouse"?typeof n.button!="number"||n.button<=0:n.isPrimary!==!1,hme=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]);function dme(n){return hme.has(n.tagName)||n.isContentEditable===!0}const pme=new Set(["INPUT","SELECT","TEXTAREA"]);function fme(n){return pme.has(n.tagName)||n.isContentEditable===!0}const xf=new WeakSet;function T$(n){return e=>{e.key==="Enter"&&n(e)}}function Ox(n,e){n.dispatchEvent(new PointerEvent("pointer"+e,{isPrimary:!0,bubbles:!0}))}const mme=(n,e)=>{const t=n.currentTarget;if(!t)return;const s=T$(()=>{if(xf.has(t))return;Ox(t,"down");const r=T$(()=>{Ox(t,"up")}),o=()=>Ox(t,"cancel");t.addEventListener("keyup",r,e),t.addEventListener("blur",o,e)});t.addEventListener("keydown",s,e),t.addEventListener("blur",()=>t.removeEventListener("keydown",s),e)};function N$(n){return ZS(n)&&!WP()}const I$=new WeakSet;function gme(n,e,t={}){const[s,r,o]=UP(n,t),i=a=>{const l=a.currentTarget;if(!N$(a)||I$.has(a))return;xf.add(l),t.stopPropagation&&I$.add(a);const u=e(l,a),h=(m,y)=>{window.removeEventListener("pointerup",p),window.removeEventListener("pointercancel",f),xf.has(l)&&xf.delete(l),N$(m)&&typeof u=="function"&&u(m,{success:y})},p=m=>{h(m,l===window||l===document||t.useGlobalTarget||GP(l,m.target))},f=m=>{h(m,!1)};window.addEventListener("pointerup",p,r),window.addEventListener("pointercancel",f,r)};return s.forEach(a=>{(t.useGlobalTarget?window:a).addEventListener("pointerdown",i,r),aw(a)&&(a.addEventListener("focus",u=>mme(u,r)),!dme(a)&&!a.hasAttribute("tabindex")&&(a.tabIndex=0))}),o}function JS(n){return QF(n)&&"ownerSVGElement"in n}const vf=new WeakMap;let li;const jP=(n,e,t)=>(s,r)=>r&&r[0]?r[0][n+"Size"]:JS(s)&&"getBBox"in s?s.getBBox()[e]:s[t],yme=jP("inline","width","offsetWidth"),xme=jP("block","height","offsetHeight");function vme({target:n,borderBoxSize:e}){var t;(t=vf.get(n))==null||t.forEach(s=>{s(n,{get width(){return yme(n,e)},get height(){return xme(n,e)}})})}function wme(n){n.forEach(vme)}function bme(){typeof ResizeObserver>"u"||(li=new ResizeObserver(wme))}function Sme(n,e){li||bme();const t=VP(n);return t.forEach(s=>{let r=vf.get(s);r||(r=new Set,vf.set(s,r)),r.add(e),li==null||li.observe(s)}),()=>{t.forEach(s=>{const r=vf.get(s);r==null||r.delete(e),r!=null&&r.size||li==null||li.unobserve(s)})}}const wf=new Set;let Al;function Cme(){Al=()=>{const n={get width(){return window.innerWidth},get height(){return window.innerHeight}};wf.forEach(e=>e(n))},window.addEventListener("resize",Al)}function kme(n){return wf.add(n),Al||Cme(),()=>{wf.delete(n),!wf.size&&typeof Al=="function"&&(window.removeEventListener("resize",Al),Al=void 0)}}function $$(n,e){return typeof n=="function"?kme(n):Sme(n,e)}function Tme(n){return JS(n)&&n.tagName==="svg"}const Nme=[...LP,cn,Ai],Ime=n=>Nme.find(PP(n)),E$=()=>({translate:0,scale:1,origin:0,originPoint:0}),Ol=()=>({x:E$(),y:E$()}),R$=()=>({min:0,max:0}),Sn=()=>({x:R$(),y:R$()}),lw={current:null},HP={current:!1},$me=typeof window<"u";function Eme(){if(HP.current=!0,!!$me)if(window.matchMedia){const n=window.matchMedia("(prefers-reduced-motion)"),e=()=>lw.current=n.matches;n.addEventListener("change",e),e()}else lw.current=!1}const Rme=new WeakMap;function oy(n){return n!==null&&typeof n=="object"&&typeof n.start=="function"}function Yc(n){return typeof n=="string"||Array.isArray(n)}const eC=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],tC=["initial",...eC];function iy(n){return oy(n.animate)||tC.some(e=>Yc(n[e]))}function KP(n){return!!(iy(n)||n.variants)}function Dme(n,e,t){for(const s in e){const r=e[s],o=t[s];if(ss(r))n.addValue(s,r);else if(ss(o))n.addValue(s,ru(r,{owner:n}));else if(o!==r)if(n.hasValue(s)){const i=n.getValue(s);i.liveStyle===!0?i.jump(r):i.hasAnimated||i.set(r)}else{const i=n.getStaticValue(s);n.addValue(s,ru(i!==void 0?i:r,{owner:n}))}}for(const s in t)e[s]===void 0&&n.removeValue(s);return e}const D$=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];let sm={};function qP(n){sm=n}function Ame(){return sm}class Ome{scrapeMotionValuesFromProps(e,t,s){return{}}constructor({parent:e,props:t,presenceContext:s,reducedMotionConfig:r,skipAnimations:o,blockInitialAnimation:i,visualState:a},l={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.shouldSkipAnimations=!1,this.values=new Map,this.KeyframeResolver=jS,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.hasBeenMounted=!1,this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{const m=ds.now();this.renderScheduledAt<m&&(this.renderScheduledAt=m,Et.render(this.render,!1,!0))};const{latestValues:u,renderState:h}=a;this.latestValues=u,this.baseTarget={...u},this.initialValues=t.initial?{...u}:{},this.renderState=h,this.parent=e,this.props=t,this.presenceContext=s,this.depth=e?e.depth+1:0,this.reducedMotionConfig=r,this.skipAnimationsConfig=o,this.options=l,this.blockInitialAnimation=!!i,this.isControllingVariants=iy(t),this.isVariantNode=KP(t),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(e&&e.current);const{willChange:p,...f}=this.scrapeMotionValuesFromProps(t,{},this);for(const m in f){const y=f[m];u[m]!==void 0&&ss(y)&&y.set(u[m])}}mount(e){var t,s;if(this.hasBeenMounted)for(const r in this.initialValues)(t=this.values.get(r))==null||t.jump(this.initialValues[r]),this.latestValues[r]=this.initialValues[r];this.current=e,Rme.set(e,this),this.projection&&!this.projection.instance&&this.projection.mount(e),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((r,o)=>this.bindToMotionValue(o,r)),this.reducedMotionConfig==="never"?this.shouldReduceMotion=!1:this.reducedMotionConfig==="always"?this.shouldReduceMotion=!0:(HP.current||Eme(),this.shouldReduceMotion=lw.current),this.shouldSkipAnimations=this.skipAnimationsConfig??!1,(s=this.parent)==null||s.addChild(this),this.update(this.props,this.presenceContext),this.hasBeenMounted=!0}unmount(){var e;this.projection&&this.projection.unmount(),Di(this.notifyUpdate),Di(this.render),this.valueSubscriptions.forEach(t=>t()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),(e=this.parent)==null||e.removeChild(this);for(const t in this.events)this.events[t].clear();for(const t in this.features){const s=this.features[t];s&&(s.unmount(),s.isMounted=!1)}this.current=null}addChild(e){this.children.add(e),this.enteringChildren??(this.enteringChildren=new Set),this.enteringChildren.add(e)}removeChild(e){this.children.delete(e),this.enteringChildren&&this.enteringChildren.delete(e)}bindToMotionValue(e,t){this.valueSubscriptions.has(e)&&this.valueSubscriptions.get(e)();const s=Iu.has(e);s&&this.onBindTransform&&this.onBindTransform();const r=t.on("change",i=>{this.latestValues[e]=i,this.props.onUpdate&&Et.preRender(this.notifyUpdate),s&&this.projection&&(this.projection.isTransformDirty=!0),this.scheduleRender()});let o;typeof window<"u"&&window.MotionCheckAppearSync&&(o=window.MotionCheckAppearSync(this,e,t)),this.valueSubscriptions.set(e,()=>{r(),o&&o(),t.owner&&t.stop()})}sortNodePosition(e){return!this.current||!this.sortInstanceNodePosition||this.type!==e.type?0:this.sortInstanceNodePosition(this.current,e.current)}updateFeatures(){let e="animation";for(e in sm){const t=sm[e];if(!t)continue;const{isEnabled:s,Feature:r}=t;if(!this.features[e]&&r&&s(this.props)&&(this.features[e]=new r(this)),this.features[e]){const o=this.features[e];o.isMounted?o.update():(o.mount(),o.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):Sn()}getStaticValue(e){return this.latestValues[e]}setStaticValue(e,t){this.latestValues[e]=t}update(e,t){(e.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=e,this.prevPresenceContext=this.presenceContext,this.presenceContext=t;for(let s=0;s<D$.length;s++){const r=D$[s];this.propEventSubscriptions[r]&&(this.propEventSubscriptions[r](),delete this.propEventSubscriptions[r]);const o="on"+r,i=e[o];i&&(this.propEventSubscriptions[r]=this.on(r,i))}this.prevMotionValues=Dme(this,this.scrapeMotionValuesFromProps(e,this.prevProps||{},this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue()}getProps(){return this.props}getVariant(e){return this.props.variants?this.props.variants[e]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(e){const t=this.getClosestVariantNode();if(t)return t.variantChildren&&t.variantChildren.add(e),()=>t.variantChildren.delete(e)}addValue(e,t){const s=this.values.get(e);t!==s&&(s&&this.removeValue(e),this.bindToMotionValue(e,t),this.values.set(e,t),this.latestValues[e]=t.get())}removeValue(e){this.values.delete(e);const t=this.valueSubscriptions.get(e);t&&(t(),this.valueSubscriptions.delete(e)),delete this.latestValues[e],this.removeValueFromRenderState(e,this.renderState)}hasValue(e){return this.values.has(e)}getValue(e,t){if(this.props.values&&this.props.values[e])return this.props.values[e];let s=this.values.get(e);return s===void 0&&t!==void 0&&(s=ru(t===null?void 0:t,{owner:this}),this.addValue(e,s)),s}readValue(e,t){let s=this.latestValues[e]!==void 0||!this.current?this.latestValues[e]:this.getBaseTargetFromProps(this.props,e)??this.readValueFromInstance(this.current,e,this.options);return s!=null&&(typeof s=="string"&&(YF(s)||ZF(s))?s=parseFloat(s):!Ime(s)&&Ai.test(t)&&(s=zP(e,t)),this.setBaseTarget(e,ss(s)?s.get():s)),ss(s)?s.get():s}setBaseTarget(e,t){this.baseTarget[e]=t}getBaseTarget(e){var o;const{initial:t}=this.props;let s;if(typeof t=="string"||typeof t=="object"){const i=qS(this.props,t,(o=this.presenceContext)==null?void 0:o.custom);i&&(s=i[e])}if(t&&s!==void 0)return s;const r=this.getBaseTargetFromProps(this.props,e);return r!==void 0&&!ss(r)?r:this.initialValues[e]!==void 0&&s===void 0?void 0:this.baseTarget[e]}on(e,t){return this.events[e]||(this.events[e]=new _S),this.events[e].add(t)}notify(e,...t){this.events[e]&&this.events[e].notify(...t)}scheduleRenderMicrotask(){QS.render(this.render)}}class XP extends Ome{constructor(){super(...arguments),this.KeyframeResolver=ame}sortInstanceNodePosition(e,t){return e.compareDocumentPosition(t)&2?1:-1}getBaseTargetFromProps(e,t){const s=e.style;return s?s[t]:void 0}removeValueFromRenderState(e,{vars:t,style:s}){delete t[e],delete s[e]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:e}=this.props;ss(e)&&(this.childSubscription=e.on("change",t=>{this.current&&(this.current.textContent=`${t}`)}))}}class ji{constructor(e){this.isMounted=!1,this.node=e}update(){}}function YP({top:n,left:e,right:t,bottom:s}){return{x:{min:e,max:t},y:{min:n,max:s}}}function _me({x:n,y:e}){return{top:e.min,right:n.max,bottom:e.max,left:n.min}}function Fme(n,e){if(!e)return n;const t=e({x:n.left,y:n.top}),s=e({x:n.right,y:n.bottom});return{top:t.y,left:t.x,bottom:s.y,right:s.x}}function _x(n){return n===void 0||n===1}function uw({scale:n,scaleX:e,scaleY:t}){return!_x(n)||!_x(e)||!_x(t)}function ca(n){return uw(n)||QP(n)||n.z||n.rotate||n.rotateX||n.rotateY||n.skewX||n.skewY}function QP(n){return A$(n.x)||A$(n.y)}function A$(n){return n&&n!=="0%"}function rm(n,e,t){const s=n-t,r=e*s;return t+r}function O$(n,e,t,s,r){return r!==void 0&&(n=rm(n,r,s)),rm(n,t,s)+e}function cw(n,e=0,t=1,s,r){n.min=O$(n.min,e,t,s,r),n.max=O$(n.max,e,t,s,r)}function ZP(n,{x:e,y:t}){cw(n.x,e.translate,e.scale,e.originPoint),cw(n.y,t.translate,t.scale,t.originPoint)}const _$=.999999999999,F$=1.0000000000001;function Pme(n,e,t,s=!1){const r=t.length;if(!r)return;e.x=e.y=1;let o,i;for(let a=0;a<r;a++){o=t[a],i=o.projectionDelta;const{visualElement:l}=o.options;l&&l.props.style&&l.props.style.display==="contents"||(s&&o.options.layoutScroll&&o.scroll&&o!==o.root&&Fl(n,{x:-o.scroll.offset.x,y:-o.scroll.offset.y}),i&&(e.x*=i.x.scale,e.y*=i.y.scale,ZP(n,i)),s&&ca(o.latestValues)&&Fl(n,o.latestValues))}e.x<F$&&e.x>_$&&(e.x=1),e.y<F$&&e.y>_$&&(e.y=1)}function _l(n,e){n.min=n.min+e,n.max=n.max+e}function P$(n,e,t,s,r=.5){const o=Gt(n.min,n.max,r);cw(n,e,t,o,s)}function Fl(n,e){P$(n.x,e.x,e.scaleX,e.scale,e.originX),P$(n.y,e.y,e.scaleY,e.scale,e.originY)}function JP(n,e){return YP(Fme(n.getBoundingClientRect(),e))}function Lme(n,e,t){const s=JP(n,t),{scroll:r}=e;return r&&(_l(s.x,r.offset.x),_l(s.y,r.offset.y)),s}const Mme={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},zme=Nu.length;function Vme(n,e,t){let s="",r=!0;for(let o=0;o<zme;o++){const i=Nu[o],a=n[i];if(a===void 0)continue;let l=!0;if(typeof a=="number")l=a===(i.startsWith("scale")?1:0);else{const u=parseFloat(a);l=i.startsWith("scale")?u===1:u===0}if(!l||t){const u=BP(a,YS[i]);if(!l){r=!1;const h=Mme[i]||i;s+=`${h}(${u}) `}t&&(e[i]=u)}}return s=s.trim(),t?s=t(e,r?"":s):r&&(s="none"),s}function nC(n,e,t){const{style:s,vars:r,transformOrigin:o}=n;let i=!1,a=!1;for(const l in e){const u=e[l];if(Iu.has(l)){i=!0;continue}else if(dP(l)){r[l]=u;continue}else{const h=BP(u,YS[l]);l.startsWith("origin")?(a=!0,o[l]=h):s[l]=h}}if(e.transform||(i||t?s.transform=Vme(e,n.transform,t):s.transform&&(s.transform="none")),a){const{originX:l="50%",originY:u="50%",originZ:h=0}=o;s.transformOrigin=`${l} ${u} ${h}`}}function eL(n,{style:e,vars:t},s,r){const o=n.style;let i;for(i in e)o[i]=e[i];r==null||r.applyProjectionStyles(o,s);for(i in t)o.setProperty(i,t[i])}function L$(n,e){return e.max===e.min?0:n/(e.max-e.min)*100}const yc={correct:(n,e)=>{if(!e.target)return n;if(typeof n=="string")if(Le.test(n))n=parseFloat(n);else return n;const t=L$(n,e.target.x),s=L$(n,e.target.y);return`${t}% ${s}%`}},Bme={correct:(n,{treeScale:e,projectionDelta:t})=>{const s=n,r=Ai.parse(n);if(r.length>5)return s;const o=Ai.createTransformer(n),i=typeof r[0]!="number"?1:0,a=t.x.scale*e.x,l=t.y.scale*e.y;r[0+i]/=a,r[1+i]/=l;const u=Gt(a,l,.5);return typeof r[2+i]=="number"&&(r[2+i]/=u),typeof r[3+i]=="number"&&(r[3+i]/=u),o(r)}},hw={borderRadius:{...yc,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:yc,borderTopRightRadius:yc,borderBottomLeftRadius:yc,borderBottomRightRadius:yc,boxShadow:Bme};function tL(n,{layout:e,layoutId:t}){return Iu.has(n)||n.startsWith("origin")||(e||t!==void 0)&&(!!hw[n]||n==="opacity")}function sC(n,e,t){var i;const s=n.style,r=e==null?void 0:e.style,o={};if(!s)return o;for(const a in s)(ss(s[a])||r&&ss(r[a])||tL(a,n)||((i=t==null?void 0:t.getValue(a))==null?void 0:i.liveStyle)!==void 0)&&(o[a]=s[a]);return o}function Wme(n){return window.getComputedStyle(n)}class Ume extends XP{constructor(){super(...arguments),this.type="html",this.renderInstance=eL}readValueFromInstance(e,t){var s;if(Iu.has(t))return(s=this.projection)!=null&&s.isProjecting?Qv(t):lfe(e,t);{const r=Wme(e),o=(dP(t)?r.getPropertyValue(t):r[t])||0;return typeof o=="string"?o.trim():o}}measureInstanceViewportBox(e,{transformPagePoint:t}){return JP(e,t)}build(e,t,s){nC(e,t,s.transformTemplate)}scrapeMotionValuesFromProps(e,t,s){return sC(e,t,s)}}const Gme={offset:"stroke-dashoffset",array:"stroke-dasharray"},jme={offset:"strokeDashoffset",array:"strokeDasharray"};function Hme(n,e,t=1,s=0,r=!0){n.pathLength=1;const o=r?Gme:jme;n[o.offset]=`${-s}`,n[o.array]=`${e} ${t}`}const Kme=["offsetDistance","offsetPath","offsetRotate","offsetAnchor"];function nL(n,{attrX:e,attrY:t,attrScale:s,pathLength:r,pathSpacing:o=1,pathOffset:i=0,...a},l,u,h){if(nC(n,a,u),l){n.style.viewBox&&(n.attrs.viewBox=n.style.viewBox);return}n.attrs=n.style,n.style={};const{attrs:p,style:f}=n;p.transform&&(f.transform=p.transform,delete p.transform),(f.transform||p.transformOrigin)&&(f.transformOrigin=p.transformOrigin??"50% 50%",delete p.transformOrigin),f.transform&&(f.transformBox=(h==null?void 0:h.transformBox)??"fill-box",delete p.transformBox);for(const m of Kme)p[m]!==void 0&&(f[m]=p[m],delete p[m]);e!==void 0&&(p.x=e),t!==void 0&&(p.y=t),s!==void 0&&(p.scale=s),r!==void 0&&Hme(p,r,o,i,!1)}const sL=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]),rL=n=>typeof n=="string"&&n.toLowerCase()==="svg";function qme(n,e,t,s){eL(n,e,void 0,s);for(const r in e.attrs)n.setAttribute(sL.has(r)?r:XS(r),e.attrs[r])}function oL(n,e,t){const s=sC(n,e,t);for(const r in n)if(ss(n[r])||ss(e[r])){const o=Nu.indexOf(r)!==-1?"attr"+r.charAt(0).toUpperCase()+r.substring(1):r;s[o]=n[r]}return s}class Xme extends XP{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=Sn}getBaseTargetFromProps(e,t){return e[t]}readValueFromInstance(e,t){if(Iu.has(t)){const s=MP(t);return s&&s.default||0}return t=sL.has(t)?t:XS(t),e.getAttribute(t)}scrapeMotionValuesFromProps(e,t,s){return oL(e,t,s)}build(e,t,s){nL(e,t,this.isSVGTag,s.transformTemplate,s.style)}renderInstance(e,t,s,r){qme(e,t,s,r)}mount(e){this.isSVGTag=rL(e.tagName),super.mount(e)}}const Yme=tC.length;function iL(n){if(!n)return;if(!n.isControllingVariants){const t=n.parent?iL(n.parent)||{}:{};return n.props.initial!==void 0&&(t.initial=n.props.initial),t}const e={};for(let t=0;t<Yme;t++){const s=tC[t],r=n.props[s];(Yc(r)||r===!1)&&(e[s]=r)}return e}function aL(n,e){if(!Array.isArray(e))return!1;const t=e.length;if(t!==n.length)return!1;for(let s=0;s<t;s++)if(e[s]!==n[s])return!1;return!0}const Qme=[...eC].reverse(),Zme=eC.length;function Jme(n){return e=>Promise.all(e.map(({animation:t,options:s})=>Qfe(n,t,s)))}function ege(n){let e=Jme(n),t=M$(),s=!0;const r=l=>(u,h)=>{var f;const p=Gl(n,h,l==="exit"?(f=n.presenceContext)==null?void 0:f.custom:void 0);if(p){const{transition:m,transitionEnd:y,...x}=p;u={...u,...x,...y}}return u};function o(l){e=l(n)}function i(l){const{props:u}=n,h=iL(n.parent)||{},p=[],f=new Set;let m={},y=1/0;for(let v=0;v<Zme;v++){const w=Qme[v],S=t[w],k=u[w]!==void 0?u[w]:h[w],T=Yc(k),I=w===l?S.isActive:null;I===!1&&(y=v);let E=k===h[w]&&k!==u[w]&&T;if(E&&s&&n.manuallyAnimateOnMount&&(E=!1),S.protectedKeys={...m},!S.isActive&&I===null||!k&&!S.prevProp||oy(k)||typeof k=="boolean")continue;const D=tge(S.prevProp,k);let O=D||w===l&&S.isActive&&!E&&T||v>y&&T,_=!1;const P=Array.isArray(k)?k:[k];let R=P.reduce(r(w),{});I===!1&&(R={});const{prevResolvedValues:W={}}=S,Q={...W,...R},ee=se=>{O=!0,f.has(se)&&(_=!0,f.delete(se)),S.needsAnimating[se]=!0;const G=n.getValue(se);G&&(G.liveStyle=!1)};for(const se in Q){const G=R[se],V=W[se];if(m.hasOwnProperty(se))continue;let B=!1;sw(G)&&sw(V)?B=!aL(G,V):B=G!==V,B?G!=null?ee(se):f.add(se):G!==void 0&&f.has(se)?ee(se):S.protectedKeys[se]=!0}S.prevProp=k,S.prevResolvedValues=R,S.isActive&&(m={...m,...R}),s&&n.blockInitialAnimation&&(O=!1);const te=E&&D;O&&(!te||_)&&p.push(...P.map(se=>{const G={type:w};if(typeof se=="string"&&s&&!te&&n.manuallyAnimateOnMount&&n.parent){const{parent:V}=n,B=Gl(V,se);if(V.enteringChildren&&B){const{delayChildren:F}=B.transition||{};G.delay=EP(V.enteringChildren,n,F)}}return{animation:se,options:G}}))}if(f.size){const v={};if(typeof u.initial!="boolean"){const w=Gl(n,Array.isArray(u.initial)?u.initial[0]:u.initial);w&&w.transition&&(v.transition=w.transition)}f.forEach(w=>{const S=n.getBaseTarget(w),k=n.getValue(w);k&&(k.liveStyle=!0),v[w]=S??null}),p.push({animation:v})}let x=!!p.length;return s&&(u.initial===!1||u.initial===u.animate)&&!n.manuallyAnimateOnMount&&(x=!1),s=!1,x?e(p):Promise.resolve()}function a(l,u){var p;if(t[l].isActive===u)return Promise.resolve();(p=n.variantChildren)==null||p.forEach(f=>{var m;return(m=f.animationState)==null?void 0:m.setActive(l,u)}),t[l].isActive=u;const h=i(l);for(const f in t)t[f].protectedKeys={};return h}return{animateChanges:i,setActive:a,setAnimateFunction:o,getState:()=>t,reset:()=>{t=M$()}}}function tge(n,e){return typeof e=="string"?e!==n:Array.isArray(e)?!aL(e,n):!1}function la(n=!1){return{isActive:n,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function M$(){return{animate:la(!0),whileInView:la(),whileHover:la(),whileTap:la(),whileDrag:la(),whileFocus:la(),exit:la()}}function z$(n,e){n.min=e.min,n.max=e.max}function Er(n,e){z$(n.x,e.x),z$(n.y,e.y)}function V$(n,e){n.translate=e.translate,n.scale=e.scale,n.originPoint=e.originPoint,n.origin=e.origin}const lL=1e-4,nge=1-lL,sge=1+lL,uL=.01,rge=0-uL,oge=0+uL;function ps(n){return n.max-n.min}function ige(n,e,t){return Math.abs(n-e)<=t}function B$(n,e,t,s=.5){n.origin=s,n.originPoint=Gt(e.min,e.max,n.origin),n.scale=ps(t)/ps(e),n.translate=Gt(t.min,t.max,n.origin)-n.originPoint,(n.scale>=nge&&n.scale<=sge||isNaN(n.scale))&&(n.scale=1),(n.translate>=rge&&n.translate<=oge||isNaN(n.translate))&&(n.translate=0)}function $c(n,e,t,s){B$(n.x,e.x,t.x,s?s.originX:void 0),B$(n.y,e.y,t.y,s?s.originY:void 0)}function W$(n,e,t){n.min=t.min+e.min,n.max=n.min+ps(e)}function age(n,e,t){W$(n.x,e.x,t.x),W$(n.y,e.y,t.y)}function U$(n,e,t){n.min=e.min-t.min,n.max=n.min+ps(e)}function om(n,e,t){U$(n.x,e.x,t.x),U$(n.y,e.y,t.y)}function G$(n,e,t,s,r){return n-=e,n=rm(n,1/t,s),r!==void 0&&(n=rm(n,1/r,s)),n}function lge(n,e=0,t=1,s=.5,r,o=n,i=n){if(oo.test(e)&&(e=parseFloat(e),e=Gt(i.min,i.max,e/100)-i.min),typeof e!="number")return;let a=Gt(o.min,o.max,s);n===o&&(a-=e),n.min=G$(n.min,e,t,a,r),n.max=G$(n.max,e,t,a,r)}function j$(n,e,[t,s,r],o,i){lge(n,e[t],e[s],e[r],e.scale,o,i)}const uge=["x","scaleX","originX"],cge=["y","scaleY","originY"];function H$(n,e,t,s){j$(n.x,e,uge,t?t.x:void 0,s?s.x:void 0),j$(n.y,e,cge,t?t.y:void 0,s?s.y:void 0)}function K$(n){return n.translate===0&&n.scale===1}function cL(n){return K$(n.x)&&K$(n.y)}function q$(n,e){return n.min===e.min&&n.max===e.max}function hge(n,e){return q$(n.x,e.x)&&q$(n.y,e.y)}function X$(n,e){return Math.round(n.min)===Math.round(e.min)&&Math.round(n.max)===Math.round(e.max)}function hL(n,e){return X$(n.x,e.x)&&X$(n.y,e.y)}function Y$(n){return ps(n.x)/ps(n.y)}function Q$(n,e){return n.translate===e.translate&&n.scale===e.scale&&n.originPoint===e.originPoint}function Xr(n){return[n("x"),n("y")]}function dge(n,e,t){let s="";const r=n.x.translate/e.x,o=n.y.translate/e.y,i=(t==null?void 0:t.z)||0;if((r||o||i)&&(s=`translate3d(${r}px, ${o}px, ${i}px) `),(e.x!==1||e.y!==1)&&(s+=`scale(${1/e.x}, ${1/e.y}) `),t){const{transformPerspective:u,rotate:h,rotateX:p,rotateY:f,skewX:m,skewY:y}=t;u&&(s=`perspective(${u}px) ${s}`),h&&(s+=`rotate(${h}deg) `),p&&(s+=`rotateX(${p}deg) `),f&&(s+=`rotateY(${f}deg) `),m&&(s+=`skewX(${m}deg) `),y&&(s+=`skewY(${y}deg) `)}const a=n.x.scale*e.x,l=n.y.scale*e.y;return(a!==1||l!==1)&&(s+=`scale(${a}, ${l})`),s||"none"}const dL=["TopLeft","TopRight","BottomLeft","BottomRight"],pge=dL.length,Z$=n=>typeof n=="string"?parseFloat(n):n,J$=n=>typeof n=="number"||Le.test(n);function fge(n,e,t,s,r,o){r?(n.opacity=Gt(0,t.opacity??1,mge(s)),n.opacityExit=Gt(e.opacity??1,0,gge(s))):o&&(n.opacity=Gt(e.opacity??1,t.opacity??1,s));for(let i=0;i<pge;i++){const a=`border${dL[i]}Radius`;let l=e2(e,a),u=e2(t,a);if(l===void 0&&u===void 0)continue;l||(l=0),u||(u=0),l===0||u===0||J$(l)===J$(u)?(n[a]=Math.max(Gt(Z$(l),Z$(u),s),0),(oo.test(u)||oo.test(l))&&(n[a]+="%")):n[a]=u}(e.rotate||t.rotate)&&(n.rotate=Gt(e.rotate||0,t.rotate||0,s))}function e2(n,e){return n[e]!==void 0?n[e]:n.borderRadius}const mge=pL(0,.5,iP),gge=pL(.5,.95,dr);function pL(n,e,t){return s=>s<n?0:s>e?1:t(Kc(n,e,s))}function yge(n,e,t){const s=ss(n)?n:ru(n);return s.start(KS("",s,e,t)),s.animation}function Qc(n,e,t,s={passive:!0}){return n.addEventListener(e,t,s),()=>n.removeEventListener(e,t)}const xge=(n,e)=>n.depth-e.depth;class vge{constructor(){this.children=[],this.isDirty=!1}add(e){RS(this.children,e),this.isDirty=!0}remove(e){DS(this.children,e),this.isDirty=!0}forEach(e){this.isDirty&&this.children.sort(xge),this.isDirty=!1,this.children.forEach(e)}}function wge(n,e){const t=ds.now(),s=({timestamp:r})=>{const o=r-t;o>=e&&(Di(s),n(o-e))};return Et.setup(s,!0),()=>Di(s)}function bf(n){return ss(n)?n.get():n}class bge{constructor(){this.members=[]}add(e){RS(this.members,e),e.scheduleRender()}remove(e){if(DS(this.members,e),e===this.prevLead&&(this.prevLead=void 0),e===this.lead){const t=this.members[this.members.length-1];t&&this.promote(t)}}relegate(e){const t=this.members.findIndex(r=>e===r);if(t===0)return!1;let s;for(let r=t;r>=0;r--){const o=this.members[r];if(o.isPresent!==!1){s=o;break}}return s?(this.promote(s),!0):!1}promote(e,t){const s=this.lead;if(e!==s&&(this.prevLead=s,this.lead=e,e.show(),s)){s.instance&&s.scheduleRender(),e.scheduleRender();const r=s.options.layoutDependency,o=e.options.layoutDependency;r!==void 0&&o!==void 0&&r===o||(e.resumeFrom=s,t&&(e.resumeFrom.preserveOpacity=!0),s.snapshot&&(e.snapshot=s.snapshot,e.snapshot.latestValues=s.animationValues||s.latestValues),e.root&&e.root.isUpdating&&(e.isLayoutDirty=!0));const{crossfade:a}=e.options;a===!1&&s.hide()}}exitAnimationComplete(){this.members.forEach(e=>{const{options:t,resumingFrom:s}=e;t.onExitComplete&&t.onExitComplete(),s&&s.options.onExitComplete&&s.options.onExitComplete()})}scheduleRender(){this.members.forEach(e=>{e.instance&&e.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}const Sf={hasAnimatedSinceResize:!0,hasEverUpdated:!1},Fx=["","X","Y","Z"],Sge=1e3;let Cge=0;function Px(n,e,t,s){const{latestValues:r}=e;r[n]&&(t[n]=r[n],e.setStaticValue(n,0),s&&(s[n]=0))}function fL(n){if(n.hasCheckedOptimisedAppear=!0,n.root===n)return;const{visualElement:e}=n.options;if(!e)return;const t=_P(e);if(window.MotionHasOptimisedAnimation(t,"transform")){const{layout:r,layoutId:o}=n.options;window.MotionCancelOptimisedAnimation(t,"transform",Et,!(r||o))}const{parent:s}=n;s&&!s.hasCheckedOptimisedAppear&&fL(s)}function mL({attachResizeListener:n,defaultParent:e,measureScroll:t,checkIsScrollRoot:s,resetTransform:r}){return class{constructor(i={},a=e==null?void 0:e()){this.id=Cge++,this.animationId=0,this.animationCommitId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.layoutVersion=0,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,this.nodes.forEach(Nge),this.nodes.forEach(Rge),this.nodes.forEach(Dge),this.nodes.forEach(Ige)},this.resolvedRelativeTargetAt=0,this.linkedParentVersion=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=i,this.root=a?a.root||a:this,this.path=a?[...a.path,a]:[],this.parent=a,this.depth=a?a.depth+1:0;for(let l=0;l<this.path.length;l++)this.path[l].shouldResetTransform=!0;this.root===this&&(this.nodes=new vge)}addEventListener(i,a){return this.eventHandlers.has(i)||this.eventHandlers.set(i,new _S),this.eventHandlers.get(i).add(a)}notifyListeners(i,...a){const l=this.eventHandlers.get(i);l&&l.notify(...a)}hasListeners(i){return this.eventHandlers.has(i)}mount(i){if(this.instance)return;this.isSVG=JS(i)&&!Tme(i),this.instance=i;const{layoutId:a,layout:l,visualElement:u}=this.options;if(u&&!u.current&&u.mount(i),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),this.root.hasTreeAnimated&&(l||a)&&(this.isLayoutDirty=!0),n){let h,p=0;const f=()=>this.root.updateBlockedByResize=!1;Et.read(()=>{p=window.innerWidth}),n(i,()=>{const m=window.innerWidth;m!==p&&(p=m,this.root.updateBlockedByResize=!0,h&&h(),h=wge(f,250),Sf.hasAnimatedSinceResize&&(Sf.hasAnimatedSinceResize=!1,this.nodes.forEach(s2)))})}a&&this.root.registerSharedNode(a,this),this.options.animate!==!1&&u&&(a||l)&&this.addEventListener("didUpdate",({delta:h,hasLayoutChanged:p,hasRelativeLayoutChanged:f,layout:m})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const y=this.options.transition||u.getDefaultTransition()||Pge,{onLayoutAnimationStart:x,onLayoutAnimationComplete:v}=u.getProps(),w=!this.targetLayout||!hL(this.targetLayout,m),S=!p&&f;if(this.options.layoutRoot||this.resumeFrom||S||p&&(w||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0);const k={...HS(y,"layout"),onPlay:x,onComplete:v};(u.shouldReduceMotion||this.options.layoutRoot)&&(k.delay=0,k.type=!1),this.startAnimation(k),this.setAnimationOrigin(h,S)}else p||s2(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=m})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const i=this.getStack();i&&i.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,this.eventHandlers.clear(),Di(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(Age),this.animationId++)}getTransformTemplate(){const{visualElement:i}=this.options;return i&&i.getProps().transformTemplate}willUpdate(i=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&fL(this),!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let h=0;h<this.path.length;h++){const p=this.path[h];p.shouldResetTransform=!0,p.updateScroll("snapshot"),p.options.layoutRoot&&p.willUpdate(!1)}const{layoutId:a,layout:l}=this.options;if(a===void 0&&!l)return;const u=this.getTransformTemplate();this.prevTransformTemplateValue=u?u(this.latestValues,""):void 0,this.updateSnapshot(),i&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(t2);return}if(this.animationId<=this.animationCommitId){this.nodes.forEach(n2);return}this.animationCommitId=this.animationId,this.isUpdating?(this.isUpdating=!1,this.nodes.forEach(Ege),this.nodes.forEach(kge),this.nodes.forEach(Tge)):this.nodes.forEach(n2),this.clearAllSnapshots();const a=ds.now();Gn.delta=co(0,1e3/60,a-Gn.timestamp),Gn.timestamp=a,Gn.isProcessing=!0,Ix.update.process(Gn),Ix.preRender.process(Gn),Ix.render.process(Gn),Gn.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,QS.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach($ge),this.sharedNodes.forEach(Oge)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,Et.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){Et.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure(),this.snapshot&&!ps(this.snapshot.measuredBox.x)&&!ps(this.snapshot.measuredBox.y)&&(this.snapshot=void 0))}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let l=0;l<this.path.length;l++)this.path[l].updateScroll();const i=this.layout;this.layout=this.measure(!1),this.layoutVersion++,this.layoutCorrected=Sn(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:a}=this.options;a&&a.notify("LayoutMeasure",this.layout.layoutBox,i?i.layoutBox:void 0)}updateScroll(i="measure"){let a=!!(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===i&&(a=!1),a&&this.instance){const l=s(this.instance);this.scroll={animationId:this.root.animationId,phase:i,isRoot:l,offset:t(this.instance),wasRoot:this.scroll?this.scroll.isRoot:l}}}resetTransform(){if(!r)return;const i=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,a=this.projectionDelta&&!cL(this.projectionDelta),l=this.getTransformTemplate(),u=l?l(this.latestValues,""):void 0,h=u!==this.prevTransformTemplateValue;i&&this.instance&&(a||ca(this.latestValues)||h)&&(r(this.instance,u),this.shouldResetTransform=!1,this.scheduleRender())}measure(i=!0){const a=this.measurePageBox();let l=this.removeElementScroll(a);return i&&(l=this.removeTransform(l)),Lge(l),{animationId:this.root.animationId,measuredBox:a,layoutBox:l,latestValues:{},source:this.id}}measurePageBox(){var u;const{visualElement:i}=this.options;if(!i)return Sn();const a=i.measureViewportBox();if(!(((u=this.scroll)==null?void 0:u.wasRoot)||this.path.some(Mge))){const{scroll:h}=this.root;h&&(_l(a.x,h.offset.x),_l(a.y,h.offset.y))}return a}removeElementScroll(i){var l;const a=Sn();if(Er(a,i),(l=this.scroll)!=null&&l.wasRoot)return a;for(let u=0;u<this.path.length;u++){const h=this.path[u],{scroll:p,options:f}=h;h!==this.root&&p&&f.layoutScroll&&(p.wasRoot&&Er(a,i),_l(a.x,p.offset.x),_l(a.y,p.offset.y))}return a}applyTransform(i,a=!1){const l=Sn();Er(l,i);for(let u=0;u<this.path.length;u++){const h=this.path[u];!a&&h.options.layoutScroll&&h.scroll&&h!==h.root&&Fl(l,{x:-h.scroll.offset.x,y:-h.scroll.offset.y}),ca(h.latestValues)&&Fl(l,h.latestValues)}return ca(this.latestValues)&&Fl(l,this.latestValues),l}removeTransform(i){const a=Sn();Er(a,i);for(let l=0;l<this.path.length;l++){const u=this.path[l];if(!u.instance||!ca(u.latestValues))continue;uw(u.latestValues)&&u.updateSnapshot();const h=Sn(),p=u.measurePageBox();Er(h,p),H$(a,u.latestValues,u.snapshot?u.snapshot.layoutBox:void 0,h)}return ca(this.latestValues)&&H$(a,this.latestValues),a}setTargetDelta(i){this.targetDelta=i,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(i){this.options={...this.options,...i,crossfade:i.crossfade!==void 0?i.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==Gn.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(i=!1){var m;const a=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=a.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=a.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=a.isSharedProjectionDirty);const l=!!this.resumingFrom||this!==a;if(!(i||l&&this.isSharedProjectionDirty||this.isProjectionDirty||(m=this.parent)!=null&&m.isProjectionDirty||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;const{layout:h,layoutId:p}=this.options;if(!this.layout||!(h||p))return;this.resolvedRelativeTargetAt=Gn.timestamp;const f=this.getClosestProjectingParent();f&&this.linkedParentVersion!==f.layoutVersion&&!f.options.layoutRoot&&this.removeRelativeTarget(),!this.targetDelta&&!this.relativeTarget&&(f&&f.layout?this.createRelativeTarget(f,this.layout.layoutBox,f.layout.layoutBox):this.removeRelativeTarget()),!(!this.relativeTarget&&!this.targetDelta)&&(this.target||(this.target=Sn(),this.targetWithTransforms=Sn()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),age(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):Er(this.target,this.layout.layoutBox),ZP(this.target,this.targetDelta)):Er(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget&&(this.attemptToResolveRelativeTarget=!1,f&&!!f.resumingFrom==!!this.resumingFrom&&!f.options.layoutScroll&&f.target&&this.animationProgress!==1?this.createRelativeTarget(f,this.target,f.target):this.relativeParent=this.relativeTarget=void 0))}getClosestProjectingParent(){if(!(!this.parent||uw(this.parent.latestValues)||QP(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}createRelativeTarget(i,a,l){this.relativeParent=i,this.linkedParentVersion=i.layoutVersion,this.forceRelativeParentToResolveTarget(),this.relativeTarget=Sn(),this.relativeTargetOrigin=Sn(),om(this.relativeTargetOrigin,a,l),Er(this.relativeTarget,this.relativeTargetOrigin)}removeRelativeTarget(){this.relativeParent=this.relativeTarget=void 0}calcProjection(){var y;const i=this.getLead(),a=!!this.resumingFrom||this!==i;let l=!0;if((this.isProjectionDirty||(y=this.parent)!=null&&y.isProjectionDirty)&&(l=!1),a&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(l=!1),this.resolvedRelativeTargetAt===Gn.timestamp&&(l=!1),l)return;const{layout:u,layoutId:h}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(u||h))return;Er(this.layoutCorrected,this.layout.layoutBox);const p=this.treeScale.x,f=this.treeScale.y;Pme(this.layoutCorrected,this.treeScale,this.path,a),i.layout&&!i.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(i.target=i.layout.layoutBox,i.targetWithTransforms=Sn());const{target:m}=i;if(!m){this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender());return}!this.projectionDelta||!this.prevProjectionDelta?this.createProjectionDeltas():(V$(this.prevProjectionDelta.x,this.projectionDelta.x),V$(this.prevProjectionDelta.y,this.projectionDelta.y)),$c(this.projectionDelta,this.layoutCorrected,m,this.latestValues),(this.treeScale.x!==p||this.treeScale.y!==f||!Q$(this.projectionDelta.x,this.prevProjectionDelta.x)||!Q$(this.projectionDelta.y,this.prevProjectionDelta.y))&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",m))}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(i=!0){var a;if((a=this.options.visualElement)==null||a.scheduleRender(),i){const l=this.getStack();l&&l.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta=Ol(),this.projectionDelta=Ol(),this.projectionDeltaWithTransform=Ol()}setAnimationOrigin(i,a=!1){const l=this.snapshot,u=l?l.latestValues:{},h={...this.latestValues},p=Ol();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!a;const f=Sn(),m=l?l.source:void 0,y=this.layout?this.layout.source:void 0,x=m!==y,v=this.getStack(),w=!v||v.members.length<=1,S=!!(x&&!w&&this.options.crossfade===!0&&!this.path.some(Fge));this.animationProgress=0;let k;this.mixTargetDelta=T=>{const I=T/1e3;r2(p.x,i.x,I),r2(p.y,i.y,I),this.setTargetDelta(p),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(om(f,this.layout.layoutBox,this.relativeParent.layout.layoutBox),_ge(this.relativeTarget,this.relativeTargetOrigin,f,I),k&&hge(this.relativeTarget,k)&&(this.isProjectionDirty=!1),k||(k=Sn()),Er(k,this.relativeTarget)),x&&(this.animationValues=h,fge(h,u,this.latestValues,I,S,w)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=I},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(i){var a,l,u;this.notifyListeners("animationStart"),(a=this.currentAnimation)==null||a.stop(),(u=(l=this.resumingFrom)==null?void 0:l.currentAnimation)==null||u.stop(),this.pendingAnimation&&(Di(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=Et.update(()=>{Sf.hasAnimatedSinceResize=!0,this.motionValue||(this.motionValue=ru(0)),this.currentAnimation=yge(this.motionValue,[0,1e3],{...i,velocity:0,isSync:!0,onUpdate:h=>{this.mixTargetDelta(h),i.onUpdate&&i.onUpdate(h)},onStop:()=>{},onComplete:()=>{i.onComplete&&i.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const i=this.getStack();i&&i.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(Sge),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const i=this.getLead();let{targetWithTransforms:a,target:l,layout:u,latestValues:h}=i;if(!(!a||!l||!u)){if(this!==i&&this.layout&&u&&gL(this.options.animationType,this.layout.layoutBox,u.layoutBox)){l=this.target||Sn();const p=ps(this.layout.layoutBox.x);l.x.min=i.target.x.min,l.x.max=l.x.min+p;const f=ps(this.layout.layoutBox.y);l.y.min=i.target.y.min,l.y.max=l.y.min+f}Er(a,l),Fl(a,h),$c(this.projectionDeltaWithTransform,this.layoutCorrected,a,h)}}registerSharedNode(i,a){this.sharedNodes.has(i)||this.sharedNodes.set(i,new bge),this.sharedNodes.get(i).add(a);const u=a.options.initialPromotionConfig;a.promote({transition:u?u.transition:void 0,preserveFollowOpacity:u&&u.shouldPreserveFollowOpacity?u.shouldPreserveFollowOpacity(a):void 0})}isLead(){const i=this.getStack();return i?i.lead===this:!0}getLead(){var a;const{layoutId:i}=this.options;return i?((a=this.getStack())==null?void 0:a.lead)||this:this}getPrevLead(){var a;const{layoutId:i}=this.options;return i?(a=this.getStack())==null?void 0:a.prevLead:void 0}getStack(){const{layoutId:i}=this.options;if(i)return this.root.sharedNodes.get(i)}promote({needsReset:i,transition:a,preserveFollowOpacity:l}={}){const u=this.getStack();u&&u.promote(this,l),i&&(this.projectionDelta=void 0,this.needsReset=!0),a&&this.setOptions({transition:a})}relegate(){const i=this.getStack();return i?i.relegate(this):!1}resetSkewAndRotation(){const{visualElement:i}=this.options;if(!i)return;let a=!1;const{latestValues:l}=i;if((l.z||l.rotate||l.rotateX||l.rotateY||l.rotateZ||l.skewX||l.skewY)&&(a=!0),!a)return;const u={};l.z&&Px("z",i,u,this.animationValues);for(let h=0;h<Fx.length;h++)Px(`rotate${Fx[h]}`,i,u,this.animationValues),Px(`skew${Fx[h]}`,i,u,this.animationValues);i.render();for(const h in u)i.setStaticValue(h,u[h]),this.animationValues&&(this.animationValues[h]=u[h]);i.scheduleRender()}applyProjectionStyles(i,a){if(!this.instance||this.isSVG)return;if(!this.isVisible){i.visibility="hidden";return}const l=this.getTransformTemplate();if(this.needsReset){this.needsReset=!1,i.visibility="",i.opacity="",i.pointerEvents=bf(a==null?void 0:a.pointerEvents)||"",i.transform=l?l(this.latestValues,""):"none";return}const u=this.getLead();if(!this.projectionDelta||!this.layout||!u.target){this.options.layoutId&&(i.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,i.pointerEvents=bf(a==null?void 0:a.pointerEvents)||""),this.hasProjected&&!ca(this.latestValues)&&(i.transform=l?l({},""):"none",this.hasProjected=!1);return}i.visibility="";const h=u.animationValues||u.latestValues;this.applyTransformsToTarget();let p=dge(this.projectionDeltaWithTransform,this.treeScale,h);l&&(p=l(h,p)),i.transform=p;const{x:f,y:m}=this.projectionDelta;i.transformOrigin=`${f.origin*100}% ${m.origin*100}% 0`,u.animationValues?i.opacity=u===this?h.opacity??this.latestValues.opacity??1:this.preserveOpacity?this.latestValues.opacity:h.opacityExit:i.opacity=u===this?h.opacity!==void 0?h.opacity:"":h.opacityExit!==void 0?h.opacityExit:0;for(const y in hw){if(h[y]===void 0)continue;const{correct:x,applyTo:v,isCSSVariable:w}=hw[y],S=p==="none"?h[y]:x(h[y],u);if(v){const k=v.length;for(let T=0;T<k;T++)i[v[T]]=S}else w?this.options.visualElement.renderState.vars[y]=S:i[y]=S}this.options.layoutId&&(i.pointerEvents=u===this?bf(a==null?void 0:a.pointerEvents)||"":"none")}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(i=>{var a;return(a=i.currentAnimation)==null?void 0:a.stop()}),this.root.nodes.forEach(t2),this.root.sharedNodes.clear()}}}function kge(n){n.updateLayout()}function Tge(n){var t;const e=((t=n.resumeFrom)==null?void 0:t.snapshot)||n.snapshot;if(n.isLead()&&n.layout&&e&&n.hasListeners("didUpdate")){const{layoutBox:s,measuredBox:r}=n.layout,{animationType:o}=n.options,i=e.source!==n.layout.source;o==="size"?Xr(p=>{const f=i?e.measuredBox[p]:e.layoutBox[p],m=ps(f);f.min=s[p].min,f.max=f.min+m}):gL(o,e.layoutBox,s)&&Xr(p=>{const f=i?e.measuredBox[p]:e.layoutBox[p],m=ps(s[p]);f.max=f.min+m,n.relativeTarget&&!n.currentAnimation&&(n.isProjectionDirty=!0,n.relativeTarget[p].max=n.relativeTarget[p].min+m)});const a=Ol();$c(a,s,e.layoutBox);const l=Ol();i?$c(l,n.applyTransform(r,!0),e.measuredBox):$c(l,s,e.layoutBox);const u=!cL(a);let h=!1;if(!n.resumeFrom){const p=n.getClosestProjectingParent();if(p&&!p.resumeFrom){const{snapshot:f,layout:m}=p;if(f&&m){const y=Sn();om(y,e.layoutBox,f.layoutBox);const x=Sn();om(x,s,m.layoutBox),hL(y,x)||(h=!0),p.options.layoutRoot&&(n.relativeTarget=x,n.relativeTargetOrigin=y,n.relativeParent=p)}}}n.notifyListeners("didUpdate",{layout:s,snapshot:e,delta:l,layoutDelta:a,hasLayoutChanged:u,hasRelativeLayoutChanged:h})}else if(n.isLead()){const{onExitComplete:s}=n.options;s&&s()}n.options.transition=void 0}function Nge(n){n.parent&&(n.isProjecting()||(n.isProjectionDirty=n.parent.isProjectionDirty),n.isSharedProjectionDirty||(n.isSharedProjectionDirty=!!(n.isProjectionDirty||n.parent.isProjectionDirty||n.parent.isSharedProjectionDirty)),n.isTransformDirty||(n.isTransformDirty=n.parent.isTransformDirty))}function Ige(n){n.isProjectionDirty=n.isSharedProjectionDirty=n.isTransformDirty=!1}function $ge(n){n.clearSnapshot()}function t2(n){n.clearMeasurements()}function n2(n){n.isLayoutDirty=!1}function Ege(n){const{visualElement:e}=n.options;e&&e.getProps().onBeforeLayoutMeasure&&e.notify("BeforeLayoutMeasure"),n.resetTransform()}function s2(n){n.finishAnimation(),n.targetDelta=n.relativeTarget=n.target=void 0,n.isProjectionDirty=!0}function Rge(n){n.resolveTargetDelta()}function Dge(n){n.calcProjection()}function Age(n){n.resetSkewAndRotation()}function Oge(n){n.removeLeadSnapshot()}function r2(n,e,t){n.translate=Gt(e.translate,0,t),n.scale=Gt(e.scale,1,t),n.origin=e.origin,n.originPoint=e.originPoint}function o2(n,e,t,s){n.min=Gt(e.min,t.min,s),n.max=Gt(e.max,t.max,s)}function _ge(n,e,t,s){o2(n.x,e.x,t.x,s),o2(n.y,e.y,t.y,s)}function Fge(n){return n.animationValues&&n.animationValues.opacityExit!==void 0}const Pge={duration:.45,ease:[.4,0,.1,1]},i2=n=>typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(n),a2=i2("applewebkit/")&&!i2("chrome/")?Math.round:dr;function l2(n){n.min=a2(n.min),n.max=a2(n.max)}function Lge(n){l2(n.x),l2(n.y)}function gL(n,e,t){return n==="position"||n==="preserve-aspect"&&!ige(Y$(e),Y$(t),.2)}function Mge(n){var e;return n!==n.root&&((e=n.scroll)==null?void 0:e.wasRoot)}const zge=mL({attachResizeListener:(n,e)=>Qc(n,"resize",e),measureScroll:()=>{var n,e;return{x:document.documentElement.scrollLeft||((n=document.body)==null?void 0:n.scrollLeft)||0,y:document.documentElement.scrollTop||((e=document.body)==null?void 0:e.scrollTop)||0}},checkIsScrollRoot:()=>!0}),Lx={current:void 0},yL=mL({measureScroll:n=>({x:n.scrollLeft,y:n.scrollTop}),defaultParent:()=>{if(!Lx.current){const n=new zge({});n.mount(window),n.setOptions({layoutScroll:!0}),Lx.current=n}return Lx.current},resetTransform:(n,e)=>{n.style.transform=e!==void 0?e:"none"},checkIsScrollRoot:n=>window.getComputedStyle(n).position==="fixed"}),rC=J.createContext({transformPagePoint:n=>n,isStatic:!1,reducedMotion:"never"});function u2(n,e){if(typeof n=="function")return n(e);n!=null&&(n.current=e)}function Vge(...n){return e=>{let t=!1;const s=n.map(r=>{const o=u2(r,e);return!t&&typeof o=="function"&&(t=!0),o});if(t)return()=>{for(let r=0;r<s.length;r++){const o=s[r];typeof o=="function"?o():u2(n[r],null)}}}}function Bge(...n){return J.useCallback(Vge(...n),n)}class Wge extends J.Component{getSnapshotBeforeUpdate(e){const t=this.props.childRef.current;if(t&&e.isPresent&&!this.props.isPresent&&this.props.pop!==!1){const s=t.offsetParent,r=aw(s)&&s.offsetWidth||0,o=aw(s)&&s.offsetHeight||0,i=this.props.sizeRef.current;i.height=t.offsetHeight||0,i.width=t.offsetWidth||0,i.top=t.offsetTop,i.left=t.offsetLeft,i.right=r-i.width-i.left,i.bottom=o-i.height-i.top}return null}componentDidUpdate(){}render(){return this.props.children}}function Uge({children:n,isPresent:e,anchorX:t,anchorY:s,root:r,pop:o}){var f;const i=J.useId(),a=J.useRef(null),l=J.useRef({width:0,height:0,top:0,left:0,right:0,bottom:0}),{nonce:u}=J.useContext(rC),h=((f=n.props)==null?void 0:f.ref)??(n==null?void 0:n.ref),p=Bge(a,h);return J.useInsertionEffect(()=>{const{width:m,height:y,top:x,left:v,right:w,bottom:S}=l.current;if(e||o===!1||!a.current||!m||!y)return;const k=t==="left"?`left: ${v}`:`right: ${w}`,T=s==="bottom"?`bottom: ${S}`:`top: ${x}`;a.current.dataset.motionPopId=i;const I=document.createElement("style");u&&(I.nonce=u);const E=r??document.head;return E.appendChild(I),I.sheet&&I.sheet.insertRule(`
          [data-motion-pop-id="${i}"] {
            position: absolute !important;
            width: ${m}px !important;
            height: ${y}px !important;
            ${k}px !important;
            ${T}px !important;
          }
        `),()=>{E.contains(I)&&E.removeChild(I)}},[e]),ke.jsx(Wge,{isPresent:e,childRef:a,sizeRef:l,pop:o,children:o===!1?n:J.cloneElement(n,{ref:p})})}const Gge=({children:n,initial:e,isPresent:t,onExitComplete:s,custom:r,presenceAffectsLayout:o,mode:i,anchorX:a,anchorY:l,root:u})=>{const h=ES(jge),p=J.useId();let f=!0,m=J.useMemo(()=>(f=!1,{id:p,initial:e,isPresent:t,custom:r,onExitComplete:y=>{h.set(y,!0);for(const x of h.values())if(!x)return;s&&s()},register:y=>(h.set(y,!1),()=>h.delete(y))}),[t,h,s]);return o&&f&&(m={...m}),J.useMemo(()=>{h.forEach((y,x)=>h.set(x,!1))},[t]),J.useEffect(()=>{!t&&!h.size&&s&&s()},[t]),n=ke.jsx(Uge,{pop:i==="popLayout",isPresent:t,anchorX:a,anchorY:l,root:u,children:n}),ke.jsx(ry.Provider,{value:m,children:n})};function jge(){return new Map}function xL(n=!0){const e=J.useContext(ry);if(e===null)return[!0,null];const{isPresent:t,onExitComplete:s,register:r}=e,o=J.useId();J.useEffect(()=>{if(n)return r(o)},[n]);const i=J.useCallback(()=>n&&s&&s(o),[o,s,n]);return!t&&s?[!1,i]:[!0]}const Zp=n=>n.key||"";function c2(n){const e=[];return J.Children.forEach(n,t=>{J.isValidElement(t)&&e.push(t)}),e}const Hge=({children:n,custom:e,initial:t=!0,onExitComplete:s,presenceAffectsLayout:r=!0,mode:o="sync",propagate:i=!1,anchorX:a="left",anchorY:l="top",root:u})=>{const[h,p]=xL(i),f=J.useMemo(()=>c2(n),[n]),m=i&&!h?[]:f.map(Zp),y=J.useRef(!0),x=J.useRef(f),v=ES(()=>new Map),w=J.useRef(new Set),[S,k]=J.useState(f),[T,I]=J.useState(f);XF(()=>{y.current=!1,x.current=f;for(let O=0;O<T.length;O++){const _=Zp(T[O]);m.includes(_)?(v.delete(_),w.current.delete(_)):v.get(_)!==!0&&v.set(_,!1)}},[T,m.length,m.join("-")]);const E=[];if(f!==S){let O=[...f];for(let _=0;_<T.length;_++){const P=T[_],R=Zp(P);m.includes(R)||(O.splice(_,0,P),E.push(P))}return o==="wait"&&E.length&&(O=E),I(c2(O)),k(f),null}const{forceRender:D}=J.useContext($S);return ke.jsx(ke.Fragment,{children:T.map(O=>{const _=Zp(O),P=i&&!h?!1:f===T||m.includes(_),R=()=>{if(w.current.has(_))return;if(w.current.add(_),v.has(_))v.set(_,!0);else return;let W=!0;v.forEach(Q=>{Q||(W=!1)}),W&&(D==null||D(),I(x.current),i&&(p==null||p()),s&&s())};return ke.jsx(Gge,{isPresent:P,initial:!y.current||t?void 0:!1,custom:e,presenceAffectsLayout:r,mode:o,root:u,onExitComplete:P?void 0:R,anchorX:a,anchorY:l,children:O},_)})})},vL=J.createContext({strict:!1}),h2={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]};let d2=!1;function Kge(){if(d2)return;const n={};for(const e in h2)n[e]={isEnabled:t=>h2[e].some(s=>!!t[s])};qP(n),d2=!0}function wL(){return Kge(),Ame()}function qge(n){const e=wL();for(const t in n)e[t]={...e[t],...n[t]};qP(e)}const Xge=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","propagate","ignoreStrict","viewport"]);function im(n){return n.startsWith("while")||n.startsWith("drag")&&n!=="draggable"||n.startsWith("layout")||n.startsWith("onTap")||n.startsWith("onPan")||n.startsWith("onLayout")||Xge.has(n)}let bL=n=>!im(n);function Yge(n){typeof n=="function"&&(bL=e=>e.startsWith("on")?!im(e):n(e))}try{Yge(require("@emotion/is-prop-valid").default)}catch{}function Qge(n,e,t){const s={};for(const r in n)r==="values"&&typeof n.values=="object"||(bL(r)||t===!0&&im(r)||!e&&!im(r)||n.draggable&&r.startsWith("onDrag"))&&(s[r]=n[r]);return s}const ay=J.createContext({});function Zge(n,e){if(iy(n)){const{initial:t,animate:s}=n;return{initial:t===!1||Yc(t)?t:void 0,animate:Yc(s)?s:void 0}}return n.inherit!==!1?e:{}}function Jge(n){const{initial:e,animate:t}=Zge(n,J.useContext(ay));return J.useMemo(()=>({initial:e,animate:t}),[p2(e),p2(t)])}function p2(n){return Array.isArray(n)?n.join(" "):n}const oC=()=>({style:{},transform:{},transformOrigin:{},vars:{}});function SL(n,e,t){for(const s in e)!ss(e[s])&&!tL(s,t)&&(n[s]=e[s])}function eye({transformTemplate:n},e){return J.useMemo(()=>{const t=oC();return nC(t,e,n),Object.assign({},t.vars,t.style)},[e])}function tye(n,e){const t=n.style||{},s={};return SL(s,t,n),Object.assign(s,eye(n,e)),s}function nye(n,e){const t={},s=tye(n,e);return n.drag&&n.dragListener!==!1&&(t.draggable=!1,s.userSelect=s.WebkitUserSelect=s.WebkitTouchCallout="none",s.touchAction=n.drag===!0?"none":`pan-${n.drag==="x"?"y":"x"}`),n.tabIndex===void 0&&(n.onTap||n.onTapStart||n.whileTap)&&(t.tabIndex=0),t.style=s,t}const CL=()=>({...oC(),attrs:{}});function sye(n,e,t,s){const r=J.useMemo(()=>{const o=CL();return nL(o,e,rL(s),n.transformTemplate,n.style),{...o.attrs,style:{...o.style}}},[e]);if(n.style){const o={};SL(o,n.style,n),r.style={...o,...r.style}}return r}const rye=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function iC(n){return typeof n!="string"||n.includes("-")?!1:!!(rye.indexOf(n)>-1||/[A-Z]/u.test(n))}function oye(n,e,t,{latestValues:s},r,o=!1,i){const l=(i??iC(n)?sye:nye)(e,s,r,n),u=Qge(e,typeof n=="string",o),h=n!==J.Fragment?{...u,...l,ref:t}:{},{children:p}=e,f=J.useMemo(()=>ss(p)?p.get():p,[p]);return J.createElement(n,{...h,children:f})}function iye({scrapeMotionValuesFromProps:n,createRenderState:e},t,s,r){return{latestValues:aye(t,s,r,n),renderState:e()}}function aye(n,e,t,s){const r={},o=s(n,{});for(const f in o)r[f]=bf(o[f]);let{initial:i,animate:a}=n;const l=iy(n),u=KP(n);e&&u&&!l&&n.inherit!==!1&&(i===void 0&&(i=e.initial),a===void 0&&(a=e.animate));let h=t?t.initial===!1:!1;h=h||i===!1;const p=h?a:i;if(p&&typeof p!="boolean"&&!oy(p)){const f=Array.isArray(p)?p:[p];for(let m=0;m<f.length;m++){const y=qS(n,f[m]);if(y){const{transitionEnd:x,transition:v,...w}=y;for(const S in w){let k=w[S];if(Array.isArray(k)){const T=h?k.length-1:0;k=k[T]}k!==null&&(r[S]=k)}for(const S in x)r[S]=x[S]}}}return r}const kL=n=>(e,t)=>{const s=J.useContext(ay),r=J.useContext(ry),o=()=>iye(n,e,s,r);return t?o():ES(o)},lye=kL({scrapeMotionValuesFromProps:sC,createRenderState:oC}),uye=kL({scrapeMotionValuesFromProps:oL,createRenderState:CL}),cye=Symbol.for("motionComponentSymbol");function hye(n,e,t){const s=J.useRef(t);J.useInsertionEffect(()=>{s.current=t});const r=J.useRef(null);return J.useCallback(o=>{var a;o&&((a=n.onMount)==null||a.call(n,o)),e&&(o?e.mount(o):e.unmount());const i=s.current;if(typeof i=="function")if(o){const l=i(o);typeof l=="function"&&(r.current=l)}else r.current?(r.current(),r.current=null):i(o);else i&&(i.current=o)},[e])}const TL=J.createContext({});function Rl(n){return n&&typeof n=="object"&&Object.prototype.hasOwnProperty.call(n,"current")}function dye(n,e,t,s,r,o){var k,T;const{visualElement:i}=J.useContext(ay),a=J.useContext(vL),l=J.useContext(ry),u=J.useContext(rC),h=u.reducedMotion,p=u.skipAnimations,f=J.useRef(null),m=J.useRef(!1);s=s||a.renderer,!f.current&&s&&(f.current=s(n,{visualState:e,parent:i,props:t,presenceContext:l,blockInitialAnimation:l?l.initial===!1:!1,reducedMotionConfig:h,skipAnimations:p,isSVG:o}),m.current&&f.current&&(f.current.manuallyAnimateOnMount=!0));const y=f.current,x=J.useContext(TL);y&&!y.projection&&r&&(y.type==="html"||y.type==="svg")&&pye(f.current,t,r,x);const v=J.useRef(!1);J.useInsertionEffect(()=>{y&&v.current&&y.update(t,l)});const w=t[OP],S=J.useRef(!!w&&!((k=window.MotionHandoffIsComplete)!=null&&k.call(window,w))&&((T=window.MotionHasOptimisedAnimation)==null?void 0:T.call(window,w)));return XF(()=>{m.current=!0,y&&(v.current=!0,window.MotionIsMounted=!0,y.updateFeatures(),y.scheduleRenderMicrotask(),S.current&&y.animationState&&y.animationState.animateChanges())}),J.useEffect(()=>{y&&(!S.current&&y.animationState&&y.animationState.animateChanges(),S.current&&(queueMicrotask(()=>{var I;(I=window.MotionHandoffMarkAsComplete)==null||I.call(window,w)}),S.current=!1),y.enteringChildren=void 0)}),y}function pye(n,e,t,s){const{layoutId:r,layout:o,drag:i,dragConstraints:a,layoutScroll:l,layoutRoot:u,layoutCrossfade:h}=e;n.projection=new t(n.latestValues,e["data-framer-portal-id"]?void 0:NL(n.parent)),n.projection.setOptions({layoutId:r,layout:o,alwaysMeasureLayout:!!i||a&&Rl(a),visualElement:n,animationType:typeof o=="string"?o:"both",initialPromotionConfig:s,crossfade:h,layoutScroll:l,layoutRoot:u})}function NL(n){if(n)return n.options.allowProjection!==!1?n.projection:NL(n.parent)}function Mx(n,{forwardMotionProps:e=!1,type:t}={},s,r){s&&qge(s);const o=t?t==="svg":iC(n),i=o?uye:lye;function a(u,h){let p;const f={...J.useContext(rC),...u,layoutId:fye(u)},{isStatic:m}=f,y=Jge(u),x=i(u,m);if(!m&&qF){mye();const v=gye(f);p=v.MeasureLayout,y.visualElement=dye(n,x,f,r,v.ProjectionNode,o)}return ke.jsxs(ay.Provider,{value:y,children:[p&&y.visualElement?ke.jsx(p,{visualElement:y.visualElement,...f}):null,oye(n,u,hye(x,y.visualElement,h),x,m,e,o)]})}a.displayName=`motion.${typeof n=="string"?n:`create(${n.displayName??n.name??""})`}`;const l=J.forwardRef(a);return l[cye]=n,l}function fye({layoutId:n}){const e=J.useContext($S).id;return e&&n!==void 0?e+"-"+n:n}function mye(n,e){J.useContext(vL).strict}function gye(n){const e=wL(),{drag:t,layout:s}=e;if(!t&&!s)return{};const r={...t,...s};return{MeasureLayout:t!=null&&t.isEnabled(n)||s!=null&&s.isEnabled(n)?r.MeasureLayout:void 0,ProjectionNode:r.ProjectionNode}}function yye(n,e){if(typeof Proxy>"u")return Mx;const t=new Map,s=(o,i)=>Mx(o,i,n,e),r=(o,i)=>s(o,i);return new Proxy(r,{get:(o,i)=>i==="create"?s:(t.has(i)||t.set(i,Mx(i,void 0,n,e)),t.get(i))})}const xye=(n,e)=>e.isSVG??iC(n)?new Xme(e):new Ume(e,{allowProjection:n!==J.Fragment});class vye extends ji{constructor(e){super(e),e.animationState||(e.animationState=ege(e))}updateAnimationControlsSubscription(){const{animate:e}=this.node.getProps();oy(e)&&(this.unmountControls=e.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:e}=this.node.getProps(),{animate:t}=this.node.prevProps||{};e!==t&&this.updateAnimationControlsSubscription()}unmount(){var e;this.node.animationState.reset(),(e=this.unmountControls)==null||e.call(this)}}let wye=0;class bye extends ji{constructor(){super(...arguments),this.id=wye++}update(){if(!this.node.presenceContext)return;const{isPresent:e,onExitComplete:t}=this.node.presenceContext,{isPresent:s}=this.node.prevPresenceContext||{};if(!this.node.animationState||e===s)return;const r=this.node.animationState.setActive("exit",!e);t&&!e&&r.then(()=>{t(this.id)})}mount(){const{register:e,onExitComplete:t}=this.node.presenceContext||{};t&&t(this.id),e&&(this.unmount=e(this.id))}unmount(){}}const Sye={animation:{Feature:vye},exit:{Feature:bye}};function Td(n){return{point:{x:n.pageX,y:n.pageY}}}const Cye=n=>e=>ZS(e)&&n(e,Td(e));function Ec(n,e,t,s){return Qc(n,e,Cye(t),s)}const IL=({current:n})=>n?n.ownerDocument.defaultView:null,f2=(n,e)=>Math.abs(n-e);function kye(n,e){const t=f2(n.x,e.x),s=f2(n.y,e.y);return Math.sqrt(t**2+s**2)}const m2=new Set(["auto","scroll"]);class $L{constructor(e,t,{transformPagePoint:s,contextWindow:r=window,dragSnapToOrigin:o=!1,distanceThreshold:i=3,element:a}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.scrollPositions=new Map,this.removeScrollListeners=null,this.onElementScroll=m=>{this.handleScroll(m.target)},this.onWindowScroll=()=>{this.handleScroll(window)},this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const m=Vx(this.lastMoveEventInfo,this.history),y=this.startEvent!==null,x=kye(m.offset,{x:0,y:0})>=this.distanceThreshold;if(!y&&!x)return;const{point:v}=m,{timestamp:w}=Gn;this.history.push({...v,timestamp:w});const{onStart:S,onMove:k}=this.handlers;y||(S&&S(this.lastMoveEvent,m),this.startEvent=this.lastMoveEvent),k&&k(this.lastMoveEvent,m)},this.handlePointerMove=(m,y)=>{this.lastMoveEvent=m,this.lastMoveEventInfo=zx(y,this.transformPagePoint),Et.update(this.updatePoint,!0)},this.handlePointerUp=(m,y)=>{this.end();const{onEnd:x,onSessionEnd:v,resumeAnimation:w}=this.handlers;if((this.dragSnapToOrigin||!this.startEvent)&&w&&w(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const S=Vx(m.type==="pointercancel"?this.lastMoveEventInfo:zx(y,this.transformPagePoint),this.history);this.startEvent&&x&&x(m,S),v&&v(m,S)},!ZS(e))return;this.dragSnapToOrigin=o,this.handlers=t,this.transformPagePoint=s,this.distanceThreshold=i,this.contextWindow=r||window;const l=Td(e),u=zx(l,this.transformPagePoint),{point:h}=u,{timestamp:p}=Gn;this.history=[{...h,timestamp:p}];const{onSessionStart:f}=t;f&&f(e,Vx(u,this.history)),this.removeListeners=Sd(Ec(this.contextWindow,"pointermove",this.handlePointerMove),Ec(this.contextWindow,"pointerup",this.handlePointerUp),Ec(this.contextWindow,"pointercancel",this.handlePointerUp)),a&&this.startScrollTracking(a)}startScrollTracking(e){let t=e.parentElement;for(;t;){const s=getComputedStyle(t);(m2.has(s.overflowX)||m2.has(s.overflowY))&&this.scrollPositions.set(t,{x:t.scrollLeft,y:t.scrollTop}),t=t.parentElement}this.scrollPositions.set(window,{x:window.scrollX,y:window.scrollY}),window.addEventListener("scroll",this.onElementScroll,{capture:!0,passive:!0}),window.addEventListener("scroll",this.onWindowScroll,{passive:!0}),this.removeScrollListeners=()=>{window.removeEventListener("scroll",this.onElementScroll,{capture:!0}),window.removeEventListener("scroll",this.onWindowScroll)}}handleScroll(e){const t=this.scrollPositions.get(e);if(!t)return;const s=e===window,r=s?{x:window.scrollX,y:window.scrollY}:{x:e.scrollLeft,y:e.scrollTop},o={x:r.x-t.x,y:r.y-t.y};o.x===0&&o.y===0||(s?this.lastMoveEventInfo&&(this.lastMoveEventInfo.point.x+=o.x,this.lastMoveEventInfo.point.y+=o.y):this.history.length>0&&(this.history[0].x-=o.x,this.history[0].y-=o.y),this.scrollPositions.set(e,r),Et.update(this.updatePoint,!0))}updateHandlers(e){this.handlers=e}end(){this.removeListeners&&this.removeListeners(),this.removeScrollListeners&&this.removeScrollListeners(),this.scrollPositions.clear(),Di(this.updatePoint)}}function zx(n,e){return e?{point:e(n.point)}:n}function g2(n,e){return{x:n.x-e.x,y:n.y-e.y}}function Vx({point:n},e){return{point:n,delta:g2(n,EL(e)),offset:g2(n,Tye(e)),velocity:Nye(e,.1)}}function Tye(n){return n[0]}function EL(n){return n[n.length-1]}function Nye(n,e){if(n.length<2)return{x:0,y:0};let t=n.length-1,s=null;const r=EL(n);for(;t>=0&&(s=n[t],!(r.timestamp-s.timestamp>ro(e)));)t--;if(!s)return{x:0,y:0};s===n[0]&&n.length>2&&r.timestamp-s.timestamp>ro(e)*2&&(s=n[1]);const o=ur(r.timestamp-s.timestamp);if(o===0)return{x:0,y:0};const i={x:(r.x-s.x)/o,y:(r.y-s.y)/o};return i.x===1/0&&(i.x=0),i.y===1/0&&(i.y=0),i}function Iye(n,{min:e,max:t},s){return e!==void 0&&n<e?n=s?Gt(e,n,s.min):Math.max(n,e):t!==void 0&&n>t&&(n=s?Gt(t,n,s.max):Math.min(n,t)),n}function y2(n,e,t){return{min:e!==void 0?n.min+e:void 0,max:t!==void 0?n.max+t-(n.max-n.min):void 0}}function $ye(n,{top:e,left:t,bottom:s,right:r}){return{x:y2(n.x,t,r),y:y2(n.y,e,s)}}function x2(n,e){let t=e.min-n.min,s=e.max-n.max;return e.max-e.min<n.max-n.min&&([t,s]=[s,t]),{min:t,max:s}}function Eye(n,e){return{x:x2(n.x,e.x),y:x2(n.y,e.y)}}function Rye(n,e){let t=.5;const s=ps(n),r=ps(e);return r>s?t=Kc(e.min,e.max-s,n.min):s>r&&(t=Kc(n.min,n.max-r,e.min)),co(0,1,t)}function Dye(n,e){const t={};return e.min!==void 0&&(t.min=e.min-n.min),e.max!==void 0&&(t.max=e.max-n.min),t}const dw=.35;function Aye(n=dw){return n===!1?n=0:n===!0&&(n=dw),{x:v2(n,"left","right"),y:v2(n,"top","bottom")}}function v2(n,e,t){return{min:w2(n,e),max:w2(n,t)}}function w2(n,e){return typeof n=="number"?n:n[e]||0}const Oye=new WeakMap;class _ye{constructor(e){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=Sn(),this.latestPointerEvent=null,this.latestPanInfo=null,this.visualElement=e}start(e,{snapToCursor:t=!1,distanceThreshold:s}={}){const{presenceContext:r}=this.visualElement;if(r&&r.isPresent===!1)return;const o=p=>{t&&this.snapToCursor(Td(p).point),this.stopAnimation()},i=(p,f)=>{const{drag:m,dragPropagation:y,onDragStart:x}=this.getProps();if(m&&!y&&(this.openDragLock&&this.openDragLock(),this.openDragLock=lme(m),!this.openDragLock))return;this.latestPointerEvent=p,this.latestPanInfo=f,this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),Xr(w=>{let S=this.getAxisMotionValue(w).get()||0;if(oo.test(S)){const{projection:k}=this.visualElement;if(k&&k.layout){const T=k.layout.layoutBox[w];T&&(S=ps(T)*(parseFloat(S)/100))}}this.originPoint[w]=S}),x&&Et.update(()=>x(p,f),!1,!0),rw(this.visualElement,"transform");const{animationState:v}=this.visualElement;v&&v.setActive("whileDrag",!0)},a=(p,f)=>{this.latestPointerEvent=p,this.latestPanInfo=f;const{dragPropagation:m,dragDirectionLock:y,onDirectionLock:x,onDrag:v}=this.getProps();if(!m&&!this.openDragLock)return;const{offset:w}=f;if(y&&this.currentDirection===null){this.currentDirection=Pye(w),this.currentDirection!==null&&x&&x(this.currentDirection);return}this.updateAxis("x",f.point,w),this.updateAxis("y",f.point,w),this.visualElement.render(),v&&Et.update(()=>v(p,f),!1,!0)},l=(p,f)=>{this.latestPointerEvent=p,this.latestPanInfo=f,this.stop(p,f),this.latestPointerEvent=null,this.latestPanInfo=null},u=()=>{const{dragSnapToOrigin:p}=this.getProps();(p||this.constraints)&&this.startAnimation({x:0,y:0})},{dragSnapToOrigin:h}=this.getProps();this.panSession=new $L(e,{onSessionStart:o,onStart:i,onMove:a,onSessionEnd:l,resumeAnimation:u},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:h,distanceThreshold:s,contextWindow:IL(this.visualElement),element:this.visualElement.current})}stop(e,t){const s=e||this.latestPointerEvent,r=t||this.latestPanInfo,o=this.isDragging;if(this.cancel(),!o||!r||!s)return;const{velocity:i}=r;this.startAnimation(i);const{onDragEnd:a}=this.getProps();a&&Et.postRender(()=>a(s,r))}cancel(){this.isDragging=!1;const{projection:e,animationState:t}=this.visualElement;e&&(e.isAnimationBlocked=!1),this.endPanSession();const{dragPropagation:s}=this.getProps();!s&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),t&&t.setActive("whileDrag",!1)}endPanSession(){this.panSession&&this.panSession.end(),this.panSession=void 0}updateAxis(e,t,s){const{drag:r}=this.getProps();if(!s||!Jp(e,r,this.currentDirection))return;const o=this.getAxisMotionValue(e);let i=this.originPoint[e]+s[e];this.constraints&&this.constraints[e]&&(i=Iye(i,this.constraints[e],this.elastic[e])),o.set(i)}resolveConstraints(){var o;const{dragConstraints:e,dragElastic:t}=this.getProps(),s=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):(o=this.visualElement.projection)==null?void 0:o.layout,r=this.constraints;e&&Rl(e)?this.constraints||(this.constraints=this.resolveRefConstraints()):e&&s?this.constraints=$ye(s.layoutBox,e):this.constraints=!1,this.elastic=Aye(t),r!==this.constraints&&!Rl(e)&&s&&this.constraints&&!this.hasMutatedConstraints&&Xr(i=>{this.constraints!==!1&&this.getAxisMotionValue(i)&&(this.constraints[i]=Dye(s.layoutBox[i],this.constraints[i]))})}resolveRefConstraints(){const{dragConstraints:e,onMeasureDragConstraints:t}=this.getProps();if(!e||!Rl(e))return!1;const s=e.current,{projection:r}=this.visualElement;if(!r||!r.layout)return!1;const o=Lme(s,r.root,this.visualElement.getTransformPagePoint());let i=Eye(r.layout.layoutBox,o);if(t){const a=t(_me(i));this.hasMutatedConstraints=!!a,a&&(i=YP(a))}return i}startAnimation(e){const{drag:t,dragMomentum:s,dragElastic:r,dragTransition:o,dragSnapToOrigin:i,onDragTransitionEnd:a}=this.getProps(),l=this.constraints||{},u=Xr(h=>{if(!Jp(h,t,this.currentDirection))return;let p=l&&l[h]||{};i&&(p={min:0,max:0});const f=r?200:1e6,m=r?40:1e7,y={type:"inertia",velocity:s?e[h]:0,bounceStiffness:f,bounceDamping:m,timeConstant:750,restDelta:1,restSpeed:10,...o,...p};return this.startAxisValueAnimation(h,y)});return Promise.all(u).then(a)}startAxisValueAnimation(e,t){const s=this.getAxisMotionValue(e);return rw(this.visualElement,e),s.start(KS(e,s,0,t,this.visualElement,!1))}stopAnimation(){Xr(e=>this.getAxisMotionValue(e).stop())}getAxisMotionValue(e){const t=`_drag${e.toUpperCase()}`,s=this.visualElement.getProps(),r=s[t];return r||this.visualElement.getValue(e,(s.initial?s.initial[e]:void 0)||0)}snapToCursor(e){Xr(t=>{const{drag:s}=this.getProps();if(!Jp(t,s,this.currentDirection))return;const{projection:r}=this.visualElement,o=this.getAxisMotionValue(t);if(r&&r.layout){const{min:i,max:a}=r.layout.layoutBox[t],l=o.get()||0;o.set(e[t]-Gt(i,a,.5)+l)}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:e,dragConstraints:t}=this.getProps(),{projection:s}=this.visualElement;if(!Rl(t)||!s||!this.constraints)return;this.stopAnimation();const r={x:0,y:0};Xr(i=>{const a=this.getAxisMotionValue(i);if(a&&this.constraints!==!1){const l=a.get();r[i]=Rye({min:l,max:l},this.constraints[i])}});const{transformTemplate:o}=this.visualElement.getProps();this.visualElement.current.style.transform=o?o({},""):"none",s.root&&s.root.updateScroll(),s.updateLayout(),this.constraints=!1,this.resolveConstraints(),Xr(i=>{if(!Jp(i,e,null))return;const a=this.getAxisMotionValue(i),{min:l,max:u}=this.constraints[i];a.set(Gt(l,u,r[i]))}),this.visualElement.render()}addListeners(){if(!this.visualElement.current)return;Oye.set(this.visualElement,this);const e=this.visualElement.current,t=Ec(e,"pointerdown",u=>{const{drag:h,dragListener:p=!0}=this.getProps(),f=u.target,m=f!==e&&fme(f);h&&p&&!m&&this.start(u)});let s;const r=()=>{const{dragConstraints:u}=this.getProps();Rl(u)&&u.current&&(this.constraints=this.resolveRefConstraints(),s||(s=Fye(e,u.current,()=>this.scalePositionWithinConstraints())))},{projection:o}=this.visualElement,i=o.addEventListener("measure",r);o&&!o.layout&&(o.root&&o.root.updateScroll(),o.updateLayout()),Et.read(r);const a=Qc(window,"resize",()=>this.scalePositionWithinConstraints()),l=o.addEventListener("didUpdate",(({delta:u,hasLayoutChanged:h})=>{this.isDragging&&h&&(Xr(p=>{const f=this.getAxisMotionValue(p);f&&(this.originPoint[p]+=u[p].translate,f.set(f.get()+u[p].translate))}),this.visualElement.render())}));return()=>{a(),t(),i(),l&&l(),s&&s()}}getProps(){const e=this.visualElement.getProps(),{drag:t=!1,dragDirectionLock:s=!1,dragPropagation:r=!1,dragConstraints:o=!1,dragElastic:i=dw,dragMomentum:a=!0}=e;return{...e,drag:t,dragDirectionLock:s,dragPropagation:r,dragConstraints:o,dragElastic:i,dragMomentum:a}}}function b2(n){let e=!0;return()=>{if(e){e=!1;return}n()}}function Fye(n,e,t){const s=$$(n,b2(t)),r=$$(e,b2(t));return()=>{s(),r()}}function Jp(n,e,t){return(e===!0||e===n)&&(t===null||t===n)}function Pye(n,e=10){let t=null;return Math.abs(n.y)>e?t="y":Math.abs(n.x)>e&&(t="x"),t}class Lye extends ji{constructor(e){super(e),this.removeGroupControls=dr,this.removeListeners=dr,this.controls=new _ye(e)}mount(){const{dragControls:e}=this.node.getProps();e&&(this.removeGroupControls=e.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||dr}update(){const{dragControls:e}=this.node.getProps(),{dragControls:t}=this.node.prevProps||{};e!==t&&(this.removeGroupControls(),e&&(this.removeGroupControls=e.subscribe(this.controls)))}unmount(){this.removeGroupControls(),this.removeListeners(),this.controls.isDragging||this.controls.endPanSession()}}const Bx=n=>(e,t)=>{n&&Et.update(()=>n(e,t),!1,!0)};class Mye extends ji{constructor(){super(...arguments),this.removePointerDownListener=dr}onPointerDown(e){this.session=new $L(e,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:IL(this.node)})}createPanHandlers(){const{onPanSessionStart:e,onPanStart:t,onPan:s,onPanEnd:r}=this.node.getProps();return{onSessionStart:Bx(e),onStart:Bx(t),onMove:Bx(s),onEnd:(o,i)=>{delete this.session,r&&Et.postRender(()=>r(o,i))}}}mount(){this.removePointerDownListener=Ec(this.node.current,"pointerdown",e=>this.onPointerDown(e))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}let Wx=!1;class zye extends J.Component{componentDidMount(){const{visualElement:e,layoutGroup:t,switchLayoutGroup:s,layoutId:r}=this.props,{projection:o}=e;o&&(t.group&&t.group.add(o),s&&s.register&&r&&s.register(o),Wx&&o.root.didUpdate(),o.addEventListener("animationComplete",()=>{this.safeToRemove()}),o.setOptions({...o.options,layoutDependency:this.props.layoutDependency,onExitComplete:()=>this.safeToRemove()})),Sf.hasEverUpdated=!0}getSnapshotBeforeUpdate(e){const{layoutDependency:t,visualElement:s,drag:r,isPresent:o}=this.props,{projection:i}=s;return i&&(i.isPresent=o,e.layoutDependency!==t&&i.setOptions({...i.options,layoutDependency:t}),Wx=!0,r||e.layoutDependency!==t||t===void 0||e.isPresent!==o?i.willUpdate():this.safeToRemove(),e.isPresent!==o&&(o?i.promote():i.relegate()||Et.postRender(()=>{const a=i.getStack();(!a||!a.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:e}=this.props.visualElement;e&&(e.root.didUpdate(),QS.postRender(()=>{!e.currentAnimation&&e.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:e,layoutGroup:t,switchLayoutGroup:s}=this.props,{projection:r}=e;Wx=!0,r&&(r.scheduleCheckAfterUnmount(),t&&t.group&&t.group.remove(r),s&&s.deregister&&s.deregister(r))}safeToRemove(){const{safeToRemove:e}=this.props;e&&e()}render(){return null}}function RL(n){const[e,t]=xL(),s=J.useContext($S);return ke.jsx(zye,{...n,layoutGroup:s,switchLayoutGroup:J.useContext(TL),isPresent:e,safeToRemove:t})}const Vye={pan:{Feature:Mye},drag:{Feature:Lye,ProjectionNode:yL,MeasureLayout:RL}};function S2(n,e,t){const{props:s}=n;n.animationState&&s.whileHover&&n.animationState.setActive("whileHover",t==="Start");const r="onHover"+t,o=s[r];o&&Et.postRender(()=>o(e,Td(e)))}class Bye extends ji{mount(){const{current:e}=this.node;e&&(this.unmount=cme(e,(t,s)=>(S2(this.node,s,"Start"),r=>S2(this.node,r,"End"))))}unmount(){}}class Wye extends ji{constructor(){super(...arguments),this.isActive=!1}onFocus(){let e=!1;try{e=this.node.current.matches(":focus-visible")}catch{e=!0}!e||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=Sd(Qc(this.node.current,"focus",()=>this.onFocus()),Qc(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}function C2(n,e,t){const{props:s}=n;if(n.current instanceof HTMLButtonElement&&n.current.disabled)return;n.animationState&&s.whileTap&&n.animationState.setActive("whileTap",t==="Start");const r="onTap"+(t==="End"?"":t),o=s[r];o&&Et.postRender(()=>o(e,Td(e)))}class Uye extends ji{mount(){const{current:e}=this.node;if(!e)return;const{globalTapTarget:t,propagate:s}=this.node.props;this.unmount=gme(e,(r,o)=>(C2(this.node,o,"Start"),(i,{success:a})=>C2(this.node,i,a?"End":"Cancel")),{useGlobalTarget:t,stopPropagation:(s==null?void 0:s.tap)===!1})}unmount(){}}const pw=new WeakMap,Ux=new WeakMap,Gye=n=>{const e=pw.get(n.target);e&&e(n)},jye=n=>{n.forEach(Gye)};function Hye({root:n,...e}){const t=n||document;Ux.has(t)||Ux.set(t,{});const s=Ux.get(t),r=JSON.stringify(e);return s[r]||(s[r]=new IntersectionObserver(jye,{root:n,...e})),s[r]}function Kye(n,e,t){const s=Hye(e);return pw.set(n,t),s.observe(n),()=>{pw.delete(n),s.unobserve(n)}}const qye={some:0,all:1};class Xye extends ji{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:e={}}=this.node.getProps(),{root:t,margin:s,amount:r="some",once:o}=e,i={root:t?t.current:void 0,rootMargin:s,threshold:typeof r=="number"?r:qye[r]},a=l=>{const{isIntersecting:u}=l;if(this.isInView===u||(this.isInView=u,o&&!u&&this.hasEnteredView))return;u&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",u);const{onViewportEnter:h,onViewportLeave:p}=this.node.getProps(),f=u?h:p;f&&f(l)};return Kye(this.node.current,i,a)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:e,prevProps:t}=this.node;["amount","margin","root"].some(Yye(e,t))&&this.startObserver()}unmount(){}}function Yye({viewport:n={}},{viewport:e={}}={}){return t=>n[t]!==e[t]}const Qye={inView:{Feature:Xye},tap:{Feature:Uye},focus:{Feature:Wye},hover:{Feature:Bye}},Zye={layout:{ProjectionNode:yL,MeasureLayout:RL}},Jye={...Sye,...Qye,...Vye,...Zye},fw=yye(Jye,xye),Gx={faces:{neutral:"https://api.dicebear.com/9.x/fun-emoji/svg?seed=LuckyNeutral",happy:"https://api.dicebear.com/9.x/fun-emoji/svg?seed=LuckyHappy",thinking:"https://api.dicebear.com/9.x/fun-emoji/svg?seed=LuckyThinking",confused:"https://api.dicebear.com/9.x/fun-emoji/svg?seed=LuckyConfused",hangry:"https://api.dicebear.com/9.x/fun-emoji/svg?seed=LuckyAngry"}},k2={ROBOT:{name:"Robot",pitch:.5,rate:.8},ALIEN:{name:"Alien",pitch:1.5,rate:1.2},SQUEAKY:{name:"Squeaky",pitch:1.8,rate:1.1},GRUMPY:{name:"Grumpy",pitch:.3,rate:.7}};function e0e(){const{state:n}=hm(),[e,t]=J.useState(Gx.faces.neutral);return J.useEffect(()=>{const s=n.mood==="neutral"?"neutral":n.mood;t(Gx.faces[s]||Gx.faces.neutral)},[n.mood]),ke.jsxs("div",{className:"relative w-64 h-64 mx-auto mb-4",children:[ke.jsx(Hge,{mode:"wait",children:ke.jsx(fw.img,{src:e,alt:"Lucky",className:"w-full h-full object-contain drop-shadow-2xl",initial:{scale:.8,opacity:0,rotate:-10},animate:{scale:1,opacity:1,rotate:0},exit:{scale:.8,opacity:0,rotate:10},transition:{type:"spring",stiffness:260,damping:20}},n.mood)}),n.mood==="happy"&&ke.jsxs(fw.div,{className:"absolute inset-0 pointer-events-none",initial:{opacity:0},animate:{opacity:1},children:[ke.jsx("div",{className:"text-4xl absolute top-0 left-0",children:""}),ke.jsx("div",{className:"text-4xl absolute top-0 right-0",children:""})]})]})}function t0e(){const{state:n}=hm(),e=t=>t<30?"bg-red-500":t<70?"bg-yellow-400":"bg-green-500";return ke.jsxs("div",{className:"w-full max-w-md mx-auto mt-4 p-4 bg-white rounded-xl shadow-lg border-2 border-gray-200",children:[ke.jsxs("div",{className:"flex justify-between items-center mb-2",children:[ke.jsx("span",{className:"font-bold text-gray-700",children:"Lucky's Mood"}),ke.jsxs("span",{className:"text-sm font-mono",children:[n.moodScore,"%"]})]}),ke.jsx("div",{className:"w-full bg-gray-200 rounded-full h-6 overflow-hidden relative border border-gray-300",children:ke.jsx(fw.div,{className:`h-full ${e(n.moodScore)}`,initial:{width:"50%"},animate:{width:`${n.moodScore}%`},transition:{type:"spring",stiffness:50}})}),ke.jsx("p",{className:"text-center text-xs text-gray-500 mt-2 italic",children:n.moodScore<30?"WARNING: LUCKY IS HANGRY!":"Keep him happy!"})]})}/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const DL=(...n)=>n.filter((e,t,s)=>!!e&&e.trim()!==""&&s.indexOf(e)===t).join(" ").trim();/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const n0e=n=>n.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase();/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const s0e=n=>n.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,s)=>s?s.toUpperCase():t.toLowerCase());/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const T2=n=>{const e=s0e(n);return e.charAt(0).toUpperCase()+e.slice(1)};/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var r0e={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const o0e=n=>{for(const e in n)if(e.startsWith("aria-")||e==="role"||e==="title")return!0;return!1};/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const i0e=J.forwardRef(({color:n="currentColor",size:e=24,strokeWidth:t=2,absoluteStrokeWidth:s,className:r="",children:o,iconNode:i,...a},l)=>J.createElement("svg",{ref:l,...r0e,width:e,height:e,stroke:n,strokeWidth:s?Number(t)*24/Number(e):t,className:DL("lucide",r),...!o&&!o0e(a)&&{"aria-hidden":"true"},...a},[...i.map(([u,h])=>J.createElement(u,h)),...Array.isArray(o)?o:[o]]));/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aC=(n,e)=>{const t=J.forwardRef(({className:s,...r},o)=>J.createElement(i0e,{ref:o,iconNode:e,className:DL(`lucide-${n0e(T2(n))}`,`lucide-${n}`,s),...r}));return t.displayName=T2(n),t};/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const a0e=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],AL=aC("arrow-left",a0e);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const l0e=[["path",{d:"M11 4.702a.705.705 0 0 0-1.203-.498L6.413 7.587A1.4 1.4 0 0 1 5.416 8H3a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h2.416a1.4 1.4 0 0 1 .997.413l3.383 3.384A.705.705 0 0 0 11 19.298z",key:"uqj9uw"}],["path",{d:"M16 9a5 5 0 0 1 0 6",key:"1q6k2b"}],["path",{d:"M19.364 18.364a9 9 0 0 0 0-12.728",key:"ijwkga"}]],u0e=aC("volume-2",l0e);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const c0e=[["path",{d:"M11 4.702a.705.705 0 0 0-1.203-.498L6.413 7.587A1.4 1.4 0 0 1 5.416 8H3a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h2.416a1.4 1.4 0 0 1 .997.413l3.383 3.384A.705.705 0 0 0 11 19.298z",key:"uqj9uw"}],["line",{x1:"22",x2:"16",y1:"9",y2:"15",key:"1ewh16"}],["line",{x1:"16",x2:"22",y1:"9",y2:"15",key:"5ykzw1"}]],h0e=aC("volume-x",c0e);function d0e(){const{state:n,dispatch:e,ACTIONS:t}=hm(),[s,r]=J.useState(!0);J.useEffect(()=>{n.lastTranslation&&s&&o(n.lastTranslation)},[n.lastTranslation]);const o=i=>{if(!window.speechSynthesis)return;window.speechSynthesis.cancel();const a=new SpeechSynthesisUtterance(i),l=k2[n.voice.toUpperCase()]||k2.ROBOT;a.pitch=l.pitch,a.rate=l.rate,window.speechSynthesis.speak(a)};return ke.jsxs("div",{className:"bg-white p-6 rounded-2xl shadow-xl border-4 border-blue-400 min-h-[150px] flex flex-col items-center justify-center relative transform rotate-1 hover:rotate-0 transition-transform duration-300",children:[ke.jsx("button",{onClick:()=>r(!s),className:"absolute top-2 right-2 p-2 rounded-full hover:bg-gray-100",children:s?ke.jsx(u0e,{className:"text-blue-500"}):ke.jsx(h0e,{className:"text-gray-400"})}),ke.jsx("h3",{className:"text-gray-400 text-sm uppercase tracking-widest mb-2 font-bold",children:"Translation"}),ke.jsx("div",{className:"text-4xl font-black text-gray-800 text-center animate-pulse",children:n.lastTranslation||"..."})]})}function p0e(){const n=[{sign:"Thumbs Up",desc:"Means 'Good Job' or 'Yes'. Make a fist and stick your thumb up!"},{sign:"Open Hand",desc:"Means 'Hello' or 'Stop'. Show your palm with fingers spread."},{sign:"Victory",desc:"Means 'Peace' or 'Two'. Index and middle fingers up, others curled."},{sign:"Pointing Up",desc:"Means 'Look up' or 'One'. Just the index finger!"}];return ke.jsxs("div",{className:"min-h-screen bg-purple-50 p-8",children:[ke.jsxs(jl,{to:"/",className:"inline-flex items-center text-blue-600 font-bold mb-6 hover:underline",children:[ke.jsx(AL,{className:"mr-2"})," Back to Lucky"]}),ke.jsx("h1",{className:"text-4xl font-black text-center text-purple-600 mb-8",children:"Teach Me, Lucky!"}),ke.jsx("div",{className:"max-w-4xl mx-auto grid grid-cols-1 sm:grid-cols-2 gap-6",children:n.map((e,t)=>ke.jsxs("div",{className:"bg-white p-6 rounded-2xl shadow-lg border-2 border-purple-100 hover:scale-105 transition-transform",children:[ke.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-2",children:e.sign}),ke.jsx("p",{className:"text-gray-600",children:e.desc}),ke.jsx("div",{className:"mt-4 h-32 bg-gray-200 rounded-lg flex items-center justify-center text-gray-400",children:"Top Secret Image Placeholder"})]},t))})]})}function f0e(){const[n,e]=J.useState("slang"),t=[{term:"Face Palm",definition:"When Lucky makes a bad translation."},{term:"Jazz Hands",definition:"Used when you successfully crash the app (just kidding)."},{term:"The 'What?'",definition:"Shrugging shoulders rapidly because the camera is blurry."}],s=[{term:"A - Z",definition:"The standard alphabet. Boring but useful."},{term:"Numbers",definition:"1, 2, 3... infinite."}];return ke.jsxs("div",{className:"min-h-screen bg-yellow-50 p-8",children:[ke.jsxs(jl,{to:"/",className:"inline-flex items-center text-blue-600 font-bold mb-6 hover:underline",children:[ke.jsx(AL,{className:"mr-2"})," Back to Lucky"]}),ke.jsx("h1",{className:"text-4xl font-black text-center text-yellow-600 mb-8",children:"Sign Dictionary"}),ke.jsxs("div",{className:"max-w-3xl mx-auto",children:[ke.jsxs("div",{className:"flex justify-center gap-4 mb-8",children:[ke.jsx("button",{onClick:()=>e("slang"),className:`px-6 py-2 rounded-full font-bold ${n==="slang"?"bg-yellow-400 text-white":"bg-white text-gray-600"}`,children:"Sign Slang"}),ke.jsx("button",{onClick:()=>e("standard"),className:`px-6 py-2 rounded-full font-bold ${n==="standard"?"bg-blue-400 text-white":"bg-white text-gray-600"}`,children:"Standard"})]}),ke.jsx("div",{className:"space-y-4",children:(n==="slang"?t:s).map((r,o)=>ke.jsxs("div",{className:"bg-white p-4 rounded-xl shadow-sm border border-yellow-200",children:[ke.jsx("h3",{className:"text-xl font-bold text-gray-800",children:r.term}),ke.jsx("p",{className:"text-gray-600 italic",children:r.definition})]},o))})]})]})}function m0e(){return ke.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-indigo-100 to-purple-100 p-8 font-sans",children:[ke.jsxs("header",{className:"mb-8 text-center relative",children:[ke.jsxs("div",{className:"absolute top-0 right-0 gap-4 flex",children:[ke.jsx(jl,{to:"/tutorial",className:"text-blue-600 font-bold hover:underline",children:"Teach Me!"}),ke.jsx(jl,{to:"/dictionary",className:"text-blue-600 font-bold hover:underline",children:"Dictionary"})]}),ke.jsx("h1",{className:"text-6xl font-black text-transparent bg-clip-text bg-gradient-to-r from-blue-600 to-purple-600 drop-shadow-sm rotate-[-2deg] inline-block",children:"LUCKY"}),ke.jsx("p",{className:"text-xl text-gray-600 mt-2 font-semibold",children:"The Sassy Sign Translator"})]}),ke.jsxs("main",{className:"max-w-6xl mx-auto grid grid-cols-1 md:grid-cols-2 gap-8 items-start",children:[ke.jsx("div",{className:"space-y-6",children:ke.jsx("div",{className:"bg-white p-4 rounded-3xl shadow-2xl border-b-8 border-r-8 border-gray-200",children:ke.jsx(ope,{})})}),ke.jsxs("div",{className:"space-y-6 flex flex-col justify-center",children:[ke.jsx(e0e,{}),ke.jsx(t0e,{}),ke.jsx(d0e,{}),ke.jsxs("div",{className:"bg-white p-4 rounded-xl shadow-md border-2 border-gray-100",children:[ke.jsx("label",{className:"block text-sm font-bold text-gray-500 mb-2",children:"Lucky's Voice"}),ke.jsx("div",{className:"flex gap-2",children:["Robot","Alien","Squeaky","Grumpy"].map(n=>ke.jsx("button",{className:"px-4 py-2 bg-blue-100 text-blue-700 rounded-lg hover:bg-blue-200 font-bold text-sm transition-colors",children:n},n))})]})]})]})]})}function g0e(){return ke.jsx(vV,{children:ke.jsx(aV,{children:ke.jsxs(Lz,{children:[ke.jsx(ef,{path:"/",element:ke.jsx(m0e,{})}),ke.jsx(ef,{path:"/tutorial",element:ke.jsx(p0e,{})}),ke.jsx(ef,{path:"/dictionary",element:ke.jsx(f0e,{})})]})})})}zM.createRoot(document.getElementById("root")).render(ke.jsx(AM.StrictMode,{children:ke.jsx(g0e,{})}));
